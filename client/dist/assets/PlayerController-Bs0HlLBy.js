var gu=Object.defineProperty;var yu=(s,e,t)=>e in s?gu(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ye=(s,e,t)=>yu(s,typeof e!="symbol"?e+"":e,t);import{D as Kr,E as ws,G as Jl,H as Ql,I as Zl,J as ec,K as tc,L as ic,N as es,O as Cn,Q as _u,u as Ni,d as ln,U as St,P as Wr,C as Vi,m as cn,_ as dn,r as hi,o as _t,c as Dt,i as Ai,l as Pi,w as oi,j as Di,e as qe,t as Qt,b as kt,n as di,R as Si,h as Yi,F as Xi,v as vu,q as _n,s as vn,a as nc,g as Dr,f as Au,V as Ts,S as bu,T as ks,W as Rs,X as ts,Y as la,Z as lo,$ as Su}from"./index-0KBw0l56.js";import{u as sn,C as rc,I as Eu,a as xu}from"./ChannelsStore-6BmmP5gh.js";import{V as Yr,_ as Cu}from"./ssrBoot-Drq5GoA5.js";import{V as wu}from"./VSwitch-CyZlsd4u.js";import{V as Tu,a as ku}from"./VCard-2D6Bj1o0.js";import{S as Ru,a as Lu}from"./swiper-C9tqf6EG.js";import{C as Iu}from"./CommentMuteSettings-CA22Rt8J.js";import{b as Du,c as ca,d as da}from"./VSelect-DeY_zS_n.js";class Zn{static extractLiveAPIQualityFromDPlayer(e){if(e.quality===null)return"1080p";const t=/streams\/live\/[a-z0-9-]*\/(.*)\/mpegts/,i=e.quality.url.match(t);return i?i[1]:"1080p"}static extractVideoAPIQualityFromDPlayer(e){if(e.quality===null)return"1080p";const t=/streams\/video\/[0-9]*\/(.*)\/playlist/,i=e.quality.url.match(t);return i?i[1]:"1080p"}static generatePlayerBackgroundURL(){return`/assets/images/player-backgrounds/${(Math.floor(Math.random()*50)+1).toString().padStart(2,"0")}.jpg`}static getNetworkCircuitType(){if(navigator.connection&&navigator.connection.type)switch(navigator.connection.type){case"cellular":return"Cellular";default:return"Wi-Fi"}else return console.warn("[PlayerUtils] navigator.connection.type is not available."),null}static isHEVCVideoSupported(){return document.createElement("video").canPlayType('video/mp4; codecs="hvc1.1.6.L123.B0"')==="probably"}}const ac=Kr.reduce((s,e)=>(s[e]={type:[Boolean,String,Number],default:!1},s),{}),sc=Kr.reduce((s,e)=>{const t="offset"+ws(e);return s[t]={type:[String,Number],default:null},s},{}),oc=Kr.reduce((s,e)=>{const t="order"+ws(e);return s[t]={type:[String,Number],default:null},s},{}),co={col:Object.keys(ac),offset:Object.keys(sc),order:Object.keys(oc)};function Ou(s,e,t){let i=s;if(!(t==null||t===!1)){if(e){const n=e.replace(s,"");i+=`-${n}`}return s==="col"&&(i="v-"+i),s==="col"&&(t===""||t===!0)||(i+=`-${t}`),i.toLowerCase()}}const Pu=["auto","start","end","center","baseline","stretch"],Bu=Jl({cols:{type:[Boolean,String,Number],default:!1},...ac,offset:{type:[String,Number],default:null},...sc,order:{type:[String,Number],default:null},...oc,alignSelf:{type:String,default:null,validator:s=>Pu.includes(s)},...Ql(),...Zl()},"VCol"),Mu=ec()({name:"VCol",props:Bu(),setup(s,e){let{slots:t}=e;const i=tc(()=>{const n=[];let o;for(o in co)co[o].forEach(c=>{const d=s[c],f=Ou(o,c,d);f&&n.push(f)});const a=n.some(c=>c.startsWith("v-col-"));return n.push({"v-col":!a||!s.cols,[`v-col-${s.cols}`]:s.cols,[`offset-${s.offset}`]:s.offset,[`order-${s.order}`]:s.order,[`align-self-${s.alignSelf}`]:s.alignSelf}),n});return()=>{var n;return ic(s.tag,{class:[i.value,s.class],style:s.style},(n=t.default)==null?void 0:n.call(t))}}}),Ls=["start","end","center"],lc=["space-between","space-around","space-evenly"];function Is(s,e){return Kr.reduce((t,i)=>{const n=s+ws(i);return t[n]=e(),t},{})}const Fu=[...Ls,"baseline","stretch"],cc=s=>Fu.includes(s),dc=Is("align",()=>({type:String,default:null,validator:cc})),Nu=[...Ls,...lc],hc=s=>Nu.includes(s),uc=Is("justify",()=>({type:String,default:null,validator:hc})),Uu=[...Ls,...lc,"stretch"],fc=s=>Uu.includes(s),pc=Is("alignContent",()=>({type:String,default:null,validator:fc})),ho={align:Object.keys(dc),justify:Object.keys(uc),alignContent:Object.keys(pc)},Gu={align:"align",justify:"justify",alignContent:"align-content"};function $u(s,e,t){let i=Gu[s];if(t!=null){if(e){const n=e.replace(s,"");i+=`-${n}`}return i+=`-${t}`,i.toLowerCase()}}const Vu=Jl({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:cc},...dc,justify:{type:String,default:null,validator:hc},...uc,alignContent:{type:String,default:null,validator:fc},...pc,...Ql(),...Zl()},"VRow"),ju=ec()({name:"VRow",props:Vu(),setup(s,e){let{slots:t}=e;const i=tc(()=>{const n=[];let o;for(o in ho)ho[o].forEach(a=>{const c=s[a],d=$u(o,a,c);d&&n.push(d)});return n.push({"v-row--no-gutters":s.noGutters,"v-row--dense":s.dense,[`align-${s.align}`]:s.align,[`justify-${s.justify}`]:s.justify,[`align-content-${s.alignContent}`]:s.alignContent}),n});return()=>{var n;return ic(s.tag,{class:["v-row",i.value,s.class],style:s.style},(n=t.default)==null?void 0:n.call(t))}}});function Hu(s){return{all:s=s||new Map,on:function(e,t){var i=s.get(e);i?i.push(t):s.set(e,[t])},off:function(e,t){var i=s.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):s.set(e,[]))},emit:function(e,t){var i=s.get(e);i&&i.slice().map(function(n){n(t)}),(i=s.get("*"))&&i.slice().map(function(n){n(e,t)})}}}const zu={id:-1,file_path:"",file_hash:"",file_size:0,recording_start_time:null,recording_end_time:null,duration:0,container_format:"MPEG-TS",video_codec:"MPEG-2",video_codec_profile:"High",video_scan_type:"Interlaced",video_frame_rate:29.97,video_resolution_width:1440,video_resolution_height:1080,primary_audio_codec:"AAC-LC",primary_audio_channel:"Stereo",primary_audio_sampling_rate:48e3,secondary_audio_codec:null,secondary_audio_channel:null,secondary_audio_sampling_rate:null,cm_sections:[]},uo={id:-1,recorded_video:zu,recording_start_margin:0,recording_end_margin:0,is_partially_recorded:!1,channel:null,network_id:null,service_id:null,event_id:null,series_id:null,series_broadcast_period_id:null,title:"取得中…",series_title:null,episode_number:null,subtitle:null,description:"取得中…",detail:{},start_time:"2000-01-01T00:00:00+09:00",end_time:"2000-01-01T00:00:00+09:00",duration:0,is_free:!0,genres:[],primary_audio_type:"2/0モード(ステレオ)",primary_audio_language:"日本語",secondary_audio_type:null,secondary_audio_language:null};class qu{static async fetchVideoJikkyoComments(e){const t=new Date(e.start_time).getTime()/1e3,i=new Date(e.end_time).getTime()/1e3,o=`https://jikkyo.tsukumijima.net/api/kakolog/${e.channel.id}?starttime=${t}&endtime=${i}&format=json`,a=await es.get(o,{timeout:3e4});if(a.type==="error"){let l;switch(a.status){case 500:l="過去ログ API でサーバーエラーが発生しました。過去ログ API に不具合がある可能性があります。(HTTP Error 500)";break;case 503:l="現在、過去ログ API は一時的に利用できなくなっています。(HTTP Error 503)";break;default:l=`現在、過去ログ API でエラーが発生しています。(HTTP Error ${a.status})`}return es.showGenericError(a,l),{is_success:!1,comments:[],detail:l}}const c=await a.data;if("error"in c)return{is_success:!1,comments:[],detail:c.error||"過去ログコメントを取得できませんでした。"};const d=c.packet;return d.length===0?{is_success:!1,comments:[],detail:"この録画番組の過去ログコメントは存在しないか、現在取得中です。"}:{is_success:!0,comments:d.map(l=>{const h=l.chat.content;if(typeof h!="string"||h===""||l.chat.deleted==="1"||/\/[a-z]+ /.test(h))return null;const r=Cn.parseCommentCommand(l.chat.mail),u=l.chat.user_id.startsWith("rekari:")?r.color+"C0":r.color,m=r.position,p=r.size,_=parseInt(l.chat.date),A=parseInt(l.chat.date_usec||"0",10),C={time:parseFloat(`${_-t}.${A}`),type:m,size:p,color:u,author:l.chat.user_id||"",text:h};return Cn.isMutedComment(C.text,C.author,C.color,C.type,C.size)?null:C}).filter(l=>l!==null),detail:"過去ログコメントを取得しました。"}}}const Ku=_u("player",{state:()=>({is_watching:!1,is_player_initialized:!1,event_emitter:Hu(),recorded_program:uo,is_virtual_keyboard_display:!1,is_fullscreen:!1,is_document_pip:!1,is_control_display:!0,is_panel_display:(()=>{const s=Ni();switch(s.settings.panel_display_state){case"AlwaysDisplay":return!0;case"AlwaysFold":return!1;case"RestorePreviousState":return s.settings.showed_panel_last_time}})(),tv_panel_active_tab:Ni().settings.tv_panel_active_tab,video_panel_active_tab:Ni().settings.video_panel_active_tab,twitter_active_tab:Ni().settings.twitter_active_tab,is_remocon_display:!1,is_zapping:!1,is_loading:!0,is_video_buffering:!0,is_video_paused:!1,is_background_display:!1,background_url:"",shortcut_key_modal:!1,live_stream_status:null,live_comment_init_failed_message:null,video_comment_init_failed_message:null}),actions:{startWatching(){this.reset(),this.is_watching=!0},stopWatching(){this.reset(),this.is_watching=!1},reset(){this.is_watching=!1,this.is_player_initialized=!1,this.recorded_program=uo,this.is_virtual_keyboard_display=!1,this.is_fullscreen=!1,this.is_document_pip=!1,this.is_control_display=!0,this.is_panel_display=(()=>{const s=Ni();switch(s.settings.panel_display_state){case"AlwaysDisplay":return!0;case"AlwaysFold":return!1;case"RestorePreviousState":return s.settings.showed_panel_last_time}})(),this.tv_panel_active_tab=Ni().settings.tv_panel_active_tab,this.video_panel_active_tab=Ni().settings.video_panel_active_tab,this.twitter_active_tab=Ni().settings.twitter_active_tab,this.is_remocon_display=!1,this.is_zapping=!1,this.is_loading=!0,this.is_video_buffering=!0,this.is_video_paused=!1,this.is_background_display=!1,this.background_url="",this.shortcut_key_modal=!1,this.live_stream_status=null,this.live_comment_init_failed_message=null}}}),pi=Ku,Wu=ln({name:"Watch-Header",props:{playback_mode:{type:String,required:!0}},data(){return{Utils:Object.freeze(St),ProgramUtils:Object.freeze(Wr),time:Vi().format(St.isSmartphoneHorizontal()?"HH:mm:ss":"YYYY/MM/DD HH:mm:ss"),time_interval_id:0}},computed:{...cn(sn,pi)},created(){this.time_interval_id=window.setInterval(()=>{this.time=Vi().format(St.isSmartphoneHorizontal()?"HH:mm:ss":"YYYY/MM/DD HH:mm:ss")},.1*1e3)},beforeUnmount(){window.clearInterval(this.time_interval_id)}}),Yu=["src"],Xu=["innerHTML"],Ju={class:"watch-header__program-time"},Qu={class:"watch-header__now"};function Zu(s,e,t,i,n,o){const a=hi("Icon"),c=hi("router-link");return _t(),Dt("header",{class:di(["watch-header",{"watch-header--video":s.playback_mode==="Video"}])},[Ai((_t(),Pi(c,{class:"watch-header__back-icon",to:s.playback_mode==="Live"?"/":"/log/"},{default:oi(()=>[kt(a,{icon:"fluent:arrow-left-12-filled",width:"25px"})]),_:1},8,["to"])),[[Si]]),s.playback_mode==="Live"?(_t(),Dt("img",{key:0,class:"watch-header__broadcaster",src:`${s.Utils.api_base_url}/channels/${s.channelsStore.channel.current.id}/logo`},null,8,Yu)):Di("",!0),qe("span",{class:"watch-header__program-title",innerHTML:s.ProgramUtils.decorateProgramInfo(s.playback_mode==="Live"?s.channelsStore.channel.current.program_present:s.playerStore.recorded_program,"title")},null,8,Xu),qe("span",Ju,Qt(s.ProgramUtils.getProgramTime(s.playback_mode==="Live"?s.channelsStore.channel.current.program_present:s.playerStore.recorded_program,!0)),1),kt(Yr),qe("span",Qu,Qt(s.time),1)],2)}const ef=dn(Wu,[["render",Zu],["__scopeId","data-v-554c1bc2"]]),tf={left_column:[{name:"全般",icon:"fluent:home-20-filled",icon_height:"22px",shortcuts:[{name:"数字キー/テンキーに対応するリモコン番号 (1~12) の地デジチャンネルに切り替える",keys:[{name:"1~9, 0, -(=), ^(~)",icon:!1}]},{name:"数字キー/テンキーに対応するリモコン番号 (1~12) の BS チャンネルに切り替える",keys:[{name:"Shift",icon:!1},{name:"1~9, 0, -(=), ^(~)",icon:!1}]},{name:"前のチャンネルに切り替える",keys:[{name:"fluent:arrow-up-12-filled",icon:!0}]},{name:"次のチャンネルに切り替える",keys:[{name:"fluent:arrow-down-12-filled",icon:!0}]},{name:"キーボードショートカットの一覧を表示する",keys:[{name:"／(？)",icon:!1}]}]},{name:"プレイヤー",icon:"fluent:play-20-filled",icon_height:"20px",shortcuts:[{name:"再生 / 一時停止の切り替え",keys:[{name:"Space",icon:!1}]},{name:"フルスクリーンの切り替え",keys:[{name:"F",icon:!1}]},{name:"Picture-in-Picture の表示切り替え",keys:[{name:"E",icon:!1}]},{name:"コメントの表示切り替え",keys:[{name:"D",icon:!1}]},{name:"コメント入力フォームにフォーカスする",keys:[{name:"M",icon:!1}]},{name:"コメント入力フォームを閉じる",keys:[{name:St.CtrlOrCmd(),icon:!1},{name:"M",icon:!1}]},{name:"コメントを送信する",keys:[{name:"コメント入力フォームを表示",icon:!1},{name:"Enter",icon:!1}]}]}],right_column:[{name:"パネル",icon:"fluent:panel-right-20-filled",icon_height:"24px",shortcuts:[{name:"パネルの表示切り替え",keys:[{name:"P",icon:!1}]},{name:"番組情報タブを表示する",keys:[{name:"K",icon:!1}]},{name:"チャンネルタブを表示する",keys:[{name:"L",icon:!1}]},{name:"コメントタブを表示する",keys:[{name:"；(＋)",icon:!1}]}]}]},nf={left_column:[{name:"全般",icon:"fluent:home-20-filled",icon_height:"22px",shortcuts:[{name:"キーボードショートカットの一覧を表示する",keys:[{name:"／(？)",icon:!1}]}]},{name:"プレイヤー",icon:"fluent:play-20-filled",icon_height:"20px",shortcuts:[{name:"再生 / 一時停止の切り替え",keys:[{name:"Space",icon:!1}]},{name:"5秒早戻し",keys:[{name:"fluent:arrow-left-12-filled",icon:!0}]},{name:"5秒早送り",keys:[{name:"fluent:arrow-right-12-filled",icon:!0}]},{name:"15秒早戻し",keys:[{name:St.CtrlOrCmd(),icon:!1},{name:"fluent:arrow-left-12-filled",icon:!0}]},{name:"15秒早送り",keys:[{name:St.CtrlOrCmd(),icon:!1},{name:"fluent:arrow-right-12-filled",icon:!0}]},{name:"30秒早戻し",keys:[{name:"Shift",icon:!1},{name:"fluent:arrow-left-12-filled",icon:!0}]},{name:"30秒早送り",keys:[{name:"Shift",icon:!1},{name:"fluent:arrow-right-12-filled",icon:!0}]},{name:"60秒早戻し",keys:[{name:St.AltOrOption(),icon:!1},{name:"fluent:arrow-left-12-filled",icon:!0}]},{name:"60秒早送り",keys:[{name:St.AltOrOption(),icon:!1},{name:"fluent:arrow-right-12-filled",icon:!0}]},{name:"フルスクリーンの切り替え",keys:[{name:"F",icon:!1}]},{name:"Picture-in-Picture の表示切り替え",keys:[{name:"E",icon:!1}]},{name:"コメントの表示切り替え",keys:[{name:"D",icon:!1}]}]}],right_column:[{name:"パネル",icon:"fluent:panel-right-20-filled",icon_height:"24px",shortcuts:[{name:"パネルの表示切り替え",keys:[{name:"P",icon:!1}]},{name:"番組情報タブを表示する",keys:[{name:"K",icon:!1}]},{name:"コメントタブを表示する",keys:[{name:"；(＋)",icon:!1}]}]}]},rf=ln({name:"KeyboardShortcutList",props:{playback_mode:{type:String,required:!0}},data(){return{Utils:Object.freeze(St),live_shortcut_list:structuredClone(tf),video_shortcut_list:structuredClone(nf)}},computed:{...cn(pi,Ni),shortcut_list(){return this.playback_mode==="Live"?this.live_shortcut_list:this.video_shortcut_list}},created(){this.settingsStore.settings.tv_channel_selection_requires_alt_key===!0&&(this.live_shortcut_list.left_column[0].shortcuts[0].keys.unshift({name:St.AltOrOption(),icon:!1}),this.live_shortcut_list.left_column[0].shortcuts[1].keys.unshift({name:St.AltOrOption(),icon:!1}))}}),mc=s=>(_n("data-v-68c6a102"),s=s(),vn(),s),af=mc(()=>qe("span",{class:"ml-3"},"キーボードショートカット",-1)),sf={class:"px-5 pb-6"},of={class:"text-subtitle-1 d-flex align-center font-weight-bold"},lf={key:1,width:"24px",height:"24px",viewBox:"0 0 512 512"},cf=mc(()=>qe("path",{fill:"currentColor",d:"M248.039 381.326L355.039 67.8258C367.539 28.3257 395.039 34.3258 406.539 34.3258C431.039 34.3258 453.376 61.3258 441.039 96.8258C362.639 322.426 343.539 375.326 340.539 384.826C338.486 391.326 342.039 391.326 345.539 391.326C377.039 391.326 386.539 418.326 386.539 435.326C386.539 458.826 371.539 477.326 350.039 477.326H214.539C179.039 477.326 85.8269 431.3 88.0387 335.826C91.0387 206.326 192.039 183.326 243.539 183.326H296.539L265.539 272.326H243.539C185.539 272.326 174.113 314.826 176.039 334.326C180.039 374.826 215.039 389.814 237.039 390.326C244.539 390.5 246.039 386.826 248.039 381.326Z"},null,-1)),df=[cf],hf={class:"ml-2"},uf={class:"text-subtitle-2 mt-2 d-flex align-center font-weight-medium"},ff=["innerHTML"],pf={class:"ml-auto d-flex align-center flex-shrink-0"},mf={class:"shortcut-key"},gf=["innerHTML"],yf={key:0,class:"shortcut-key-plus"};function _f(s,e,t,i,n,o){const a=hi("Icon");return _t(),Pi(wu,{"max-width":"1050",transition:"slide-y-transition",modelValue:s.playerStore.shortcut_key_modal,"onUpdate:modelValue":e[1]||(e[1]=c=>s.playerStore.shortcut_key_modal=c)},{default:oi(()=>[kt(ku,null,{default:oi(()=>[kt(Tu,{class:"px-5 pt-6 pb-3 d-flex align-center font-weight-bold"},{default:oi(()=>[kt(a,{icon:"fluent:keyboard-20-filled",height:"28px"}),af,kt(Yr),Ai((_t(),Dt("div",{class:"d-flex align-center rounded-circle cursor-pointer px-2 py-2",onClick:e[0]||(e[0]=c=>s.playerStore.shortcut_key_modal=!1)},[kt(a,{icon:"fluent:dismiss-12-filled",width:"23px",height:"23px"})])),[[Si]])]),_:1}),qe("div",sf,[kt(ju,null,{default:oi(()=>[(_t(!0),Dt(Xi,null,Yi(s.shortcut_list,(c,d)=>(_t(),Pi(Mu,{cols:"6",key:d},{default:oi(()=>[(_t(!0),Dt(Xi,null,Yi(c,f=>(_t(),Dt("div",{class:"mt-3",key:f.name},[qe("div",of,[f.name!=="データ放送"?(_t(),Pi(a,{key:0,icon:f.icon,height:f.icon_height},null,8,["icon","height"])):(_t(),Dt("svg",lf,df)),qe("span",hf,Qt(f.name),1)]),(_t(!0),Dt(Xi,null,Yi(f.shortcuts,l=>(_t(),Dt("div",{class:"mt-3",key:l.name},[qe("div",uf,[qe("span",{class:"mr-2",innerHTML:l.name},null,8,ff),qe("div",pf,[(_t(!0),Dt(Xi,null,Yi(l.keys,(h,r)=>(_t(),Dt("div",{class:"ml-auto d-flex align-center",key:h.name},[qe("span",mf,[(_t(!0),Dt(Xi,null,Yi(h.name.split(";"),u=>Ai((_t(),Pi(a,{icon:u,height:"18px",key:u},null,8,["icon"])),[[vu,h.icon===!0]])),128)),h.icon===!1?(_t(),Dt("span",{key:0,innerHTML:h.name},null,8,gf)):Di("",!0)]),r<l.keys.length-1?(_t(),Dt("span",yf,"+")):Di("",!0)]))),128))])])]))),128))]))),128))]),_:2},1024))),128))]),_:1})])]),_:1})]),_:1},8,["modelValue"])}const vf=dn(rf,[["render",_f],["__scopeId","data-v-68c6a102"]]),Af=ln({name:"Watch-Navigation",computed:{...cn(pi)}}),bf="/assets/images/icon.svg",Sf=s=>(_n("data-v-23625336"),s=s(),vn(),s),Ef=Sf(()=>qe("img",{class:"watch-navigation__icon-image",src:bf,width:"23px"},null,-1)),xf={class:"watch-navigation__link",href:"https://jikkyo.tsukumijima.net",target:"_blank"};function Cf(s,e,t,i,n,o){const a=hi("router-link"),c=hi("Icon"),d=nc("tooltip");return _t(),Dt("nav",{class:"watch-navigation",onMousemove:e[0]||(e[0]=f=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:f})),onTouchmove:e[1]||(e[1]=f=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:f})),onClick:e[2]||(e[2]=f=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:f}))},[Ai((_t(),Pi(a,{class:"watch-navigation__icon",to:"/"},{default:oi(()=>[Ef]),_:1})),[[Si]]),Ai((_t(),Pi(a,{class:di(["watch-navigation__link",{"watch-navigation__link--active":s.$route.path.startsWith("/watch")}]),"active-class":"watch-navigation__link--active",to:"/"},{default:oi(()=>[kt(c,{class:"watch-navigation__link-icon",icon:"fluent:tv-20-regular",width:"26px"})]),_:1},8,["class"])),[[Si],[d,"テレビ実況",void 0,{right:!0}]]),Ai((_t(),Pi(a,{class:di(["watch-navigation__link",{"watch-navigation__link--active":s.$route.path.startsWith("/log")}]),"active-class":"watch-navigation__link--active",to:"/log/"},{default:oi(()=>[kt(c,{class:"watch-navigation__link-icon",icon:"fluent:receipt-play-20-regular",width:"26px"})]),_:1},8,["class"])),[[Si],[d,"過去ログ再生",void 0,{right:!0}]]),Ai((_t(),Dt("a",xf,[kt(c,{class:"watch-navigation__link-icon",icon:"fluent:slide-text-multiple-20-regular",width:"26px"})])),[[Si],[d,"過去ログ API",void 0,{right:!0}]]),Ai((_t(),Pi(a,{class:di(["watch-navigation__link",{"watch-navigation__link--active":s.$route.path.startsWith("/about")}]),"active-class":"watch-navigation__link--active",to:"/about/"},{default:oi(()=>[kt(c,{class:"watch-navigation__link-icon",icon:"fluent:info-16-regular",width:"26px"})]),_:1},8,["class"])),[[Si],[d,"NX-Jikkyo とは",void 0,{right:!0}]]),kt(Yr),Ai((_t(),Pi(a,{class:di(["watch-navigation__link",{"watch-navigation__link--active":s.$route.path.startsWith("/settings")}]),"active-class":"watch-navigation__link--active",to:"/settings/"},{default:oi(()=>[kt(c,{class:"watch-navigation__link-icon",icon:"fluent:settings-20-regular",width:"26px"})]),_:1},8,["class"])),[[Si],[d,"設定",void 0,{right:!0}]])],32)}const wf=dn(Af,[["render",Cf],["__scopeId","data-v-23625336"]]),Tf=ln({name:"Panel-ChannelTab",components:{Swiper:Ru,SwiperSlide:Lu},data(){return{Utils:Object.freeze(St),ChannelUtils:Object.freeze(rc),ProgramUtils:Object.freeze(Wr),active_tab_index:0,swiper_instance:null}},computed:{...cn(sn,pi)},watch:{active_tab_index(){var s,e;(s=this.swiper_instance)==null||s.updateAutoHeight(),(e=this.swiper_instance)==null||e.slideTo(this.active_tab_index)},async"playerStore.tv_panel_active_tab"(){var s;await St.sleep(.05),(s=this.swiper_instance)==null||s.updateAutoHeight()},async"playerStore.video_panel_active_tab"(){var s;await St.sleep(.05),(s=this.swiper_instance)==null||s.updateAutoHeight()}},async mounted(){var s,e,t;if(await St.sleep(.05),(s=this.swiper_instance)==null||s.updateAutoHeight(),(e=document.querySelector(".channels-list-container"))==null||e.addEventListener("scroll",()=>{var i;(i=this.swiper_instance)==null||i.updateAutoHeight()},{passive:!0}),this.playerStore.tv_panel_active_tab==="Channel")for(let i=0;i<20;i++)await St.sleep(.1),(t=this.swiper_instance)==null||t.updateAutoHeight()}}),Xr=s=>(_n("data-v-de79e876"),s=s(),vn(),s),kf={class:"channels-container channels-container--watch"},Rf={class:"channels-tab"},Lf=Xr(()=>qe("div",{class:"channels-tab__highlight"},null,-1)),If={class:"channels-list-container"},Df={class:"channels"},Of={class:"channel__broadcaster"},Pf=["src"],Bf={class:"channel__broadcaster-content"},Mf={class:"channel__broadcaster-name"},Ff=Xr(()=>qe("svg",{class:"iconify iconify--fa-solid",width:"9.63px",height:"11px",viewBox:"0 0 448 512"},[qe("path",{fill:"currentColor",d:"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z"})],-1)),Nf={class:"ml-1"},Uf={class:"channel__program-present"},Gf=["innerHTML"],$f={class:"channel__program-present-time"},Vf={class:"channel__program-following"},jf={class:"channel__program-following-title"},Hf=Xr(()=>qe("span",{class:"channel__program-following-title-decorate"},"NEXT",-1)),zf=Xr(()=>qe("svg",{class:"channel__program-following-title-icon iconify iconify--fluent",width:"16px",height:"16px",viewBox:"0 0 20 20"},[qe("path",{fill:"currentColor",d:"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z"})],-1)),qf=["innerHTML"],Kf={class:"channel__program-following-time"},Wf={class:"channel__progressbar"};function Yf(s,e,t,i,n,o){const a=hi("router-link"),c=hi("SwiperSlide"),d=hi("Swiper");return _t(),Dt("div",kf,[qe("div",Rf,[qe("div",{class:"channels-tab__buttons",style:Dr({"--tab-length":Array.from(s.channelsStore.channels_list_with_pinned_for_watch).length,"--active-tab-index":s.active_tab_index})},[(_t(!0),Dt(Xi,null,Yi(Array.from(s.channelsStore.channels_list_with_pinned_for_watch),([f],l)=>(_t(),Pi(Ts,{variant:"flat",class:di(["channels-tab__button",{"channels-tab__button--active":s.active_tab_index===l}]),key:f,onClick:h=>s.active_tab_index=l},{default:oi(()=>[Au(Qt(f),1)]),_:2},1032,["class","onClick"]))),128)),Lf],4)]),qe("div",If,[kt(d,{class:"channels-list","space-between":32,"auto-height":!0,"touch-start-prevent-default":!1,observer:!0,"observe-parents":!0,onSwiper:e[0]||(e[0]=f=>s.swiper_instance=f),onSlideChange:e[1]||(e[1]=f=>s.active_tab_index=f.activeIndex)},{default:oi(()=>[(_t(!0),Dt(Xi,null,Yi(Array.from(s.channelsStore.channels_list_with_pinned_for_watch),([f,l])=>(_t(),Pi(c,{key:f},{default:oi(()=>[qe("div",Df,[(_t(!0),Dt(Xi,null,Yi(l,h=>Ai((_t(),Pi(a,{class:"channel",draggable:"false",key:h.id,to:`/watch/${h.display_channel_id}`},{default:oi(()=>[qe("div",Of,[qe("img",{class:"channel__broadcaster-icon",src:`${s.Utils.api_base_url}/channels/${h.id}/logo`},null,8,Pf),qe("div",Bf,[qe("span",Mf,"Ch: "+Qt(h.channel_number)+" "+Qt(h.name),1),qe("div",{class:di(["channel__broadcaster-force",`channel__broadcaster-force--${s.ChannelUtils.getChannelForceType(h.jikkyo_force)}`])},[Ff,qe("span",Nf,Qt(h.jikkyo_force??"--"),1)],2)])]),qe("div",Uf,[qe("span",{class:"channel__program-present-title",innerHTML:s.ProgramUtils.decorateProgramInfo(h.program_present,"title")},null,8,Gf),qe("span",$f,Qt(s.ProgramUtils.getProgramTime(h.program_present)),1)]),qe("div",Vf,[qe("div",jf,[Hf,zf,qe("span",{class:"channel__program-following-title-text",innerHTML:s.ProgramUtils.decorateProgramInfo(h.program_following,"title")},null,8,qf)]),qe("span",Kf,Qt(s.ProgramUtils.getProgramTime(h.program_following)),1)]),qe("div",Wf,[qe("div",{class:"channel__progressbar-progress",style:Dr(`width:${s.ProgramUtils.getProgramProgress(h.program_present)}%;`)},null,4)])]),_:2},1032,["to"])),[[Si]])),128))])]),_:2},1024))),128))]),_:1})])])}const Xf=dn(Tf,[["render",Yf],["__scopeId","data-v-de79e876"]]),Jf=ln({name:"Panel-CommentTab",components:{CommentMuteSettings:Iu},props:{playback_mode:{type:String,required:!0}},data(){return{Utils:Object.freeze(St),is_manual_scroll:!1,is_auto_scrolling:!1,comment_list:[],comment_list_element:null,is_comment_list_dropdown_display:!1,comment_list_dropdown_top:0,comment_list_dropdown_comment:null,comment_mute_settings_modal:!1,visibilitychange_listener:null}},computed:{...cn(sn,pi)},watch:{"channelsStore.channel.current.id":{handler(){this.playback_mode==="Live"&&(this.comment_list=[])}}},mounted(){this.comment_list_element===null&&(this.comment_list_element=document.querySelector(".comment-list"));let s=!1;this.comment_list_element.onmousedown=o=>{if(this.comment_list_element===null)return;o.clientX-this.comment_list_element.getBoundingClientRect().left>this.comment_list_element.clientWidth&&(s=!0)},this.comment_list_element.onmouseup=o=>{if(this.comment_list_element===null)return;o.clientX-this.comment_list_element.getBoundingClientRect().left>this.comment_list_element.clientWidth&&(s=!1)};const e=()=>{s=!0,window.setTimeout(()=>s=!1,100)};let t=!1;this.comment_list_element.ontouchstart=()=>t=!0,this.comment_list_element.ontouchend=()=>t=!1,this.comment_list_element.ontouchmove=()=>t===!0?e():"",this.comment_list_element.onwheel=e,this.comment_list_element.onscroll=async()=>{this.comment_list_element!==null&&this.is_auto_scrolling===!1&&s===!0&&(this.is_manual_scroll=!0,await St.sleep(.1),this.comment_list_element.scrollTop+this.comment_list_element.offsetHeight>this.comment_list_element.scrollHeight-10&&(this.is_manual_scroll=!1))};const i=[],n=500;this.playerStore.event_emitter.on("CommentReceived",async o=>{if(o.is_initial_comments===!0)this.comment_list=[],this.comment_list.push(...o.comments),this.playback_mode==="Live"&&this.scrollCommentList();else{if(document.visibilityState==="hidden"){i.push(...o.comments);return}this.comment_list.length>=n&&this.is_manual_scroll===!1&&this.comment_list.splice(0,Math.max(0,this.comment_list.length-n)),this.comment_list.push(...o.comments),this.scrollCommentList()}}),this.playerStore.event_emitter.on("CommentSendCompleted",async o=>{this.comment_list.push(o.comment),this.scrollCommentList()}),this.visibilitychange_listener=()=>{if(document.visibilityState==="visible"){const o=this.comment_list.length+i.length;o>=n&&this.is_manual_scroll===!1&&this.comment_list.splice(0,Math.max(0,o-n)),this.comment_list.push(...i),i.length=0,this.scrollCommentList()}},document.addEventListener("visibilitychange",this.visibilitychange_listener)},beforeUnmount(){this.visibilitychange_listener!==null&&(document.removeEventListener("visibilitychange",this.visibilitychange_listener),this.visibilitychange_listener=null),this.playerStore.event_emitter.off("CommentReceived"),this.playerStore.event_emitter.off("CommentSendCompleted"),this.comment_list=[]},methods:{showCommentListDropdown(s,e){const t=this.$refs.comment_list_wrapper.getBoundingClientRect(),i=106,n=s.currentTarget.getBoundingClientRect();this.comment_list_dropdown_top=n.top-t.top,this.comment_list_dropdown_top+i>t.height&&(this.comment_list_dropdown_top=this.comment_list_dropdown_top-i+n.height),this.comment_list_dropdown_comment=e,this.is_comment_list_dropdown_display=!0},hideCommentListDropdown(){this.is_comment_list_dropdown_display=!1,this.comment_list=this.comment_list.filter(s=>Cn.isMutedComment(s.text,s.user_id)===!1)},copyTextToClipboard(){this.comment_list_dropdown_comment!==null&&(navigator.clipboard.writeText(this.comment_list_dropdown_comment.text),this.hideCommentListDropdown())},addMutedKeywords(){this.comment_list_dropdown_comment!==null&&(Cn.addMutedKeywords(this.comment_list_dropdown_comment.text),this.hideCommentListDropdown())},addMutedNiconicoUserIds(){this.comment_list_dropdown_comment!==null&&(Cn.addMutedNiconicoUserIDs(this.comment_list_dropdown_comment.user_id),this.hideCommentListDropdown())},async scrollCommentList(s=!1){if(this.comment_list_element===null||(this.is_comment_list_dropdown_display===!0&&(this.is_manual_scroll=!0),this.is_manual_scroll===!0))return;this.is_auto_scrolling=!0;const e=(t=3)=>{t<=0||window.requestAnimationFrame(()=>{var i,n;s===!0?(i=this.comment_list_element)==null||i.scrollTo({top:this.comment_list_element.scrollHeight,left:0,behavior:"smooth"}):(n=this.comment_list_element)==null||n.scrollTo(0,this.comment_list_element.scrollHeight),e(t-1)})};e(),await St.sleep(.1),this.is_auto_scrolling=!1}}}),Hi=s=>(_n("data-v-b4be8147"),s=s(),vn(),s),Qf={class:"comment-container"},Zf={class:"comment-header"},ep={class:"comment-header__title"},tp=Hi(()=>qe("span",{class:"comment-header__title-text"},"コメント",-1)),ip=Hi(()=>qe("span",{class:"ml-1"},"ミュート設定",-1)),np={class:"comment-list-wrapper",ref:"comment_list_wrapper"},rp=Hi(()=>qe("span",{class:"ml-2"},"クリップボードにコピー",-1)),ap=Hi(()=>qe("span",{class:"ml-2"},"このコメントをミュート",-1)),sp=Hi(()=>qe("span",{class:"ml-2"},"このコメントの投稿者をミュート",-1)),op={class:"comment__text"},lp={class:"comment__time"},cp=["onMouseup","onTouchend"],dp=Hi(()=>qe("svg",{class:"iconify iconify--fluent",width:"20px",height:"20px",viewBox:"0 0 20 20"},[qe("path",{fill:"currentColor",d:"M10 6.5A1.75 1.75 0 1 1 10 3a1.75 1.75 0 0 1 0 3.5ZM10 17a1.75 1.75 0 1 1 0-3.5a1.75 1.75 0 0 1 0 3.5Zm-1.75-7a1.75 1.75 0 1 0 3.5 0a1.75 1.75 0 0 0-3.5 0Z"})],-1)),hp=[dp],up={key:0,class:"comment-announce"},fp=Hi(()=>qe("div",{class:"comment-announce__heading"},"まだコメントがありません。",-1)),pp=Hi(()=>qe("div",{class:"comment-announce__text"},[qe("p",{class:"mt-0 mb-0"},"このチャンネルに対応する実況のコメントが、リアルタイムで表示されます。")],-1)),mp=[fp,pp],gp={key:1,class:"comment-announce"},yp=Hi(()=>qe("div",{class:"comment-announce__heading"},"コメントがありません。",-1)),_p={class:"comment-announce__text"},vp={class:"mt-0 mb-0"},Ap={key:2,class:"comment-announce"},bp=Hi(()=>qe("div",{class:"comment-announce__heading"},"まだコメントがありません。",-1)),Sp=Hi(()=>qe("div",{class:"comment-announce__text"},[qe("p",{class:"mt-0 mb-0"},"この録画番組に対応する、実況の過去ログコメントを取得しています...")],-1)),Ep=[bp,Sp],xp={key:3,class:"comment-announce"},Cp=Hi(()=>qe("div",{class:"comment-announce__heading"},"コメントがありません。",-1)),wp={class:"comment-announce__text"},Tp={class:"mt-0 mb-0"};function kp(s,e,t,i,n,o){const a=hi("Icon"),c=hi("DynamicScrollerItem"),d=hi("DynamicScroller"),f=hi("CommentMuteSettings");return _t(),Dt("div",Qf,[qe("section",Zf,[qe("h2",ep,[kt(a,{class:"comment-header__title-icon",icon:"bi:chat-left-text-fill",height:"18.5px"}),tp]),Ai((_t(),Dt("button",{class:"comment-header__button ml-auto",onClick:e[0]||(e[0]=l=>s.comment_mute_settings_modal=!s.comment_mute_settings_modal)},[kt(a,{icon:"heroicons-solid:filter",height:"11px"}),ip])),[[Si]])]),qe("section",np,[qe("div",{class:di(["comment-list-dropdown",{"comment-list-dropdown--display":s.is_comment_list_dropdown_display}]),style:Dr({"--comment-list-dropdown-top":`${s.comment_list_dropdown_top}px`})},[kt(Du,{style:{background:"rgb(var(--v-theme-background-lighten-1))"}},{default:oi(()=>[kt(ca,{density:"compact",style:{"min-height":"30px"},onClick:e[1]||(e[1]=l=>s.copyTextToClipboard())},{default:oi(()=>[kt(da,{class:"d-flex align-center"},{default:oi(()=>[kt(a,{icon:"fluent:clipboard-paste-20-filled",width:"20px"}),rp]),_:1})]),_:1}),kt(ca,{density:"compact",style:{"min-height":"30px"},onClick:e[2]||(e[2]=l=>s.addMutedKeywords())},{default:oi(()=>[kt(da,{class:"d-flex align-center"},{default:oi(()=>[kt(a,{icon:"fluent:comment-dismiss-20-filled",width:"20px"}),ap]),_:1})]),_:1}),kt(ca,{density:"compact",style:{"min-height":"30px"},onClick:e[3]||(e[3]=l=>s.addMutedNiconicoUserIds())},{default:oi(()=>[kt(da,{class:"d-flex align-center"},{default:oi(()=>[kt(a,{icon:"fluent:person-prohibited-20-filled",width:"20px"}),sp]),_:1})]),_:1})]),_:1})],6),qe("div",{class:di(["comment-list-cover",{"comment-list-cover--display":s.is_comment_list_dropdown_display}]),onClick:e[4]||(e[4]=l=>s.hideCommentListDropdown())},null,2),kt(d,{class:"comment-list",direction:"vertical",items:s.comment_list,"min-item-size":34},{default:oi(({item:l,active:h})=>[kt(c,{item:l,active:h,"size-dependencies":[l.text]},{default:oi(()=>[qe("div",{class:di(["comment",{"comment--my-post":l.my_post}])},[qe("span",op,Qt(l.text),1),qe("span",lp,Qt(l.rekari?"[Re:仮] ":"")+Qt(l.time),1),Ai((_t(),Dt("div",{class:"comment__icon",onMouseup:r=>s.showCommentListDropdown(r,l),onTouchend:r=>s.showCommentListDropdown(r,l)},hp,40,cp)),[[Si,!s.Utils.isTouchDevice()]])],2)]),_:2},1032,["item","active","size-dependencies"])]),_:1},8,["items"]),s.playback_mode==="Live"&&s.playerStore.live_comment_init_failed_message===null&&s.comment_list.length===0?(_t(),Dt("div",up,mp)):Di("",!0),s.playback_mode==="Live"&&s.playerStore.live_comment_init_failed_message!==null&&s.comment_list.length===0?(_t(),Dt("div",gp,[yp,qe("div",_p,[qe("p",vp,Qt(s.playerStore.live_comment_init_failed_message),1)])])):Di("",!0),s.playback_mode==="Video"&&s.playerStore.video_comment_init_failed_message===null&&s.comment_list.length===0?(_t(),Dt("div",Ap,Ep)):Di("",!0),s.playback_mode==="Video"&&s.playerStore.video_comment_init_failed_message!==null&&s.comment_list.length===0?(_t(),Dt("div",xp,[Cp,qe("div",wp,[qe("p",Tp,Qt(s.playerStore.video_comment_init_failed_message),1)])])):Di("",!0)],512),Ai((_t(),Dt("div",{class:di(["comment-scroll-button elevation-5",{"comment-scroll-button--display":s.is_manual_scroll}]),onClick:e[5]||(e[5]=l=>{s.is_manual_scroll=!1,s.scrollCommentList(!0)})},[kt(a,{icon:"fluent:arrow-down-12-filled",height:"29px"})],2)),[[Si]]),kt(f,{modelValue:s.comment_mute_settings_modal,"onUpdate:modelValue":e[6]||(e[6]=l=>s.comment_mute_settings_modal=l)},null,8,["modelValue"])])}const Rp=dn(Jf,[["render",kp],["__scopeId","data-v-b4be8147"]]),Lp=ln({name:"Panel-ProgramTab",data(){return{Utils:Object.freeze(St),ChannelUtils:Object.freeze(rc),ProgramUtils:Object.freeze(Wr)}},computed:{...cn(sn)},methods:{shareToTwitter(){var t;const s=this.channelsStore.channel.current,e=`NX-Jikkyo で【Ch: ${s.channel_number} ${s.name}】「${(t=s.program_present)==null?void 0:t.title}」を実況中🎧  #NXJikkyo
https://nx-jikkyo.tsukumijima.net/watch/${s.id}`;window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(e)}`)}}}),Jr=s=>(_n("data-v-eb149415"),s=s(),vn(),s),Ip={class:"program-container"},Dp={class:"program-broadcaster"},Op=["src"],Pp={class:"program-broadcaster__number"},Bp={class:"program-broadcaster__name"},Mp={class:"program-info"},Fp=["innerHTML"],Np={class:"program-info__time"},Up=["innerHTML"],Gp={class:"program-info__next"},$p=Jr(()=>qe("span",{class:"program-info__next-decorate"},"NEXT",-1)),Vp=["innerHTML"],jp={class:"program-info__next-time"},Hp={class:"program-info__status"},zp=Jr(()=>qe("span",{class:"ml-2"},"勢い:",-1)),qp={class:"ml-1"},Kp={class:"program-info__status-viewers ml-3"},Wp=Jr(()=>qe("span",{class:"ml-2"},"累計コメント数:",-1)),Yp={class:"ml-1"},Xp=Jr(()=>qe("span",{class:"ml-1"},"Twitter でシェア",-1)),Jp={class:"program-detail-container"},Qp={class:"program-detail__heading"},Zp=["innerHTML"];function em(s,e,t,i,n,o){var c;const a=hi("Icon");return _t(),Dt("div",Ip,[qe("section",Dp,[qe("img",{class:"program-broadcaster__icon",src:`${s.Utils.api_base_url}/channels/${s.channelsStore.channel.current.id}/logo`},null,8,Op),qe("div",Pp,"Ch: "+Qt(s.channelsStore.channel.current.channel_number),1),qe("div",Bp,Qt(s.channelsStore.channel.current.name),1)]),qe("section",Mp,[qe("h1",{class:"program-info__title",innerHTML:s.ProgramUtils.decorateProgramInfo(s.channelsStore.channel.current.program_present,"title")},null,8,Fp),qe("div",Np,Qt(s.ProgramUtils.getProgramTime(s.channelsStore.channel.current.program_present)),1),qe("div",{class:"program-info__description",innerHTML:s.ProgramUtils.decorateProgramInfo(s.channelsStore.channel.current.program_present,"description")},null,8,Up),qe("div",Gp,[$p,kt(a,{class:"program-info__next-icon",icon:"fluent:fast-forward-20-filled",width:"16px"})]),qe("span",{class:"program-info__next-title",innerHTML:s.ProgramUtils.decorateProgramInfo(s.channelsStore.channel.current.program_following,"title")},null,8,Vp),qe("div",jp,Qt(s.ProgramUtils.getProgramTime(s.channelsStore.channel.current.program_following)),1),qe("div",Hp,[qe("div",{class:di(["program-info__status-force",`program-info__status-force--${s.ChannelUtils.getChannelForceType(s.channelsStore.channel.current.jikkyo_force)}`])},[kt(a,{icon:"fa-solid:fire-alt",height:"14px"}),zp,qe("span",qp,Qt(s.channelsStore.channel.current.jikkyo_force??"--")+" コメ/分",1)],2),qe("div",Kp,[kt(a,{icon:"bi:chat-left-text-fill",height:"14px"}),Wp,qe("span",Yp,Qt(s.channelsStore.channel.current.viewer_count),1)])]),kt(Ts,{class:"mt-4 px-3 py-0",style:{background:"#1d9BF0",height:"32px","border-radius":"6px","font-size":"13.5px"},onClick:e[0]||(e[0]=d=>s.shareToTwitter())},{default:oi(()=>[kt(a,{icon:"fa-brands:twitter",height:"16px"}),Xp]),_:1})]),qe("section",Jp,[(_t(!0),Dt(Xi,null,Yi(((c=s.channelsStore.channel.current.program_present)==null?void 0:c.detail)??{},(d,f)=>(_t(),Dt("div",{class:"program-detail",key:f},[qe("h2",Qp,Qt(f),1),qe("div",{class:"program-detail__text",innerHTML:s.Utils.URLtoLink(d)},null,8,Zp)]))),128))])])}const tm=dn(Lp,[["render",em],["__scopeId","data-v-eb149415"]]),im=ln({name:"Panel-RecordedProgramTab",data(){return{Utils:Object.freeze(St),ProgramUtils:Object.freeze(Wr),comment_count:null}},computed:{...cn(pi)},created(){this.playerStore.event_emitter.on("CommentReceived",s=>{s.is_initial_comments===!0&&(this.comment_count=s.comments.length)})},beforeUnmount(){this.playerStore.event_emitter.off("CommentReceived")},methods:{shareToTwitter(){const s=this.playerStore.recorded_program.channel??Eu,e=Vi(this.playerStore.recorded_program.start_time),t=Vi(this.playerStore.recorded_program.end_time),i=e.hour()<4?e.subtract(1,"day"):e,n=`NX-Jikkyo で【Ch: ${s.channel_number} ${s.name}】${i.format("YYYY年MM月DD日 (dd)")} ${i.format("HH:mm")} 〜 ${t.format("HH:mm")} の過去ログコメントを再生中🎧  #NXJikkyo
https://nx-jikkyo.tsukumijima.net/log/${this.$route.params.display_channel_id}/${this.$route.params.kakolog_period_id}`;window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(n)}`)}}}),gc=s=>(_n("data-v-0f294d19"),s=s(),vn(),s),nm={class:"program-container"},rm={class:"program-info"},am=["innerHTML"],sm={key:0,class:"program-info__broadcaster"},om=["src"],lm={class:"program-info__broadcaster-container"},cm={class:"d-flex align-center"},dm={class:"program-info__broadcaster-number"},hm={class:"program-info__broadcaster-name"},um={class:"program-info__broadcaster-time"},fm=["innerHTML"],pm={class:"program-info__genre-container"},mm={class:"mt-2"},gm={class:"program-info__status"},ym=gc(()=>qe("span",{class:"ml-2"},"コメント数:",-1)),_m={class:"ml-2"},vm=gc(()=>qe("span",{class:"ml-1"},"Twitter でシェア",-1)),Am={class:"program-detail-container"},bm={class:"program-detail__heading"},Sm=["innerHTML"];function Em(s,e,t,i,n,o){const a=hi("Icon");return _t(),Dt("div",nm,[qe("section",rm,[qe("h1",{class:"program-info__title",innerHTML:s.ProgramUtils.decorateProgramInfo(s.playerStore.recorded_program,"title")},null,8,am),s.playerStore.recorded_program.channel!==null?(_t(),Dt("div",sm,[qe("img",{class:"program-info__broadcaster-icon",src:`${s.Utils.api_base_url}/channels/${s.playerStore.recorded_program.channel.id}/logo`},null,8,om),qe("div",lm,[qe("div",cm,[qe("div",dm,"Ch: "+Qt(s.playerStore.recorded_program.channel.channel_number),1),qe("div",hm,Qt(s.playerStore.recorded_program.channel.name),1)]),qe("div",um,Qt(s.ProgramUtils.getProgramTime(s.playerStore.recorded_program)),1)])])):Di("",!0),qe("div",{class:"program-info__description",innerHTML:s.ProgramUtils.decorateProgramInfo(s.playerStore.recorded_program,"description")},null,8,fm),qe("div",pm,[(_t(!0),Dt(Xi,null,Yi(s.playerStore.recorded_program.genres??[],(c,d)=>(_t(),Dt("div",{class:"program-info__genre",key:d},Qt(c.major)+" / "+Qt(c.middle),1))),128))]),qe("div",mm,[qe("div",gm,[kt(a,{icon:"bi:chat-left-text-fill",height:"12.5px",style:{"margin-bottom":"-3px"}}),ym,qe("span",_m,Qt(s.comment_count??"--"),1)])]),kt(Ts,{class:"mt-4 px-3 py-0",style:{background:"#1d9BF0",height:"32px","border-radius":"6px","font-size":"13.5px"},onClick:e[0]||(e[0]=c=>s.shareToTwitter())},{default:oi(()=>[kt(a,{icon:"fa-brands:twitter",height:"16px"}),vm]),_:1})]),qe("section",Am,[(_t(!0),Dt(Xi,null,Yi(s.playerStore.recorded_program.detail??{},(c,d)=>(_t(),Dt("div",{class:"program-detail",key:d},[qe("h2",bm,Qt(d),1),qe("div",{class:"program-detail__text",innerHTML:s.Utils.URLtoLink(c)},null,8,Sm)]))),128))])])}const xm=dn(im,[["render",Em],["__scopeId","data-v-0f294d19"]]),Cm=ln({name:"Watch-Panel",components:{Channel:Xf,Comment:Rp,Program:tm,RecordedProgram:xm},props:{playback_mode:{type:String,required:!0}},data(){return{Utils:Object.freeze(St)}},computed:{...cn(sn,pi),panel_active_tab(){return this.playback_mode==="Live"?this.playerStore.tv_panel_active_tab:this.playerStore.video_panel_active_tab}}}),or=s=>(_n("data-v-7d76ef90"),s=s(),vn(),s),wm={class:"watch-panel__header"},Tm=or(()=>qe("span",{class:"panel-close-button__text"},"閉じる",-1)),km={key:0,class:"panel-broadcaster"},Rm=["src"],Lm={class:"panel-broadcaster__number"},Im={class:"panel-broadcaster__name"},Dm={class:"watch-panel__content-container"},Om={class:"watch-panel__navigation"},Pm=or(()=>qe("span",{class:"panel-navigation-button__text"},"情報",-1)),Bm=or(()=>qe("span",{class:"panel-navigation-button__text"},"情報",-1)),Mm=or(()=>qe("span",{class:"panel-navigation-button__text"},"チャンネル",-1)),Fm=or(()=>qe("span",{class:"panel-navigation-button__text"},"コメント",-1));function Nm(s,e,t,i,n,o){const a=hi("Icon"),c=hi("Program"),d=hi("RecordedProgram"),f=hi("Channel"),l=hi("Comment");return _t(),Dt("div",{class:"watch-panel",onMousemove:e[5]||(e[5]=h=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:h}))},[qe("div",wm,[Ai((_t(),Dt("div",{class:"panel-close-button",onClick:e[0]||(e[0]=h=>s.playerStore.is_panel_display=!1)},[kt(a,{class:"panel-close-button__icon",icon:"akar-icons:chevron-right",width:"25px"}),Tm])),[[Si]]),kt(Yr),s.playback_mode==="Live"?(_t(),Dt("div",km,[qe("img",{class:"panel-broadcaster__icon",src:`${s.Utils.api_base_url}/channels/${s.channelsStore.channel.current.id}/logo`},null,8,Rm),qe("div",Lm,Qt(s.channelsStore.channel.current.channel_number),1),qe("div",Im,Qt(s.channelsStore.channel.current.name),1)])):Di("",!0)]),qe("div",Dm,[s.playback_mode==="Live"?(_t(),Pi(c,{key:0,class:di(["watch-panel__content",{"watch-panel__content--active":s.panel_active_tab==="Program"}])},null,8,["class"])):Di("",!0),s.playback_mode==="Video"?(_t(),Pi(d,{key:1,class:di(["watch-panel__content",{"watch-panel__content--active":s.panel_active_tab==="RecordedProgram"}])},null,8,["class"])):Di("",!0),s.playback_mode==="Live"?(_t(),Pi(f,{key:2,class:di(["watch-panel__content",{"watch-panel__content--active":s.panel_active_tab==="Channel"}])},null,8,["class"])):Di("",!0),kt(l,{class:di(["watch-panel__content",{"watch-panel__content--active":s.panel_active_tab==="Comment"}]),playback_mode:s.playback_mode},null,8,["playback_mode","class"])]),qe("div",Om,[s.playback_mode==="Live"?Ai((_t(),Dt("div",{key:0,class:di(["panel-navigation-button",{"panel-navigation-button--active":s.panel_active_tab==="Program"}]),onClick:e[1]||(e[1]=h=>s.playerStore.tv_panel_active_tab="Program")},[kt(a,{class:"panel-navigation-button__icon",icon:"fa-solid:info-circle",width:"33px"}),Pm],2)),[[Si]]):Di("",!0),s.playback_mode==="Video"?Ai((_t(),Dt("div",{key:1,class:di(["panel-navigation-button",{"panel-navigation-button--active":s.panel_active_tab==="RecordedProgram"}]),onClick:e[2]||(e[2]=h=>s.playerStore.video_panel_active_tab="RecordedProgram")},[kt(a,{class:"panel-navigation-button__icon",icon:"fa-solid:info-circle",width:"33px"}),Bm],2)),[[Si]]):Di("",!0),s.playback_mode==="Live"?Ai((_t(),Dt("div",{key:2,class:di(["panel-navigation-button",{"panel-navigation-button--active":s.panel_active_tab==="Channel"}]),onClick:e[3]||(e[3]=h=>s.playerStore.tv_panel_active_tab="Channel")},[kt(a,{class:"panel-navigation-button__icon",icon:"fa-solid:broadcast-tower",width:"34px"}),Mm],2)),[[Si]]):Di("",!0),Ai((_t(),Dt("div",{class:di(["panel-navigation-button",{"panel-navigation-button--active":s.panel_active_tab==="Comment"}]),onClick:e[4]||(e[4]=h=>s.playback_mode==="Live"?s.playerStore.tv_panel_active_tab="Comment":s.playerStore.video_panel_active_tab="Comment")},[kt(a,{class:"panel-navigation-button__icon",icon:"bi:chat-left-text-fill",width:"29px"}),Fm],2)),[[Si]])])],32)}const Um=dn(Cm,[["render",Nm],["__scopeId","data-v-7d76ef90"]]),Gm=ln({name:"Watch-Player",props:{playback_mode:{type:String,required:!0}},data(){return{Utils:Object.freeze(St),time:Vi().format(`YYYY/MM/DD
HH:mm:ss`),time_interval_id:0}},computed:{...cn(sn,pi,Ni)},created(){this.time_interval_id=window.setInterval(()=>{if(this.playerStore.recorded_program&&this.playerStore.recorded_program.id===-1){if(window.player&&window.player.video&&window.player.video.paused){this.time="〈コメント再生停止中〉";return}this.time=Vi().format(`YYYY/MM/DD
HH:mm:ss`)}else if(this.playerStore.recorded_program){const s=window.player;s&&s.video&&(this.time=Vi(this.playerStore.recorded_program.start_time).add(s.video.currentTime,"second").format(`YYYY/MM/DD
HH:mm:ss`))}},.1*1e3)},beforeUnmount(){window.clearInterval(this.time_interval_id)}}),yc=s=>(_n("data-v-27ce78ae"),s=s(),vn(),s),$m={class:"watch-player__background-wrapper"},Vm={class:"watch-player__background-text"},jm=yc(()=>qe("img",{class:"watch-player__background-logo",src:Cu},null,-1)),Hm=yc(()=>qe("div",{class:"watch-player__dplayer"},null,-1));function zm(s,e,t,i,n,o){const a=hi("Icon"),c=nc("tooltip");return _t(),Dt("div",{class:di(["watch-player",{"watch-player--loading":s.playerStore.is_loading,"watch-player--virtual-keyboard-display":s.playerStore.is_virtual_keyboard_display&&s.Utils.hasActiveElementClass("dplayer-comment-input"),"watch-player--video":s.playback_mode==="Video"}])},[qe("div",$m,[qe("div",{class:di(["watch-player__background",{"watch-player__background--display":s.playerStore.is_background_display,"watch-player__background--background-hide":s.settingsStore.settings.show_player_background_image===!1}]),style:Dr({backgroundImage:`url(${s.playerStore.background_url})`})},[qe("div",Vm,Qt(s.time),1),jm],6)]),kt(bu,{indeterminate:"",size:"60",width:"6",class:di(["watch-player__buffering",{"watch-player__buffering--display":s.playerStore.is_video_buffering}])},null,8,["class"]),Hm,qe("div",{class:"watch-player__button",onMousemove:e[3]||(e[3]=d=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:d})),onTouchmove:e[4]||(e[4]=d=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:d})),onClick:e[5]||(e[5]=d=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:d}))},[s.playback_mode==="Live"?Ai((_t(),Dt("div",{key:0,class:"switch-button switch-button-up",onClick:e[0]||(e[0]=d=>{s.playerStore.is_zapping=!0,s.$router.push({path:`/watch/${s.channelsStore.channel.previous.display_channel_id}`})})},[kt(a,{class:"switch-button-icon",icon:"fluent:ios-arrow-left-24-filled",width:"32px",style:{transform:"rotate(90deg)"}})])),[[Si],[c,"前のチャンネル",void 0,{top:!0}]]):Di("",!0),Ai((_t(),Dt("div",{class:di(["switch-button switch-button-panel",{"switch-button-panel--open":s.playerStore.is_panel_display}]),onClick:e[1]||(e[1]=d=>s.playerStore.is_panel_display=!s.playerStore.is_panel_display)},[kt(a,{class:"switch-button-icon",icon:"fluent:navigation-16-filled",width:"32px"})],2)),[[Si]]),s.playback_mode==="Live"?Ai((_t(),Dt("div",{key:1,class:"switch-button switch-button-down",onClick:e[2]||(e[2]=d=>{s.playerStore.is_zapping=!0,s.$router.push({path:`/watch/${s.channelsStore.channel.next.display_channel_id}`})})},[kt(a,{class:"switch-button-icon",icon:"fluent:ios-arrow-right-24-filled",width:"33px",style:{transform:"rotate(90deg)"}})])),[[Si],[c,"次のチャンネル",void 0,{bottom:!0}]]):Di("",!0)],32)],2)}const qm=dn(Gm,[["render",zm],["__scopeId","data-v-27ce78ae"]]),Km=ln({name:"Watch",components:{WatchHeader:ef,WatchNavigation:wf,WatchPanel:Um,WatchPlayer:qm,KeyboardShortcutList:vf},props:{playback_mode:{type:String,required:!0}},data(){return{Utils:Object.freeze(St)}},computed:{...cn(pi,Ni)},watch:{"playerStore.is_panel_display":{handler(){this.settingsStore.settings.showed_panel_last_time=this.playerStore.is_panel_display}}},created(){"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.ongeometrychange=s=>{s.target.boundingRect.width===0&&s.target.boundingRect.height===0?this.playerStore.is_virtual_keyboard_display=!1:this.playerStore.is_virtual_keyboard_display=!0}),this.playerStore.startWatching()},beforeUnmount(){this.playerStore.stopWatching(),"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!1)}}),Wm={class:"route-container"};function Ym(s,e,t,i,n,o){const a=hi("WatchNavigation"),c=hi("WatchHeader"),d=hi("WatchPlayer"),f=hi("WatchPanel"),l=hi("KeyboardShortcutList");return _t(),Dt("div",Wm,[qe("main",{class:di(["watch-container",{"watch-container--control-display":s.playerStore.is_control_display,"watch-container--panel-display":s.Utils.isSmartphoneVertical()||s.Utils.isTabletVertical()?!0:s.playerStore.is_panel_display,"watch-container--fullscreen":s.playerStore.is_fullscreen,"watch-container--document-pip":s.playerStore.is_document_pip,"watch-container--video":s.playback_mode==="Video"}])},[kt(a),qe("div",{class:"watch-content",onMousemove:e[0]||(e[0]=h=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:h,is_player_region_event:!0})),onTouchmove:e[1]||(e[1]=h=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:h,is_player_region_event:!0})),onClick:e[2]||(e[2]=h=>s.playerStore.event_emitter.emit("SetControlDisplayTimer",{event:h,is_player_region_event:!0}))},[kt(c,{playback_mode:s.playback_mode},null,8,["playback_mode"]),kt(d,{playback_mode:s.playback_mode},null,8,["playback_mode"])],32),kt(f,{playback_mode:s.playback_mode},null,8,["playback_mode"])],2),kt(l,{playback_mode:s.playback_mode},null,8,["playback_mode"])])}const vb=dn(Km,[["render",Ym],["__scopeId","data-v-092f3824"]]);var ha={exports:{}},ua={},zn={},_c={},Ds=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0},Xm=Ds,Os=function(){return Xm()&&!!Symbol.toStringTag},Jm=Error,Qm=EvalError,Zm=RangeError,e0=ReferenceError,vc=SyntaxError,Qr=TypeError,t0=URIError,fo=typeof Symbol<"u"&&Symbol,i0=Ds,n0=function(){return typeof fo!="function"||typeof Symbol!="function"||typeof fo("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:i0()},fa={__proto__:null,foo:{}},r0=Object,a0=function(){return{__proto__:fa}.foo===fa.foo&&!(fa instanceof r0)},s0="Function.prototype.bind called on incompatible ",o0=Object.prototype.toString,l0=Math.max,c0="[object Function]",po=function(e,t){for(var i=[],n=0;n<e.length;n+=1)i[n]=e[n];for(var o=0;o<t.length;o+=1)i[o+e.length]=t[o];return i},d0=function(e,t){for(var i=[],n=t,o=0;n<e.length;n+=1,o+=1)i[o]=e[n];return i},h0=function(s,e){for(var t="",i=0;i<s.length;i+=1)t+=s[i],i+1<s.length&&(t+=e);return t},u0=function(e){var t=this;if(typeof t!="function"||o0.apply(t)!==c0)throw new TypeError(s0+t);for(var i=d0(arguments,1),n,o=function(){if(this instanceof n){var l=t.apply(this,po(i,arguments));return Object(l)===l?l:this}return t.apply(e,po(i,arguments))},a=l0(0,t.length-i.length),c=[],d=0;d<a;d++)c[d]="$"+d;if(n=Function("binder","return function ("+h0(c,",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var f=function(){};f.prototype=t.prototype,n.prototype=new f,f.prototype=null}return n},f0=u0,Ps=Function.prototype.bind||f0,p0=Function.prototype.call,m0=Object.prototype.hasOwnProperty,g0=Ps,y0=g0.call(p0,m0),Vt,_0=Jm,v0=Qm,A0=Zm,b0=e0,qn=vc,Vn=Qr,S0=t0,Ac=Function,pa=function(s){try{return Ac('"use strict"; return ('+s+").constructor;")()}catch{}},wn=Object.getOwnPropertyDescriptor;if(wn)try{wn({},"")}catch{wn=null}var ma=function(){throw new Vn},E0=wn?function(){try{return arguments.callee,ma}catch{try{return wn(arguments,"callee").get}catch{return ma}}}():ma,Ln=n0(),x0=a0(),Ri=Object.getPrototypeOf||(x0?function(s){return s.__proto__}:null),Nn={},C0=typeof Uint8Array>"u"||!Ri?Vt:Ri(Uint8Array),Tn={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Vt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Vt:ArrayBuffer,"%ArrayIteratorPrototype%":Ln&&Ri?Ri([][Symbol.iterator]()):Vt,"%AsyncFromSyncIteratorPrototype%":Vt,"%AsyncFunction%":Nn,"%AsyncGenerator%":Nn,"%AsyncGeneratorFunction%":Nn,"%AsyncIteratorPrototype%":Nn,"%Atomics%":typeof Atomics>"u"?Vt:Atomics,"%BigInt%":typeof BigInt>"u"?Vt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Vt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Vt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Vt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":_0,"%eval%":eval,"%EvalError%":v0,"%Float32Array%":typeof Float32Array>"u"?Vt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Vt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Vt:FinalizationRegistry,"%Function%":Ac,"%GeneratorFunction%":Nn,"%Int8Array%":typeof Int8Array>"u"?Vt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Vt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Vt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ln&&Ri?Ri(Ri([][Symbol.iterator]())):Vt,"%JSON%":typeof JSON=="object"?JSON:Vt,"%Map%":typeof Map>"u"?Vt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ln||!Ri?Vt:Ri(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Vt:Promise,"%Proxy%":typeof Proxy>"u"?Vt:Proxy,"%RangeError%":A0,"%ReferenceError%":b0,"%Reflect%":typeof Reflect>"u"?Vt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Vt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ln||!Ri?Vt:Ri(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Vt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ln&&Ri?Ri(""[Symbol.iterator]()):Vt,"%Symbol%":Ln?Symbol:Vt,"%SyntaxError%":qn,"%ThrowTypeError%":E0,"%TypedArray%":C0,"%TypeError%":Vn,"%Uint8Array%":typeof Uint8Array>"u"?Vt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Vt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Vt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Vt:Uint32Array,"%URIError%":S0,"%WeakMap%":typeof WeakMap>"u"?Vt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Vt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Vt:WeakSet};if(Ri)try{null.error}catch(s){var w0=Ri(Ri(s));Tn["%Error.prototype%"]=w0}var T0=function s(e){var t;if(e==="%AsyncFunction%")t=pa("async function () {}");else if(e==="%GeneratorFunction%")t=pa("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=pa("async function* () {}");else if(e==="%AsyncGenerator%"){var i=s("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=s("%AsyncGenerator%");n&&Ri&&(t=Ri(n.prototype))}return Tn[e]=t,t},mo={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},lr=Ps,Or=y0,k0=lr.call(Function.call,Array.prototype.concat),R0=lr.call(Function.apply,Array.prototype.splice),go=lr.call(Function.call,String.prototype.replace),Pr=lr.call(Function.call,String.prototype.slice),L0=lr.call(Function.call,RegExp.prototype.exec),I0=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,D0=/\\(\\)?/g,O0=function(e){var t=Pr(e,0,1),i=Pr(e,-1);if(t==="%"&&i!=="%")throw new qn("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new qn("invalid intrinsic syntax, expected opening `%`");var n=[];return go(e,I0,function(o,a,c,d){n[n.length]=c?go(d,D0,"$1"):a||o}),n},P0=function(e,t){var i=e,n;if(Or(mo,i)&&(n=mo[i],i="%"+n[0]+"%"),Or(Tn,i)){var o=Tn[i];if(o===Nn&&(o=T0(i)),typeof o>"u"&&!t)throw new Vn("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:o}}throw new qn("intrinsic "+e+" does not exist!")},cr=function(e,t){if(typeof e!="string"||e.length===0)throw new Vn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Vn('"allowMissing" argument must be a boolean');if(L0(/^%?[^%]*%?$/,e)===null)throw new qn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=O0(e),n=i.length>0?i[0]:"",o=P0("%"+n+"%",t),a=o.name,c=o.value,d=!1,f=o.alias;f&&(n=f[0],R0(i,k0([0,1],f)));for(var l=1,h=!0;l<i.length;l+=1){var r=i[l],u=Pr(r,0,1),m=Pr(r,-1);if((u==='"'||u==="'"||u==="`"||m==='"'||m==="'"||m==="`")&&u!==m)throw new qn("property names with quotes must have matching quotes");if((r==="constructor"||!h)&&(d=!0),n+="."+r,a="%"+n+"%",Or(Tn,a))c=Tn[a];else if(c!=null){if(!(r in c)){if(!t)throw new Vn("base intrinsic for "+e+" exists, but the property is not available.");return}if(wn&&l+1>=i.length){var p=wn(c,r);h=!!p,h&&"get"in p&&!("originalValue"in p.get)?c=p.get:c=c[r]}else h=Or(c,r),c=c[r];h&&!d&&(Tn[a]=c)}}return c},bc={exports:{}},ga,yo;function Bs(){if(yo)return ga;yo=1;var s=cr,e=s("%Object.defineProperty%",!0)||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return ga=e,ga}var B0=cr,Ar=B0("%Object.getOwnPropertyDescriptor%",!0);if(Ar)try{Ar([],"length")}catch{Ar=null}var Ms=Ar,_o=Bs(),M0=vc,In=Qr,vo=Ms,Sc=function(e,t,i){if(!e||typeof e!="object"&&typeof e!="function")throw new In("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new In("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new In("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new In("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new In("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new In("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,c=arguments.length>6?arguments[6]:!1,d=!!vo&&vo(e,t);if(_o)_o(e,t,{configurable:a===null&&d?d.configurable:!a,enumerable:n===null&&d?d.enumerable:!n,value:i,writable:o===null&&d?d.writable:!o});else if(c||!n&&!o&&!a)e[t]=i;else throw new M0("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},is=Bs(),Ec=function(){return!!is};Ec.hasArrayLengthDefineBug=function(){if(!is)return null;try{return is([],"length",{value:1}).length!==1}catch{return!0}};var xc=Ec,F0=cr,Ao=Sc,N0=xc(),bo=Ms,So=Qr,U0=F0("%Math.floor%"),G0=function(e,t){if(typeof e!="function")throw new So("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||U0(t)!==t)throw new So("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],n=!0,o=!0;if("length"in e&&bo){var a=bo(e,"length");a&&!a.configurable&&(n=!1),a&&!a.writable&&(o=!1)}return(n||o||!i)&&(N0?Ao(e,"length",t,!0,!0):Ao(e,"length",t)),e};(function(s){var e=Ps,t=cr,i=G0,n=Qr,o=t("%Function.prototype.apply%"),a=t("%Function.prototype.call%"),c=t("%Reflect.apply%",!0)||e.call(a,o),d=Bs(),f=t("%Math.max%");s.exports=function(r){if(typeof r!="function")throw new n("a function is required");var u=c(e,a,arguments);return i(u,1+f(0,r.length-(arguments.length-1)),!0)};var l=function(){return c(e,o,arguments)};d?d(s.exports,"apply",{value:l}):s.exports.apply=l})(bc);var Zr=bc.exports,Cc=cr,wc=Zr,$0=wc(Cc("String.prototype.indexOf")),ea=function(e,t){var i=Cc(e,!!t);return typeof i=="function"&&$0(e,".prototype.")>-1?wc(i):i},V0=Os(),j0=ea,ns=j0("Object.prototype.toString"),ta=function(e){return V0&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:ns(e)==="[object Arguments]"},Tc=function(e){return ta(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&ns(e)!=="[object Array]"&&ns(e.callee)==="[object Function]"},H0=function(){return ta(arguments)}();ta.isLegacyArguments=Tc;var z0=H0?ta:Tc,q0=Object.prototype.toString,K0=Function.prototype.toString,W0=/^\s*(?:function)?\*/,kc=Os(),ya=Object.getPrototypeOf,Y0=function(){if(!kc)return!1;try{return Function("return function*() {}")()}catch{}},_a,X0=function(e){if(typeof e!="function")return!1;if(W0.test(K0.call(e)))return!0;if(!kc){var t=q0.call(e);return t==="[object GeneratorFunction]"}if(!ya)return!1;if(typeof _a>"u"){var i=Y0();_a=i?ya(i):!1}return ya(e)===_a},Rc=Function.prototype.toString,Un=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,rs,br;if(typeof Un=="function"&&typeof Object.defineProperty=="function")try{rs=Object.defineProperty({},"length",{get:function(){throw br}}),br={},Un(function(){throw 42},null,rs)}catch(s){s!==br&&(Un=null)}else Un=null;var J0=/^\s*class\b/,as=function(e){try{var t=Rc.call(e);return J0.test(t)}catch{return!1}},va=function(e){try{return as(e)?!1:(Rc.call(e),!0)}catch{return!1}},Sr=Object.prototype.toString,Q0="[object Object]",Z0="[object Function]",eg="[object GeneratorFunction]",tg="[object HTMLAllCollection]",ig="[object HTML document.all class]",ng="[object HTMLCollection]",rg=typeof Symbol=="function"&&!!Symbol.toStringTag,ag=!(0 in[,]),ss=function(){return!1};if(typeof document=="object"){var sg=document.all;Sr.call(sg)===Sr.call(document.all)&&(ss=function(e){if((ag||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=Sr.call(e);return(t===tg||t===ig||t===ng||t===Q0)&&e("")==null}catch{}return!1})}var og=Un?function(e){if(ss(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{Un(e,null,rs)}catch(t){if(t!==br)return!1}return!as(e)&&va(e)}:function(e){if(ss(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(rg)return va(e);if(as(e))return!1;var t=Sr.call(e);return t!==Z0&&t!==eg&&!/^\[object HTML/.test(t)?!1:va(e)},lg=og,cg=Object.prototype.toString,Lc=Object.prototype.hasOwnProperty,dg=function(e,t,i){for(var n=0,o=e.length;n<o;n++)Lc.call(e,n)&&(i==null?t(e[n],n,e):t.call(i,e[n],n,e))},hg=function(e,t,i){for(var n=0,o=e.length;n<o;n++)i==null?t(e.charAt(n),n,e):t.call(i,e.charAt(n),n,e)},ug=function(e,t,i){for(var n in e)Lc.call(e,n)&&(i==null?t(e[n],n,e):t.call(i,e[n],n,e))},fg=function(e,t,i){if(!lg(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=i),cg.call(e)==="[object Array]"?dg(e,t,n):typeof e=="string"?hg(e,t,n):ug(e,t,n)},pg=fg,mg=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],Aa=mg,gg=typeof globalThis>"u"?ks:globalThis,yg=function(){for(var e=[],t=0;t<Aa.length;t++)typeof gg[Aa[t]]=="function"&&(e[e.length]=Aa[t]);return e},Br=pg,_g=yg,Eo=Zr,Fs=ea,Er=Ms,vg=Fs("Object.prototype.toString"),Ic=Os(),xo=typeof globalThis>"u"?ks:globalThis,os=_g(),Ns=Fs("String.prototype.slice"),ba=Object.getPrototypeOf,Ag=Fs("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},Mr={__proto__:null};Ic&&Er&&ba?Br(os,function(s){var e=new xo[s];if(Symbol.toStringTag in e){var t=ba(e),i=Er(t,Symbol.toStringTag);if(!i){var n=ba(t);i=Er(n,Symbol.toStringTag)}Mr["$"+s]=Eo(i.get)}}):Br(os,function(s){var e=new xo[s],t=e.slice||e.set;t&&(Mr["$"+s]=Eo(t))});var bg=function(e){var t=!1;return Br(Mr,function(i,n){if(!t)try{"$"+i(e)===n&&(t=Ns(n,1))}catch{}}),t},Sg=function(e){var t=!1;return Br(Mr,function(i,n){if(!t)try{i(e),t=Ns(n,1)}catch{}}),t},Dc=function(e){if(!e||typeof e!="object")return!1;if(!Ic){var t=Ns(vg(e),8,-1);return Ag(os,t)>-1?t:t!=="Object"?!1:Sg(e)}return Er?bg(e):null},Eg=Dc,xg=function(e){return!!Eg(e)};(function(s){var e=z0,t=X0,i=Dc,n=xg;function o(Ee){return Ee.call.bind(Ee)}var a=typeof BigInt<"u",c=typeof Symbol<"u",d=o(Object.prototype.toString),f=o(Number.prototype.valueOf),l=o(String.prototype.valueOf),h=o(Boolean.prototype.valueOf);if(a)var r=o(BigInt.prototype.valueOf);if(c)var u=o(Symbol.prototype.valueOf);function m(Ee,ft){if(typeof Ee!="object")return!1;try{return ft(Ee),!0}catch{return!1}}s.isArgumentsObject=e,s.isGeneratorFunction=t,s.isTypedArray=n;function p(Ee){return typeof Promise<"u"&&Ee instanceof Promise||Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"&&typeof Ee.catch=="function"}s.isPromise=p;function _(Ee){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Ee):n(Ee)||w(Ee)}s.isArrayBufferView=_;function A(Ee){return i(Ee)==="Uint8Array"}s.isUint8Array=A;function E(Ee){return i(Ee)==="Uint8ClampedArray"}s.isUint8ClampedArray=E;function C(Ee){return i(Ee)==="Uint16Array"}s.isUint16Array=C;function k(Ee){return i(Ee)==="Uint32Array"}s.isUint32Array=k;function O(Ee){return i(Ee)==="Int8Array"}s.isInt8Array=O;function G(Ee){return i(Ee)==="Int16Array"}s.isInt16Array=G;function B(Ee){return i(Ee)==="Int32Array"}s.isInt32Array=B;function T(Ee){return i(Ee)==="Float32Array"}s.isFloat32Array=T;function L(Ee){return i(Ee)==="Float64Array"}s.isFloat64Array=L;function I(Ee){return i(Ee)==="BigInt64Array"}s.isBigInt64Array=I;function M(Ee){return i(Ee)==="BigUint64Array"}s.isBigUint64Array=M;function K(Ee){return d(Ee)==="[object Map]"}K.working=typeof Map<"u"&&K(new Map);function re(Ee){return typeof Map>"u"?!1:K.working?K(Ee):Ee instanceof Map}s.isMap=re;function ae(Ee){return d(Ee)==="[object Set]"}ae.working=typeof Set<"u"&&ae(new Set);function te(Ee){return typeof Set>"u"?!1:ae.working?ae(Ee):Ee instanceof Set}s.isSet=te;function ne(Ee){return d(Ee)==="[object WeakMap]"}ne.working=typeof WeakMap<"u"&&ne(new WeakMap);function me(Ee){return typeof WeakMap>"u"?!1:ne.working?ne(Ee):Ee instanceof WeakMap}s.isWeakMap=me;function Ae(Ee){return d(Ee)==="[object WeakSet]"}Ae.working=typeof WeakSet<"u"&&Ae(new WeakSet);function F(Ee){return Ae(Ee)}s.isWeakSet=F;function y(Ee){return d(Ee)==="[object ArrayBuffer]"}y.working=typeof ArrayBuffer<"u"&&y(new ArrayBuffer);function v(Ee){return typeof ArrayBuffer>"u"?!1:y.working?y(Ee):Ee instanceof ArrayBuffer}s.isArrayBuffer=v;function S(Ee){return d(Ee)==="[object DataView]"}S.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&S(new DataView(new ArrayBuffer(1),0,1));function w(Ee){return typeof DataView>"u"?!1:S.working?S(Ee):Ee instanceof DataView}s.isDataView=w;var x=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function D(Ee){return d(Ee)==="[object SharedArrayBuffer]"}function U(Ee){return typeof x>"u"?!1:(typeof D.working>"u"&&(D.working=D(new x)),D.working?D(Ee):Ee instanceof x)}s.isSharedArrayBuffer=U;function j(Ee){return d(Ee)==="[object AsyncFunction]"}s.isAsyncFunction=j;function X(Ee){return d(Ee)==="[object Map Iterator]"}s.isMapIterator=X;function ee(Ee){return d(Ee)==="[object Set Iterator]"}s.isSetIterator=ee;function ie(Ee){return d(Ee)==="[object Generator]"}s.isGeneratorObject=ie;function be(Ee){return d(Ee)==="[object WebAssembly.Module]"}s.isWebAssemblyCompiledModule=be;function Te(Ee){return m(Ee,f)}s.isNumberObject=Te;function Oe(Ee){return m(Ee,l)}s.isStringObject=Oe;function He(Ee){return m(Ee,h)}s.isBooleanObject=He;function st(Ee){return a&&m(Ee,r)}s.isBigIntObject=st;function Le(Ee){return c&&m(Ee,u)}s.isSymbolObject=Le;function rt(Ee){return Te(Ee)||Oe(Ee)||He(Ee)||st(Ee)||Le(Ee)}s.isBoxedPrimitive=rt;function tt(Ee){return typeof Uint8Array<"u"&&(v(Ee)||U(Ee))}s.isAnyArrayBuffer=tt,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Ee){Object.defineProperty(s,Ee,{enumerable:!1,value:function(){throw new Error(Ee+" is not supported in userland")}})})})(_c);var Cg=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"},ls={exports:{}};typeof Object.create=="function"?ls.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ls.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}};var wg=ls.exports;(function(s){var e={},t=Object.getOwnPropertyDescriptors||function(x){for(var D=Object.keys(x),U={},j=0;j<D.length;j++)U[D[j]]=Object.getOwnPropertyDescriptor(x,D[j]);return U},i=/%[sdj%]/g;s.format=function(w){if(!G(w)){for(var x=[],D=0;D<arguments.length;D++)x.push(c(arguments[D]));return x.join(" ")}for(var D=1,U=arguments,j=U.length,X=String(w).replace(i,function(ie){if(ie==="%%")return"%";if(D>=j)return ie;switch(ie){case"%s":return String(U[D++]);case"%d":return Number(U[D++]);case"%j":try{return JSON.stringify(U[D++])}catch{return"[Circular]"}default:return ie}}),ee=U[D];D<j;ee=U[++D])C(ee)||!I(ee)?X+=" "+ee:X+=" "+c(ee);return X},s.deprecate=function(w,x){if(typeof process<"u"&&process.noDeprecation===!0)return w;if(typeof process>"u")return function(){return s.deprecate(w,x).apply(this,arguments)};var D=!1;function U(){if(!D){if(process.throwDeprecation)throw new Error(x);process.traceDeprecation?console.trace(x):console.error(x),D=!0}return w.apply(this,arguments)}return U};var n={},o=/^$/;if(e.NODE_DEBUG){var a=e.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),o=new RegExp("^"+a+"$","i")}s.debuglog=function(w){if(w=w.toUpperCase(),!n[w])if(o.test(w)){var x=process.pid;n[w]=function(){var D=s.format.apply(s,arguments);console.error("%s %d: %s",w,x,D)}}else n[w]=function(){};return n[w]};function c(w,x){var D={seen:[],stylize:f};return arguments.length>=3&&(D.depth=arguments[2]),arguments.length>=4&&(D.colors=arguments[3]),E(x)?D.showHidden=x:x&&s._extend(D,x),T(D.showHidden)&&(D.showHidden=!1),T(D.depth)&&(D.depth=2),T(D.colors)&&(D.colors=!1),T(D.customInspect)&&(D.customInspect=!0),D.colors&&(D.stylize=d),h(D,w,D.depth)}s.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function d(w,x){var D=c.styles[x];return D?"\x1B["+c.colors[D][0]+"m"+w+"\x1B["+c.colors[D][1]+"m":w}function f(w,x){return w}function l(w){var x={};return w.forEach(function(D,U){x[D]=!0}),x}function h(w,x,D){if(w.customInspect&&x&&re(x.inspect)&&x.inspect!==s.inspect&&!(x.constructor&&x.constructor.prototype===x)){var U=x.inspect(D,w);return G(U)||(U=h(w,U,D)),U}var j=r(w,x);if(j)return j;var X=Object.keys(x),ee=l(X);if(w.showHidden&&(X=Object.getOwnPropertyNames(x)),K(x)&&(X.indexOf("message")>=0||X.indexOf("description")>=0))return u(x);if(X.length===0){if(re(x)){var ie=x.name?": "+x.name:"";return w.stylize("[Function"+ie+"]","special")}if(L(x))return w.stylize(RegExp.prototype.toString.call(x),"regexp");if(M(x))return w.stylize(Date.prototype.toString.call(x),"date");if(K(x))return u(x)}var be="",Te=!1,Oe=["{","}"];if(A(x)&&(Te=!0,Oe=["[","]"]),re(x)){var He=x.name?": "+x.name:"";be=" [Function"+He+"]"}if(L(x)&&(be=" "+RegExp.prototype.toString.call(x)),M(x)&&(be=" "+Date.prototype.toUTCString.call(x)),K(x)&&(be=" "+u(x)),X.length===0&&(!Te||x.length==0))return Oe[0]+be+Oe[1];if(D<0)return L(x)?w.stylize(RegExp.prototype.toString.call(x),"regexp"):w.stylize("[Object]","special");w.seen.push(x);var st;return Te?st=m(w,x,D,ee,X):st=X.map(function(Le){return p(w,x,D,ee,Le,Te)}),w.seen.pop(),_(st,be,Oe)}function r(w,x){if(T(x))return w.stylize("undefined","undefined");if(G(x)){var D="'"+JSON.stringify(x).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return w.stylize(D,"string")}if(O(x))return w.stylize(""+x,"number");if(E(x))return w.stylize(""+x,"boolean");if(C(x))return w.stylize("null","null")}function u(w){return"["+Error.prototype.toString.call(w)+"]"}function m(w,x,D,U,j){for(var X=[],ee=0,ie=x.length;ee<ie;++ee)F(x,String(ee))?X.push(p(w,x,D,U,String(ee),!0)):X.push("");return j.forEach(function(be){be.match(/^\d+$/)||X.push(p(w,x,D,U,be,!0))}),X}function p(w,x,D,U,j,X){var ee,ie,be;if(be=Object.getOwnPropertyDescriptor(x,j)||{value:x[j]},be.get?be.set?ie=w.stylize("[Getter/Setter]","special"):ie=w.stylize("[Getter]","special"):be.set&&(ie=w.stylize("[Setter]","special")),F(U,j)||(ee="["+j+"]"),ie||(w.seen.indexOf(be.value)<0?(C(D)?ie=h(w,be.value,null):ie=h(w,be.value,D-1),ie.indexOf(`
`)>-1&&(X?ie=ie.split(`
`).map(function(Te){return"  "+Te}).join(`
`).slice(2):ie=`
`+ie.split(`
`).map(function(Te){return"   "+Te}).join(`
`))):ie=w.stylize("[Circular]","special")),T(ee)){if(X&&j.match(/^\d+$/))return ie;ee=JSON.stringify(""+j),ee.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ee=ee.slice(1,-1),ee=w.stylize(ee,"name")):(ee=ee.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ee=w.stylize(ee,"string"))}return ee+": "+ie}function _(w,x,D){var U=w.reduce(function(j,X){return X.indexOf(`
`)>=0,j+X.replace(/\u001b\[\d\d?m/g,"").length+1},0);return U>60?D[0]+(x===""?"":x+`
 `)+" "+w.join(`,
  `)+" "+D[1]:D[0]+x+" "+w.join(", ")+" "+D[1]}s.types=_c;function A(w){return Array.isArray(w)}s.isArray=A;function E(w){return typeof w=="boolean"}s.isBoolean=E;function C(w){return w===null}s.isNull=C;function k(w){return w==null}s.isNullOrUndefined=k;function O(w){return typeof w=="number"}s.isNumber=O;function G(w){return typeof w=="string"}s.isString=G;function B(w){return typeof w=="symbol"}s.isSymbol=B;function T(w){return w===void 0}s.isUndefined=T;function L(w){return I(w)&&te(w)==="[object RegExp]"}s.isRegExp=L,s.types.isRegExp=L;function I(w){return typeof w=="object"&&w!==null}s.isObject=I;function M(w){return I(w)&&te(w)==="[object Date]"}s.isDate=M,s.types.isDate=M;function K(w){return I(w)&&(te(w)==="[object Error]"||w instanceof Error)}s.isError=K,s.types.isNativeError=K;function re(w){return typeof w=="function"}s.isFunction=re;function ae(w){return w===null||typeof w=="boolean"||typeof w=="number"||typeof w=="string"||typeof w=="symbol"||typeof w>"u"}s.isPrimitive=ae,s.isBuffer=Cg;function te(w){return Object.prototype.toString.call(w)}function ne(w){return w<10?"0"+w.toString(10):w.toString(10)}var me=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ae(){var w=new Date,x=[ne(w.getHours()),ne(w.getMinutes()),ne(w.getSeconds())].join(":");return[w.getDate(),me[w.getMonth()],x].join(" ")}s.log=function(){console.log("%s - %s",Ae(),s.format.apply(s,arguments))},s.inherits=wg,s._extend=function(w,x){if(!x||!I(x))return w;for(var D=Object.keys(x),U=D.length;U--;)w[D[U]]=x[D[U]];return w};function F(w,x){return Object.prototype.hasOwnProperty.call(w,x)}var y=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;s.promisify=function(x){if(typeof x!="function")throw new TypeError('The "original" argument must be of type Function');if(y&&x[y]){var D=x[y];if(typeof D!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(D,y,{value:D,enumerable:!1,writable:!1,configurable:!0}),D}function D(){for(var U,j,X=new Promise(function(be,Te){U=be,j=Te}),ee=[],ie=0;ie<arguments.length;ie++)ee.push(arguments[ie]);ee.push(function(be,Te){be?j(be):U(Te)});try{x.apply(this,ee)}catch(be){j(be)}return X}return Object.setPrototypeOf(D,Object.getPrototypeOf(x)),y&&Object.defineProperty(D,y,{value:D,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(D,t(x))},s.promisify.custom=y;function v(w,x){if(!w){var D=new Error("Promise was rejected with a falsy value");D.reason=w,w=D}return x(w)}function S(w){if(typeof w!="function")throw new TypeError('The "original" argument must be of type Function');function x(){for(var D=[],U=0;U<arguments.length;U++)D.push(arguments[U]);var j=D.pop();if(typeof j!="function")throw new TypeError("The last argument must be of type Function");var X=this,ee=function(){return j.apply(X,arguments)};w.apply(this,D).then(function(ie){process.nextTick(ee.bind(null,null,ie))},function(ie){process.nextTick(v.bind(null,ie,ee))})}return Object.setPrototypeOf(x,Object.getPrototypeOf(w)),Object.defineProperties(x,t(w)),x}s.callbackify=S})(zn);var Co;function Oc(){if(Co)return ua;Co=1;function s(E){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},s(E)}function e(E,C,k){return Object.defineProperty(E,"prototype",{writable:!1}),E}function t(E,C){if(!(E instanceof C))throw new TypeError("Cannot call a class as a function")}function i(E,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");E.prototype=Object.create(C&&C.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),Object.defineProperty(E,"prototype",{writable:!1}),C&&n(E,C)}function n(E,C){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,G){return O.__proto__=G,O},n(E,C)}function o(E){var C=d();return function(){var O=f(E),G;if(C){var B=f(this).constructor;G=Reflect.construct(O,arguments,B)}else G=O.apply(this,arguments);return a(this,G)}}function a(E,C){if(C&&(s(C)==="object"||typeof C=="function"))return C;if(C!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c(E)}function c(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(E){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(k){return k.__proto__||Object.getPrototypeOf(k)},f(E)}var l={},h,r;function u(E,C,k){k||(k=Error);function O(B,T,L){return typeof C=="string"?C:C(B,T,L)}var G=function(B){i(L,B);var T=o(L);function L(I,M,K){var re;return t(this,L),re=T.call(this,O(I,M,K)),re.code=E,re}return e(L)}(k);l[E]=G}function m(E,C){if(Array.isArray(E)){var k=E.length;return E=E.map(function(O){return String(O)}),k>2?"one of ".concat(C," ").concat(E.slice(0,k-1).join(", "),", or ")+E[k-1]:k===2?"one of ".concat(C," ").concat(E[0]," or ").concat(E[1]):"of ".concat(C," ").concat(E[0])}else return"of ".concat(C," ").concat(String(E))}function p(E,C,k){return E.substr(0,C.length)===C}function _(E,C,k){return(k===void 0||k>E.length)&&(k=E.length),E.substring(k-C.length,k)===C}function A(E,C,k){return typeof k!="number"&&(k=0),k+C.length>E.length?!1:E.indexOf(C,k)!==-1}return u("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),u("ERR_INVALID_ARG_TYPE",function(E,C,k){h===void 0&&(h=cs()),h(typeof E=="string","'name' must be a string");var O;typeof C=="string"&&p(C,"not ")?(O="must not be",C=C.replace(/^not /,"")):O="must be";var G;if(_(E," argument"))G="The ".concat(E," ").concat(O," ").concat(m(C,"type"));else{var B=A(E,".")?"property":"argument";G='The "'.concat(E,'" ').concat(B," ").concat(O," ").concat(m(C,"type"))}return G+=". Received type ".concat(s(k)),G},TypeError),u("ERR_INVALID_ARG_VALUE",function(E,C){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";r===void 0&&(r=zn);var O=r.inspect(C);return O.length>128&&(O="".concat(O.slice(0,128),"...")),"The argument '".concat(E,"' ").concat(k,". Received ").concat(O)},TypeError),u("ERR_INVALID_RETURN_VALUE",function(E,C,k){var O;return k&&k.constructor&&k.constructor.name?O="instance of ".concat(k.constructor.name):O="type ".concat(s(k)),"Expected ".concat(E,' to be returned from the "').concat(C,'"')+" function but got ".concat(O,".")},TypeError),u("ERR_MISSING_ARGS",function(){for(var E=arguments.length,C=new Array(E),k=0;k<E;k++)C[k]=arguments[k];h===void 0&&(h=cs()),h(C.length>0,"At least one arg needs to be specified");var O="The ",G=C.length;switch(C=C.map(function(B){return'"'.concat(B,'"')}),G){case 1:O+="".concat(C[0]," argument");break;case 2:O+="".concat(C[0]," and ").concat(C[1]," arguments");break;default:O+=C.slice(0,G-1).join(", "),O+=", and ".concat(C[G-1]," arguments");break}return"".concat(O," must be specified")},TypeError),ua.codes=l,ua}var Sa,wo;function Tg(){if(wo)return Sa;wo=1;function s(F,y){var v=Object.keys(F);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(F);y&&(S=S.filter(function(w){return Object.getOwnPropertyDescriptor(F,w).enumerable})),v.push.apply(v,S)}return v}function e(F){for(var y=1;y<arguments.length;y++){var v=arguments[y]!=null?arguments[y]:{};y%2?s(Object(v),!0).forEach(function(S){t(F,S,v[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(v)):s(Object(v)).forEach(function(S){Object.defineProperty(F,S,Object.getOwnPropertyDescriptor(v,S))})}return F}function t(F,y,v){return y=a(y),y in F?Object.defineProperty(F,y,{value:v,enumerable:!0,configurable:!0,writable:!0}):F[y]=v,F}function i(F,y){if(!(F instanceof y))throw new TypeError("Cannot call a class as a function")}function n(F,y){for(var v=0;v<y.length;v++){var S=y[v];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(F,a(S.key),S)}}function o(F,y,v){return y&&n(F.prototype,y),Object.defineProperty(F,"prototype",{writable:!1}),F}function a(F){var y=c(F,"string");return E(y)==="symbol"?y:String(y)}function c(F,y){if(E(F)!=="object"||F===null)return F;var v=F[Symbol.toPrimitive];if(v!==void 0){var S=v.call(F,y||"default");if(E(S)!=="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return(y==="string"?String:Number)(F)}function d(F,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(y&&y.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),Object.defineProperty(F,"prototype",{writable:!1}),y&&_(F,y)}function f(F){var y=m();return function(){var S=A(F),w;if(y){var x=A(this).constructor;w=Reflect.construct(S,arguments,x)}else w=S.apply(this,arguments);return l(this,w)}}function l(F,y){if(y&&(E(y)==="object"||typeof y=="function"))return y;if(y!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(F)}function h(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function r(F){var y=typeof Map=="function"?new Map:void 0;return r=function(S){if(S===null||!p(S))return S;if(typeof S!="function")throw new TypeError("Super expression must either be null or a function");if(typeof y<"u"){if(y.has(S))return y.get(S);y.set(S,w)}function w(){return u(S,arguments,A(this).constructor)}return w.prototype=Object.create(S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),_(w,S)},r(F)}function u(F,y,v){return m()?u=Reflect.construct.bind():u=function(w,x,D){var U=[null];U.push.apply(U,x);var j=Function.bind.apply(w,U),X=new j;return D&&_(X,D.prototype),X},u.apply(null,arguments)}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(F){return Function.toString.call(F).indexOf("[native code]")!==-1}function _(F,y){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(S,w){return S.__proto__=w,S},_(F,y)}function A(F){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(v){return v.__proto__||Object.getPrototypeOf(v)},A(F)}function E(F){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},E(F)}var C=zn,k=C.inspect,O=Oc(),G=O.codes.ERR_INVALID_ARG_TYPE;function B(F,y,v){return(v===void 0||v>F.length)&&(v=F.length),F.substring(v-y.length,v)===y}function T(F,y){if(y=Math.floor(y),F.length==0||y==0)return"";var v=F.length*y;for(y=Math.floor(Math.log(y)/Math.log(2));y;)F+=F,y--;return F+=F.substring(0,v-F.length),F}var L="",I="",M="",K="",re={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},ae=10;function te(F){var y=Object.keys(F),v=Object.create(Object.getPrototypeOf(F));return y.forEach(function(S){v[S]=F[S]}),Object.defineProperty(v,"message",{value:F.message}),v}function ne(F){return k(F,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function me(F,y,v){var S="",w="",x=0,D="",U=!1,j=ne(F),X=j.split(`
`),ee=ne(y).split(`
`),ie=0,be="";if(v==="strictEqual"&&E(F)==="object"&&E(y)==="object"&&F!==null&&y!==null&&(v="strictEqualObject"),X.length===1&&ee.length===1&&X[0]!==ee[0]){var Te=X[0].length+ee[0].length;if(Te<=ae){if((E(F)!=="object"||F===null)&&(E(y)!=="object"||y===null)&&(F!==0||y!==0))return"".concat(re[v],`

`)+"".concat(X[0]," !== ").concat(ee[0],`
`)}else if(v!=="strictEqualObject"){var Oe=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(Te<Oe){for(;X[0][ie]===ee[0][ie];)ie++;ie>2&&(be=`
  `.concat(T(" ",ie),"^"),ie=0)}}}for(var He=X[X.length-1],st=ee[ee.length-1];He===st&&(ie++<2?D=`
  `.concat(He).concat(D):S=He,X.pop(),ee.pop(),!(X.length===0||ee.length===0));)He=X[X.length-1],st=ee[ee.length-1];var Le=Math.max(X.length,ee.length);if(Le===0){var rt=j.split(`
`);if(rt.length>30)for(rt[26]="".concat(L,"...").concat(K);rt.length>27;)rt.pop();return"".concat(re.notIdentical,`

`).concat(rt.join(`
`),`
`)}ie>3&&(D=`
`.concat(L,"...").concat(K).concat(D),U=!0),S!==""&&(D=`
  `.concat(S).concat(D),S="");var tt=0,Ee=re[v]+`
`.concat(I,"+ actual").concat(K," ").concat(M,"- expected").concat(K),ft=" ".concat(L,"...").concat(K," Lines skipped");for(ie=0;ie<Le;ie++){var pt=ie-x;if(X.length<ie+1)pt>1&&ie>2&&(pt>4?(w+=`
`.concat(L,"...").concat(K),U=!0):pt>3&&(w+=`
  `.concat(ee[ie-2]),tt++),w+=`
  `.concat(ee[ie-1]),tt++),x=ie,S+=`
`.concat(M,"-").concat(K," ").concat(ee[ie]),tt++;else if(ee.length<ie+1)pt>1&&ie>2&&(pt>4?(w+=`
`.concat(L,"...").concat(K),U=!0):pt>3&&(w+=`
  `.concat(X[ie-2]),tt++),w+=`
  `.concat(X[ie-1]),tt++),x=ie,w+=`
`.concat(I,"+").concat(K," ").concat(X[ie]),tt++;else{var Ze=ee[ie],je=X[ie],he=je!==Ze&&(!B(je,",")||je.slice(0,-1)!==Ze);he&&B(Ze,",")&&Ze.slice(0,-1)===je&&(he=!1,je+=","),he?(pt>1&&ie>2&&(pt>4?(w+=`
`.concat(L,"...").concat(K),U=!0):pt>3&&(w+=`
  `.concat(X[ie-2]),tt++),w+=`
  `.concat(X[ie-1]),tt++),x=ie,w+=`
`.concat(I,"+").concat(K," ").concat(je),S+=`
`.concat(M,"-").concat(K," ").concat(Ze),tt+=2):(w+=S,S="",(pt===1||ie===0)&&(w+=`
  `.concat(je),tt++))}if(tt>20&&ie<Le-2)return"".concat(Ee).concat(ft,`
`).concat(w,`
`).concat(L,"...").concat(K).concat(S,`
`)+"".concat(L,"...").concat(K)}return"".concat(Ee).concat(U?ft:"",`
`).concat(w).concat(S).concat(D).concat(be)}var Ae=function(F,y){d(S,F);var v=f(S);function S(w){var x;if(i(this,S),E(w)!=="object"||w===null)throw new G("options","Object",w);var D=w.message,U=w.operator,j=w.stackStartFn,X=w.actual,ee=w.expected,ie=Error.stackTraceLimit;if(Error.stackTraceLimit=0,D!=null)x=v.call(this,String(D));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(L="\x1B[34m",I="\x1B[32m",K="\x1B[39m",M="\x1B[31m"):(L="",I="",K="",M="")),E(X)==="object"&&X!==null&&E(ee)==="object"&&ee!==null&&"stack"in X&&X instanceof Error&&"stack"in ee&&ee instanceof Error&&(X=te(X),ee=te(ee)),U==="deepStrictEqual"||U==="strictEqual")x=v.call(this,me(X,ee,U));else if(U==="notDeepStrictEqual"||U==="notStrictEqual"){var be=re[U],Te=ne(X).split(`
`);if(U==="notStrictEqual"&&E(X)==="object"&&X!==null&&(be=re.notStrictEqualObject),Te.length>30)for(Te[26]="".concat(L,"...").concat(K);Te.length>27;)Te.pop();Te.length===1?x=v.call(this,"".concat(be," ").concat(Te[0])):x=v.call(this,"".concat(be,`

`).concat(Te.join(`
`),`
`))}else{var Oe=ne(X),He="",st=re[U];U==="notDeepEqual"||U==="notEqual"?(Oe="".concat(re[U],`

`).concat(Oe),Oe.length>1024&&(Oe="".concat(Oe.slice(0,1021),"..."))):(He="".concat(ne(ee)),Oe.length>512&&(Oe="".concat(Oe.slice(0,509),"...")),He.length>512&&(He="".concat(He.slice(0,509),"...")),U==="deepEqual"||U==="equal"?Oe="".concat(st,`

`).concat(Oe,`

should equal

`):He=" ".concat(U," ").concat(He)),x=v.call(this,"".concat(Oe).concat(He))}return Error.stackTraceLimit=ie,x.generatedMessage=!D,Object.defineProperty(h(x),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),x.code="ERR_ASSERTION",x.actual=X,x.expected=ee,x.operator=U,Error.captureStackTrace&&Error.captureStackTrace(h(x),j),x.stack,x.name="AssertionError",l(x)}return o(S,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:y,value:function(x,D){return k(this,e(e({},D),{},{customInspect:!1,depth:0}))}}]),S}(r(Error),k.custom);return Sa=Ae,Sa}var To=Object.prototype.toString,Pc=function(e){var t=To.call(e),i=t==="[object Arguments]";return i||(i=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&To.call(e.callee)==="[object Function]"),i},Ea,ko;function kg(){if(ko)return Ea;ko=1;var s;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,i=Pc,n=Object.prototype.propertyIsEnumerable,o=!n.call({toString:null},"toString"),a=n.call(function(){},"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(r){var u=r.constructor;return u&&u.prototype===r},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},l=function(){if(typeof window>"u")return!1;for(var r in window)try{if(!f["$"+r]&&e.call(window,r)&&window[r]!==null&&typeof window[r]=="object")try{d(window[r])}catch{return!0}}catch{return!0}return!1}(),h=function(r){if(typeof window>"u"||!l)return d(r);try{return d(r)}catch{return!1}};s=function(u){var m=u!==null&&typeof u=="object",p=t.call(u)==="[object Function]",_=i(u),A=m&&t.call(u)==="[object String]",E=[];if(!m&&!p&&!_)throw new TypeError("Object.keys called on a non-object");var C=a&&p;if(A&&u.length>0&&!e.call(u,0))for(var k=0;k<u.length;++k)E.push(String(k));if(_&&u.length>0)for(var O=0;O<u.length;++O)E.push(String(O));else for(var G in u)!(C&&G==="prototype")&&e.call(u,G)&&E.push(String(G));if(o)for(var B=h(u),T=0;T<c.length;++T)!(B&&c[T]==="constructor")&&e.call(u,c[T])&&E.push(c[T]);return E}}return Ea=s,Ea}var Rg=Array.prototype.slice,Lg=Pc,Ro=Object.keys,xr=Ro?function(e){return Ro(e)}:kg(),Lo=Object.keys;xr.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(i){return Lg(i)?Lo(Rg.call(i)):Lo(i)})}else Object.keys=xr;return Object.keys||xr};var Bc=xr,Ig=Bc,Mc=Ds(),Fc=ea,Io=Object,Dg=Fc("Array.prototype.push"),Do=Fc("Object.prototype.propertyIsEnumerable"),Og=Mc?Object.getOwnPropertySymbols:null,Pg=function(e,t){if(e==null)throw new TypeError("target must be an object");var i=Io(e);if(arguments.length===1)return i;for(var n=1;n<arguments.length;++n){var o=Io(arguments[n]),a=Ig(o),c=Mc&&(Object.getOwnPropertySymbols||Og);if(c)for(var d=c(o),f=0;f<d.length;++f){var l=d[f];Do(o,l)&&Dg(a,l)}for(var h=0;h<a.length;++h){var r=a[h];if(Do(o,r)){var u=o[r];i[r]=u}}}return i},xa=Pg,Bg=function(){if(!Object.assign)return!1;for(var s="abcdefghijklmnopqrst",e=s.split(""),t={},i=0;i<e.length;++i)t[e[i]]=e[i];var n=Object.assign({},t),o="";for(var a in n)o+=a;return s!==o},Mg=function(){if(!Object.assign||!Object.preventExtensions)return!1;var s=Object.preventExtensions({1:2});try{Object.assign(s,"xy")}catch{return s[1]==="y"}return!1},Fg=function(){return!Object.assign||Bg()||Mg()?xa:Object.assign},Oo=function(s){return s!==s},Nc=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||Oo(e)&&Oo(t))},Ng=Nc,Us=function(){return typeof Object.is=="function"?Object.is:Ng},Ca,Po;function ia(){if(Po)return Ca;Po=1;var s=Bc,e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",t=Object.prototype.toString,i=Array.prototype.concat,n=Sc,o=function(f){return typeof f=="function"&&t.call(f)==="[object Function]"},a=xc(),c=function(f,l,h,r){if(l in f){if(r===!0){if(f[l]===h)return}else if(!o(r)||!r())return}a?n(f,l,h,!0):n(f,l,h)},d=function(f,l){var h=arguments.length>2?arguments[2]:{},r=s(l);e&&(r=i.call(r,Object.getOwnPropertySymbols(l)));for(var u=0;u<r.length;u+=1)c(f,r[u],l[r[u]],h[r[u]])};return d.supportsDescriptors=!!a,Ca=d,Ca}var wa,Bo;function Ug(){if(Bo)return wa;Bo=1;var s=Us,e=ia();return wa=function(){var i=s();return e(Object,{is:i},{is:function(){return Object.is!==i}}),i},wa}var Ta,Mo;function Gg(){if(Mo)return Ta;Mo=1;var s=ia(),e=Zr,t=Nc,i=Us,n=Ug(),o=e(i(),Object);return s(o,{getPolyfill:i,implementation:t,shim:n}),Ta=o,Ta}var ka,Fo;function Uc(){return Fo||(Fo=1,ka=function(e){return e!==e}),ka}var Ra,No;function Gc(){if(No)return Ra;No=1;var s=Uc();return Ra=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:s},Ra}var La,Uo;function $g(){if(Uo)return La;Uo=1;var s=ia(),e=Gc();return La=function(){var i=e();return s(Number,{isNaN:i},{isNaN:function(){return Number.isNaN!==i}}),i},La}var Ia,Go;function Vg(){if(Go)return Ia;Go=1;var s=Zr,e=ia(),t=Uc(),i=Gc(),n=$g(),o=s(i(),Number);return e(o,{getPolyfill:i,implementation:t,shim:n}),Ia=o,Ia}var Da,$o;function jg(){if($o)return Da;$o=1;function s(he,_e){return o(he)||n(he,_e)||t(he,_e)||e()}function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(he,_e){if(he){if(typeof he=="string")return i(he,_e);var Ne=Object.prototype.toString.call(he).slice(8,-1);if(Ne==="Object"&&he.constructor&&(Ne=he.constructor.name),Ne==="Map"||Ne==="Set")return Array.from(he);if(Ne==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ne))return i(he,_e)}}function i(he,_e){(_e==null||_e>he.length)&&(_e=he.length);for(var Ne=0,fe=new Array(_e);Ne<_e;Ne++)fe[Ne]=he[Ne];return fe}function n(he,_e){var Ne=he==null?null:typeof Symbol<"u"&&he[Symbol.iterator]||he["@@iterator"];if(Ne!=null){var fe,Je,ot,nt,q=[],Z=!0,z=!1;try{if(ot=(Ne=Ne.call(he)).next,_e!==0)for(;!(Z=(fe=ot.call(Ne)).done)&&(q.push(fe.value),q.length!==_e);Z=!0);}catch($){z=!0,Je=$}finally{try{if(!Z&&Ne.return!=null&&(nt=Ne.return(),Object(nt)!==nt))return}finally{if(z)throw Je}}return q}}function o(he){if(Array.isArray(he))return he}function a(he){"@babel/helpers - typeof";return a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},a(he)}var c=/a/g.flags!==void 0,d=function(_e){var Ne=[];return _e.forEach(function(fe){return Ne.push(fe)}),Ne},f=function(_e){var Ne=[];return _e.forEach(function(fe,Je){return Ne.push([Je,fe])}),Ne},l=Object.is?Object.is:Gg(),h=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},r=Number.isNaN?Number.isNaN:Vg();function u(he){return he.call.bind(he)}var m=u(Object.prototype.hasOwnProperty),p=u(Object.prototype.propertyIsEnumerable),_=u(Object.prototype.toString),A=zn.types,E=A.isAnyArrayBuffer,C=A.isArrayBufferView,k=A.isDate,O=A.isMap,G=A.isRegExp,B=A.isSet,T=A.isNativeError,L=A.isBoxedPrimitive,I=A.isNumberObject,M=A.isStringObject,K=A.isBooleanObject,re=A.isBigIntObject,ae=A.isSymbolObject,te=A.isFloat32Array,ne=A.isFloat64Array;function me(he){if(he.length===0||he.length>10)return!0;for(var _e=0;_e<he.length;_e++){var Ne=he.charCodeAt(_e);if(Ne<48||Ne>57)return!0}return he.length===10&&he>=Math.pow(2,32)}function Ae(he){return Object.keys(he).filter(me).concat(h(he).filter(Object.prototype.propertyIsEnumerable.bind(he)))}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function F(he,_e){if(he===_e)return 0;for(var Ne=he.length,fe=_e.length,Je=0,ot=Math.min(Ne,fe);Je<ot;++Je)if(he[Je]!==_e[Je]){Ne=he[Je],fe=_e[Je];break}return Ne<fe?-1:fe<Ne?1:0}var y=!0,v=!1,S=0,w=1,x=2,D=3;function U(he,_e){return c?he.source===_e.source&&he.flags===_e.flags:RegExp.prototype.toString.call(he)===RegExp.prototype.toString.call(_e)}function j(he,_e){if(he.byteLength!==_e.byteLength)return!1;for(var Ne=0;Ne<he.byteLength;Ne++)if(he[Ne]!==_e[Ne])return!1;return!0}function X(he,_e){return he.byteLength!==_e.byteLength?!1:F(new Uint8Array(he.buffer,he.byteOffset,he.byteLength),new Uint8Array(_e.buffer,_e.byteOffset,_e.byteLength))===0}function ee(he,_e){return he.byteLength===_e.byteLength&&F(new Uint8Array(he),new Uint8Array(_e))===0}function ie(he,_e){return I(he)?I(_e)&&l(Number.prototype.valueOf.call(he),Number.prototype.valueOf.call(_e)):M(he)?M(_e)&&String.prototype.valueOf.call(he)===String.prototype.valueOf.call(_e):K(he)?K(_e)&&Boolean.prototype.valueOf.call(he)===Boolean.prototype.valueOf.call(_e):re(he)?re(_e)&&BigInt.prototype.valueOf.call(he)===BigInt.prototype.valueOf.call(_e):ae(_e)&&Symbol.prototype.valueOf.call(he)===Symbol.prototype.valueOf.call(_e)}function be(he,_e,Ne,fe){if(he===_e)return he!==0?!0:Ne?l(he,_e):!0;if(Ne){if(a(he)!=="object")return typeof he=="number"&&r(he)&&r(_e);if(a(_e)!=="object"||he===null||_e===null||Object.getPrototypeOf(he)!==Object.getPrototypeOf(_e))return!1}else{if(he===null||a(he)!=="object")return _e===null||a(_e)!=="object"?he==_e:!1;if(_e===null||a(_e)!=="object")return!1}var Je=_(he),ot=_(_e);if(Je!==ot)return!1;if(Array.isArray(he)){if(he.length!==_e.length)return!1;var nt=Ae(he),q=Ae(_e);return nt.length!==q.length?!1:Oe(he,_e,Ne,fe,w,nt)}if(Je==="[object Object]"&&(!O(he)&&O(_e)||!B(he)&&B(_e)))return!1;if(k(he)){if(!k(_e)||Date.prototype.getTime.call(he)!==Date.prototype.getTime.call(_e))return!1}else if(G(he)){if(!G(_e)||!U(he,_e))return!1}else if(T(he)||he instanceof Error){if(he.message!==_e.message||he.name!==_e.name)return!1}else if(C(he)){if(!Ne&&(te(he)||ne(he))){if(!j(he,_e))return!1}else if(!X(he,_e))return!1;var Z=Ae(he),z=Ae(_e);return Z.length!==z.length?!1:Oe(he,_e,Ne,fe,S,Z)}else{if(B(he))return!B(_e)||he.size!==_e.size?!1:Oe(he,_e,Ne,fe,x);if(O(he))return!O(_e)||he.size!==_e.size?!1:Oe(he,_e,Ne,fe,D);if(E(he)){if(!ee(he,_e))return!1}else if(L(he)&&!ie(he,_e))return!1}return Oe(he,_e,Ne,fe,S)}function Te(he,_e){return _e.filter(function(Ne){return p(he,Ne)})}function Oe(he,_e,Ne,fe,Je,ot){if(arguments.length===5){ot=Object.keys(he);var nt=Object.keys(_e);if(ot.length!==nt.length)return!1}for(var q=0;q<ot.length;q++)if(!m(_e,ot[q]))return!1;if(Ne&&arguments.length===5){var Z=h(he);if(Z.length!==0){var z=0;for(q=0;q<Z.length;q++){var $=Z[q];if(p(he,$)){if(!p(_e,$))return!1;ot.push($),z++}else if(p(_e,$))return!1}var ce=h(_e);if(Z.length!==ce.length&&Te(_e,ce).length!==z)return!1}else{var Se=h(_e);if(Se.length!==0&&Te(_e,Se).length!==0)return!1}}if(ot.length===0&&(Je===S||Je===w&&he.length===0||he.size===0))return!0;if(fe===void 0)fe={val1:new Map,val2:new Map,position:0};else{var se=fe.val1.get(he);if(se!==void 0){var ve=fe.val2.get(_e);if(ve!==void 0)return se===ve}fe.position++}fe.val1.set(he,fe.position),fe.val2.set(_e,fe.position);var Pe=pt(he,_e,Ne,ot,fe,Je);return fe.val1.delete(he),fe.val2.delete(_e),Pe}function He(he,_e,Ne,fe){for(var Je=d(he),ot=0;ot<Je.length;ot++){var nt=Je[ot];if(be(_e,nt,Ne,fe))return he.delete(nt),!0}return!1}function st(he){switch(a(he)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":he=+he;case"number":if(r(he))return!1}return!0}function Le(he,_e,Ne){var fe=st(Ne);return fe??(_e.has(fe)&&!he.has(fe))}function rt(he,_e,Ne,fe,Je){var ot=st(Ne);if(ot!=null)return ot;var nt=_e.get(ot);return nt===void 0&&!_e.has(ot)||!be(fe,nt,!1,Je)?!1:!he.has(ot)&&be(fe,nt,!1,Je)}function tt(he,_e,Ne,fe){for(var Je=null,ot=d(he),nt=0;nt<ot.length;nt++){var q=ot[nt];if(a(q)==="object"&&q!==null)Je===null&&(Je=new Set),Je.add(q);else if(!_e.has(q)){if(Ne||!Le(he,_e,q))return!1;Je===null&&(Je=new Set),Je.add(q)}}if(Je!==null){for(var Z=d(_e),z=0;z<Z.length;z++){var $=Z[z];if(a($)==="object"&&$!==null){if(!He(Je,$,Ne,fe))return!1}else if(!Ne&&!he.has($)&&!He(Je,$,Ne,fe))return!1}return Je.size===0}return!0}function Ee(he,_e,Ne,fe,Je,ot){for(var nt=d(he),q=0;q<nt.length;q++){var Z=nt[q];if(be(Ne,Z,Je,ot)&&be(fe,_e.get(Z),Je,ot))return he.delete(Z),!0}return!1}function ft(he,_e,Ne,fe){for(var Je=null,ot=f(he),nt=0;nt<ot.length;nt++){var q=s(ot[nt],2),Z=q[0],z=q[1];if(a(Z)==="object"&&Z!==null)Je===null&&(Je=new Set),Je.add(Z);else{var $=_e.get(Z);if($===void 0&&!_e.has(Z)||!be(z,$,Ne,fe)){if(Ne||!rt(he,_e,Z,z,fe))return!1;Je===null&&(Je=new Set),Je.add(Z)}}}if(Je!==null){for(var ce=f(_e),Se=0;Se<ce.length;Se++){var se=s(ce[Se],2),ve=se[0],Pe=se[1];if(a(ve)==="object"&&ve!==null){if(!Ee(Je,he,ve,Pe,Ne,fe))return!1}else if(!Ne&&(!he.has(ve)||!be(he.get(ve),Pe,!1,fe))&&!Ee(Je,he,ve,Pe,!1,fe))return!1}return Je.size===0}return!0}function pt(he,_e,Ne,fe,Je,ot){var nt=0;if(ot===x){if(!tt(he,_e,Ne,Je))return!1}else if(ot===D){if(!ft(he,_e,Ne,Je))return!1}else if(ot===w)for(;nt<he.length;nt++)if(m(he,nt)){if(!m(_e,nt)||!be(he[nt],_e[nt],Ne,Je))return!1}else{if(m(_e,nt))return!1;for(var q=Object.keys(he);nt<q.length;nt++){var Z=q[nt];if(!m(_e,Z)||!be(he[Z],_e[Z],Ne,Je))return!1}return q.length===Object.keys(_e).length}for(nt=0;nt<fe.length;nt++){var z=fe[nt];if(!be(he[z],_e[z],Ne,Je))return!1}return!0}function Ze(he,_e){return be(he,_e,v)}function je(he,_e){return be(he,_e,y)}return Da={isDeepEqual:Ze,isDeepStrictEqual:je},Da}var Vo;function cs(){if(Vo)return ha.exports;Vo=1;function s(x){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},s(x)}function e(x,D,U){return Object.defineProperty(x,"prototype",{writable:!1}),x}function t(x,D){if(!(x instanceof D))throw new TypeError("Cannot call a class as a function")}var i=Oc(),n=i.codes,o=n.ERR_AMBIGUOUS_ARGUMENT,a=n.ERR_INVALID_ARG_TYPE,c=n.ERR_INVALID_ARG_VALUE,d=n.ERR_INVALID_RETURN_VALUE,f=n.ERR_MISSING_ARGS,l=Tg(),h=zn,r=h.inspect,u=zn.types,m=u.isPromise,p=u.isRegExp,_=Fg(),A=Us(),E=ea("RegExp.prototype.test"),C,k;function O(){var x=jg();C=x.isDeepEqual,k=x.isDeepStrictEqual}var G=!1,B=ha.exports=K,T={};function L(x){throw x.message instanceof Error?x.message:new l(x)}function I(x,D,U,j,X){var ee=arguments.length,ie;if(ee===0)ie="Failed";else if(ee===1)U=x,x=void 0;else{if(G===!1){G=!0;var be=process.emitWarning?process.emitWarning:console.warn.bind(console);be("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}ee===2&&(j="!=")}if(U instanceof Error)throw U;var Te={actual:x,expected:D,operator:j===void 0?"fail":j,stackStartFn:X||I};U!==void 0&&(Te.message=U);var Oe=new l(Te);throw ie&&(Oe.message=ie,Oe.generatedMessage=!0),Oe}B.fail=I,B.AssertionError=l;function M(x,D,U,j){if(!U){var X=!1;if(D===0)X=!0,j="No value argument passed to `assert.ok()`";else if(j instanceof Error)throw j;var ee=new l({actual:U,expected:!0,message:j,operator:"==",stackStartFn:x});throw ee.generatedMessage=X,ee}}function K(){for(var x=arguments.length,D=new Array(x),U=0;U<x;U++)D[U]=arguments[U];M.apply(void 0,[K,D.length].concat(D))}B.ok=K,B.equal=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");D!=U&&L({actual:D,expected:U,message:j,operator:"==",stackStartFn:x})},B.notEqual=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");D==U&&L({actual:D,expected:U,message:j,operator:"!=",stackStartFn:x})},B.deepEqual=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");C===void 0&&O(),C(D,U)||L({actual:D,expected:U,message:j,operator:"deepEqual",stackStartFn:x})},B.notDeepEqual=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");C===void 0&&O(),C(D,U)&&L({actual:D,expected:U,message:j,operator:"notDeepEqual",stackStartFn:x})},B.deepStrictEqual=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");C===void 0&&O(),k(D,U)||L({actual:D,expected:U,message:j,operator:"deepStrictEqual",stackStartFn:x})},B.notDeepStrictEqual=re;function re(x,D,U){if(arguments.length<2)throw new f("actual","expected");C===void 0&&O(),k(x,D)&&L({actual:x,expected:D,message:U,operator:"notDeepStrictEqual",stackStartFn:re})}B.strictEqual=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");A(D,U)||L({actual:D,expected:U,message:j,operator:"strictEqual",stackStartFn:x})},B.notStrictEqual=function x(D,U,j){if(arguments.length<2)throw new f("actual","expected");A(D,U)&&L({actual:D,expected:U,message:j,operator:"notStrictEqual",stackStartFn:x})};var ae=e(function x(D,U,j){var X=this;t(this,x),U.forEach(function(ee){ee in D&&(j!==void 0&&typeof j[ee]=="string"&&p(D[ee])&&E(D[ee],j[ee])?X[ee]=j[ee]:X[ee]=D[ee])})});function te(x,D,U,j,X,ee){if(!(U in x)||!k(x[U],D[U])){if(!j){var ie=new ae(x,X),be=new ae(D,X,x),Te=new l({actual:ie,expected:be,operator:"deepStrictEqual",stackStartFn:ee});throw Te.actual=x,Te.expected=D,Te.operator=ee.name,Te}L({actual:x,expected:D,message:j,operator:ee.name,stackStartFn:ee})}}function ne(x,D,U,j){if(typeof D!="function"){if(p(D))return E(D,x);if(arguments.length===2)throw new a("expected",["Function","RegExp"],D);if(s(x)!=="object"||x===null){var X=new l({actual:x,expected:D,message:U,operator:"deepStrictEqual",stackStartFn:j});throw X.operator=j.name,X}var ee=Object.keys(D);if(D instanceof Error)ee.push("name","message");else if(ee.length===0)throw new c("error",D,"may not be an empty object");return C===void 0&&O(),ee.forEach(function(ie){typeof x[ie]=="string"&&p(D[ie])&&E(D[ie],x[ie])||te(x,D,ie,U,ee,j)}),!0}return D.prototype!==void 0&&x instanceof D?!0:Error.isPrototypeOf(D)?!1:D.call({},x)===!0}function me(x){if(typeof x!="function")throw new a("fn","Function",x);try{x()}catch(D){return D}return T}function Ae(x){return m(x)||x!==null&&s(x)==="object"&&typeof x.then=="function"&&typeof x.catch=="function"}function F(x){return Promise.resolve().then(function(){var D;if(typeof x=="function"){if(D=x(),!Ae(D))throw new d("instance of Promise","promiseFn",D)}else if(Ae(x))D=x;else throw new a("promiseFn",["Function","Promise"],x);return Promise.resolve().then(function(){return D}).then(function(){return T}).catch(function(U){return U})})}function y(x,D,U,j){if(typeof U=="string"){if(arguments.length===4)throw new a("error",["Object","Error","Function","RegExp"],U);if(s(D)==="object"&&D!==null){if(D.message===U)throw new o("error/message",'The error message "'.concat(D.message,'" is identical to the message.'))}else if(D===U)throw new o("error/message",'The error "'.concat(D,'" is identical to the message.'));j=U,U=void 0}else if(U!=null&&s(U)!=="object"&&typeof U!="function")throw new a("error",["Object","Error","Function","RegExp"],U);if(D===T){var X="";U&&U.name&&(X+=" (".concat(U.name,")")),X+=j?": ".concat(j):".";var ee=x.name==="rejects"?"rejection":"exception";L({actual:void 0,expected:U,operator:x.name,message:"Missing expected ".concat(ee).concat(X),stackStartFn:x})}if(U&&!ne(D,U,j,x))throw D}function v(x,D,U,j){if(D!==T){if(typeof U=="string"&&(j=U,U=void 0),!U||ne(D,U)){var X=j?": ".concat(j):".",ee=x.name==="doesNotReject"?"rejection":"exception";L({actual:D,expected:U,operator:x.name,message:"Got unwanted ".concat(ee).concat(X,`
`)+'Actual message: "'.concat(D&&D.message,'"'),stackStartFn:x})}throw D}}B.throws=function x(D){for(var U=arguments.length,j=new Array(U>1?U-1:0),X=1;X<U;X++)j[X-1]=arguments[X];y.apply(void 0,[x,me(D)].concat(j))},B.rejects=function x(D){for(var U=arguments.length,j=new Array(U>1?U-1:0),X=1;X<U;X++)j[X-1]=arguments[X];return F(D).then(function(ee){return y.apply(void 0,[x,ee].concat(j))})},B.doesNotThrow=function x(D){for(var U=arguments.length,j=new Array(U>1?U-1:0),X=1;X<U;X++)j[X-1]=arguments[X];v.apply(void 0,[x,me(D)].concat(j))},B.doesNotReject=function x(D){for(var U=arguments.length,j=new Array(U>1?U-1:0),X=1;X<U;X++)j[X-1]=arguments[X];return F(D).then(function(ee){return v.apply(void 0,[x,ee].concat(j))})},B.ifError=function x(D){if(D!=null){var U="ifError got unwanted exception: ";s(D)==="object"&&typeof D.message=="string"?D.message.length===0&&D.constructor?U+=D.constructor.name:U+=D.message:U+=r(D);var j=new l({actual:D,expected:null,operator:"ifError",message:U,stackStartFn:x}),X=D.stack;if(typeof X=="string"){var ee=X.split(`
`);ee.shift();for(var ie=j.stack.split(`
`),be=0;be<ee.length;be++){var Te=ie.indexOf(ee[be]);if(Te!==-1){ie=ie.slice(0,Te);break}}j.stack="".concat(ie.join(`
`),`
`).concat(ee.join(`
`))}throw j}};function S(x,D,U,j,X){if(!p(D))throw new a("regexp","RegExp",D);var ee=X==="match";if(typeof x!="string"||E(D,x)!==ee){if(U instanceof Error)throw U;var ie=!U;U=U||(typeof x!="string"?'The "string" argument must be of type string. Received type '+"".concat(s(x)," (").concat(r(x),")"):(ee?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(r(D),`. Input:

`).concat(r(x),`
`));var be=new l({actual:x,expected:D,message:U,operator:X,stackStartFn:j});throw be.generatedMessage=ie,be}}B.match=function x(D,U,j){S(D,U,j,x,"match")},B.doesNotMatch=function x(D,U,j){S(D,U,j,x,"doesNotMatch")};function w(){for(var x=arguments.length,D=new Array(x),U=0;U<x;U++)D[U]=arguments[U];M.apply(void 0,[w,D.length].concat(D))}return B.strict=_(w,B,{equal:B.strictEqual,deepEqual:B.deepStrictEqual,notEqual:B.notStrictEqual,notDeepEqual:B.notDeepStrictEqual}),B.strict.strict=B.strict,ha.exports}var Hg=cs();const Qi=Rs(Hg);var $c={exports:{}};(function(s,e){(function(t,i){s.exports=i()})(globalThis,()=>(()=>{var t={456:(a,c,d)=>{var f=d(143);a.exports=function(l){var h,r="",u=(l=l||{}).video,m=l.options,p=f.$escape,_=l.tran,A=l.icons,E=f.$each,C=(l.$value,l.$index,l.index);return r+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    <div class="dplayer-video-wrap-aspect">
      `,h=d(194)(u),r+=h,r+=`
    </div>
    `,m.logo&&(r+=`
    <div class="dplayer-logo">
        <img src="`,r+=p(m.logo),r+=`">
    </div>
    `),r+=`
    <div class="dplayer-danmaku"`,m.danmaku&&m.danmaku.bottom&&(r+=' style="margin-bottom:',r+=p(m.danmaku.bottom),r+='"'),r+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,m.danmaku&&(r+=`
        <span class="dplayer-danloading">`,r+=p(_("Danmaku is loading")),r+=`</span>
        `),r+=`
        <span class="dplayer-loading-icon">`,r+=A.loading,r+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" aria-label="`,r+=p(_("Setting")),r+=`" data-balloon-nofocus data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=A.pallette,r+=`</span>
        </button>
        <input class="dplayer-comment-input" type="search" placeholder="`,r+=p(_("Input danmaku, hit Enter")),r+=`" spellcheck="false" maxlength="60">
        <button class="dplayer-icon dplayer-send-icon" aria-label="`,r+=p(_("Send")),r+=`" data-balloon-nofocus data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=A.send,r+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,r+=A.play,r+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,r+=A.volumeDown,r+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-nofocus data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,r+=p(m.theme),r+=`;">
                        <span class="dplayer-thumb" style="background: `,r+=p(m.theme),r+=`;"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">00:00</span> /
            <span class="dplayer-dtime">00:00</span>
        </span>
        `,m.live&&(r+=`
        <span class="dplayer-live-badge" aria-label="`,r+=p(_("Synchronize")),r+=`" data-balloon-nofocus data-balloon-pos="up">
            <span class="dplayer-icon-content">
                <span class="dplayer-live-dot" style="background: `,r+=p(m.theme),r+=';"></span>',r+=p(_("Live")),r+=`
            </span>
        </span>
        `),r+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,m.screenshot&&(r+=`
        <div class="dplayer-icon dplayer-camera-icon" aria-label="`,r+=p(_("Screenshot")),r+=`" data-balloon-nofocus data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=A.camera,r+=`</span>
        </div>
        `),r+=`
        `,m.airplay&&(r+=`
        <div class="dplayer-icon dplayer-airplay-icon" aria-label="`,r+=p(_("AirPlay")),r+=`" data-balloon-nofocus data-balloon-pos="up">
            <span class="dplayer-icon-content">`,r+=A.airplay,r+=`</span>
        </div>
        `),r+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" aria-label="`,r+=p(_("Send danmaku")),r+=`" data-balloon-nofocus data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=A.comment,r+=`</span>
            </button>
        </div>
        `,m.subtitle&&(r+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" aria-label="`,r+=p(_("Hide subtitle")),r+=`" data-balloon-nofocus data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=A.subtitle,r+=`</span>
            </button>
        </div>
        `),r+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" aria-label="`,r+=p(_("Setting")),r+=`" data-balloon-nofocus data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=A.setting,r+=`</span>
            </button>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-pip-icon" aria-label="`,r+=p(_("Picture-in-Picture")),r+=`" data-balloon-nofocus data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=A.pip,r+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-in-icon" aria-label="`,r+=p(_("Web full screen")),r+=`" data-balloon-nofocus data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=A.fullWeb,r+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" aria-label="`,r+=p(_("Full screen")),r+=`" data-balloon-nofocus data-balloon-pos="up">
                <span class="dplayer-icon-content">`,r+=A.full,r+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,r+=p(m.theme),r+=`;">
                <span class="dplayer-thumb" style="background: `,r+=p(m.theme),r+=`;"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-setting-box" style="`,r+=p(m.video.quality?`--quality-length:${m.video.quality.length}`:""),r+=`">
    <div class="dplayer-setting-origin-panel">
        `,m.video.quality&&(r+=`
        <div class="dplayer-setting-item dplayer-setting-quality">
            <span class="dplayer-label">`,r+=p(_("Quality")),r+=`</span>
            <span class="dplayer-label-value">`,r+=p(m.video.quality[m.video.defaultQuality].name),r+=`</span>
            <div class="dplayer-toggle">`,r+=A.right,r+=`</div>
        </div>
        `),r+=`
        <div class="dplayer-setting-item dplayer-setting-audio">
            <span class="dplayer-label">`,r+=p(_("Audio")),r+=`</span>
            <span class="dplayer-label-value">`,r+=p(_("Primary audio")),r+=`</span>
            <div class="dplayer-toggle">`,r+=A.right,r+=`</div>
        </div>
        <div class="dplayer-setting-item dplayer-setting-speed">
            <span class="dplayer-label">`,r+=p(_("Speed")),r+=`</span>
            <span class="dplayer-label-value">`,r+=p(_("Normal")),r+=`</span>
            <div class="dplayer-toggle">`,r+=A.right,r+=`</div>
        </div>
        <div class="dplayer-setting-item dplayer-setting-loop">
            <span class="dplayer-label">`,r+=p(_("Loop")),r+=`</span>
            <div class="dplayer-toggle">
                <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                <label for="dplayer-toggle" style="--theme-color:`,r+=p(m.theme),r+=`"></label>
            </div>
        </div>
        <div class="dplayer-setting-item dplayer-setting-showdan">
            <span class="dplayer-label">`,r+=p(_("Show danmaku")),r+=`</span>
            <div class="dplayer-toggle">
                <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                <label for="dplayer-toggle-dan" style="--theme-color:`,r+=p(m.theme),r+=`"></label>
            </div>
        </div>
        <div class="dplayer-setting-item dplayer-setting-danunlimit">
            <span class="dplayer-label">`,r+=p(_("Unlimited danmaku")),r+=`</span>
            <div class="dplayer-toggle">
                <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                <label for="dplayer-toggle-danunlimit" style="--theme-color:`,r+=p(m.theme),r+=`"></label>
            </div>
        </div>
        <div class="dplayer-setting-item dplayer-setting-danmaku">
            <span class="dplayer-label">`,r+=p(_("Opacity for danmaku")),r+=`</span>
            <span class="dplayer-label-value">1.0</span>
            <div class="dplayer-danmaku-bar-wrap">
                <div class="dplayer-danmaku-bar">
                    <div class="dplayer-danmaku-bar-inner" style="background: `,r+=p(m.theme),r+=`;">
                        <span class="dplayer-thumb" style="background: `,r+=p(m.theme),r+=`;"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    `,m.video.quality&&(r+=`
    <div class="dplayer-setting-quality-panel">
        <div class="dplayer-setting-header dplayer-setting-quality-header">
            <div class="dplayer-toggle">`,r+=A.left,r+=`</div>
            <span class="dplayer-label">`,r+=p(_("Quality")),r+=`</span>
        </div>
        `,E(m.video.quality,function(k,O){r+=`
            <div class="dplayer-setting-quality-item `,r+=p(k.name===m.video.quality[m.video.defaultQuality].name?"dplayer-setting-quality-current":""),r+='" data-index="',r+=p(O),r+=`">
                <div class="dplayer-toggle">`,r+=A.check,r+=`</div>
                <span class="dplayer-label">`,r+=p(k.name),r+=`</span>
            </div>
        `}),r+=`
    </div>
    `),r+=`
    <div class="dplayer-setting-speed-panel">
        <div class="dplayer-setting-header dplayer-setting-speed-header">
            <div class="dplayer-toggle">`,r+=A.left,r+=`</div>
            <span class="dplayer-label">`,r+=p(_("Speed")),r+=`</span>
        </div>
        `,E(m.playbackSpeed,function(k,O){r+=`
            <div class="dplayer-setting-speed-item `,r+=p(k===1?"dplayer-setting-speed-current":""),r+='" data-speed="',r+=p(k),r+=`">
                <div class="dplayer-toggle">`,r+=A.check,r+=`</div>
                <span class="dplayer-label">`,r+=p(k===1?_("Normal"):k),r+=`</span>
            </div>
        `}),r+=`
    </div>
    <div class="dplayer-setting-audio-panel">
        <div class="dplayer-setting-header dplayer-setting-audio-header">
            <div class="dplayer-toggle">`,r+=A.left,r+=`</div>
            <span class="dplayer-label">`,r+=p(_("Audio")),r+=`</span>
        </div>
        <div class="dplayer-setting-audio-item dplayer-setting-audio-current" data-audio="primary">
            <div class="dplayer-toggle">`,r+=A.check,r+=`</div>
            <span class="dplayer-label">`,r+=p(_("Primary audio")),r+=`</span>
        </div>
        <div class="dplayer-setting-audio-item" data-audio="secondary">
            <div class="dplayer-toggle">`,r+=A.check,r+=`</div>
            <span class="dplayer-label">`,r+=p(_("Secondary audio")),r+=`</span>
        </div>
    </div>
</div>
<div class="dplayer-comment-setting-box">
    <div class="dplayer-comment-setting-color">
        <div class="dplayer-comment-setting-title">`,r+=p(_("Set danmaku color")),r+=`</div>
        <div class="dplayer-comment-setting-color-list">
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#ffeaea" checked>
                <span style="background: #ffeaea"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#f02840">
                <span style="background: #f02840"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#fd7e80">
                <span style="background: #fd7e80"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#fda708">
                <span style="background: #fda708"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#ffe133">
                <span style="background: #ffe133"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#64dd17">
                <span style="background: #64dd17"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#00d4f5">
                <span style="background: #00d4f5"></span>
            </label>
            <label>
                <input type="radio" name="dplayer-danmaku-color-`,r+=p(C),r+=`" value="#4763ff">
                <span style="background: #4763ff"></span>
            </label>
        </div>
    </div>
    <div class="dplayer-comment-setting-type">
        <div class="dplayer-comment-setting-title">`,r+=p(_("Set danmaku type")),r+=`</div>
        <label>
            <input type="radio" name="dplayer-danmaku-type-`,r+=p(C),r+=`" value="top">
            <span>`,r+=p(_("Top")),r+=`</span>
        </label>
        <label>
            <input type="radio" name="dplayer-danmaku-type-`,r+=p(C),r+=`" value="right" checked>
            <span>`,r+=p(_("Rolling")),r+=`</span>
        </label>
        <label>
            <input type="radio" name="dplayer-danmaku-type-`,r+=p(C),r+=`" value="bottom">
            <span>`,r+=p(_("Bottom")),r+=`</span>
        </label>
    </div>
    <div class="dplayer-comment-setting-size">
        <div class="dplayer-comment-setting-title">`,r+=p(_("Set danmaku size")),r+=`</div>
        <label>
            <input type="radio" name="dplayer-danmaku-size-`,r+=p(C),r+=`" value="big">
            <span>`,r+=p(_("Big")),r+=`</span>
        </label>
        <label>
            <input type="radio" name="dplayer-danmaku-size-`,r+=p(C),r+=`" value="medium" checked>
            <span>`,r+=p(_("Medium")),r+=`</span>
        </label>
        <label>
            <input type="radio" name="dplayer-danmaku-size-`,r+=p(C),r+=`" value="small">
            <span>`,r+=p(_("Small")),r+=`</span>
        </label>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player Version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-mimetype">
        <span class="dplayer-info-panel-item-title">Mime Type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-video-fps">
        <span class="dplayer-info-panel-item-title">Video FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-page-fps">
        <span class="dplayer-info-panel-item-title">Page FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-dropped-frames">
        <span class="dplayer-info-panel-item-title">Dropped Frames</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video Type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video URL</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video Resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video Duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-buffer-remain">
        <span class="dplayer-info-panel-item-title">Buffer Remain</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-download-speed">
        <span class="dplayer-info-panel-item-title">Download Speed</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
</div>
<div class="dplayer-menu">
    `,E(m.contextmenu,function(k,O){r+=`
        <div class="dplayer-menu-item">
            <a`,k.link&&(r+=' target="_blank"'),r+=' href="',r+=p(k.link||"javascript:void(0);"),r+='">',r+=p(_(k.text)),r+=`</a>
        </div>
    `}),r+=`
</div>
<div class="dplayer-notice"></div>
<div class="dplayer-mobile-icon-wrap">
    <button class="dplayer-mobile-icon dplayer-mobile-icon-backward">
        `,r+=A.backward,r+=`
    </button>
    <button class="dplayer-mobile-icon dplayer-mobile-icon-play">
        `,r+=A.play,r+=`
    </button>
    <button class="dplayer-mobile-icon dplayer-mobile-icon-forward">
        `,r+=A.forward,r+=`
    </button>
</div>
`}},194:(a,c,d)=>{var f=d(143);a.exports=function(l){var h="",r=(l=l||{}).enableSubtitle,u=l.subtitle,m=l.current,p=l.airplay,_=l.pic,A=f.$escape,E=l.crossOrigin,C=l.screenshot,k=l.preload,O=l.url;return r=u&&u.type==="webvtt",h+=`
<video
    class="dplayer-video `,m&&(h+="dplayer-video-current"),h+=`"
    webkit-playsinline
    `,p&&(h+=' x-webkit-airplay="allow" '),h+=`
    playsinline
    `,_&&(h+='poster="',h+=A(_),h+='"'),h+=`
    `,(E!==null||C||r)&&(h+='crossorigin="',h+=A(E||"anonymous"),h+='"'),h+=`
    `,k&&(h+='preload="',h+=A(k),h+='"'),h+=`
    `,O&&(h+='src="',h+=A(O),h+='"'),h+=`
    >
    `,r&&(h+=`
    <track kind="metadata" default src="`,h+=A(u.url),h+=`"></track>
    `),h+=`
</video>
`}},880:(a,c,d)=>{d.d(c,{A:()=>u});var f=d(34),l=d.n(f),h=d(122),r=d.n(h)()(l());r.push([a.id,':root{--balloon-border-radius:2px;--balloon-color:#101010f2;--balloon-text-color:#fff;--balloon-font-size:12px;--balloon-move:4px}button[aria-label][data-balloon-pos]{overflow:visible}[aria-label][data-balloon-pos]{cursor:pointer;position:relative}[aria-label][data-balloon-pos]:after{background:var(--balloon-color);border-radius:2px;border-radius:var(--balloon-border-radius);color:var(--balloon-text-color);content:attr(aria-label);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:var(--balloon-font-size);font-style:normal;font-weight:400;padding:.5em 1em;text-indent:0;text-shadow:none;white-space:nowrap}[aria-label][data-balloon-pos]:after,[aria-label][data-balloon-pos]:before{opacity:0;pointer-events:none;position:absolute;transition:all .18s ease-out .18s;z-index:10}[aria-label][data-balloon-pos]:before{border:5px solid #0000;border-top:5px solid var(--balloon-color);content:"";height:0;width:0}[aria-label][data-balloon-pos]:hover:after,[aria-label][data-balloon-pos]:hover:before,[aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after,[aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before,[aria-label][data-balloon-pos][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-visible]:before{opacity:1;pointer-events:none}[aria-label][data-balloon-pos].font-awesome:after{font-family:FontAwesome,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif}[aria-label][data-balloon-pos][data-balloon-break]:after{white-space:pre}[aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after{white-space:pre-line;word-break:break-word}[aria-label][data-balloon-pos][data-balloon-blunt]:after,[aria-label][data-balloon-pos][data-balloon-blunt]:before{transition:none}[aria-label][data-balloon-pos][data-balloon-pos=down]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=down]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=down][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=down][data-balloon-visible]:before,[aria-label][data-balloon-pos][data-balloon-pos=up]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=up]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=up][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=up][data-balloon-visible]:before{transform:translate(-50%)}[aria-label][data-balloon-pos][data-balloon-pos*=-left]:after{left:0}[aria-label][data-balloon-pos][data-balloon-pos*=-left]:before{left:5px}[aria-label][data-balloon-pos][data-balloon-pos*=-right]:after{right:0}[aria-label][data-balloon-pos][data-balloon-pos*=-right]:before{right:5px}[aria-label][data-balloon-pos][data-balloon-po*=-left]:hover:after,[aria-label][data-balloon-pos][data-balloon-po*=-left]:hover:before,[aria-label][data-balloon-pos][data-balloon-po*=-left][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-po*=-left][data-balloon-visible]:before,[aria-label][data-balloon-pos][data-balloon-pos*=-right]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos*=-right]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos*=-right][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos*=-right][data-balloon-visible]:before{transform:translate(0)}[aria-label][data-balloon-pos][data-balloon-pos^=up]:after,[aria-label][data-balloon-pos][data-balloon-pos^=up]:before{bottom:100%;transform:translateY(var(--balloon-move));transform-origin:top}[aria-label][data-balloon-pos][data-balloon-pos^=up]:after{margin-bottom:10px}[aria-label][data-balloon-pos][data-balloon-pos=up]:after,[aria-label][data-balloon-pos][data-balloon-pos=up]:before{left:50%;transform:translate(-50%,var(--balloon-move))}[aria-label][data-balloon-pos][data-balloon-pos^=down]:after,[aria-label][data-balloon-pos][data-balloon-pos^=down]:before{top:100%;transform:translateY(calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos^=down]:after{margin-top:10px}[aria-label][data-balloon-pos][data-balloon-pos^=down]:before{border:5px solid #0000;border-bottom:5px solid var(--balloon-color);height:0;width:0}[aria-label][data-balloon-pos][data-balloon-pos=down]:after,[aria-label][data-balloon-pos][data-balloon-pos=down]:before{left:50%;transform:translate(-50%,calc(var(--balloon-move)*-1))}[aria-label][data-balloon-pos][data-balloon-pos=left]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=left]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=left][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=left][data-balloon-visible]:before,[aria-label][data-balloon-pos][data-balloon-pos=right]:hover:after,[aria-label][data-balloon-pos][data-balloon-pos=right]:hover:before,[aria-label][data-balloon-pos][data-balloon-pos=right][data-balloon-visible]:after,[aria-label][data-balloon-pos][data-balloon-pos=right][data-balloon-visible]:before{transform:translateY(-50%)}[aria-label][data-balloon-pos][data-balloon-pos=left]:after,[aria-label][data-balloon-pos][data-balloon-pos=left]:before{right:100%;top:50%;transform:translate(var(--balloon-move),-50%)}[aria-label][data-balloon-pos][data-balloon-pos=left]:after{margin-right:10px}[aria-label][data-balloon-pos][data-balloon-pos=left]:before{border:5px solid #0000;border-left:5px solid var(--balloon-color);height:0;width:0}[aria-label][data-balloon-pos][data-balloon-pos=right]:after,[aria-label][data-balloon-pos][data-balloon-pos=right]:before{left:100%;top:50%;transform:translate(calc(var(--balloon-move)*-1),-50%)}[aria-label][data-balloon-pos][data-balloon-pos=right]:after{margin-left:10px}[aria-label][data-balloon-pos][data-balloon-pos=right]:before{border:5px solid #0000;border-right:5px solid var(--balloon-color);height:0;width:0}[aria-label][data-balloon-pos][data-balloon-length]:after{white-space:normal}[aria-label][data-balloon-pos][data-balloon-length=small]:after{width:80px}[aria-label][data-balloon-pos][data-balloon-length=medium]:after{width:150px}[aria-label][data-balloon-pos][data-balloon-length=large]:after{width:260px}[aria-label][data-balloon-pos][data-balloon-length=xlarge]:after{width:380px}@media screen and (max-width:768px){[aria-label][data-balloon-pos][data-balloon-length=xlarge]:after{width:90vw}}[aria-label][data-balloon-pos][data-balloon-length=fit]:after{width:100%}',"",{version:3,sources:["webpack://./node_modules/balloon-css/balloon.css"],names:[],mappings:"AAAA,MACE,2BAA4B,CAC5B,yBAAuC,CACvC,yBAA0B,CAC1B,wBAAyB,CACzB,kBAAqB,CAEvB,qCACE,gBAAmB,CAErB,+BAEE,cAAe,CADf,iBACiB,CACjB,qCAUE,+BAAgC,CAChC,iBAAkB,CAElB,0CAA2C,CAD3C,+BAAgC,CAEhC,wBAAyB,CATzB,wHAAwI,CAIxI,kCAAmC,CAFnC,iBAAkB,CADlB,eAAmB,CASnB,gBAAiB,CAXjB,aAAc,CAId,gBAAiB,CASjB,kBACa,CACf,2EAlBE,SAAU,CACV,mBAAoB,CAcpB,iBAAkB,CAblB,iCAAoC,CAepC,UAWa,CAVf,sCAIE,sBAAsC,CAAtC,yCAAsC,CAItC,UAAW,CANX,QAAS,CADT,OASa,CACf,6VACE,SAAU,CACV,mBAAsB,CACxB,kDACE,oIAAuJ,CACzJ,yDACE,eAAkB,CACpB,8EACE,oBAAqB,CACrB,qBAAwB,CAC1B,mHACE,eAAkB,CAGpB,4kBACE,yBAA+B,CACjC,8DACE,MAAS,CACX,+DACE,QAAW,CACb,+DACE,OAAU,CACZ,gEACE,SAAY,CAGd,omBACE,sBAA4B,CAC9B,uHACE,WAAY,CAEZ,yCAA4C,CAD5C,oBAC8C,CAChD,2DACE,kBAAqB,CACvB,qHACE,QAAS,CACT,6CAAiD,CACnD,2HACE,QAAS,CACT,kDAAyD,CAC3D,6DACE,eAAkB,CACpB,8DAIE,sBAAyC,CAAzC,4CAAyC,CAFzC,QAAS,CADT,OAG2C,CAC7C,yHACE,QAAS,CACT,sDAA4D,CAG9D,wlBACE,0BAA+B,CACjC,yHACE,UAAW,CACX,OAAQ,CACR,6CAAiD,CACnD,4DACE,iBAAoB,CACtB,6DAIE,sBAAuC,CAAvC,0CAAuC,CAFvC,QAAS,CADT,OAGyC,CAC3C,2HACE,SAAU,CACV,OAAQ,CACR,sDAA4D,CAC9D,6DACE,gBAAmB,CACrB,8DAIE,sBAAwC,CAAxC,2CAAwC,CAFxC,QAAS,CADT,OAG0C,CAC5C,0DACE,kBAAqB,CACvB,gEACE,UAAa,CACf,iEACE,WAAc,CAChB,gEACE,WAAc,CAChB,iEACE,WAAc,CACd,oCACE,iEACE,UAAa,CAAE,CACrB,8DACE,UAAa",sourcesContent:[`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: var(--balloon-font-size);
    background: var(--balloon-color);
    border-radius: 2px;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`],sourceRoot:""}]);const u=r},420:(a,c,d)=>{d.d(c,{A:()=>p});var f=d(34),l=d.n(f),h=d(122),r=d.n(h),u=d(880),m=r()(l());m.i(u.A),m.push([a.id,'@keyframes my-face{2%{transform:translateY(1.5px) rotate(1.5deg)}4%{transform:translateY(-1.5px) rotate(-.5deg)}6%{transform:translateY(1.5px) rotate(-1.5deg)}8%{transform:translateY(-1.5px) rotate(-1.5deg)}10%{transform:translateY(2.5px) rotate(1.5deg)}12%{transform:translateY(-.5px) rotate(1.5deg)}14%{transform:translateY(-1.5px) rotate(1.5deg)}16%{transform:translateY(-.5px) rotate(-1.5deg)}18%{transform:translateY(.5px) rotate(-1.5deg)}20%{transform:translateY(-1.5px) rotate(2.5deg)}22%{transform:translateY(.5px) rotate(-1.5deg)}24%{transform:translateY(1.5px) rotate(1.5deg)}26%{transform:translateY(.5px) rotate(.5deg)}28%{transform:translateY(.5px) rotate(1.5deg)}30%{transform:translateY(-.5px) rotate(2.5deg)}32%{transform:translateY(1.5px) rotate(-.5deg)}34%{transform:translateY(1.5px) rotate(-.5deg)}36%{transform:translateY(-1.5px) rotate(2.5deg)}38%{transform:translateY(1.5px) rotate(-1.5deg)}40%{transform:translateY(-.5px) rotate(2.5deg)}42%{transform:translateY(2.5px) rotate(-1.5deg)}44%{transform:translateY(1.5px) rotate(.5deg)}46%{transform:translateY(-1.5px) rotate(2.5deg)}48%{transform:translateY(-.5px) rotate(.5deg)}50%{transform:translateY(.5px) rotate(.5deg)}52%{transform:translateY(2.5px) rotate(2.5deg)}54%{transform:translateY(-1.5px) rotate(1.5deg)}56%{transform:translateY(2.5px) rotate(2.5deg)}58%{transform:translateY(.5px) rotate(2.5deg)}60%{transform:translateY(2.5px) rotate(2.5deg)}62%{transform:translateY(-.5px) rotate(2.5deg)}64%{transform:translateY(-.5px) rotate(1.5deg)}66%{transform:translateY(1.5px) rotate(-.5deg)}68%{transform:translateY(-1.5px) rotate(-.5deg)}70%{transform:translateY(1.5px) rotate(.5deg)}72%{transform:translateY(2.5px) rotate(1.5deg)}74%{transform:translateY(-.5px) rotate(.5deg)}76%{transform:translateY(-.5px) rotate(2.5deg)}78%{transform:translateY(-.5px) rotate(1.5deg)}80%{transform:translateY(1.5px) rotate(1.5deg)}82%{transform:translateY(-.5px) rotate(.5deg)}84%{transform:translateY(1.5px) rotate(2.5deg)}86%{transform:translateY(-1.5px) rotate(-1.5deg)}88%{transform:translateY(-.5px) rotate(2.5deg)}90%{transform:translateY(2.5px) rotate(-.5deg)}92%{transform:translateY(.5px) rotate(-.5deg)}94%{transform:translateY(2.5px) rotate(.5deg)}96%{transform:translateY(-.5px) rotate(1.5deg)}98%{transform:translateY(-1.5px) rotate(-.5deg)}0%,to{transform:translate(0) rotate(0deg)}}.dplayer{line-height:1;overflow:hidden;position:relative;user-select:none;-webkit-user-select:none}.dplayer *{box-sizing:initial}.dplayer svg{height:100%;width:100%}.dplayer svg circle,.dplayer svg path{fill:#fff}.dplayer.dplayer-fulled,.dplayer.dplayer-fulled-browser{background:#000;height:100%!important;left:0;margin:0;padding:0;position:fixed;top:0;transform:translate(0);width:100%!important;z-index:100000}.dplayer.dplayer-live .dplayer-bar-wrap,.dplayer.dplayer-live .dplayer-time,.dplayer.dplayer-no-audio-switching .dplayer-setting-box .dplayer-setting-audio,.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment,.dplayer.dplayer-no-danmaku .dplayer-danmaku,.dplayer.dplayer-no-danmaku .dplayer-setting-box .dplayer-setting-danmaku,.dplayer.dplayer-no-danmaku .dplayer-setting-box .dplayer-setting-danunlimit,.dplayer.dplayer-no-danmaku .dplayer-setting-box .dplayer-setting-showdan{display:none}.dplayer.dplayer-live .dplayer-notice{bottom:56px}.dplayer.dplayer-live .dplayer-setting-loop,.dplayer.dplayer-live .dplayer-setting-speed{display:none}.dplayer.dplayer-live .dplayer-controller .dplayer-icons .dplayer-setting-box{height:auto;overflow-y:hidden}.dplayer.dplayer-live .dplayer-mobile-icon-backward,.dplayer.dplayer-live .dplayer-mobile-icon-forward{display:none}.dplayer.dplayer-live .dplayer-comment-setting-box,.dplayer.dplayer-live .dplayer-setting-box{bottom:58px;max-height:calc(100% - 66px)}.dplayer.dplayer-live.dplayer-mobile .dplayer-comment-setting-box,.dplayer.dplayer-live.dplayer-mobile .dplayer-setting-box{bottom:52px;max-height:calc(100% - 60px)}.dplayer.dplayer-narrow .dplayer-danmaku{font-size:18px}.dplayer.dplayer-narrow .dplayer-icon{margin:0 -3px}.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move{animation-play-state:running}.dplayer.dplayer-playing .dplayer-controller,.dplayer.dplayer-playing .dplayer-controller-mask{opacity:0}.dplayer.dplayer-playing:hover .dplayer-controller,.dplayer.dplayer-playing:hover .dplayer-controller-mask{opacity:1}.dplayer.dplayer-loading .dplayer-bezel .dplayer-loading-icon{display:block}.dplayer.dplayer-loading .dplayer-danmaku,.dplayer.dplayer-loading .dplayer-danmaku-move,.dplayer.dplayer-paused .dplayer-danmaku,.dplayer.dplayer-paused .dplayer-danmaku-move{animation-play-state:paused}.dplayer.dplayer-show-controller .dplayer-controller,.dplayer.dplayer-show-controller .dplayer-controller-mask{opacity:1}.dplayer.dplayer-fulled{height:100%!important;left:0;position:fixed!important;top:0;width:100%!important;z-index:100000}.dplayer.dplayer-fulled.dplayer-hide-controller{cursor:none}.dplayer.dplayer-fulled.dplayer-hide-controller .dplayer-controller,.dplayer.dplayer-fulled.dplayer-hide-controller .dplayer-controller-mask{opacity:0!important}.dplayer.dplayer-fulled-browser.dplayer-hide-controller{cursor:none}.dplayer.dplayer-fulled-browser.dplayer-hide-controller .dplayer-controller,.dplayer.dplayer-fulled-browser.dplayer-hide-controller .dplayer-controller-mask{opacity:0!important}.dplayer.dplayer-mobile .dplayer-controller{height:44px}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons{padding-bottom:3px;padding-top:3px}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume{display:none}.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon,.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-pip-icon{display:inline-block;position:static}.dplayer.dplayer-mobile .dplayer-controller-mask{background:linear-gradient(#0000008c 78%,#000c);height:100%}.dplayer.dplayer-mobile.dplayer-playing .dplayer-controller,.dplayer.dplayer-mobile.dplayer-playing .dplayer-controller-mask{opacity:1}.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-controller-mask{opacity:0}.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-controller{opacity:0;transform:translateY(100%)}.dplayer.dplayer-mobile .dplayer-bar-wrap{bottom:40px}.dplayer.dplayer-mobile .dplayer-bar-wrap .dplayer-bar-time{display:none}.dplayer.dplayer-mobile .dplayer-comment-setting-box,.dplayer.dplayer-mobile .dplayer-setting-box{bottom:58px;max-height:calc(100% - 66px)}.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-icon-wrap{opacity:0;visibility:hidden}.dplayer.dplayer-mobile .dplayer-mobile-icon-wrap{opacity:.7;visibility:visible}.dplayer-web-fullscreen-fix{left:0;margin:0;padding:0;position:fixed;top:0}.dplayer [aria-label]{--balloon-font-size:11.5px}.dplayer [aria-label]:before{display:none}.dplayer [aria-label]:after{background:#111111b3!important;font-family:inherit!important;padding:.3em .8em!important}.dplayer [aria-label][data-balloon-pos=up]:after{margin-bottom:0!important}.dplayer-bezel{bottom:0;color:#fff;font-size:22px;left:0;pointer-events:none;position:absolute;right:0;top:0}.dplayer-bezel .dplayer-bezel-icon{background:#00000080;border-radius:50%;box-sizing:border-box;height:52px;left:50%;margin:-26px 0 0 -26px;opacity:0;padding:12px;pointer-events:none;position:absolute;top:50%;width:52px;will-change:transform}.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition{animation:bezel-hide .5s linear}@keyframes bezel-hide{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(2)}}.dplayer-bezel .dplayer-danloading{animation:my-face 5s ease-in-out infinite;font-size:14px;line-height:14px;margin-top:-7px;position:absolute;text-align:center;top:50%;width:100%}.dplayer-bezel .dplayer-loading-icon{display:none;height:36px;left:50%;margin:-18px 0 0 -18px;pointer-events:none;position:absolute;top:50%;width:36px}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-hide{display:none}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot{animation:dplayer-loading-dot-fade .8s ease infinite;opacity:0;transform-origin:4px 4px;will-change:transform}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-7{animation-delay:.7s}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-6{animation-delay:.6s}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-5{animation-delay:.5s}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-4{animation-delay:.4s}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-3{animation-delay:.3s}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-2{animation-delay:.2s}.dplayer-bezel .dplayer-loading-icon .dplayer-loading-dot.dplayer-loading-dot-1{animation-delay:.1s}@keyframes dplayer-loading-dot-fade{0%{opacity:.7;transform:scale(1.2)}50%{opacity:.25;transform:scale(.9)}to{opacity:.25;transform:scale(.85)}}.dplayer-controller-mask{background:linear-gradient(#0000 15%,#000000b3);height:98px;width:100%}.dplayer-controller,.dplayer-controller-mask{bottom:0;position:absolute;transition:all .3s ease}.dplayer-controller{height:50px;left:0;padding:0 20px;right:0;user-select:none;-webkit-user-select:none}.dplayer-controller.dplayer-controller-comment .dplayer-icons{display:none}.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box{display:block}.dplayer-controller .dplayer-bar-wrap{bottom:46px;cursor:pointer;height:3px;padding:5px 0;position:absolute;width:calc(100% - 40px)}.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb{transform:scale(1)}.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight{display:block;height:40%;top:4px;transform:translateX(-4px);width:8px}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight{background-color:#fff;border-radius:6px;height:20%;position:absolute;text-align:center;top:5px;transform:translateX(-3px);transition:all .2s ease-in-out;width:6px;z-index:12}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text{display:block}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover~.dplayer-bar-preview,.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover~.dplayer-bar-time{opacity:0}.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text{background-color:#0000009e;border-radius:4px;color:#fff;display:none;font-size:12px;left:50%;padding:5px 8px;position:absolute;top:-24px;transform:translateX(-50%);white-space:nowrap}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview{background:#fff;background-size:16000px 100%;border-radius:6px;display:none;pointer-events:none;position:absolute}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas{height:100%;pointer-events:none;position:absolute;width:100%;z-index:1}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time{word-wrap:normal;background-color:#0000009e;border-radius:4px;color:#fff;font-size:12px;left:0;opacity:1;padding:5px 7px;pointer-events:none;position:absolute;text-align:center;top:-20px;transition:opacity .1s ease-in-out;word-break:normal;z-index:2}.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden{opacity:0}.dplayer-controller .dplayer-bar-wrap .dplayer-bar{background:#fff3;cursor:pointer;height:4px;position:relative;width:100%}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded{background:#fff;transition:all .5s ease}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded,.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played{bottom:0;height:4px;left:0;position:absolute;top:0;will-change:width}.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb{border-radius:50%;cursor:pointer;height:11px;margin-right:-10px;margin-top:-4px;position:absolute;right:5px;top:0;transform:scale(0);transition:all .3s ease-in-out;width:11px}.dplayer-controller .dplayer-icons{-webkit-tap-highlight-color:rgba(0,0,0,0);bottom:0;height:38px;padding-bottom:6px;padding-top:6px;position:absolute}.dplayer-controller .dplayer-icons.dplayer-comment-box{bottom:0;color:#fff;display:none;height:38px;left:20px;position:absolute;right:20px;transition:all .3s ease-in-out;z-index:2}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon{padding:7px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon{left:0;position:absolute;top:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon{position:absolute;right:0;top:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon[aria-label]:after{left:14%}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input{background:none;border:none;border-radius:4px;box-sizing:border-box;color:#fff;font-family:inherit;font-size:14px;height:100%;line-height:18px;margin:0;outline:none;padding:8px 0;text-align:center;width:100%}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder{color:#fff;opacity:.8}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-focus-inner{border:0}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear{display:none}@media(max-width:350px){.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box{padding:9px 10px 15px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title{font-size:12px;line-height:24px}.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input{font-size:12px}}.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon{padding:7px}@media(max-width:500px){.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon{padding-top:6px}}@media(max-width:350px){.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon{padding-top:7px}}.dplayer-controller .dplayer-icons.dplayer-icons-right{right:20px}.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon{padding:8px}@media(max-width:500px){.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon{padding:7px;width:38px}}@media(max-width:350px){.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon{padding:5px;width:31px}}.dplayer-controller .dplayer-icons .dplayer-time{color:#eee;font-family:inherit;font-size:13px;line-height:38px;text-shadow:0 0 2px #00000080;vertical-align:middle}@media(max-width:350px){.dplayer-controller .dplayer-icons .dplayer-time{font-size:12px}}.dplayer-controller .dplayer-icons .dplayer-live-badge{align-items:center;color:#eee;cursor:pointer;display:inline-flex;font-family:inherit;font-size:13px;height:100%;line-height:18px;text-shadow:0 0 2px #00000080;vertical-align:middle}.dplayer-controller .dplayer-icons .dplayer-live-dot{border-radius:6px;content:"";display:inline-block;height:6px;margin-right:5px;vertical-align:4%;width:6px}.dplayer-controller .dplayer-icons .dplayer-icon{background-color:#0000;border:none;box-sizing:border-box;cursor:pointer;display:inline-block;height:100%;line-height:18px;outline:none;vertical-align:middle;width:40px}.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content{opacity:.8;transition:all .2s ease-in-out}.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content{opacity:1}.dplayer-controller .dplayer-icons .dplayer-icon::-moz-focus-inner{border:0}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon{padding:10.5px 9.5px 8px}@media(max-width:500px){.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon{padding:9px 9px 8px}}@media(max-width:350px){.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon{padding:6.5px 6.5px 6px}}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon{width:43px}.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-full-icon[aria-label]:after{left:1%}@media(max-width:350px){.dplayer-controller .dplayer-icons .dplayer-icon{width:35px}}.dplayer-controller .dplayer-icons .dplayer-volume{cursor:pointer;display:inline-block;height:100%;position:relative}.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar{width:45px}.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar{width:45px}.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{transform:scale(1)}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap{display:inline-block;height:100%;margin:0 10px 0 -5px;vertical-align:middle}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar{background:#fff;height:4px;position:relative;top:17px;transition:all .3s ease-in-out;width:0}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner{bottom:0;height:100%;left:0;position:absolute;transition:all .1s ease;will-change:width}.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb{border-radius:50%;cursor:pointer;height:11px;margin-right:-10px;margin-top:-4px;position:absolute;right:5px;top:0;transform:scale(0);transition:all .3s ease-in-out;width:11px}.dplayer-controller .dplayer-icons .dplayer-setting,.dplayer-controller .dplayer-icons .dplayer-subtitle-btn{display:inline-block;height:100%}.dplayer-controller .dplayer-icons .dplayer-full{display:inline-block;height:100%;position:relative}.dplayer-controller .dplayer-icons .dplayer-comment{display:inline-block;height:100%}.dplayer-mobile-icon-wrap{align-items:center;display:flex;height:50px;justify-content:space-evenly;left:50%;opacity:0;pointer-events:none;position:absolute;top:50%;transform:translate(-50%,-50%);transition:all .28s ease;visibility:hidden;width:100%}.dplayer-mobile-icon-wrap .dplayer-mobile-icon{-webkit-tap-highlight-color:rgba(0,0,0,0);background-color:#0000;border:none;box-sizing:border-box;cursor:pointer;filter:drop-shadow(0 0 7px rgba(0,0,0,.5));height:50px;outline:none;pointer-events:auto;width:50px}.dplayer-mobile-icon-wrap .dplayer-mobile-icon-backward,.dplayer-mobile-icon-wrap .dplayer-mobile-icon-forward{padding:12px}.dplayer-setting-box{-webkit-tap-highlight-color:rgba(0,0,0,0);background:#1c1c1ce6;border-radius:7px;bottom:64px;box-sizing:border-box;display:flex;height:calc(100% - 72px);opacity:0;overflow-x:hidden;overflow-y:hidden;position:absolute;right:20px;transition:all .25s ease;visibility:hidden;width:210px;z-index:2}.dplayer-setting-box>div{overflow-x:hidden}.dplayer-setting-box>div.dplayer-setting-origin-panel{display:block}.dplayer-setting-box.dplayer-setting-box-open{opacity:1;visibility:visible}.dplayer-setting-box.dplayer-setting-box-quality{clip-path:inset(calc(100% - 30px*var(--quality-length) - 54px) 0 0 round 7px)!important}.dplayer-setting-box.dplayer-setting-box-quality .dplayer-setting-origin-panel{transform:translateX(-100%)}.dplayer-setting-box.dplayer-setting-box-quality .dplayer-setting-quality-panel{display:block;transform:translateX(0)}.dplayer-setting-box.dplayer-setting-box-speed{clip-path:inset(calc(100% - 294px) 0 0 round 7px)!important}.dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel{transform:translateX(-100%)}.dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel{display:block;transform:translateX(0)}.dplayer-setting-box.dplayer-setting-box-audio{clip-path:inset(calc(100% - 114px) 0 0 round 7px)!important}.dplayer-setting-box.dplayer-setting-box-audio .dplayer-setting-origin-panel{transform:translateX(-100%)}.dplayer-setting-box.dplayer-setting-box-audio .dplayer-setting-audio-panel{display:block;transform:translateX(0)}.dplayer-setting-box .dplayer-label{color:#eee;display:inline-block;font-size:13px;vertical-align:middle;white-space:nowrap}.dplayer-setting-box .dplayer-label-value{color:#e0e0e0;display:inline-block;font-size:12px;margin-left:auto;margin-right:23px;vertical-align:middle;white-space:nowrap}.dplayer-setting-box .dplayer-toggle{font-size:0;height:20px;position:absolute;right:7px;text-align:center;top:5px;vertical-align:middle;width:20px}.dplayer-setting-box .dplayer-toggle input{display:none;max-height:0;max-width:0}.dplayer-setting-box .dplayer-toggle input+label{border:1px solid #dfdfdf;border-radius:10px;box-shadow:inset 0 0 0 0 #dfdfdf;box-sizing:border-box;cursor:pointer;display:inline-block;height:20px;position:relative;right:15px;transition:.25s ease;width:32px}.dplayer-setting-box .dplayer-toggle input+label:before{border-radius:15px;content:"";display:block;height:19px;left:-.5px;position:absolute;top:-.5px;transition:.25s ease;width:19px}.dplayer-setting-box .dplayer-toggle input+label:after{background:#fff;border-radius:15px;box-shadow:0 1px 3px #0006;content:"";display:block;height:18.1px;left:0;position:absolute;top:-.1px;transition:.25s ease;width:18.1px}.dplayer-setting-box .dplayer-toggle input:checked+label{border-color:var(--theme-color)}.dplayer-setting-box .dplayer-toggle input:checked+label:before{background:var(--theme-color);width:31px}.dplayer-setting-box .dplayer-toggle input:checked+label:after{left:12px}.dplayer-setting-box .dplayer-setting-audio-panel,.dplayer-setting-box .dplayer-setting-origin-panel,.dplayer-setting-box .dplayer-setting-quality-panel,.dplayer-setting-box .dplayer-setting-speed-panel{bottom:0;box-sizing:border-box;max-height:100%;overflow-y:auto;padding:7px 0;position:absolute;scrollbar-width:thin;transition:transform .25s ease;width:100%}.dplayer-setting-box .dplayer-setting-audio-panel::-webkit-scrollbar,.dplayer-setting-box .dplayer-setting-origin-panel::-webkit-scrollbar,.dplayer-setting-box .dplayer-setting-quality-panel::-webkit-scrollbar,.dplayer-setting-box .dplayer-setting-speed-panel::-webkit-scrollbar{width:6px}.dplayer-setting-box .dplayer-setting-audio-panel::-webkit-scrollbar-thumb,.dplayer-setting-box .dplayer-setting-origin-panel::-webkit-scrollbar-thumb,.dplayer-setting-box .dplayer-setting-quality-panel::-webkit-scrollbar-thumb,.dplayer-setting-box .dplayer-setting-speed-panel::-webkit-scrollbar-thumb{background:#ffffff26}.dplayer-setting-box .dplayer-setting-origin-panel{transform:translateX(0)}.dplayer-setting-box .dplayer-setting-audio-panel,.dplayer-setting-box .dplayer-setting-quality-panel,.dplayer-setting-box .dplayer-setting-speed-panel{transform:translateX(100%)}.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-header,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-header,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-header{align-items:center;border-bottom:2px solid #ffffff26;box-sizing:border-box;cursor:pointer;display:flex;height:33px;margin-bottom:7px;padding-bottom:5px;padding-left:5px}.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-audio-item,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-quality-item,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-speed-item,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-audio-item,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-quality-item,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-speed-item,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-audio-item,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-quality-item,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-speed-item{padding:5px}.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-audio-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-quality-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-speed-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-audio-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-quality-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-speed-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-audio-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-quality-item .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-speed-item .dplayer-toggle{visibility:hidden}.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-audio-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-audio-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-audio-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-quality-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-quality-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-quality-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-speed-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-speed-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-setting-speed-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-audio-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-audio-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-audio-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-quality-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-quality-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-quality-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-speed-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-speed-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-setting-speed-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-audio-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-audio-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-audio-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-quality-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-quality-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-quality-item.dplayer-setting-speed-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-speed-item.dplayer-setting-audio-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-speed-item.dplayer-setting-quality-current .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-setting-speed-item.dplayer-setting-speed-current .dplayer-toggle{visibility:visible}.dplayer-setting-box .dplayer-setting-audio-panel .dplayer-toggle,.dplayer-setting-box .dplayer-setting-quality-panel .dplayer-toggle,.dplayer-setting-box .dplayer-setting-speed-panel .dplayer-toggle{display:inline-block;margin-right:6px;position:static;width:22px}.dplayer-setting-box .dplayer-setting-audio-item,.dplayer-setting-box .dplayer-setting-item,.dplayer-setting-box .dplayer-setting-quality-item,.dplayer-setting-box .dplayer-setting-speed-item{align-items:center;box-sizing:border-box;cursor:pointer;display:flex;height:30px;padding:5px 10px;position:relative}.dplayer-setting-box .dplayer-setting-audio-item:hover,.dplayer-setting-box .dplayer-setting-item:hover,.dplayer-setting-box .dplayer-setting-quality-item:hover,.dplayer-setting-box .dplayer-setting-speed-item:hover{background-color:#ffffff1a}.dplayer-setting-box .dplayer-setting-danmaku{padding:5px 0}.dplayer-setting-box .dplayer-setting-danmaku .dplayer-label{display:inline;padding:0 10px}.dplayer-setting-box .dplayer-setting-danmaku .dplayer-label-value{font-size:12.5px;margin-right:18px}.dplayer-setting-box .dplayer-setting-danmaku:hover .dplayer-label,.dplayer-setting-box .dplayer-setting-danmaku:hover .dplayer-label-value{display:none}.dplayer-setting-box .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap{display:inline-block}.dplayer-setting-box .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label,.dplayer-setting-box .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label-value{display:none}.dplayer-setting-box .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap{display:inline-block}.dplayer-setting-box .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap{box-sizing:border-box;display:none;height:100%;padding:0 10px;vertical-align:middle;width:100%}.dplayer-setting-box .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar{background:#fff;height:3px;position:relative;top:8.5px;transition:all .3s ease-in-out;width:100%}.dplayer-setting-box .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner{bottom:0;height:100%;left:0;position:absolute;transition:all .05s ease;will-change:width}.dplayer-setting-box .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb{border-radius:50%;cursor:pointer;height:11px;margin-right:-10px;margin-top:-4px;position:absolute;right:5px;top:0;transition:all .3s ease-in-out;width:11px}.dplayer-comment-setting-box{-webkit-tap-highlight-color:rgba(0,0,0,0);background:#1c1c1ce6;border-radius:7px;bottom:64px;box-sizing:border-box;clip-path:inset(0 0 0 round 7px);font-size:14px;left:20px;max-height:calc(100% - 72px);opacity:0;overflow-y:auto;padding:10px 10px 16px;position:absolute;scrollbar-width:thin;transition:all .25s ease;visibility:hidden;width:255px;z-index:2}.dplayer-comment-setting-box::-webkit-scrollbar{width:6px}.dplayer-comment-setting-box::-webkit-scrollbar-thumb{background:#ffffff26}.dplayer-comment-setting-box.dplayer-comment-setting-open{opacity:1;visibility:visible}.dplayer-comment-setting-box input[type=radio]{display:none}.dplayer-comment-setting-box label{cursor:pointer}.dplayer-comment-setting-box .dplayer-comment-setting-title{color:#fff;font-size:13px;line-height:30px}.dplayer-comment-setting-box .dplayer-comment-setting-size,.dplayer-comment-setting-box .dplayer-comment-setting-type{font-size:0}.dplayer-comment-setting-box .dplayer-comment-setting-size.dplayer-comment-setting-size,.dplayer-comment-setting-box .dplayer-comment-setting-type.dplayer-comment-setting-size{margin-top:8px}.dplayer-comment-setting-box .dplayer-comment-setting-size .dplayer-comment-setting-title,.dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title{margin-bottom:6px}.dplayer-comment-setting-box .dplayer-comment-setting-size label:nth-child(2) span,.dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span{border-radius:4px 0 0 4px}.dplayer-comment-setting-box .dplayer-comment-setting-size label:nth-child(4) span,.dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span{border-radius:0 4px 4px 0}.dplayer-comment-setting-box .dplayer-comment-setting-size span,.dplayer-comment-setting-box .dplayer-comment-setting-type span{border:1px solid #fff;box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-size:12px;line-height:16px;margin-right:-1px;padding:4px 6px;text-align:center;width:33.6%}.dplayer-comment-setting-box .dplayer-comment-setting-size input:checked+span,.dplayer-comment-setting-box .dplayer-comment-setting-type input:checked+span{background:#e4e4e6;color:#1c1c1c}.dplayer-comment-setting-box .dplayer-comment-setting-color{font-size:0}.dplayer-comment-setting-box .dplayer-comment-setting-color .dplayer-comment-setting-color-list{display:flex;justify-content:space-between;padding:4px 0}.dplayer-comment-setting-box .dplayer-comment-setting-color .dplayer-comment-setting-color-list label{display:inline-block;font-size:0;padding:6px 0}.dplayer-comment-setting-box .dplayer-comment-setting-color .dplayer-comment-setting-color-list span{border-radius:50%;box-sizing:border-box;cursor:pointer;display:inline-block;height:22px;width:22px}.dplayer-comment-setting-box .dplayer-comment-setting-color .dplayer-comment-setting-color-list span:hover{animation:my-face 5s ease-in-out infinite}.dplayer-danmaku{aspect-ratio:16/9;bottom:0;color:#fff;font-family:inherit;font-size:29px;left:0;margin:auto;max-height:100%;max-width:100%;overflow:hidden;position:absolute;right:0;top:0}.dplayer-danmaku .dplayer-danmaku-item{cursor:default;display:inline-block;font-size:var(--dplayer-danmaku-font-size);font-weight:700;opacity:var(--dplayer-danmaku-opacity);pointer-events:none;text-shadow:1.2px 1.2px 4px #000000e6;user-select:none;-webkit-user-select:none;white-space:nowrap}.dplayer-danmaku .dplayer-danmaku-item--demo{position:absolute;visibility:hidden}.dplayer-danmaku .dplayer-danmaku-item span{box-decoration-break:clone;-webkit-box-decoration-break:clone}.dplayer-danmaku .dplayer-danmaku-item.dplayer-danmaku-size-big{font-size:calc(var(--dplayer-danmaku-font-size)*1.25)}.dplayer-danmaku .dplayer-danmaku-item.dplayer-danmaku-size-small{font-size:calc(var(--dplayer-danmaku-font-size)*.8)}.dplayer-danmaku .dplayer-danmaku-right{position:absolute;right:0;transform:translateX(100%)}.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move{animation-name:danmaku;animation-play-state:paused;animation-timing-function:linear}@keyframes danmaku{0%{transform:translateX(100%)}}.dplayer-danmaku .dplayer-danmaku-bottom,.dplayer-danmaku .dplayer-danmaku-top{left:50%;position:absolute;transform:translateX(-50%);visibility:hidden}.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move,.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move{animation-name:danmaku-center;animation-play-state:paused;animation-timing-function:linear}@keyframes danmaku-center{0%{visibility:visible}to{visibility:visible}}.dplayer-logo{left:20px;max-height:50px;max-width:50px;pointer-events:none;position:absolute;top:20px}.dplayer-logo img{background:none;max-height:100%;max-width:100%}.dplayer-menu{background:#1c1c1cd9;border-radius:2px;display:none;overflow:hidden;padding:5px 0;position:absolute;width:170px;z-index:3}.dplayer-menu.dplayer-menu-show{display:block}.dplayer-menu .dplayer-menu-item{box-sizing:border-box;cursor:pointer;height:30px}.dplayer-menu .dplayer-menu-item:hover{background-color:#ffffff1a}.dplayer-menu .dplayer-menu-item a{box-sizing:border-box;color:#eee;display:inline-block;font-size:13px;line-height:30px;overflow:hidden;padding:0 10px;text-overflow:ellipsis;vertical-align:middle;white-space:nowrap;width:100%}.dplayer-menu .dplayer-menu-item a:hover{text-decoration:none}.dplayer-notice{background:#1c1c1ce6;border-radius:4px;bottom:68px;color:#fff;font-size:14px;left:20px;line-height:1.6;margin-right:20px;opacity:0;overflow:hidden;padding:12px 18px;pointer-events:none;position:absolute;transition:all .3s ease-in-out,color 0s}@media(max-width:500px){.dplayer-notice{bottom:auto!important;top:10px}}.dplayer-subtitle{bottom:40px;color:#fff;font-size:20px;left:5%;position:absolute;text-align:center;text-shadow:.5px .5px .5px #00000080;width:90%}.dplayer-subtitle.dplayer-subtitle-hide{display:none}.dplayer-mask{bottom:0;display:none;left:0;position:absolute;right:0;top:0;z-index:1}.dplayer-mask.dplayer-mask-show{display:block}.dplayer-video-wrap{align-items:center;background:#000;display:flex;font-size:0;height:100%;justify-content:center;position:relative;width:100%}.dplayer-video-wrap .dplayer-video-wrap-aspect{aspect-ratio:16/9;max-height:100%;max-width:100%;overflow:hidden;position:relative}.dplayer-video-wrap .dplayer-video-wrap-aspect .dplayer-video{display:none;max-height:100%;max-width:100%;width:99999px}.dplayer-video-wrap .dplayer-video-wrap-aspect .dplayer-video-current{display:block}.dplayer-video-wrap .dplayer-video-wrap-aspect .dplayer-video-prepare{display:none}.dplayer-info-panel{background:#1c1c1ccc;border-radius:2px;color:#fff;font-size:12px;left:10px;padding:10px;position:absolute;top:10px;width:450px}.dplayer-info-panel-hide{display:none}.dplayer-info-panel .dplayer-info-panel-close{cursor:pointer;position:absolute;right:10px;top:10px}.dplayer-info-panel .dplayer-info-panel-item>span{display:inline-block;line-height:15px;overflow:hidden;text-overflow:ellipsis;vertical-align:middle;white-space:nowrap}.dplayer-info-panel .dplayer-info-panel-item-title{margin-right:10px;text-align:right;width:100px}.dplayer-info-panel .dplayer-info-panel-item-data{width:320px}',"",{version:3,sources:["webpack://./src/css/balloon.scss","webpack://./src/css/global.scss","webpack://./src/css/player.scss","webpack://./src/css/bezel.scss","webpack://./src/css/controller.scss","webpack://./src/css/danmaku.scss","webpack://./src/css/logo.scss","webpack://./src/css/menu.scss","webpack://./src/css/notice.scss","webpack://./src/css/subtitle.scss","webpack://./src/css/video.scss","webpack://./src/css/info-panel.scss"],names:[],mappings:"AAAQ,mBCCJ,GACI,0CAAA,CAEJ,GACI,2CAAA,CAEJ,GACI,2CAAA,CAEJ,GACI,4CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,wCAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,wCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,4CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,yCAAA,CAEJ,IACI,0CAAA,CAEJ,IACI,2CAAA,CAEJ,MAEI,mCAAA,CAAA,CCtJR,SAKI,aAAA,CAHA,eAAA,CADA,iBAAA,CAEA,gBAAA,CACA,wBACA,CAEA,WACI,kBAAA,CAGJ,aAEI,WAAA,CADA,UACA,CAEA,sCAEI,SAAA,CAIR,wDAGI,eAAA,CADA,qBAAA,CAIA,MAAA,CAEA,QAAA,CACA,SAAA,CALA,cAAA,CAGA,KAAA,CAGA,sBAAA,CATA,oBAAA,CAIA,cAKA,CAiCA,0fACI,YAAA,CAEJ,sCACI,WAAA,CAKJ,yFACI,YAAA,CAEJ,8EACI,WAAA,CACA,iBAAA,CAEJ,uGACI,YAAA,CAGJ,8FACI,WAAA,CACA,4BAAA,CAGA,4HACI,WAAA,CACA,4BAAA,CAMR,yCACI,cAAA,CAEJ,sCACI,aAAA,CAKJ,gEACI,4BAAA,CAMJ,+FACI,SAAA,CAOA,2GACI,SAAA,CAMR,8DACI,aAAA,CAMJ,gLAEI,2BAAA,CAQJ,+GACI,SAAA,CAIR,wBAMI,qBAAA,CAHA,MAAA,CAFA,wBAAA,CAGA,KAAA,CACA,oBAAA,CAHA,cAIA,CAEA,gDACI,WAAA,CAIA,6IACI,mBAAA,CAMR,wDACI,WAAA,CAIA,6JACI,mBAAA,CAMR,4CACI,WAAA,CACA,2DAEI,kBAAA,CADA,eACA,CACA,0OAGI,YAAA,CAMJ,0LAEI,oBAAA,CADA,eACA,CAKZ,iDACI,+CAAA,CACA,WAAA,CAOA,6HACI,SAAA,CAKJ,yEACI,SAAA,CAEJ,oEACI,SAAA,CACA,0BAAA,CAIR,0CACI,WAAA,CACA,4DACI,YAAA,CAIR,kGACI,WAAA,CACA,4BAAA,CAIA,0EAEI,SAAA,CADA,iBACA,CAIR,kDAEI,UAAA,CADA,kBACA,CAMZ,4BAGI,MAAA,CACA,QAAA,CACA,SAAA,CAJA,cAAA,CACA,KAGA,CFjQJ,sBACI,0BAAA,CAGJ,6BACI,YAAA,CAGJ,4BAEI,8BAAA,CACA,6BAAA,CAFA,2BAEA,CAGJ,iDACI,yBAAA,CGjBJ,eAKI,QAAA,CAEA,UAAA,CADA,cAAA,CAJA,MAAA,CAMA,mBAAA,CAPA,iBAAA,CAEA,OAAA,CACA,KAIA,CACA,mCASI,oBAAA,CACA,iBAAA,CAFA,qBAAA,CAHA,WAAA,CAFA,QAAA,CACA,sBAAA,CAOA,SAAA,CAJA,YAAA,CAKA,mBAAA,CAXA,iBAAA,CACA,OAAA,CAIA,UAAA,CAOA,qBAAA,CACA,4DACI,+BAAA,CAEJ,sBACI,GACI,SAAA,CACA,kBAAA,CAEJ,GACI,SAAA,CACA,kBAAA,CAAA,CAIZ,mCAQI,yCAAA,CAFA,cAAA,CACA,gBAAA,CAJA,eAAA,CAFA,iBAAA,CAIA,iBAAA,CAHA,OAAA,CAEA,UAIA,CAEJ,qCACI,YAAA,CAKA,WAAA,CAFA,QAAA,CACA,sBAAA,CAGA,mBAAA,CANA,iBAAA,CACA,OAAA,CAIA,UACA,CACA,2DACI,YAAA,CAEJ,0DACI,oDAAA,CACA,SAAA,CACA,wBAAA,CACA,qBAAA,CAEI,gFACI,mBAAA,CADJ,gFACI,mBAAA,CADJ,gFACI,mBAAA,CADJ,gFACI,mBAAA,CADJ,gFACI,mBAAA,CADJ,gFACI,mBAAA,CADJ,gFACI,mBAAA,CAIZ,oCACI,GACI,UAAA,CACA,oBAAA,CAEJ,IACI,WAAA,CACA,mBAAA,CAEJ,GACI,WAAA,CACA,oBAAA,CAAA,CChFhB,yBAKI,+CAAA,CAFA,WAAA,CADA,UAIA,CAGJ,6CALI,QAAA,CAHA,iBAAA,CAKA,uBAYA,CATJ,oBAKI,WAAA,CAFA,MAAA,CAGA,cAAA,CAFA,OAAA,CAGA,gBAAA,CACA,wBACA,CAEI,8DACI,YAAA,CAEJ,kFACI,aAAA,CAGR,sCAII,WAAA,CAEA,cAAA,CAHA,UAAA,CAEA,aAAA,CAJA,iBAAA,CACA,uBAIA,CAEI,wFACI,kBAAA,CAEJ,+DACI,aAAA,CAIA,UAAA,CADA,OAAA,CADA,0BAAA,CADA,SAGA,CAGR,yDAOI,qBAAA,CADA,iBAAA,CADA,UAAA,CAHA,iBAAA,CAMA,iBAAA,CALA,OAAA,CAMA,0BAAA,CACA,8BAAA,CANA,SAAA,CAHA,UASA,CAEI,uFACI,aAAA,CAKJ,qKACI,SAAA,CAGR,iFAMI,0BAAA,CAEA,iBAAA,CADA,UAAA,CANA,YAAA,CAQA,cAAA,CANA,QAAA,CAEA,eAAA,CAHA,iBAAA,CAEA,SAAA,CAOA,0BAAA,CADA,kBACA,CAGR,2DAII,eAAA,CAEA,4BAAA,CAHA,iBAAA,CAFA,YAAA,CAIA,mBAAA,CAHA,iBAIA,CAEJ,kEAGI,WAAA,CAEA,mBAAA,CAJA,iBAAA,CACA,UAAA,CAEA,SACA,CAEJ,wDAeI,gBAAA,CANA,0BAAA,CAFA,iBAAA,CAGA,UAAA,CACA,cAAA,CANA,MAAA,CAQA,SAAA,CALA,eAAA,CAUA,mBAAA,CAdA,iBAAA,CAQA,iBAAA,CANA,SAAA,CAQA,kCAAA,CAEA,iBAAA,CACA,SACA,CAjBA,+DACI,SAAA,CAkBR,mDAII,gBAAA,CACA,cAAA,CAHA,UAAA,CADA,iBAAA,CAEA,UAEA,CACA,mEAKI,eAAA,CAEA,uBACA,CAEJ,sIANI,QAAA,CAEA,UAAA,CAJA,MAAA,CADA,iBAAA,CAEA,KAAA,CAKA,iBAQA,CACA,kFAQI,iBAAA,CACA,cAAA,CAHA,WAAA,CADA,kBAAA,CADA,eAAA,CAHA,iBAAA,CAEA,SAAA,CADA,KAAA,CASA,kBAAA,CADA,8BAAA,CAHA,UAIA,CAKhB,mCAMI,yCAAA,CADA,QAAA,CAHA,WAAA,CAEA,kBAAA,CADA,eAAA,CAFA,iBAKA,CACA,uDAMI,QAAA,CAGA,UAAA,CARA,YAAA,CAIA,WAAA,CAEA,SAAA,CALA,iBAAA,CAMA,UAAA,CALA,8BAAA,CACA,SAKA,CACA,qEACI,WAAA,CAEJ,qFAEI,MAAA,CADA,iBAAA,CAEA,KAAA,CAEJ,0EACI,iBAAA,CACA,OAAA,CACA,KAAA,CACA,4FACI,QAAA,CAGR,8EASI,eAAA,CAPA,WAAA,CAMA,iBAAA,CAIA,qBAAA,CAEA,UAAA,CATA,mBAAA,CADA,cAAA,CAOA,WAAA,CALA,gBAAA,CAIA,QAAA,CATA,YAAA,CAEA,aAAA,CAIA,iBAAA,CAMA,UACA,CACA,2FACI,UAAA,CACA,UAAA,CAEJ,gGACI,QAAA,CAEJ,yFACI,YAAA,CAGR,wBACI,oFACI,qBAAA,CACA,mHACI,cAAA,CACA,gBAAA,CAGR,8EACI,cAAA,CAAA,CAKR,oEACI,WAAA,CAEJ,wBACI,oEACI,eAAA,CAAA,CAGR,wBACI,oEACI,eAAA,CAAA,CAIZ,uDACI,UAAA,CACA,qEACI,WAAA,CACA,wBACI,qEAEI,WAAA,CADA,UACA,CAAA,CAGR,wBACI,qEAEI,WAAA,CADA,UACA,CAAA,CAKhB,iDAEI,UAAA,CAIA,mBAAA,CADA,cAAA,CAJA,gBAAA,CAEA,6BAAA,CACA,qBAEA,CACA,wBACI,iDACI,cAAA,CAAA,CAIZ,uDAUI,kBAAA,CARA,UAAA,CAIA,cAAA,CAGA,mBAAA,CAFA,mBAAA,CAFA,cAAA,CAGA,WAAA,CAPA,gBAAA,CAEA,6BAAA,CACA,qBAMA,CAEJ,qDAOI,iBAAA,CADA,UAAA,CALA,oBAAA,CAEA,UAAA,CAEA,gBAAA,CADA,iBAAA,CAFA,SAKA,CAEJ,iDAII,sBAAA,CADA,WAAA,CAMA,qBAAA,CAFA,cAAA,CAGA,oBAAA,CARA,WAAA,CAGA,gBAAA,CACA,YAAA,CAEA,qBAAA,CAPA,UASA,CACA,uEAEI,UAAA,CADA,8BACA,CAGA,6EACI,SAAA,CAGR,mEACI,QAAA,CAEJ,sEACI,wBAAA,CACA,wBACI,sEACI,mBAAA,CAAA,CAGR,wBACI,sEACI,uBAAA,CAAA,CAIZ,qEACI,UAAA,CAEJ,qFACI,OAAA,CAEJ,wBACI,iDACI,UAAA,CAAA,CAIZ,mDAGI,cAAA,CADA,oBAAA,CAEA,WAAA,CAHA,iBAGA,CAEI,sGACI,UAAA,CAEJ,+IACI,kBAAA,CAIJ,sHACI,UAAA,CAEJ,+JACI,kBAAA,CAGR,4EACI,oBAAA,CAGA,WAAA,CAFA,oBAAA,CACA,qBACA,CACA,gGAKI,eAAA,CADA,UAAA,CAHA,iBAAA,CACA,QAAA,CAIA,8BAAA,CAHA,OAGA,CACA,0HAEI,QAAA,CAEA,WAAA,CADA,MAAA,CAFA,iBAAA,CAIA,uBAAA,CACA,iBAAA,CACA,yIAQI,iBAAA,CACA,cAAA,CAHA,WAAA,CADA,kBAAA,CADA,eAAA,CAHA,iBAAA,CAEA,SAAA,CADA,KAAA,CASA,kBAAA,CADA,8BAAA,CAHA,UAIA,CAUpB,6GACI,oBAAA,CACA,WAAA,CAEJ,iDACI,oBAAA,CACA,WAAA,CACA,iBAAA,CAEJ,oDACI,oBAAA,CACA,WAAA,CAKZ,0BAEI,kBAAA,CADA,YAAA,CAOA,WAAA,CALA,4BAAA,CAGA,QAAA,CAKA,SAAA,CAEA,mBAAA,CATA,iBAAA,CACA,OAAA,CAIA,8BAAA,CACA,wBAAA,CAEA,iBAAA,CALA,UAMA,CAEA,+CAKI,yCAAA,CADA,sBAAA,CADA,WAAA,CAIA,qBAAA,CACA,cAAA,CAFA,0CAAA,CAJA,WAAA,CAOA,YAAA,CACA,mBAAA,CATA,UASA,CAEA,+GACI,YAAA,CAKZ,qBAgBI,yCAAA,CARA,oBAAA,CADA,iBAAA,CAHA,WAAA,CAMA,qBAAA,CATA,YAAA,CAKA,wBAAA,CAQA,SAAA,CAHA,iBAAA,CACA,iBAAA,CAVA,iBAAA,CACA,UAAA,CAMA,wBAAA,CAIA,iBAAA,CARA,WAAA,CAUA,SACA,CACA,yBACI,iBAAA,CACA,sDACI,aAAA,CAGR,8CAEI,SAAA,CADA,kBACA,CAEJ,iDACI,uFAAA,CACA,+EACI,2BAAA,CAEJ,gFACI,aAAA,CACA,uBAAA,CAGR,+CACI,2DAAA,CACA,6EACI,2BAAA,CAEJ,4EACI,aAAA,CACA,uBAAA,CAGR,+CACI,2DAAA,CACA,6EACI,2BAAA,CAEJ,4EACI,aAAA,CACA,uBAAA,CAGR,oCAEI,UAAA,CADA,oBAAA,CAEA,cAAA,CACA,qBAAA,CACA,kBAAA,CAEJ,0CAII,aAAA,CAHA,oBAAA,CAIA,cAAA,CAHA,gBAAA,CACA,iBAAA,CAGA,qBAAA,CACA,kBAAA,CAEJ,qCAOI,WAAA,CAFA,WAAA,CAJA,iBAAA,CAEA,SAAA,CAGA,iBAAA,CAJA,OAAA,CAMA,qBAAA,CAJA,UAIA,CACA,2CAGI,YAAA,CAFA,YAAA,CACA,WACA,CAEJ,iDAUI,wBAAA,CAJA,kBAAA,CAGA,gCAAA,CAFA,qBAAA,CAIA,cAAA,CAVA,oBAAA,CAIA,WAAA,CAHA,iBAAA,CACA,UAAA,CAKA,oBAAA,CAJA,UAOA,CAEJ,wDAQI,kBAAA,CAPA,UAAA,CAEA,aAAA,CACA,WAAA,CAGA,UAAA,CALA,iBAAA,CAIA,SAAA,CAGA,oBAAA,CAJA,UAIA,CAEJ,uDASI,eAAA,CADA,kBAAA,CAGA,0BAAA,CAVA,UAAA,CACA,aAAA,CAEA,aAAA,CAGA,MAAA,CAJA,iBAAA,CAGA,SAAA,CAIA,oBAAA,CALA,YAMA,CAEJ,yDACI,+BAAA,CAEJ,gEAEI,6BAAA,CADA,UACA,CAEJ,+DACI,SAAA,CAGR,2MAKI,QAAA,CAKA,qBAAA,CAHA,eAAA,CAKA,eAAA,CAJA,aAAA,CAJA,iBAAA,CAOA,oBAAA,CAFA,8BAAA,CAHA,UAMA,CACA,uRACI,SAAA,CAEJ,+SACI,oBAAA,CAGR,mDACI,uBAAA,CAEJ,wJAGI,0BAAA,CACA,gOAEI,kBAAA,CAKA,iCAAA,CACA,qBAAA,CACA,cAAA,CARA,YAAA,CAEA,WAAA,CAGA,iBAAA,CADA,kBAAA,CADA,gBAKA,CAEJ,0sBAGI,WAAA,CACA,01BACI,iBAAA,CAEJ,00GAGI,kBAAA,CAGR,wMACI,oBAAA,CAGA,gBAAA,CAFA,eAAA,CACA,UACA,CAGR,gMAKI,kBAAA,CAGA,qBAAA,CACA,cAAA,CALA,YAAA,CAEA,WAAA,CACA,gBAAA,CAGA,iBAAA,CACA,wNACI,0BAAA,CAGR,8CACI,aAAA,CACA,6DAEI,cAAA,CADA,cACA,CAEJ,mEAEI,gBAAA,CADA,iBACA,CAGA,4IACI,YAAA,CAEJ,8EACI,oBAAA,CAIJ,8LACI,YAAA,CAEJ,uGACI,oBAAA,CAGR,wEAEI,qBAAA,CACA,YAAA,CAEA,WAAA,CAJA,cAAA,CAGA,qBAAA,CAEA,UAAA,CACA,6FAKI,eAAA,CADA,UAAA,CAHA,iBAAA,CACA,SAAA,CAIA,8BAAA,CAHA,UAGA,CACA,wHAEI,QAAA,CAEA,WAAA,CADA,MAAA,CAFA,iBAAA,CAIA,wBAAA,CACA,iBAAA,CACA,uIAQI,iBAAA,CACA,cAAA,CAHA,WAAA,CADA,kBAAA,CADA,eAAA,CAHA,iBAAA,CAEA,SAAA,CADA,KAAA,CAQA,8BAAA,CAHA,UAGA,CAQxB,6BAkBI,yCAAA,CAVA,oBAAA,CADA,iBAAA,CAJA,WAAA,CAYA,qBAAA,CATA,gCAAA,CAIA,cAAA,CARA,SAAA,CAGA,4BAAA,CASA,SAAA,CAEA,eAAA,CAPA,sBAAA,CARA,iBAAA,CAWA,oBAAA,CADA,wBAAA,CAEA,iBAAA,CATA,WAAA,CAaA,SACA,CACA,gDACI,SAAA,CAEJ,sDACI,oBAAA,CAEJ,0DAEI,SAAA,CADA,kBACA,CAEJ,+CACI,YAAA,CAEJ,mCACI,cAAA,CAEJ,4DAEI,UAAA,CADA,cAAA,CAEA,gBAAA,CAEJ,sHACI,WAAA,CACA,gLACI,cAAA,CAEJ,oLACI,iBAAA,CAII,sKACI,yBAAA,CAIJ,sKACI,yBAAA,CAIZ,gIAOI,qBAAA,CAEA,qBAAA,CAHA,UAAA,CAKA,cAAA,CAPA,oBAAA,CACA,cAAA,CAFA,gBAAA,CAKA,iBAAA,CANA,eAAA,CAQA,iBAAA,CATA,WAUA,CAEJ,4JACI,kBAAA,CACA,aAAA,CAGR,4DACI,WAAA,CACA,gGACI,YAAA,CACA,6BAAA,CACA,aAAA,CACA,sGACI,oBAAA,CACA,WAAA,CACA,aAAA,CAEJ,qGAII,iBAAA,CACA,qBAAA,CACA,cAAA,CALA,oBAAA,CAEA,WAAA,CADA,UAIA,CACA,2GACI,yCAAA,CCxzBpB,iBAQI,iBAAA,CAHA,QAAA,CAOA,UAAA,CADA,mBAAA,CADA,cAAA,CAPA,MAAA,CAMA,WAAA,CAFA,eAAA,CADA,cAAA,CAOA,eAAA,CAZA,iBAAA,CAGA,OAAA,CAFA,KAWA,CACA,uCAOI,cAAA,CANA,oBAAA,CAEA,0CAAA,CADA,eAAA,CAEA,sCAAA,CAMA,mBAAA,CAJA,qCAAA,CAEA,gBAAA,CACA,wBAAA,CAJA,kBAKA,CACA,6CACI,iBAAA,CACA,iBAAA,CAEJ,4CACI,0BAAA,CACA,kCAAA,CAEJ,gEACI,qDAAA,CAEJ,kEACI,mDAAA,CAGR,wCACI,iBAAA,CACA,OAAA,CACA,0BAAA,CACA,6DACI,sBAAA,CAEA,2BAAA,CADA,gCACA,CAGR,mBACI,GACI,0BAAA,CAAA,CAGR,+EAGI,QAAA,CADA,iBAAA,CAEA,0BAAA,CACA,iBAAA,CACA,yHACI,6BAAA,CAEA,2BAAA,CADA,gCACA,CAGR,0BACI,GACI,kBAAA,CAEJ,GACI,kBAAA,CAAA,CCxEZ,cAGI,SAAA,CAGA,eAAA,CADA,cAAA,CAJA,mBAAA,CACA,iBAAA,CAEA,QAEA,CACA,kBAGI,eAAA,CADA,eAAA,CADA,cAEA,CCVR,cAII,oBAAA,CADA,iBAAA,CAKA,YAAA,CAFA,eAAA,CADA,aAAA,CAJA,iBAAA,CACA,WAAA,CAKA,SACA,CACA,gCACI,aAAA,CAEJ,iCAEI,qBAAA,CACA,cAAA,CAFA,WAEA,CACA,uCACI,0BAAA,CAEJ,mCASI,qBAAA,CALA,UAAA,CAEA,oBAAA,CADA,cAAA,CAFA,gBAAA,CASA,eAAA,CAVA,cAAA,CASA,sBAAA,CAJA,qBAAA,CAGA,kBAAA,CAFA,UAIA,CACA,yCACI,oBAAA,CCjChB,gBAOI,oBAAA,CADA,iBAAA,CAJA,WAAA,CAMA,UAAA,CACA,cAAA,CANA,SAAA,CAOA,eAAA,CALA,iBAAA,CAOA,SAAA,CACA,eAAA,CATA,iBAAA,CAUA,mBAAA,CAbA,iBAAA,CAUA,uCAGA,CAEJ,wBACI,gBAEI,qBAAA,CADA,QACA,CAAA,CCnBR,kBAEI,WAAA,CAIA,UAAA,CAEA,cAAA,CAJA,OAAA,CAHA,iBAAA,CAIA,iBAAA,CAEA,oCAAA,CAJA,SAKA,CACA,wCACI,YAAA,CCVR,cAGI,QAAA,CAIA,YAAA,CAHA,MAAA,CAHA,iBAAA,CAIA,OAAA,CAHA,KAAA,CAIA,SACA,CACA,gCACI,aAAA,CAIR,oBAGI,kBAAA,CAEA,eAAA,CAJA,YAAA,CAKA,WAAA,CAEA,WAAA,CAJA,sBAAA,CAFA,iBAAA,CAKA,UACA,CAEA,+CAII,iBAAA,CADA,eAAA,CADA,cAAA,CAGA,eAAA,CAJA,iBAIA,CAEA,8DAII,YAAA,CADA,eAAA,CADA,cAAA,CADA,aAGA,CAEJ,sEACI,aAAA,CAEJ,sEACI,YAAA,CCxCZ,oBAKI,oBAAA,CAIA,iBAAA,CAFA,UAAA,CACA,cAAA,CALA,SAAA,CAGA,YAAA,CALA,iBAAA,CACA,QAAA,CAEA,WAKA,CAEA,yBACI,YAAA,CAGJ,8CACI,cAAA,CACA,iBAAA,CACA,UAAA,CACA,QAAA,CAIA,kDACI,oBAAA,CAEA,gBAAA,CAGA,eAAA,CADA,sBAAA,CAHA,qBAAA,CAEA,kBAEA,CAIR,mDAGI,iBAAA,CADA,gBAAA,CADA,WAEA,CAGJ,kDACI,WAAA",sourcesContent:[`@import '../../node_modules/balloon-css/balloon.css';

.dplayer [aria-label] {
    --balloon-font-size: 11.5px;
}

.dplayer [aria-label]:before {
    display: none;
}

.dplayer [aria-label]:after {
    padding: .3em .8em !important;
    background: rgba(17, 17, 17, 0.7) !important;
    font-family: inherit !important;
}

.dplayer [aria-label][data-balloon-pos="up"]:after {
    margin-bottom: 0 !important;
}
`,`@keyframes my-face {
    2% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    4% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    6% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    8% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    10% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    12% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    14% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    16% {
        transform: translate(0, -0.5px) rotate(-1.5deg);
    }
    18% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    20% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    22% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    24% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    26% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    28% {
        transform: translate(0, 0.5px) rotate(1.5deg);
    }
    30% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    32% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    34% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    36% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    38% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    40% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    42% {
        transform: translate(0, 2.5px) rotate(-1.5deg);
    }
    44% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    46% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    48% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    50% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    52% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    54% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    56% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    58% {
        transform: translate(0, 0.5px) rotate(2.5deg);
    }
    60% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    62% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    64% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    66% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    68% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    70% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    72% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    74% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    76% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    78% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    80% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    82% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    84% {
        transform: translate(0, 1.5px) rotate(2.5deg);
    }
    86% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    88% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    90% {
        transform: translate(0, 2.5px) rotate(-0.5deg);
    }
    92% {
        transform: translate(0, 0.5px) rotate(-0.5deg);
    }
    94% {
        transform: translate(0, 2.5px) rotate(0.5deg);
    }
    96% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    98% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}
`,`.dplayer {
    position: relative;
    overflow: hidden;
    user-select: none;
    -webkit-user-select: none;
    line-height: 1;

    * {
        box-sizing: content-box;
    }

    svg {
        width: 100%;
        height: 100%;

        path,
        circle {
            fill: #fff;
        }
    }

    &.dplayer-fulled, &.dplayer-fulled-browser {
        width: 100% !important;
        height: 100% !important;
        background: #000;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        margin: 0;
        padding: 0;
        transform: translate(0, 0);
    }

    &.dplayer-no-danmaku {
        .dplayer-setting-box {
            .dplayer-setting-showdan,
            .dplayer-setting-danmaku,
            .dplayer-setting-danunlimit {
                display: none;
            }
        }

        .dplayer-controller .dplayer-icons .dplayer-comment {
            display: none;
        }

        .dplayer-danmaku {
            display: none;
        }
    }

    &.dplayer-no-audio-switching {
        .dplayer-setting-box {
            .dplayer-setting-audio {
                display: none;
            }
        }
    }

    &.dplayer-live {
        .dplayer-time {
            display: none;
        }
        .dplayer-bar-wrap {
            display: none;
        }
        .dplayer-notice {
            bottom: 56px;
        }
        .dplayer-setting-speed {
            display: none;
        }
        .dplayer-setting-loop {
            display: none;
        }
        .dplayer-controller .dplayer-icons .dplayer-setting-box {
            height: auto;
            overflow-y: hidden;
        }
        .dplayer-mobile-icon-backward, .dplayer-mobile-icon-forward {
            display: none;
        }

        .dplayer-setting-box, .dplayer-comment-setting-box {
            bottom: 58px;
            max-height: calc(100% - 58px - 8px);
        }
        &.dplayer-mobile {
            .dplayer-setting-box, .dplayer-comment-setting-box {
                bottom: 52px;
                max-height: calc(100% - 52px - 8px);
            }
        }
    }

    &.dplayer-narrow {
        .dplayer-danmaku {
            font-size: 18px;
        }
        .dplayer-icon {
            margin: 0 -3px;
        }
    }

    &.dplayer-playing {
        .dplayer-danmaku .dplayer-danmaku-move {
            animation-play-state: running;
        }

        .dplayer-controller-mask {
            opacity: 0;
        }
        .dplayer-controller {
            opacity: 0;
        }

        &:hover {
            .dplayer-controller-mask {
                opacity: 1;
            }
            .dplayer-controller {
                opacity: 1;
            }
        }
    }

    &.dplayer-loading {
        .dplayer-bezel .dplayer-loading-icon {
            display: block;
        }
    }

    &.dplayer-loading,
    &.dplayer-paused {
        .dplayer-danmaku,
        .dplayer-danmaku-move {
            animation-play-state: paused;
        }
    }

    &.dplayer-show-controller {
        .dplayer-controller-mask {
            opacity: 1;
        }
        .dplayer-controller {
            opacity: 1;
        }
    }

    &.dplayer-fulled {
        position: fixed !important;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100% !important;
        height: 100% !important;

        &.dplayer-hide-controller {
            cursor: none;
            .dplayer-controller-mask {
                opacity: 0 !important;
            }
            .dplayer-controller {
                opacity: 0 !important;
            }
        }
    }

    &.dplayer-fulled-browser {
        &.dplayer-hide-controller {
            cursor: none;
            .dplayer-controller-mask {
                opacity: 0 !important;
            }
            .dplayer-controller {
                opacity: 0 !important;
            }
        }
    }

    &.dplayer-mobile {
        .dplayer-controller {
            height: 44px;
            .dplayer-icons {
                padding-top: 3px;
                padding-bottom: 3px;
                .dplayer-volume,
                .dplayer-airplay-icon,
                .dplayer-play-icon {
                    display: none;
                }
                .dplayer-full .dplayer-full-in-icon {
                    position: static;
                    display: inline-block;
                }
                .dplayer-full .dplayer-pip-icon {
                    position: static;
                    display: inline-block;
                }
            }
        }

        .dplayer-controller-mask {
            background: linear-gradient(rgba(0, 0, 0, 0.55) 78%, rgba(0, 0, 0, 0.8) 100%);
            height: 100%;
        }

        &.dplayer-playing {
            .dplayer-controller-mask {
                opacity: 1;
            }
            .dplayer-controller {
                opacity: 1;
            }
        }

        &.dplayer-hide-controller {
            .dplayer-controller-mask {
                opacity: 0;
            }
            .dplayer-controller {
                opacity: 0;
                transform: translateY(100%);
            }
        }

        .dplayer-bar-wrap {
            bottom: 40px;
            .dplayer-bar-time {
                display: none;
            }
        }

        .dplayer-setting-box, .dplayer-comment-setting-box {
            bottom: 58px;
            max-height: calc(100% - 58px - 8px);
        }

        &.dplayer-hide-controller {
            .dplayer-mobile-icon-wrap {
                visibility: hidden;
                opacity: 0;
            }
        }

        .dplayer-mobile-icon-wrap {
            visibility: visible;
            opacity: 0.7;
        }
    }
}

// To hide scroll bar, apply this class to <body>
.dplayer-web-fullscreen-fix {
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
}
`,`.dplayer-bezel {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    pointer-events: none;
    .dplayer-bezel-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -26px 0 0 -26px;
        height: 52px;
        width: 52px;
        padding: 12px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, .5);
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
        will-change: transform;
        &.dplayer-bezel-transition {
            animation: bezel-hide .5s linear;
        }
        @keyframes bezel-hide {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
    }
    .dplayer-danloading {
        position: absolute;
        top: 50%;
        margin-top: -7px;
        width: 100%;
        text-align: center;
        font-size: 14px;
        line-height: 14px;
        animation: my-face 5s infinite ease-in-out;
    }
    .dplayer-loading-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -18px 0 0 -18px;
        height: 36px;
        width: 36px;
        pointer-events: none;
        .dplayer-loading-hide {
            display: none;
        }
        .dplayer-loading-dot {
            animation: dplayer-loading-dot-fade .8s ease infinite;
            opacity: 0;
            transform-origin: 4px 4px;
            will-change: transform;
            @for $i from 7 through 1 {
                &.dplayer-loading-dot-#{$i} {
                    animation-delay: .1s * $i;
                }
            }
        }
        @keyframes dplayer-loading-dot-fade {
            0% {
                opacity: .7;
                transform: scale(1.2, 1.2);
            }
            50% {
                opacity: .25;
                transform: scale(.9, .9);
            }
            to {
                opacity: .25;
                transform: scale(.85, .85);
            }
        }
    }
}
`,`
.dplayer-controller-mask {
    position: absolute;
    width: 100%;
    height: 98px;
    bottom: 0;
    background: linear-gradient(rgba(0, 0, 0, 0.0) 15%, rgba(0, 0, 0, 0.7) 100%);
    transition: all 0.3s ease;
}

.dplayer-controller {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 50px;
    padding: 0 20px;
    user-select: none;
    -webkit-user-select: none;
    transition: all 0.3s ease;
    &.dplayer-controller-comment {
        .dplayer-icons {
            display: none;
        }
        .dplayer-icons.dplayer-comment-box {
            display: block;
        }
    }
    .dplayer-bar-wrap {
        position: absolute;
        width: calc(100% - 40px);
        height: 3px;
        bottom: 46px;
        padding: 5px 0;
        cursor: pointer;
        &:hover {
            .dplayer-bar .dplayer-played .dplayer-thumb {
                transform: scale(1);
            }
            .dplayer-highlight {
                display: block;
                width: 8px;
                transform: translateX(-4px);
                top: 4px;
                height: 40%;
            }
        }
        .dplayer-highlight {
            z-index: 12;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 20%;
            border-radius: 6px;
            background-color: #fff;
            text-align: center;
            transform: translateX(-3px);
            transition: all .2s ease-in-out;
            &:hover {
                .dplayer-highlight-text {
                    display: block;
                }
                &~.dplayer-bar-preview {
                    opacity: 0;
                }
                &~.dplayer-bar-time {
                    opacity: 0;
                }
            }
            .dplayer-highlight-text {
                display: none;
                position: absolute;
                left: 50%;
                top: -24px;
                padding: 5px 8px;
                background-color: rgba(0, 0, 0, .62);
                color: #fff;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                transform: translateX(-50%);
            }
        }
        .dplayer-bar-preview {
            display: none;
            position: absolute;
            border-radius: 6px;
            background: #fff;
            pointer-events: none;
            background-size: 16000px 100%;
        }
        .dplayer-bar-preview-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        .dplayer-bar-time {
            &.hidden {
                opacity: 0;
            }
            position: absolute;
            left: 0px;
            top: -20px;
            border-radius: 4px;
            padding: 5px 7px;
            background-color: rgba(0, 0, 0, 0.62);
            color: #fff;
            font-size: 12px;
            text-align: center;
            opacity: 1;
            transition: opacity .1s ease-in-out;
            word-wrap: normal;
            word-break: normal;
            z-index: 2;
            pointer-events: none;
        }
        .dplayer-bar {
            position: relative;
            height: 4px;
            width: 100%;
            background: rgba(255, 255, 255, .2);
            cursor: pointer;
            .dplayer-loaded {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                background: #fff;
                height: 4px;
                transition: all 0.5s ease;
                will-change: width;
            }
            .dplayer-played {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                height: 4px;
                will-change: width;
                .dplayer-thumb {
                    position: absolute;
                    top: 0;
                    right: 5px;
                    margin-top: -4px;
                    margin-right: -10px;
                    height: 11px;
                    width: 11px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: all .3s ease-in-out;
                    transform: scale(0);
                }
            }
        }
    }
    .dplayer-icons {
        position: absolute;
        height: 38px;
        padding-top: 6px;
        padding-bottom: 6px;
        bottom: 0;
        -webkit-tap-highlight-color: transparent;
        &.dplayer-comment-box {
            display: none;
            position: absolute;
            transition: all .3s ease-in-out;
            z-index: 2;
            height: 38px;
            bottom: 0;
            left: 20px;
            right: 20px;
            color: #fff;
            .dplayer-icon {
                padding: 7px;
            }
            .dplayer-comment-setting-icon {
                position: absolute;
                left: 0;
                top: 0;
            }
            .dplayer-send-icon {
                position: absolute;
                right: 0;
                top: 0;
                &[aria-label]:after {
                    left: 14%;
                }
            }
            .dplayer-comment-input {
                outline: none;
                border: none;
                padding: 8px 0px;
                font-size: 14px;
                font-family: inherit;
                line-height: 18px;
                text-align: center;
                border-radius: 4px;
                background: none;
                margin: 0;
                height: 100%;
                box-sizing: border-box;
                width: 100%;
                color: #fff;
                &::placeholder {
                    color: #fff;
                    opacity: 0.8;
                }
                &::-moz-focus-inner {
                    border: 0;
                }
                &::-ms-clear {
                    display: none;
                }
            }
            @media (max-width: 350px){
                .dplayer-comment-setting-box {
                    padding: 9px 10px 15px;
                    .dplayer-comment-setting-title {
                        font-size: 12px;
                        line-height: 24px;
                    }
                }
                .dplayer-comment-input {
                    font-size: 12px;
                }
            }
        }
        &.dplayer-icons-left {
            .dplayer-icon {
                padding: 7px;
            }
            @media (max-width: 500px){
                .dplayer-icon {
                    padding-top: 6px;
                }
            }
            @media (max-width: 350px){
                .dplayer-icon {
                    padding-top: 7px;
                }
            }
        }
        &.dplayer-icons-right {
            right: 20px;
            .dplayer-icon {
                padding: 8px;
                @media (max-width: 500px){
                    & {
                        width: 38px;
                        padding: 7px;
                    }
                }
                @media (max-width: 350px){
                    & {
                        width: 31px;
                        padding: 5px;
                    }
                }
            }
        }
        .dplayer-time {
            line-height: 38px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            font-family: inherit;
            @media (max-width: 350px){
                & {
                    font-size: 12px;
                }
            }
        }
        .dplayer-live-badge {
            line-height: 18px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            cursor: pointer;
            font-family: inherit;
            height: 100%;
            display: inline-flex;
            align-items: center;
        }
        .dplayer-live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            vertical-align: 4%;
            margin-right: 5px;
            content: '';
            border-radius: 6px;
        }
        .dplayer-icon {
            width: 40px;
            height: 100%;
            border: none;
            background-color: transparent;
            line-height: 18px;
            outline: none;
            cursor: pointer;
            vertical-align: middle;
            box-sizing: border-box;
            display: inline-block;
            .dplayer-icon-content {
                transition: all .2s ease-in-out;
                opacity: .8;
            }
            &:hover {
                .dplayer-icon-content {
                    opacity: 1;
                }
            }
            &::-moz-focus-inner {
                border: 0;
            }
            &.dplayer-comment-icon {
                padding: 10.5px 9.5px 8px;
                @media (max-width: 500px){
                    & {
                        padding: 9px 9px 8px;
                    }
                }
                @media (max-width: 350px){
                    & {
                        padding: 6.5px 6.5px 6px;
                    }
                }
            }
            &.dplayer-volume-icon {
                width: 43px;
            }
            &.dplayer-full-icon[aria-label]:after {
                left: 1%;
            }
            @media (max-width: 350px){
                & {
                    width: 35px;
                }
            }
        }
        .dplayer-volume {
            position: relative;
            display: inline-block;
            cursor: pointer;
            height: 100%;
            &:hover {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            &.dplayer-volume-active {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            .dplayer-volume-bar-wrap {
                display: inline-block;
                margin: 0 10px 0 -5px;
                vertical-align: middle;
                height: 100%;
                .dplayer-volume-bar {
                    position: relative;
                    top: 17px;
                    width: 0;
                    height: 4px;
                    background: #FFF;
                    transition: all 0.3s ease-in-out;
                    .dplayer-volume-bar-inner {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        height: 100%;
                        transition: all 0.1s ease;
                        will-change: width;
                        .dplayer-thumb {
                            position: absolute;
                            top: 0;
                            right: 5px;
                            margin-top: -4px;
                            margin-right: -10px;
                            height: 11px;
                            width: 11px;
                            border-radius: 50%;
                            cursor: pointer;
                            transition: all .3s ease-in-out;
                            transform: scale(0);
                        }
                    }
                }
            }
        }
        .dplayer-subtitle-btn {
            display: inline-block;
            height: 100%;
        }
        .dplayer-setting {
            display: inline-block;
            height: 100%;
        }
        .dplayer-full {
            display: inline-block;
            height: 100%;
            position: relative;
        }
        .dplayer-comment {
            display: inline-block;
            height: 100%;
        }
    }
}

.dplayer-mobile-icon-wrap {
    display: flex;
    align-items: center;
    justify-content: space-evenly;
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 50px;
    transform: translate(-50%, -50%);
    transition: all 0.28s ease;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;

    .dplayer-mobile-icon {
        width: 50px;
        height: 50px;
        border: none;
        background-color: transparent;
        -webkit-tap-highlight-color: transparent;
        filter: drop-shadow(0 0 7px rgba(0, 0, 0, 0.5));
        box-sizing: border-box;
        cursor: pointer;
        outline: none;
        pointer-events: auto;

        &-backward, &-forward {
            padding: 12px;
        }
    }
}

.dplayer-setting-box {
    display: flex;
    position: absolute;
    right: 20px;
    bottom: 64px;
    width: 210px;
    height: calc(100% - 64px - 8px);
    border-radius: 7px;
    background: rgba(28, 28, 28, 0.9);
    transition: all .25s ease;
    box-sizing: border-box;
    overflow-x: hidden;
    overflow-y: hidden;
    visibility: hidden;
    opacity: 0;
    z-index: 2;
    -webkit-tap-highlight-color: transparent;
    &>div {
        overflow-x: hidden;
        &.dplayer-setting-origin-panel {
            display: block;
        }
    }
    &.dplayer-setting-box-open {
        visibility: visible;
        opacity: 1;
    }
    &.dplayer-setting-box-quality {
        clip-path: inset(calc(100% - (30px * var(--quality-length)) - 54px) 0 0 round 7px) !important;
        .dplayer-setting-origin-panel {
            transform: translateX(-100%);
        }
        .dplayer-setting-quality-panel {
            display: block;
            transform: translateX(0%);
        }
    }
    &.dplayer-setting-box-speed {
        clip-path: inset(calc(100% - 294px) 0 0 round 7px) !important;
        .dplayer-setting-origin-panel {
            transform: translateX(-100%);
        }
        .dplayer-setting-speed-panel {
            display: block;
            transform: translateX(0%);
        }
    }
    &.dplayer-setting-box-audio {
        clip-path: inset(calc(100% - 114px) 0 0 round 7px) !important;
        .dplayer-setting-origin-panel {
            transform: translateX(-100%);
        }
        .dplayer-setting-audio-panel {
            display: block;
            transform: translateX(0%);
        }
    }
    .dplayer-label {
        display: inline-block;
        color: #eee;
        font-size: 13px;
        vertical-align: middle;
        white-space: nowrap;
    }
    .dplayer-label-value {
        display: inline-block;
        margin-left: auto;
        margin-right: 23px;
        color: #e0e0e0;
        font-size: 12px;
        vertical-align: middle;
        white-space: nowrap;
    }
    .dplayer-toggle {
        position: absolute;
        top: 5px;
        right: 7px;
        width: 20px;
        height: 20px;
        text-align: center;
        font-size: 0;
        vertical-align: middle;
        input {
            max-height: 0;
            max-width: 0;
            display: none;
        }
        input+label {
            display: inline-block;
            position: relative;
            right: 15px;
            width: 32px;
            height: 20px;
            border-radius: 10px;
            box-sizing: border-box;
            transition: .25s ease;
            box-shadow: rgb(223, 223, 223) 0 0 0 0 inset;
            border: 1px solid rgb(223, 223, 223);
            cursor: pointer;
        }
        input+label:before {
            content: "";
            position: absolute;
            display: block;
            height: 19px;
            width: 19px;
            top: -0.5px;
            left: -0.5px;
            border-radius: 15px;
            transition: .25s ease;
        }
        input+label:after {
            content: "";
            display: block;
            position: absolute;
            height: 18.1px;
            width: 18.1px;
            top: -0.1px;
            left: 0;
            border-radius: 15px;
            background: #fff;
            transition: .25s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
        }
        input:checked+label {
            border-color: var(--theme-color);
        }
        input:checked+label:before {
            width: 31px;
            background: var(--theme-color);
        }
        input:checked+label:after {
            left: 12px;
        }
    }
    .dplayer-setting-origin-panel,
    .dplayer-setting-quality-panel,
    .dplayer-setting-speed-panel,
    .dplayer-setting-audio-panel {
        position: absolute;
        bottom: 0px;
        width: 100%;
        max-height: 100%;
        padding: 7px 0;
        transition: transform .25s ease;
        box-sizing: border-box;
        scrollbar-width: thin;
        overflow-y: auto;
        &::-webkit-scrollbar {
            width: 6px;
        }
        &::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, .15);
        }
    }
    .dplayer-setting-origin-panel {
        transform: translateX(0%);
    }
    .dplayer-setting-quality-panel,
    .dplayer-setting-speed-panel,
    .dplayer-setting-audio-panel {
        transform: translateX(100%);
        .dplayer-setting-header {
            display: flex;
            align-items: center;
            height: 33px;
            padding-left: 5px;
            padding-bottom: 5px;
            margin-bottom: 7px;
            border-bottom: 2px solid rgba(255, 255, 255, .15);
            box-sizing: border-box;
            cursor: pointer;
        }
        .dplayer-setting-quality-item,
        .dplayer-setting-speed-item,
        .dplayer-setting-audio-item {
            padding: 5px;
            .dplayer-toggle {
                visibility: hidden;
            }
            &.dplayer-setting-quality-current .dplayer-toggle,
            &.dplayer-setting-speed-current .dplayer-toggle,
            &.dplayer-setting-audio-current .dplayer-toggle {
                visibility: visible;
            }
        }
        .dplayer-toggle {
            display: inline-block;
            position: static;
            width: 22px;
            margin-right: 6px;
        }
    }
    .dplayer-setting-item,
    .dplayer-setting-quality-item,
    .dplayer-setting-speed-item,
    .dplayer-setting-audio-item {
        display: flex;
        align-items: center;
        height: 30px;
        padding: 5px 10px;
        box-sizing: border-box;
        cursor: pointer;
        position: relative;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
    }
    .dplayer-setting-danmaku {
        padding: 5px 0;
        .dplayer-label {
            padding: 0 10px;
            display: inline;
        }
        .dplayer-label-value {
            margin-right: 18px;
            font-size: 12.5px;
        }
        &:hover {
            .dplayer-label, .dplayer-label-value {
                display: none;
            }
            .dplayer-danmaku-bar-wrap {
                display: inline-block;
            }
        }
        &.dplayer-setting-danmaku-active {
            .dplayer-label, .dplayer-label-value {
                display: none;
            }
            .dplayer-danmaku-bar-wrap {
                display: inline-block;
            }
        }
        .dplayer-danmaku-bar-wrap {
            padding: 0 10px;
            box-sizing: border-box;
            display: none;
            vertical-align: middle;
            height: 100%;
            width: 100%;
            .dplayer-danmaku-bar {
                position: relative;
                top: 8.5px;
                width: 100%;
                height: 3px;
                background: #fff;
                transition: all 0.3s ease-in-out;
                .dplayer-danmaku-bar-inner {
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    height: 100%;
                    transition: all 0.05s ease;
                    will-change: width;
                    .dplayer-thumb {
                        position: absolute;
                        top: 0;
                        right: 5px;
                        margin-top: -4px;
                        margin-right: -10px;
                        height: 11px;
                        width: 11px;
                        border-radius: 50%;
                        cursor: pointer;
                        transition: all .3s ease-in-out;
                    }
                }
            }
        }
    }
}

.dplayer-comment-setting-box {
    position: absolute;
    left: 20px;
    bottom: 64px;
    width: 255px;
    max-height: calc(100% - 64px - 8px);
    clip-path: inset(0 0 0 round 7px);
    border-radius: 7px;
    background: rgba(28, 28, 28, 0.9);
    padding: 10px 10px 16px;
    font-size: 14px;
    transition: all .25s ease;
    scrollbar-width: thin;
    visibility: hidden;
    opacity: 0;
    box-sizing: border-box;
    overflow-y: auto;
    z-index: 2;
    -webkit-tap-highlight-color: transparent;
    &::-webkit-scrollbar {
        width: 6px;
    }
    &::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, .15);
    }
    &.dplayer-comment-setting-open {
        visibility: visible;
        opacity: 1;
    }
    input[type=radio] {
        display: none;
    }
    label {
        cursor: pointer;
    }
    .dplayer-comment-setting-title {
        font-size: 13px;
        color: #fff;
        line-height: 30px;
    }
    .dplayer-comment-setting-type, .dplayer-comment-setting-size {
        font-size: 0;
        &.dplayer-comment-setting-size {
            margin-top: 8px;
        }
        .dplayer-comment-setting-title {
            margin-bottom: 6px;
        }
        label {
            &:nth-child(2) {
                span {
                    border-radius: 4px 0 0 4px;
                }
            }
            &:nth-child(4) {
                span {
                    border-radius: 0 4px 4px 0;
                }
            }
        }
        span {
            width: 33.6%;
            padding: 4px 6px;
            line-height: 16px;
            display: inline-block;
            font-size: 12px;
            color: #fff;
            border: 1px solid #fff;
            margin-right: -1px;
            box-sizing: border-box;
            text-align: center;
            cursor: pointer;
        }
        input:checked+span {
            background: #E4E4E6;
            color: #1c1c1c;
        }
    }
    .dplayer-comment-setting-color {
        font-size: 0;
        .dplayer-comment-setting-color-list {
            display: flex;
            justify-content: space-between;
            padding: 4px 0px;
            label {
                display: inline-block;
                font-size: 0;
                padding: 6px 0px;
            }
            span {
                display: inline-block;
                width: 22px;
                height: 22px;
                border-radius: 50%;
                box-sizing: border-box;
                cursor: pointer;
                &:hover {
                    animation: my-face 5s infinite ease-in-out;
                }
            }
        }
    }
}
`,`.dplayer-danmaku {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    max-width: 100%;
    max-height: 100%;
    aspect-ratio: 16/9;
    margin: auto;
    font-size: 29px;
    font-family: inherit;
    color: #fff;
    overflow: hidden;
    .dplayer-danmaku-item {
        display: inline-block;
        font-weight: bold;
        font-size: var(--dplayer-danmaku-font-size);
        opacity: var(--dplayer-danmaku-opacity);
        white-space: nowrap;
        text-shadow: 1.2px 1.2px 4px rgba(0, 0, 0, 0.9);
        cursor: default;
        user-select: none;
        -webkit-user-select: none;
        pointer-events: none;
        &--demo {
            position: absolute;
            visibility: hidden;
        }
        span {
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }
        &.dplayer-danmaku-size-big {
            font-size: calc(var(--dplayer-danmaku-font-size) * 1.25);
        }
        &.dplayer-danmaku-size-small {
            font-size: calc(var(--dplayer-danmaku-font-size) * 0.8);
        }
    }
    .dplayer-danmaku-right {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        &.dplayer-danmaku-move {
            animation-name: danmaku;
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku {
        from {
            transform: translateX(100%);
        }
    }
    .dplayer-danmaku-top,
    .dplayer-danmaku-bottom {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        visibility: hidden;
        &.dplayer-danmaku-move {
            animation-name: danmaku-center;
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku-center {
        from {
            visibility: visible;
        }
        to {
            visibility: visible;
        }
    }
}
`,`.dplayer-logo {
    pointer-events: none;
    position: absolute;
    left: 20px;
    top: 20px;
    max-width: 50px;
    max-height: 50px;
    img {
        max-width: 100%;
        max-height: 100%;
        background: none;
    }
}
`,`.dplayer-menu {
    position: absolute;
    width: 170px;
    border-radius: 2px;
    background: rgba(28, 28, 28, 0.85);
    padding: 5px 0;
    overflow: hidden;
    z-index: 3;
    display: none;
    &.dplayer-menu-show {
        display: block;
    }
    .dplayer-menu-item {
        height: 30px;
        box-sizing: border-box;
        cursor: pointer;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
        a {
            display: inline-block;
            padding: 0 10px;
            line-height: 30px;
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            box-sizing: border-box;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            &:hover {
                text-decoration: none;
            }
        }
    }
}
`,`.dplayer-notice {
    position: absolute;
    bottom: 68px;
    left: 20px;
    padding: 12px 18px;
    margin-right: 20px;
    border-radius: 4px;
    background: rgba(28, 28, 28, 0.9);
    color: #fff;
    font-size: 14px;
    line-height: 1.6;
    transition: all .3s ease-in-out, color 0s;
    opacity: 0;
    overflow: hidden;
    pointer-events: none;
}
@media (max-width: 500px){
    .dplayer-notice {
        top: 10px;
        bottom: auto !important;
    }
}
`,`.dplayer-subtitle {
    position: absolute;
    bottom: 40px;
    width: 90%;
    left: 5%;
    text-align: center;
    color: #fff;
    text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
    font-size: 20px;
    &.dplayer-subtitle-hide {
        display: none;
    }
}
`,`.dplayer-mask {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    display: none;
    &.dplayer-mask-show {
        display: block;
    }
}

.dplayer-video-wrap {
    display: flex;
    position: relative;
    align-items: center;
    justify-content: center;
    background: #000;
    font-size: 0;
    width: 100%;
    height: 100%;

    .dplayer-video-wrap-aspect {
        position: relative;
        max-width: 100%;
        max-height: 100%;
        aspect-ratio: 16 / 9;
        overflow: hidden;

        .dplayer-video {
            width: 99999px;  // magic!!
            max-width: 100%;
            max-height: 100%;
            display: none;
        }
        .dplayer-video-current {
            display: block;
        }
        .dplayer-video-prepare {
            display: none;
        }
    }
}
`,`.dplayer-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 450px;
    background: rgba(28, 28, 28, 0.8);
    padding: 10px;
    color: #fff;
    font-size: 12px;
    border-radius: 2px;

    &-hide {
        display: none;
    }

    .dplayer-info-panel-close {
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }

    .dplayer-info-panel-item {
        & > span {
            display: inline-block;
            vertical-align: middle;
            line-height: 15px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    }

    .dplayer-info-panel-item-title {
        width: 100px;
        text-align: right;
        margin-right: 10px;
    }

    .dplayer-info-panel-item-data {
        width: 320px;
    }
}
`],sourceRoot:""}]);const p=m},149:function(a){a.exports=function(){var c={9798:function(l,h,r){r.r(h),r.d(h,{CanvasProvider:function(){return w},CanvasRenderer:function(){return Je},HTMLProvider:function(){return Ue},HTMLRenderer:function(){return zt},SVGProvider:function(){return ce},SVGRenderer:function(){return ke}}),r(2526),r(1817),r(2222),r(6992),r(7042),r(5212),r(9575),r(9653),r(5192),r(4363),r(9494),r(1539),r(9714),r(2472),r(2990),r(8927),r(3105),r(5035),r(4345),r(7174),r(2846),r(4731),r(7209),r(6319),r(8867),r(7789),r(3739),r(9368),r(4483),r(2056),r(3462),r(678),r(7462),r(3824),r(5021),r(2974),r(5016),r(3290),r(6699),r(1532),r(9720),r(4916),r(2023),r(8783),r(3112),r(5306),r(3948);var u=new Map([[0,{bytes:2,alphabet:0}],[1,{bytes:1,alphabet:1}],[2,{bytes:1,alphabet:2}],[3,{bytes:1,alphabet:3}],[4,{bytes:1,alphabet:4}],[5,{bytes:1,alphabet:5}],[6,{bytes:1,alphabet:6}],[7,{bytes:1,alphabet:7}],[8,{bytes:1,alphabet:8}],[9,{bytes:1,alphabet:9}],[10,{bytes:1,alphabet:10}],[11,{bytes:1,alphabet:11}],[12,{bytes:2,alphabet:12}],[13,{bytes:2,alphabet:13}],[14,{bytes:2,alphabet:14}]]),m=new Map([[66,{bytes:2,alphabet:0}],[74,{bytes:1,alphabet:1}],[48,{bytes:1,alphabet:2}],[49,{bytes:1,alphabet:3}],[50,{bytes:1,alphabet:4}],[51,{bytes:1,alphabet:5}],[52,{bytes:1,alphabet:6}],[53,{bytes:1,alphabet:7}],[54,{bytes:1,alphabet:8}],[55,{bytes:1,alphabet:9}],[56,{bytes:1,alphabet:10}],[73,{bytes:1,alphabet:11}],[57,{bytes:2,alphabet:12}],[58,{bytes:2,alphabet:13}],[59,{bytes:2,alphabet:14}]]),p=new Map([[15,{bytes:2,alphabet:15}],[16,{bytes:1,alphabet:16}],[17,{bytes:1,alphabet:17}],[18,{bytes:1,alphabet:18}],[19,{bytes:1,alphabet:19}],[20,{bytes:1,alphabet:20}],[21,{bytes:1,alphabet:21}],[22,{bytes:1,alphabet:22}],[23,{bytes:1,alphabet:23}],[24,{bytes:1,alphabet:24}],[25,{bytes:1,alphabet:25}],[26,{bytes:1,alphabet:26}],[27,{bytes:1,alphabet:27}],[28,{bytes:1,alphabet:28}],[29,{bytes:1,alphabet:29}],[30,{bytes:1,alphabet:30}],[31,{bytes:1,alphabet:31}]]),_=new Map([[64,{bytes:2,alphabet:15}],[65,{bytes:1,alphabet:16}],[66,{bytes:1,alphabet:17}],[67,{bytes:1,alphabet:18}],[68,{bytes:1,alphabet:19}],[69,{bytes:1,alphabet:20}],[70,{bytes:1,alphabet:21}],[71,{bytes:1,alphabet:22}],[72,{bytes:1,alphabet:23}],[73,{bytes:1,alphabet:24}],[74,{bytes:1,alphabet:25}],[75,{bytes:1,alphabet:26}],[76,{bytes:1,alphabet:27}],[77,{bytes:1,alphabet:28}],[78,{bytes:1,alphabet:29}],[79,{bytes:1,alphabet:30}],[112,{bytes:1,alphabet:31}]]),A=[["#000000FF","#FF0000FF","#00FF00FF","#FFFF00FF","#0000FFFF","#FF00FFFF","#00FFFFFF","#FFFFFFFF","#00000000","#AA0000FF","#00AA00FF","#AAAA00FF","#0000AAFF","#AA00AAFF","#00AAAAFF","#AAAAAAFF"],["#000055FF","#005500FF","#005555FF","#0055AAFF","#0055FFFF","#00AA55FF","#00AAFFFF","#00FF55FF","#00FFAAFF","#550000FF","#550055FF","#5500AAFF","#5500FFFF","#555500FF","#555555FF","#5555AAFF"],["#5555FFFF","#55AA00FF","#55AA55FF","#55AAAAFF","#55AAFFFF","#55FF00FF","#55FF55FF","#55FFAAFF","#55FFFFFF","#AA0055FF","#AA00FFFF","#AA5500FF","#AA5555FF","#AA55AAFF","#AA55FFFF","#AAAA55FF"],["#AAAAFFFF","#AAFF00FF","#AAFF55FF","#AAFFAAFF","#AAFFFFFF","#FF0055FF","#FF00AAFF","#FF5500FF","#FF5555FF","#FF55AAFF","#FF55FFFF","#FFAA00FF","#FFAA55FF","#FFAAAAFF","#FFAAFFFF","#FFFF55FF"],["#FFFFAAFF","#00000080","#FF000080","#00FF0080","#FFFF0080","#0000FF80","#FF00FF80","#00FFFF80","#FFFFFF80","#AA000080","#00AA0080","#AAAA0080","#0000AA80","#AA00AA80","#00AAAA80","#AAAAAA80"],["#00005580","#00550080","#00555580","#0055AA80","#0055FF80","#00AA5580","#00AAFF80","#00FF5580","#00FFAA80","#55000080","#55005580","#5500AA80","#5500FF80","#55550080","#55555580","#5555AA80"],["#5555FF80","#55AA0080","#55AA5580","#55AAAA80","#55AAFF80","#55FF0080","#55FF5580","#55FFAA80","#55FFFF80","#AA005580","#AA00FF80","#AA550080","#AA555580","#AA55AA80","#AA55FF80","#AAAA5580"],["#AAAAFF80","#AAFF0080","#AAFF5580","#AAFFAA80","#AAFFFF80","#FF005580","#FF00AA80","#FF550080","#FF555580","#FF55AA80","#FF55FF80","#FFAA0080","#FFAA5580","#FFAAAA80","#FFAAFF80","#FFFF5580"]],E=["　","、","。","，","．","・","：","；","？","！","゛","゜","´","｀","¨","＾","￣","＿","ヽ","ヾ","ゝ","ゞ","〃","仝","々","〆","〇","ー","―","‐","／","＼","〜","‖","｜","…","‥","‘","’","“","”","（","）","〔","〕","［","］","｛","｝","〈","〉","《","》","「","」","『","』","【","】","＋","−","±","×","÷","＝","≠","＜","＞","≦","≧","∞","∴","♂","♀","°","′","″","℃","￥","＄","¢","£","％","＃","＆","＊","＠","§","☆","★","○","●","◎","◇","◆","□","■","△","▲","▽","▼","※","〒","→","←","↑","↓","〓","＇","＂","－","～","〳","〴","〵","〻","〼","ヿ","ゟ","∈","∋","⊆","⊇","⊂","⊃","∪","∩","⊄","⊅","⊊","⊋","∉","∅","⌅","⌆","∧","∨","¬","⇒","⇔","∀","∃","⊕","⊖","⊗","∥","∦","⦅","⦆","〘","〙","〖","〗","∠","⊥","⌒","∂","∇","≡","≒","≪","≫","√","∽","∝","∵","∫","∬","≢","≃","≅","≈","≶","≷","↔","Å","‰","♯","♭","♪","†","‡","¶","♮","♫","♬","♩","◯","▷","▶","◁","◀","↗","↘","↖","↙","⇄","⇨","⇦","⇧","⇩","⤴","⤵","０","１","２","３","４","５","６","７","８","９","⦿","◉","〽","﹆","﹅","◦","•","Ａ","Ｂ","Ｃ","Ｄ","Ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","Ｚ","∓","ℵ","ℏ","㏋","ℓ","℧","ａ","ｂ","ｃ","ｄ","ｅ","ｆ","ｇ","ｈ","ｉ","ｊ","ｋ","ｌ","ｍ","ｎ","ｏ","ｐ","ｑ","ｒ","ｓ","ｔ","ｕ","ｖ","ｗ","ｘ","ｙ","ｚ","゠","–","⧺","⧻","ぁ","あ","ぃ","い","ぅ","う","ぇ","え","ぉ","お","か","が","き","ぎ","く","ぐ","け","げ","こ","ご","さ","ざ","し","じ","す","ず","せ","ぜ","そ","ぞ","た","だ","ち","ぢ","っ","つ","づ","て","で","と","ど","な","に","ぬ","ね","の","は","ば","ぱ","ひ","び","ぴ","ふ","ぶ","ぷ","へ","べ","ぺ","ほ","ぼ","ぽ","ま","み","む","め","も","ゃ","や","ゅ","ゆ","ょ","よ","ら","り","る","れ","ろ","ゎ","わ","ゐ","ゑ","を","ん","ゔ","ゕ","ゖ","か゚","き゚","く゚","け゚","こ゚","","","","ァ","ア","ィ","イ","ゥ","ウ","ェ","エ","ォ","オ","カ","ガ","キ","ギ","ク","グ","ケ","ゲ","コ","ゴ","サ","ザ","シ","ジ","ス","ズ","セ","ゼ","ソ","ゾ","タ","ダ","チ","ヂ","ッ","ツ","ヅ","テ","デ","ト","ド","ナ","ニ","ヌ","ネ","ノ","ハ","バ","パ","ヒ","ビ","ピ","フ","ブ","プ","ヘ","ベ","ペ","ホ","ボ","ポ","マ","ミ","ム","メ","モ","ャ","ヤ","ュ","ユ","ョ","ヨ","ラ","リ","ル","レ","ロ","ヮ","ワ","ヰ","ヱ","ヲ","ン","ヴ","ヵ","ヶ","カ゚","キ゚","ク゚","ケ゚","コ゚","セ゚","ツ゚","ト゚","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω","♤","♠","♢","♦","♡","♥","♧","♣","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","ς","⓵","⓶","⓷","⓸","⓹","⓺","⓻","⓼","⓽","⓾","☖","☗","〠","☎","☀","☁","☂","☃","♨","▱","ㇰ","ㇱ","ㇲ","ㇳ","ㇴ","ㇵ","ㇶ","ㇷ","ㇸ","ㇹ","ㇷ゚","ㇺ","ㇻ","ㇼ","ㇽ","ㇾ","ㇿ","А","Б","В","Г","Д","Е","Ё","Ж","З","И","Й","К","Л","М","Н","О","П","Р","С","Т","У","Ф","Х","Ц","Ч","Ш","Щ","Ъ","Ы","Ь","Э","Ю","Я","⎾","⎿","⏀","⏁","⏂","⏃","⏄","⏅","⏆","⏇","⏈","⏉","⏊","⏋","⏌","а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я","ヷ","ヸ","ヹ","ヺ","⋚","⋛","⅓","⅔","⅕","✓","⌘","␣","⏎","─","│","┌","┐","┘","└","├","┬","┤","┴","┼","━","┃","┏","┓","┛","┗","┣","┳","┫","┻","╋","┠","┯","┨","┷","┿","┝","┰","┥","┸","╂","㉑","㉒","㉓","㉔","㉕","㉖","㉗","㉘","㉙","㉚","㉛","㉜","㉝","㉞","㉟","㊱","㊲","㊳","㊴","㊵","㊶","㊷","㊸","㊹","㊺","㊻","㊼","㊽","㊾","㊿","","","","","","","","","◐","◑","◒","◓","‼","⁇","⁈","⁉","Ǎ","ǎ","ǐ","Ḿ","ḿ","Ǹ","ǹ","Ǒ","ǒ","ǔ","ǖ","ǘ","ǚ","ǜ","","","€"," ","¡","¤","¦","©","ª","«","­","®","¯","²","³","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","ø","ù","ú","û","ü","ý","þ","ÿ","Ā","Ī","Ū","Ē","Ō","ā","ī","ū","ē","ō","Ą","˘","Ł","Ľ","Ś","Š","Ş","Ť","Ź","Ž","Ż","ą","˛","ł","ľ","ś","ˇ","š","ş","ť","ź","˝","ž","ż","Ŕ","Ă","Ĺ","Ć","Č","Ę","Ě","Ď","Ń","Ň","Ő","Ř","Ů","Ű","Ţ","ŕ","ă","ĺ","ć","č","ę","ě","ď","đ","ń","ň","ő","ř","ů","ű","ţ","˙","Ĉ","Ĝ","Ĥ","Ĵ","Ŝ","Ŭ","ĉ","ĝ","ĥ","ĵ","ŝ","ŭ","ɱ","ʋ","ɾ","ʃ","ʒ","ɬ","ɮ","ɹ","ʈ","ɖ","ɳ","ɽ","ʂ","ʐ","ɻ","ɭ","ɟ","ɲ","ʝ","ʎ","ɡ","ŋ","ɰ","ʁ","ħ","ʕ","ʔ","ɦ","ʘ","ǂ","ɓ","ɗ","ʄ","ɠ","Ɠ","œ","Œ","ɨ","ʉ","ɘ","ɵ","ə","ɜ","ɞ","ɐ","ɯ","ʊ","ɤ","ʌ","ɔ","ɑ","ɒ","ʍ","ɥ","ʢ","ʡ","ɕ","ʑ","ɺ","ɧ","ɚ","æ̀","ǽ","ὰ","ά","ɔ̀","ɔ́","ʌ̀","ʌ́","ə̀","ə́","ɚ̀","ɚ́","ὲ","έ","͡","ˈ","ˌ","ː","ˑ","̆","‿","̋","́","̄","̀","̏","̌","̂","˥","˦","˧","˨","˩","˩˥","˥˩","̥","̬","̹","̜","̟","̠","̈","̽","̩","̯","˞","̤","̰","̼","̴","̝","̞","̘","̙","̪","̺","̻","̃","̚","❶","❷","❸","❹","❺","❻","❼","❽","❾","❿","⓫","⓬","⓭","⓮","⓯","⓰","⓱","⓲","⓳","⓴","ⅰ","ⅱ","ⅲ","ⅳ","ⅴ","ⅵ","ⅶ","ⅷ","ⅸ","ⅹ","ⅺ","ⅻ","ⓐ","ⓑ","ⓒ","ⓓ","ⓔ","ⓕ","ⓖ","ⓗ","ⓘ","ⓙ","ⓚ","ⓛ","ⓜ","ⓝ","ⓞ","ⓟ","ⓠ","ⓡ","ⓢ","ⓣ","ⓤ","ⓥ","ⓦ","ⓧ","ⓨ","ⓩ","㋐","㋑","㋒","㋓","㋔","㋕","㋖","㋗","㋘","㋙","㋚","㋛","㋜","㋝","㋞","㋟","㋠","㋡","㋢","㋣","㋺","㋩","㋥","㋭","㋬","","","","","","","","","","⁑","⁂","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ","㍉","㌔","㌢","㍍","㌘","㌧","㌃","㌶","㍑","㍗","㌍","㌦","㌣","㌫","㍊","㌻","㎜","㎝","㎞","㎎","㎏","㏄","㎡","Ⅻ","","","","","","","","㍻","〝","〟","№","㏍","℡","㊤","㊥","㊦","㊧","㊨","㈱","㈲","㈹","㍾","㍽","㍼","","","","∮","","","","","∟","⊿","","","","❖","☞","俱","𠀋","㐂","丨","丯","丰","亍","仡","份","仿","伃","伋","你","佈","佉","佖","佟","佪","佬","佾","侊","侔","侗","侮","俉","俠","倁","倂","倎","倘","倧","倮","偀","倻","偁","傔","僌","僲","僐","僦","僧","儆","儃","儋","儞","儵","兊","免","兕","兗","㒵","冝","凃","凊","凞","凢","凮","刁","㓛","刓","刕","剉","剗","剡","劓","勈","勉","勌","勐","勖","勛","勤","勰","勻","匀","匇","匜","卑","卡","卣","卽","厓","厝","厲","吒","吧","呍","咜","呫","呴","呿","咈","咖","咡","咩","哆","哿","唎","唫","唵","啐","啞","喁","喆","喎","喝","喭","嗎","嘆","嘈","嘎","嘻","噉","噶","噦","器","噯","噱","噲","嚙","嚞","嚩","嚬","嚳","囉","囊","圊","𡈽","圡","圯","圳","圴","坰","坷","坼","垜","﨏","𡌛","垸","埇","埈","埏","埤","埭","埵","埶","埿","堉","塚","塡","塤","塀","塼","墉","增","墨","墩","𡑮","壒","壎","壔","壚","壠","壩","夌","虁","奝","奭","妋","妒","妤","姃","姒","姝","娓","娣","婧","婭","婷","婾","媄","媞","媧","嫄","𡢽","嬙","嬥","剝","亜","唖","娃","阿","哀","愛","挨","姶","逢","葵","茜","穐","悪","握","渥","旭","葦","芦","鯵","梓","圧","斡","扱","宛","姐","虻","飴","絢","綾","鮎","或","粟","袷","安","庵","按","暗","案","闇","鞍","杏","以","伊","位","依","偉","囲","夷","委","威","尉","惟","意","慰","易","椅","為","畏","異","移","維","緯","胃","萎","衣","謂","違","遺","医","井","亥","域","育","郁","磯","一","壱","溢","逸","稲","茨","芋","鰯","允","印","咽","員","因","姻","引","飲","淫","胤","蔭","院","陰","隠","韻","吋","右","宇","烏","羽","迂","雨","卯","鵜","窺","丑","碓","臼","渦","嘘","唄","欝","蔚","鰻","姥","厩","浦","瓜","閏","噂","云","運","雲","荏","餌","叡","営","嬰","影","映","曳","栄","永","泳","洩","瑛","盈","穎","頴","英","衛","詠","鋭","液","疫","益","駅","悦","謁","越","閲","榎","厭","円","園","堰","奄","宴","延","怨","掩","援","沿","演","炎","焔","煙","燕","猿","縁","艶","苑","薗","遠","鉛","鴛","塩","於","汚","甥","凹","央","奥","往","応","押","旺","横","欧","殴","王","翁","襖","鴬","鴎","黄","岡","沖","荻","億","屋","憶","臆","桶","牡","乙","俺","卸","恩","温","穏","音","下","化","仮","何","伽","価","佳","加","可","嘉","夏","嫁","家","寡","科","暇","果","架","歌","河","火","珂","禍","禾","稼","箇","花","苛","茄","荷","華","菓","蝦","課","嘩","貨","迦","過","霞","蚊","俄","峨","我","牙","画","臥","芽","蛾","賀","雅","餓","駕","介","会","解","回","塊","壊","廻","快","怪","悔","恢","懐","戒","拐","改","魁","晦","械","海","灰","界","皆","絵","芥","蟹","開","階","貝","凱","劾","外","咳","害","崖","慨","概","涯","碍","蓋","街","該","鎧","骸","浬","馨","蛙","垣","柿","蛎","鈎","劃","嚇","各","廓","拡","撹","格","核","殻","獲","確","穫","覚","角","赫","較","郭","閣","隔","革","学","岳","楽","額","顎","掛","笠","樫","橿","梶","鰍","潟","割","喝","恰","括","活","渇","滑","葛","褐","轄","且","鰹","叶","椛","樺","鞄","株","兜","竃","蒲","釜","鎌","噛","鴨","栢","茅","萱","粥","刈","苅","瓦","乾","侃","冠","寒","刊","勘","勧","巻","喚","堪","姦","完","官","寛","干","幹","患","感","慣","憾","換","敢","柑","桓","棺","款","歓","汗","漢","澗","潅","環","甘","監","看","竿","管","簡","緩","缶","翰","肝","艦","莞","観","諌","貫","還","鑑","間","閑","関","陥","韓","館","舘","丸","含","岸","巌","玩","癌","眼","岩","翫","贋","雁","頑","顔","願","企","伎","危","喜","器","基","奇","嬉","寄","岐","希","幾","忌","揮","机","旗","既","期","棋","棄","機","帰","毅","気","汽","畿","祈","季","稀","紀","徽","規","記","貴","起","軌","輝","飢","騎","鬼","亀","偽","儀","妓","宜","戯","技","擬","欺","犠","疑","祇","義","蟻","誼","議","掬","菊","鞠","吉","吃","喫","桔","橘","詰","砧","杵","黍","却","客","脚","虐","逆","丘","久","仇","休","及","吸","宮","弓","急","救","朽","求","汲","泣","灸","球","究","窮","笈","級","糾","給","旧","牛","去","居","巨","拒","拠","挙","渠","虚","許","距","鋸","漁","禦","魚","亨","享","京","供","侠","僑","兇","競","共","凶","協","匡","卿","叫","喬","境","峡","強","彊","怯","恐","恭","挟","教","橋","況","狂","狭","矯","胸","脅","興","蕎","郷","鏡","響","饗","驚","仰","凝","尭","暁","業","局","曲","極","玉","桐","粁","僅","勤","均","巾","錦","斤","欣","欽","琴","禁","禽","筋","緊","芹","菌","衿","襟","謹","近","金","吟","銀","九","倶","句","区","狗","玖","矩","苦","躯","駆","駈","駒","具","愚","虞","喰","空","偶","寓","遇","隅","串","櫛","釧","屑","屈","掘","窟","沓","靴","轡","窪","熊","隈","粂","栗","繰","桑","鍬","勲","君","薫","訓","群","軍","郡","卦","袈","祁","係","傾","刑","兄","啓","圭","珪","型","契","形","径","恵","慶","慧","憩","掲","携","敬","景","桂","渓","畦","稽","系","経","継","繋","罫","茎","荊","蛍","計","詣","警","軽","頚","鶏","芸","迎","鯨","劇","戟","撃","激","隙","桁","傑","欠","決","潔","穴","結","血","訣","月","件","倹","倦","健","兼","券","剣","喧","圏","堅","嫌","建","憲","懸","拳","捲","検","権","牽","犬","献","研","硯","絹","県","肩","見","謙","賢","軒","遣","鍵","険","顕","験","鹸","元","原","厳","幻","弦","減","源","玄","現","絃","舷","言","諺","限","乎","個","古","呼","固","姑","孤","己","庫","弧","戸","故","枯","湖","狐","糊","袴","股","胡","菰","虎","誇","跨","鈷","雇","顧","鼓","五","互","伍","午","呉","吾","娯","後","御","悟","梧","檎","瑚","碁","語","誤","護","醐","乞","鯉","交","佼","侯","候","倖","光","公","功","効","勾","厚","口","向","后","喉","坑","垢","好","孔","孝","宏","工","巧","巷","幸","広","庚","康","弘","恒","慌","抗","拘","控","攻","昂","晃","更","杭","校","梗","構","江","洪","浩","港","溝","甲","皇","硬","稿","糠","紅","紘","絞","綱","耕","考","肯","肱","腔","膏","航","荒","行","衡","講","貢","購","郊","酵","鉱","砿","鋼","閤","降","項","香","高","鴻","剛","劫","号","合","壕","拷","濠","豪","轟","麹","克","刻","告","国","穀","酷","鵠","黒","獄","漉","腰","甑","忽","惚","骨","狛","込","此","頃","今","困","坤","墾","婚","恨","懇","昏","昆","根","梱","混","痕","紺","艮","魂","些","佐","叉","唆","嵯","左","差","査","沙","瑳","砂","詐","鎖","裟","坐","座","挫","債","催","再","最","哉","塞","妻","宰","彩","才","採","栽","歳","済","災","采","犀","砕","砦","祭","斎","細","菜","裁","載","際","剤","在","材","罪","財","冴","坂","阪","堺","榊","肴","咲","崎","埼","碕","鷺","作","削","咋","搾","昨","朔","柵","窄","策","索","錯","桜","鮭","笹","匙","冊","刷","察","拶","撮","擦","札","殺","薩","雑","皐","鯖","捌","錆","鮫","皿","晒","三","傘","参","山","惨","撒","散","桟","燦","珊","産","算","纂","蚕","讃","賛","酸","餐","斬","暫","残","仕","仔","伺","使","刺","司","史","嗣","四","士","始","姉","姿","子","屍","市","師","志","思","指","支","孜","斯","施","旨","枝","止","死","氏","獅","祉","私","糸","紙","紫","肢","脂","至","視","詞","詩","試","誌","諮","資","賜","雌","飼","歯","事","似","侍","児","字","寺","慈","持","時","次","滋","治","爾","璽","痔","磁","示","而","耳","自","蒔","辞","汐","鹿","式","識","鴫","竺","軸","宍","雫","七","叱","執","失","嫉","室","悉","湿","漆","疾","質","実","蔀","篠","偲","柴","芝","屡","蕊","縞","舎","写","射","捨","赦","斜","煮","社","紗","者","謝","車","遮","蛇","邪","借","勺","尺","杓","灼","爵","酌","釈","錫","若","寂","弱","惹","主","取","守","手","朱","殊","狩","珠","種","腫","趣","酒","首","儒","受","呪","寿","授","樹","綬","需","囚","収","周","宗","就","州","修","愁","拾","洲","秀","秋","終","繍","習","臭","舟","蒐","衆","襲","讐","蹴","輯","週","酋","酬","集","醜","什","住","充","十","従","戎","柔","汁","渋","獣","縦","重","銃","叔","夙","宿","淑","祝","縮","粛","塾","熟","出","術","述","俊","峻","春","瞬","竣","舜","駿","准","循","旬","楯","殉","淳","準","潤","盾","純","巡","遵","醇","順","処","初","所","暑","曙","渚","庶","緒","署","書","薯","藷","諸","助","叙","女","序","徐","恕","鋤","除","傷","償","勝","匠","升","召","哨","商","唱","嘗","奨","妾","娼","宵","将","小","少","尚","庄","床","廠","彰","承","抄","招","掌","捷","昇","昌","昭","晶","松","梢","樟","樵","沼","消","渉","湘","焼","焦","照","症","省","硝","礁","祥","称","章","笑","粧","紹","肖","菖","蒋","蕉","衝","裳","訟","証","詔","詳","象","賞","醤","鉦","鍾","鐘","障","鞘","上","丈","丞","乗","冗","剰","城","場","壌","嬢","常","情","擾","条","杖","浄","状","畳","穣","蒸","譲","醸","錠","嘱","埴","飾","拭","植","殖","燭","織","職","色","触","食","蝕","辱","尻","伸","信","侵","唇","娠","寝","審","心","慎","振","新","晋","森","榛","浸","深","申","疹","真","神","秦","紳","臣","芯","薪","親","診","身","辛","進","針","震","人","仁","刃","塵","壬","尋","甚","尽","腎","訊","迅","陣","靭","笥","諏","須","酢","図","厨","逗","吹","垂","帥","推","水","炊","睡","粋","翠","衰","遂","酔","錐","錘","随","瑞","髄","崇","嵩","数","枢","趨","雛","据","杉","椙","菅","頗","雀","裾","澄","摺","寸","世","瀬","畝","是","凄","制","勢","姓","征","性","成","政","整","星","晴","棲","栖","正","清","牲","生","盛","精","聖","声","製","西","誠","誓","請","逝","醒","青","静","斉","税","脆","隻","席","惜","戚","斥","昔","析","石","積","籍","績","脊","責","赤","跡","蹟","碩","切","拙","接","摂","折","設","窃","節","説","雪","絶","舌","蝉","仙","先","千","占","宣","専","尖","川","戦","扇","撰","栓","栴","泉","浅","洗","染","潜","煎","煽","旋","穿","箭","線","繊","羨","腺","舛","船","薦","詮","賎","践","選","遷","銭","銑","閃","鮮","前","善","漸","然","全","禅","繕","膳","糎","噌","塑","岨","措","曾","曽","楚","狙","疏","疎","礎","祖","租","粗","素","組","蘇","訴","阻","遡","鼠","僧","創","双","叢","倉","喪","壮","奏","爽","宋","層","匝","惣","想","捜","掃","挿","掻","操","早","曹","巣","槍","槽","漕","燥","争","痩","相","窓","糟","総","綜","聡","草","荘","葬","蒼","藻","装","走","送","遭","鎗","霜","騒","像","増","憎","臓","蔵","贈","造","促","側","則","即","息","捉","束","測","足","速","俗","属","賊","族","続","卒","袖","其","揃","存","孫","尊","損","村","遜","他","多","太","汰","詑","唾","堕","妥","惰","打","柁","舵","楕","陀","駄","騨","体","堆","対","耐","岱","帯","待","怠","態","戴","替","泰","滞","胎","腿","苔","袋","貸","退","逮","隊","黛","鯛","代","台","大","第","醍","題","鷹","滝","瀧","卓","啄","宅","托","択","拓","沢","濯","琢","託","鐸","濁","諾","茸","凧","蛸","只","叩","但","達","辰","奪","脱","巽","竪","辿","棚","谷","狸","鱈","樽","誰","丹","単","嘆","坦","担","探","旦","歎","淡","湛","炭","短","端","箪","綻","耽","胆","蛋","誕","鍛","団","壇","弾","断","暖","檀","段","男","談","値","知","地","弛","恥","智","池","痴","稚","置","致","蜘","遅","馳","築","畜","竹","筑","蓄","逐","秩","窒","茶","嫡","着","中","仲","宙","忠","抽","昼","柱","注","虫","衷","註","酎","鋳","駐","樗","瀦","猪","苧","著","貯","丁","兆","凋","喋","寵","帖","帳","庁","弔","張","彫","徴","懲","挑","暢","朝","潮","牒","町","眺","聴","脹","腸","蝶","調","諜","超","跳","銚","長","頂","鳥","勅","捗","直","朕","沈","珍","賃","鎮","陳","津","墜","椎","槌","追","鎚","痛","通","塚","栂","掴","槻","佃","漬","柘","辻","蔦","綴","鍔","椿","潰","坪","壷","嬬","紬","爪","吊","釣","鶴","亭","低","停","偵","剃","貞","呈","堤","定","帝","底","庭","廷","弟","悌","抵","挺","提","梯","汀","碇","禎","程","締","艇","訂","諦","蹄","逓","邸","鄭","釘","鼎","泥","摘","擢","敵","滴","的","笛","適","鏑","溺","哲","徹","撤","轍","迭","鉄","典","填","天","展","店","添","纏","甜","貼","転","顛","点","伝","殿","澱","田","電","兎","吐","堵","塗","妬","屠","徒","斗","杜","渡","登","菟","賭","途","都","鍍","砥","砺","努","度","土","奴","怒","倒","党","冬","凍","刀","唐","塔","塘","套","宕","島","嶋","悼","投","搭","東","桃","梼","棟","盗","淘","湯","涛","灯","燈","当","痘","祷","等","答","筒","糖","統","到","董","蕩","藤","討","謄","豆","踏","逃","透","鐙","陶","頭","騰","闘","働","動","同","堂","導","憧","撞","洞","瞳","童","胴","萄","道","銅","峠","鴇","匿","得","徳","涜","特","督","禿","篤","毒","独","読","栃","橡","凸","突","椴","届","鳶","苫","寅","酉","瀞","噸","屯","惇","敦","沌","豚","遁","頓","呑","曇","鈍","奈","那","内","乍","凪","薙","謎","灘","捺","鍋","楢","馴","縄","畷","南","楠","軟","難","汝","二","尼","弐","迩","匂","賑","肉","虹","廿","日","乳","入","如","尿","韮","任","妊","忍","認","濡","禰","祢","寧","葱","猫","熱","年","念","捻","撚","燃","粘","乃","廼","之","埜","嚢","悩","濃","納","能","脳","膿","農","覗","蚤","巴","把","播","覇","杷","波","派","琶","破","婆","罵","芭","馬","俳","廃","拝","排","敗","杯","盃","牌","背","肺","輩","配","倍","培","媒","梅","楳","煤","狽","買","売","賠","陪","這","蝿","秤","矧","萩","伯","剥","博","拍","柏","泊","白","箔","粕","舶","薄","迫","曝","漠","爆","縛","莫","駁","麦","函","箱","硲","箸","肇","筈","櫨","幡","肌","畑","畠","八","鉢","溌","発","醗","髪","伐","罰","抜","筏","閥","鳩","噺","塙","蛤","隼","伴","判","半","反","叛","帆","搬","斑","板","氾","汎","版","犯","班","畔","繁","般","藩","販","範","釆","煩","頒","飯","挽","晩","番","盤","磐","蕃","蛮","匪","卑","否","妃","庇","彼","悲","扉","批","披","斐","比","泌","疲","皮","碑","秘","緋","罷","肥","被","誹","費","避","非","飛","樋","簸","備","尾","微","枇","毘","琵","眉","美","鼻","柊","稗","匹","疋","髭","彦","膝","菱","肘","弼","必","畢","筆","逼","桧","姫","媛","紐","百","謬","俵","彪","標","氷","漂","瓢","票","表","評","豹","廟","描","病","秒","苗","錨","鋲","蒜","蛭","鰭","品","彬","斌","浜","瀕","貧","賓","頻","敏","瓶","不","付","埠","夫","婦","富","冨","布","府","怖","扶","敷","斧","普","浮","父","符","腐","膚","芙","譜","負","賦","赴","阜","附","侮","撫","武","舞","葡","蕪","部","封","楓","風","葺","蕗","伏","副","復","幅","服","福","腹","複","覆","淵","弗","払","沸","仏","物","鮒","分","吻","噴","墳","憤","扮","焚","奮","粉","糞","紛","雰","文","聞","丙","併","兵","塀","幣","平","弊","柄","並","蔽","閉","陛","米","頁","僻","壁","癖","碧","別","瞥","蔑","箆","偏","変","片","篇","編","辺","返","遍","便","勉","娩","弁","鞭","保","舗","鋪","圃","捕","歩","甫","補","輔","穂","募","墓","慕","戊","暮","母","簿","菩","倣","俸","包","呆","報","奉","宝","峰","峯","崩","庖","抱","捧","放","方","朋","法","泡","烹","砲","縫","胞","芳","萌","蓬","蜂","褒","訪","豊","邦","鋒","飽","鳳","鵬","乏","亡","傍","剖","坊","妨","帽","忘","忙","房","暴","望","某","棒","冒","紡","肪","膨","謀","貌","貿","鉾","防","吠","頬","北","僕","卜","墨","撲","朴","牧","睦","穆","釦","勃","没","殆","堀","幌","奔","本","翻","凡","盆","摩","磨","魔","麻","埋","妹","昧","枚","毎","哩","槙","幕","膜","枕","鮪","柾","鱒","桝","亦","俣","又","抹","末","沫","迄","侭","繭","麿","万","慢","満","漫","蔓","味","未","魅","巳","箕","岬","密","蜜","湊","蓑","稔","脈","妙","粍","民","眠","務","夢","無","牟","矛","霧","鵡","椋","婿","娘","冥","名","命","明","盟","迷","銘","鳴","姪","牝","滅","免","棉","綿","緬","面","麺","摸","模","茂","妄","孟","毛","猛","盲","網","耗","蒙","儲","木","黙","目","杢","勿","餅","尤","戻","籾","貰","問","悶","紋","門","匁","也","冶","夜","爺","耶","野","弥","矢","厄","役","約","薬","訳","躍","靖","柳","薮","鑓","愉","愈","油","癒","諭","輸","唯","佑","優","勇","友","宥","幽","悠","憂","揖","有","柚","湧","涌","猶","猷","由","祐","裕","誘","遊","邑","郵","雄","融","夕","予","余","与","誉","輿","預","傭","幼","妖","容","庸","揚","揺","擁","曜","楊","様","洋","溶","熔","用","窯","羊","耀","葉","蓉","要","謡","踊","遥","陽","養","慾","抑","欲","沃","浴","翌","翼","淀","羅","螺","裸","来","莱","頼","雷","洛","絡","落","酪","乱","卵","嵐","欄","濫","藍","蘭","覧","利","吏","履","李","梨","理","璃","痢","裏","裡","里","離","陸","律","率","立","葎","掠","略","劉","流","溜","琉","留","硫","粒","隆","竜","龍","侶","慮","旅","虜","了","亮","僚","両","凌","寮","料","梁","涼","猟","療","瞭","稜","糧","良","諒","遼","量","陵","領","力","緑","倫","厘","林","淋","燐","琳","臨","輪","隣","鱗","麟","瑠","塁","涙","累","類","令","伶","例","冷","励","嶺","怜","玲","礼","苓","鈴","隷","零","霊","麗","齢","暦","歴","列","劣","烈","裂","廉","恋","憐","漣","煉","簾","練","聯","蓮","連","錬","呂","魯","櫓","炉","賂","路","露","労","婁","廊","弄","朗","楼","榔","浪","漏","牢","狼","篭","老","聾","蝋","郎","六","麓","禄","肋","録","論","倭","和","話","歪","賄","脇","惑","枠","鷲","亙","亘","鰐","詫","藁","蕨","椀","湾","碗","腕","𠮟","孁","孖","孽","宓","寘","寬","尒","尞","尣","尫","㞍","屢","層","屮","𡚴","屺","岏","岟","岣","岪","岺","峋","峐","峒","峴","𡸴","㟢","崍","崧","﨑","嵆","嵇","嵓","嵊","嵭","嶁","嶠","嶤","嶧","嶸","巋","吞","弌","丐","丕","个","丱","丶","丼","丿","乂","乖","乘","亂","亅","豫","亊","舒","弍","于","亞","亟","亠","亢","亰","亳","亶","从","仍","仄","仆","仂","仗","仞","仭","仟","价","伉","佚","估","佛","佝","佗","佇","佶","侈","侏","侘","佻","佩","佰","侑","佯","來","侖","儘","俔","俟","俎","俘","俛","俑","俚","俐","俤","俥","倚","倨","倔","倪","倥","倅","伜","俶","倡","倩","倬","俾","俯","們","倆","偃","假","會","偕","偐","偈","做","偖","偬","偸","傀","傚","傅","傴","傲","僉","僊","傳","僂","僖","僞","僥","僭","僣","僮","價","僵","儉","儁","儂","儖","儕","儔","儚","儡","儺","儷","儼","儻","儿","兀","兒","兌","兔","兢","竸","兩","兪","兮","冀","冂","囘","册","冉","冏","冑","冓","冕","冖","冤","冦","冢","冩","冪","冫","决","冱","冲","冰","况","冽","凅","凉","凛","几","處","凩","凭","凰","凵","凾","刄","刋","刔","刎","刧","刪","刮","刳","刹","剏","剄","剋","剌","剞","剔","剪","剴","剩","剳","剿","剽","劍","劔","劒","剱","劈","劑","辨","辧","劬","劭","劼","劵","勁","勍","勗","勞","勣","勦","飭","勠","勳","勵","勸","勹","匆","匈","甸","匍","匐","匏","匕","匚","匣","匯","匱","匳","匸","區","卆","卅","丗","卉","卍","凖","卞","卩","卮","夘","卻","卷","厂","厖","厠","厦","厥","厮","厰","厶","參","簒","雙","叟","曼","燮","叮","叨","叭","叺","吁","吽","呀","听","吭","吼","吮","吶","吩","吝","呎","咏","呵","咎","呟","呱","呷","呰","咒","呻","咀","呶","咄","咐","咆","哇","咢","咸","咥","咬","哄","哈","咨","咫","哂","咤","咾","咼","哘","哥","哦","唏","唔","哽","哮","哭","哺","哢","唹","啀","啣","啌","售","啜","啅","啖","啗","唸","唳","啝","喙","喀","咯","喊","喟","啻","啾","喘","喞","單","啼","喃","喩","喇","喨","嗚","嗅","嗟","嗄","嗜","嗤","嗔","嘔","嗷","嘖","嗾","嗽","嘛","嗹","噎","噐","營","嘴","嘶","嘲","嘸","噫","噤","嘯","噬","噪","嚆","嚀","嚊","嚠","嚔","嚏","嚥","嚮","嚶","嚴","囂","嚼","囁","囃","囀","囈","囎","囑","囓","囗","囮","囹","圀","囿","圄","圉","圈","國","圍","圓","團","圖","嗇","圜","圦","圷","圸","坎","圻","址","坏","坩","埀","垈","坡","坿","垉","垓","垠","垳","垤","垪","垰","埃","埆","埔","埒","埓","堊","埖","埣","堋","堙","堝","塲","堡","塢","塋","塰","毀","塒","堽","塹","墅","墹","墟","墫","墺","壞","墻","墸","墮","壅","壓","壑","壗","壙","壘","壥","壜","壤","壟","壯","壺","壹","壻","壼","壽","夂","夊","夐","夛","梦","夥","夬","夭","夲","夸","夾","竒","奕","奐","奎","奚","奘","奢","奠","奧","奬","奩","奸","妁","妝","佞","侫","妣","妲","姆","姨","姜","妍","姙","姚","娥","娟","娑","娜","娉","娚","婀","婬","婉","娵","娶","婢","婪","媚","媼","媾","嫋","嫂","媽","嫣","嫗","嫦","嫩","嫖","嫺","嫻","嬌","嬋","嬖","嬲","嫐","嬪","嬶","嬾","孃","孅","孀","孑","孕","孚","孛","孥","孩","孰","孳","孵","學","斈","孺","宀","它","宦","宸","寃","寇","寉","寔","寐","寤","實","寢","寞","寥","寫","寰","寶","寳","尅","將","專","對","尓","尠","尢","尨","尸","尹","屁","屆","屎","屓","屐","屏","孱","屬","屮","乢","屶","屹","岌","岑","岔","妛","岫","岻","岶","岼","岷","峅","岾","峇","峙","峩","峽","峺","峭","嶌","峪","崋","崕","崗","嵜","崟","崛","崑","崔","崢","崚","崙","崘","嵌","嵒","嵎","嵋","嵬","嵳","嵶","嶇","嶄","嶂","嶢","嶝","嶬","嶮","嶽","嶐","嶷","嶼","巉","巍","巓","巒","巖","巛","巫","已","巵","帋","帚","帙","帑","帛","帶","帷","幄","幃","幀","幎","幗","幔","幟","幢","幤","幇","幵","并","幺","麼","广","庠","廁","廂","廈","廐","廏","廖","廣","廝","廚","廛","廢","廡","廨","廩","廬","廱","廳","廰","廴","廸","廾","弃","弉","彝","彜","弋","弑","弖","弩","弭","弸","彁","彈","彌","彎","弯","彑","彖","彗","彙","彡","彭","彳","彷","徃","徂","彿","徊","很","徑","徇","從","徙","徘","徠","徨","徭","徼","忖","忻","忤","忸","忱","忝","悳","忿","怡","恠","怙","怐","怩","怎","怱","怛","怕","怫","怦","怏","怺","恚","恁","恪","恷","恟","恊","恆","恍","恣","恃","恤","恂","恬","恫","恙","悁","悍","惧","悃","悚","悄","悛","悖","悗","悒","悧","悋","惡","悸","惠","惓","悴","忰","悽","惆","悵","惘","慍","愕","愆","惶","惷","愀","惴","惺","愃","愡","惻","惱","愍","愎","慇","愾","愨","愧","慊","愿","愼","愬","愴","愽","慂","慄","慳","慷","慘","慙","慚","慫","慴","慯","慥","慱","慟","慝","慓","慵","憙","憖","憇","憬","憔","憚","憊","憑","憫","憮","懌","懊","應","懷","懈","懃","懆","憺","懋","罹","懍","懦","懣","懶","懺","懴","懿","懽","懼","懾","戀","戈","戉","戍","戌","戔","戛","戞","戡","截","戮","戰","戲","戳","扁","扎","扞","扣","扛","扠","扨","扼","抂","抉","找","抒","抓","抖","拔","抃","抔","拗","拑","抻","拏","拿","拆","擔","拈","拜","拌","拊","拂","拇","抛","拉","挌","拮","拱","挧","挂","挈","拯","拵","捐","挾","捍","搜","捏","掖","掎","掀","掫","捶","掣","掏","掉","掟","掵","捫","捩","掾","揩","揀","揆","揣","揉","插","揶","揄","搖","搴","搆","搓","搦","搶","攝","搗","搨","搏","摧","摯","摶","摎","攪","撕","撓","撥","撩","撈","撼","據","擒","擅","擇","撻","擘","擂","擱","擧","舉","擠","擡","抬","擣","擯","攬","擶","擴","擲","擺","攀","擽","攘","攜","攅","攤","攣","攫","攴","攵","攷","收","攸","畋","效","敖","敕","敍","敘","敞","敝","敲","數","斂","斃","變","斛","斟","斫","斷","旃","旆","旁","旄","旌","旒","旛","旙","无","旡","旱","杲","昊","昃","旻","杳","昵","昶","昴","昜","晏","晄","晉","晁","晞","晝","晤","晧","晨","晟","晢","晰","暃","暈","暎","暉","暄","暘","暝","曁","暹","曉","暾","暼","曄","暸","曖","曚","曠","昿","曦","曩","曰","曵","曷","朏","朖","朞","朦","朧","霸","朮","朿","朶","杁","朸","朷","杆","杞","杠","杙","杣","杤","枉","杰","枩","杼","杪","枌","枋","枦","枡","枅","枷","柯","枴","柬","枳","柩","枸","柤","柞","柝","柢","柮","枹","柎","柆","柧","檜","栞","框","栩","桀","桍","栲","桎","梳","栫","桙","档","桷","桿","梟","梏","梭","梔","條","梛","梃","檮","梹","桴","梵","梠","梺","椏","梍","桾","椁","棊","椈","棘","椢","椦","棡","椌","棍","棔","棧","棕","椶","椒","椄","棗","棣","椥","棹","棠","棯","椨","椪","椚","椣","椡","棆","楹","楷","楜","楸","楫","楔","楾","楮","椹","楴","椽","楙","椰","楡","楞","楝","榁","楪","榲","榮","槐","榿","槁","槓","榾","槎","寨","槊","槝","榻","槃","榧","樮","榑","榠","榜","榕","榴","槞","槨","樂","樛","槿","權","槹","槲","槧","樅","榱","樞","槭","樔","槫","樊","樒","櫁","樣","樓","橄","樌","橲","樶","橸","橇","橢","橙","橦","橈","樸","樢","檐","檍","檠","檄","檢","檣","檗","蘗","檻","櫃","櫂","檸","檳","檬","櫞","櫑","櫟","檪","櫚","櫪","櫻","欅","蘖","櫺","欒","欖","鬱","欟","欸","欷","盜","欹","飮","歇","歃","歉","歐","歙","歔","歛","歟","歡","歸","歹","歿","殀","殄","殃","殍","殘","殕","殞","殤","殪","殫","殯","殲","殱","殳","殷","殼","毆","毋","毓","毟","毬","毫","毳","毯","麾","氈","氓","气","氛","氤","氣","汞","汕","汢","汪","沂","沍","沚","沁","沛","汾","汨","汳","沒","沐","泄","泱","泓","沽","泗","泅","泝","沮","沱","沾","沺","泛","泯","泙","泪","洟","衍","洶","洫","洽","洸","洙","洵","洳","洒","洌","浣","涓","浤","浚","浹","浙","涎","涕","濤","涅","淹","渕","渊","涵","淇","淦","涸","淆","淬","淞","淌","淨","淒","淅","淺","淙","淤","淕","淪","淮","渭","湮","渮","渙","湲","湟","渾","渣","湫","渫","湶","湍","渟","湃","渺","湎","渤","滿","渝","游","溂","溪","溘","滉","溷","滓","溽","溯","滄","溲","滔","滕","溏","溥","滂","溟","潁","漑","灌","滬","滸","滾","漿","滲","漱","滯","漲","滌","漾","漓","滷","澆","潺","潸","澁","澀","潯","潛","濳","潭","澂","潼","潘","澎","澑","濂","潦","澳","澣","澡","澤","澹","濆","澪","濟","濕","濬","濔","濘","濱","濮","濛","瀉","瀋","濺","瀑","瀁","瀏","濾","瀛","瀚","潴","瀝","瀘","瀟","瀰","瀾","瀲","灑","灣","炙","炒","炯","烱","炬","炸","炳","炮","烟","烋","烝","烙","焉","烽","焜","焙","煥","煕","熈","煦","煢","煌","煖","煬","熏","燻","熄","熕","熨","熬","燗","熹","熾","燒","燉","燔","燎","燠","燬","燧","燵","燼","燹","燿","爍","爐","爛","爨","爭","爬","爰","爲","爻","爼","爿","牀","牆","牋","牘","牴","牾","犂","犁","犇","犒","犖","犢","犧","犹","犲","狃","狆","狄","狎","狒","狢","狠","狡","狹","狷","倏","猗","猊","猜","猖","猝","猴","猯","猩","猥","猾","獎","獏","默","獗","獪","獨","獰","獸","獵","獻","獺","珈","玳","珎","玻","珀","珥","珮","珞","璢","琅","瑯","琥","珸","琲","琺","瑕","琿","瑟","瑙","瑁","瑜","瑩","瑰","瑣","瑪","瑶","瑾","璋","璞","璧","瓊","瓏","瓔","珱","瓠","瓣","瓧","瓩","瓮","瓲","瓰","瓱","瓸","瓷","甄","甃","甅","甌","甎","甍","甕","甓","甞","甦","甬","甼","畄","畍","畊","畉","畛","畆","畚","畩","畤","畧","畫","畭","畸","當","疆","疇","畴","疊","疉","疂","疔","疚","疝","疥","疣","痂","疳","痃","疵","疽","疸","疼","疱","痍","痊","痒","痙","痣","痞","痾","痿","痼","瘁","痰","痺","痲","痳","瘋","瘍","瘉","瘟","瘧","瘠","瘡","瘢","瘤","瘴","瘰","瘻","癇","癈","癆","癜","癘","癡","癢","癨","癩","癪","癧","癬","癰","癲","癶","癸","發","皀","皃","皈","皋","皎","皖","皓","皙","皚","皰","皴","皸","皹","皺","盂","盍","盖","盒","盞","盡","盥","盧","盪","蘯","盻","眈","眇","眄","眩","眤","眞","眥","眦","眛","眷","眸","睇","睚","睨","睫","睛","睥","睿","睾","睹","瞎","瞋","瞑","瞠","瞞","瞰","瞶","瞹","瞿","瞼","瞽","瞻","矇","矍","矗","矚","矜","矣","矮","矼","砌","砒","礦","砠","礪","硅","碎","硴","碆","硼","碚","碌","碣","碵","碪","碯","磑","磆","磋","磔","碾","碼","磅","磊","磬","磧","磚","磽","磴","礇","礒","礑","礙","礬","礫","祀","祠","祗","祟","祚","祕","祓","祺","祿","禊","禝","禧","齋","禪","禮","禳","禹","禺","秉","秕","秧","秬","秡","秣","稈","稍","稘","稙","稠","稟","禀","稱","稻","稾","稷","穃","穗","穉","穡","穢","穩","龝","穰","穹","穽","窈","窗","窕","窘","窖","窩","竈","窰","窶","竅","竄","窿","邃","竇","竊","竍","竏","竕","竓","站","竚","竝","竡","竢","竦","竭","竰","笂","笏","笊","笆","笳","笘","笙","笞","笵","笨","笶","筐","筺","笄","筍","笋","筌","筅","筵","筥","筴","筧","筰","筱","筬","筮","箝","箘","箟","箍","箜","箚","箋","箒","箏","筝","箙","篋","篁","篌","篏","箴","篆","篝","篩","簑","簔","篦","篥","籠","簀","簇","簓","篳","篷","簗","簍","篶","簣","簧","簪","簟","簷","簫","簽","籌","籃","籔","籏","籀","籐","籘","籟","籤","籖","籥","籬","籵","粃","粐","粤","粭","粢","粫","粡","粨","粳","粲","粱","粮","粹","粽","糀","糅","糂","糘","糒","糜","糢","鬻","糯","糲","糴","糶","糺","紆","紂","紜","紕","紊","絅","絋","紮","紲","紿","紵","絆","絳","絖","絎","絲","絨","絮","絏","絣","經","綉","絛","綏","絽","綛","綺","綮","綣","綵","緇","綽","綫","總","綢","綯","緜","綸","綟","綰","緘","緝","緤","緞","緻","緲","緡","縅","縊","縣","縡","縒","縱","縟","縉","縋","縢","繆","繦","縻","縵","縹","繃","縷","縲","縺","繧","繝","繖","繞","繙","繚","繹","繪","繩","繼","繻","纃","緕","繽","辮","繿","纈","纉","續","纒","纐","纓","纔","纖","纎","纛","纜","缸","缺","罅","罌","罍","罎","罐","网","罕","罔","罘","罟","罠","罨","罩","罧","罸","羂","羆","羃","羈","羇","羌","羔","羞","羝","羚","羣","羯","羲","羹","羮","羶","羸","譱","翅","翆","翊","翕","翔","翡","翦","翩","翳","翹","飜","耆","耄","耋","耒","耘","耙","耜","耡","耨","耿","耻","聊","聆","聒","聘","聚","聟","聢","聨","聳","聲","聰","聶","聹","聽","聿","肄","肆","肅","肛","肓","肚","肭","冐","肬","胛","胥","胙","胝","胄","胚","胖","脉","胯","胱","脛","脩","脣","脯","腋","隋","腆","脾","腓","腑","胼","腱","腮","腥","腦","腴","膃","膈","膊","膀","膂","膠","膕","膤","膣","腟","膓","膩","膰","膵","膾","膸","膽","臀","臂","膺","臉","臍","臑","臙","臘","臈","臚","臟","臠","臧","臺","臻","臾","舁","舂","舅","與","舊","舍","舐","舖","舩","舫","舸","舳","艀","艙","艘","艝","艚","艟","艤","艢","艨","艪","艫","舮","艱","艷","艸","艾","芍","芒","芫","芟","芻","芬","苡","苣","苟","苒","苴","苳","苺","莓","范","苻","苹","苞","茆","苜","茉","苙","茵","茴","茖","茲","茱","荀","茹","荐","荅","茯","茫","茗","茘","莅","莚","莪","莟","莢","莖","茣","莎","莇","莊","荼","莵","荳","荵","莠","莉","莨","菴","萓","菫","菎","菽","萃","菘","萋","菁","菷","萇","菠","菲","萍","萢","萠","莽","萸","蔆","菻","葭","萪","萼","蕚","蒄","葷","葫","蒭","葮","蒂","葩","葆","萬","葯","葹","萵","蓊","葢","蒹","蒿","蒟","蓙","蓍","蒻","蓚","蓐","蓁","蓆","蓖","蒡","蔡","蓿","蓴","蔗","蔘","蔬","蔟","蔕","蔔","蓼","蕀","蕣","蕘","蕈","蕁","蘂","蕋","蕕","薀","薤","薈","薑","薊","薨","蕭","薔","薛","藪","薇","薜","蕷","蕾","薐","藉","薺","藏","薹","藐","藕","藝","藥","藜","藹","蘊","蘓","蘋","藾","藺","蘆","蘢","蘚","蘰","蘿","虍","乕","虔","號","虧","虱","蚓","蚣","蚩","蚪","蚋","蚌","蚶","蚯","蛄","蛆","蚰","蛉","蠣","蚫","蛔","蛞","蛩","蛬","蛟","蛛","蛯","蜒","蜆","蜈","蜀","蜃","蛻","蜑","蜉","蜍","蛹","蜊","蜴","蜿","蜷","蜻","蜥","蜩","蜚","蝠","蝟","蝸","蝌","蝎","蝴","蝗","蝨","蝮","蝙","蝓","蝣","蝪","蠅","螢","螟","螂","螯","蟋","螽","蟀","蟐","雖","螫","蟄","螳","蟇","蟆","螻","蟯","蟲","蟠","蠏","蠍","蟾","蟶","蟷","蠎","蟒","蠑","蠖","蠕","蠢","蠡","蠱","蠶","蠹","蠧","蠻","衄","衂","衒","衙","衞","衢","衫","袁","衾","袞","衵","衽","袵","衲","袂","袗","袒","袮","袙","袢","袍","袤","袰","袿","袱","裃","裄","裔","裘","裙","裝","裹","褂","裼","裴","裨","裲","褄","褌","褊","褓","襃","褞","褥","褪","褫","襁","襄","褻","褶","褸","襌","褝","襠","襞","襦","襤","襭","襪","襯","襴","襷","襾","覃","覈","覊","覓","覘","覡","覩","覦","覬","覯","覲","覺","覽","覿","觀","觚","觜","觝","觧","觴","觸","訃","訖","訐","訌","訛","訝","訥","訶","詁","詛","詒","詆","詈","詼","詭","詬","詢","誅","誂","誄","誨","誡","誑","誥","誦","誚","誣","諄","諍","諂","諚","諫","諳","諧","諤","諱","謔","諠","諢","諷","諞","諛","謌","謇","謚","諡","謖","謐","謗","謠","謳","鞫","謦","謫","謾","謨","譁","譌","譏","譎","證","譖","譛","譚","譫","譟","譬","譯","譴","譽","讀","讌","讎","讒","讓","讖","讙","讚","谺","豁","谿","豈","豌","豎","豐","豕","豢","豬","豸","豺","貂","貉","貅","貊","貍","貎","貔","豼","貘","戝","貭","貪","貽","貲","貳","貮","貶","賈","賁","賤","賣","賚","賽","賺","賻","贄","贅","贊","贇","贏","贍","贐","齎","贓","賍","贔","贖","赧","赭","赱","赳","趁","趙","跂","趾","趺","跏","跚","跖","跌","跛","跋","跪","跫","跟","跣","跼","踈","踉","跿","踝","踞","踐","踟","蹂","踵","踰","踴","蹊","蹇","蹉","蹌","蹐","蹈","蹙","蹤","蹠","踪","蹣","蹕","蹶","蹲","蹼","躁","躇","躅","躄","躋","躊","躓","躑","躔","躙","躪","躡","躬","躰","軆","躱","躾","軅","軈","軋","軛","軣","軼","軻","軫","軾","輊","輅","輕","輒","輙","輓","輜","輟","輛","輌","輦","輳","輻","輹","轅","轂","輾","轌","轉","轆","轎","轗","轜","轢","轣","轤","辜","辟","辣","辭","辯","辷","迚","迥","迢","迪","迯","邇","迴","逅","迹","迺","逑","逕","逡","逍","逞","逖","逋","逧","逶","逵","逹","迸","遏","遐","遑","遒","逎","遉","逾","遖","遘","遞","遨","遯","遶","隨","遲","邂","遽","邁","邀","邊","邉","邏","邨","邯","邱","邵","郢","郤","扈","郛","鄂","鄒","鄙","鄲","鄰","酊","酖","酘","酣","酥","酩","酳","酲","醋","醉","醂","醢","醫","醯","醪","醵","醴","醺","釀","釁","釉","釋","釐","釖","釟","釡","釛","釼","釵","釶","鈞","釿","鈔","鈬","鈕","鈑","鉞","鉗","鉅","鉉","鉤","鉈","銕","鈿","鉋","鉐","銜","銖","銓","銛","鉚","鋏","銹","銷","鋩","錏","鋺","鍄","錮","錙","錢","錚","錣","錺","錵","錻","鍜","鍠","鍼","鍮","鍖","鎰","鎬","鎭","鎔","鎹","鏖","鏗","鏨","鏥","鏘","鏃","鏝","鏐","鏈","鏤","鐚","鐔","鐓","鐃","鐇","鐐","鐶","鐫","鐵","鐡","鐺","鑁","鑒","鑄","鑛","鑠","鑢","鑞","鑪","鈩","鑰","鑵","鑷","鑽","鑚","鑼","鑾","钁","鑿","閂","閇","閊","閔","閖","閘","閙","閠","閨","閧","閭","閼","閻","閹","閾","闊","濶","闃","闍","闌","闕","闔","闖","關","闡","闥","闢","阡","阨","阮","阯","陂","陌","陏","陋","陷","陜","陞","陝","陟","陦","陲","陬","隍","隘","隕","隗","險","隧","隱","隲","隰","隴","隶","隸","隹","雎","雋","雉","雍","襍","雜","霍","雕","雹","霄","霆","霈","霓","霎","霑","霏","霖","霙","霤","霪","霰","霹","霽","霾","靄","靆","靈","靂","靉","靜","靠","靤","靦","靨","勒","靫","靱","靹","鞅","靼","鞁","靺","鞆","鞋","鞏","鞐","鞜","鞨","鞦","鞣","鞳","鞴","韃","韆","韈","韋","韜","韭","齏","韲","竟","韶","韵","頏","頌","頸","頤","頡","頷","頽","顆","顏","顋","顫","顯","顰","顱","顴","顳","颪","颯","颱","颶","飄","飃","飆","飩","飫","餃","餉","餒","餔","餘","餡","餝","餞","餤","餠","餬","餮","餽","餾","饂","饉","饅","饐","饋","饑","饒","饌","饕","馗","馘","馥","馭","馮","馼","駟","駛","駝","駘","駑","駭","駮","駱","駲","駻","駸","騁","騏","騅","駢","騙","騫","騷","驅","驂","驀","驃","騾","驕","驍","驛","驗","驟","驢","驥","驤","驩","驫","驪","骭","骰","骼","髀","髏","髑","髓","體","髞","髟","髢","髣","髦","髯","髫","髮","髴","髱","髷","髻","鬆","鬘","鬚","鬟","鬢","鬣","鬥","鬧","鬨","鬩","鬪","鬮","鬯","鬲","魄","魃","魏","魍","魎","魑","魘","魴","鮓","鮃","鮑","鮖","鮗","鮟","鮠","鮨","鮴","鯀","鯊","鮹","鯆","鯏","鯑","鯒","鯣","鯢","鯤","鯔","鯡","鰺","鯲","鯱","鯰","鰕","鰔","鰉","鰓","鰌","鰆","鰈","鰒","鰊","鰄","鰮","鰛","鰥","鰤","鰡","鰰","鱇","鰲","鱆","鰾","鱚","鱠","鱧","鱶","鱸","鳧","鳬","鳰","鴉","鴈","鳫","鴃","鴆","鴪","鴦","鶯","鴣","鴟","鵄","鴕","鴒","鵁","鴿","鴾","鵆","鵈","鵝","鵞","鵤","鵑","鵐","鵙","鵲","鶉","鶇","鶫","鵯","鵺","鶚","鶤","鶩","鶲","鷄","鷁","鶻","鶸","鶺","鷆","鷏","鷂","鷙","鷓","鷸","鷦","鷭","鷯","鷽","鸚","鸛","鸞","鹵","鹹","鹽","麁","麈","麋","麌","麒","麕","麑","麝","麥","麩","麸","麪","麭","靡","黌","黎","黏","黐","黔","黜","點","黝","黠","黥","黨","黯","黴","黶","黷","黹","黻","黼","黽","鼇","鼈","皷","鼕","鼡","鼬","鼾","齊","齒","齔","齣","齟","齠","齡","齦","齧","齬","齪","齷","齲","齶","龕","龜","龠","堯","槇","遙","瑤","凜","熙","噓","巢","帔","帘","幘","幞","庾","廊","廋","廹","开","异","弇","弝","弣","弴","弶","弽","彀","彅","彔","彘","彤","彧","彽","徉","徜","徧","徯","徵","德","忉","忞","忡","忩","怍","怔","怘","怳","怵","恇","悔","悝","悞","惋","惔","惕","惝","惸","愜","愫","愰","愷","慨","憍","憎","憼","憹","懲","戢","戾","扃","扖","扚","扯","抅","拄","拖","拼","挊","挘","挹","捃","捥","捼","揥","揭","揵","搐","搔","搢","摹","摑","摠","摭","擎","撾","撿","㐂","𠅘","份","仿","侚","俉","傜","儞","冼","㔟","匇","卡","卬","詹","𠮷","呍","咖","咜","咩","唎","啊","噲","囤","圳","圴","塚","墀","姤","娣","婕","寬","﨑","㟢","庬","弴","彅","德","怗","恵","愰","昤","曈","曙","曺","曻","桒","鿄","椑","椻","橅","檑","櫛","𣏌","𣏾","𣗄","毱","泠","洮","海","涿","淊","淸","渚","潞","濹","灤","𤋮","𤋮","煇","燁","爀","玟","玨","珉","珖","琛","琡","琢","琦","琪","琬","琹","瑋","㻚","畵","疁","睲","䂓","磈","磠","祇","禮","鿆","䄃","鿅","秚","稞","筿","簱","䉤","綋","羡","脘","脺","舘","芮","葛","蓜","蓬","蕙","藎","蝕","蟬","蠋","裵","角","諶","跎","辻","迶","郝","鄧","鄭","醲","鈳","銈","錡","鍈","閒","雞","餃","饀","髙","鯖","鷗","麴","麵","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","⛌","⛍","❗","⛏","⛐","⛑","","⛒","⛕","⛓","⛔","","","","","","","","","⛖","⛗","⛘","⛙","⛚","⛛","⛜","⛝","⛞","⛟","⛠","⛡","⭕","㉈","㉉","㉊","㉋","㉌","㉍","㉎","㉏","","","","","⒑","⒒","⒓","","","","","","","","","","","","","","","","","⬛","⬤","","","","","","⚿","","","","","","","","","","","","㊙","","","","","","","","","","","","⛣","⭖","⭗","⭘","⭙","☓","㊋","〒","⛨","㉆","㉅","⛩","࿖","⛪","⛫","⛬","♨","⛭","⛮","⛯","⚓","✈","⛰","⛱","⛲","⛳","⛴","⛵","","Ⓓ","Ⓢ","⛶","","","","","","⛷","⛸","⛹","⛺","","☎","⛻","⛼","⛽","⛾","","⛿","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","➡","⬅","⬆","⬇","⬯","⬮","年","月","日","円","㎡","㎥","㎝","㎠","㎤","","⒈","⒉","⒊","⒋","⒌","⒍","⒎","⒏","⒐","","","","","","","","","","","","","","","","","㈳","㈶","㈲","㈱","㈹","㉄","▶","◀","〖","〗","⟐","²","³","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","㉇","","","℻","","","","㈪","㈫","㈬","㈭","㈮","㈯","㈰","㈷","㍾","㍽","㍼","㍻","№","℡","〶","⚾","","","","","","","","","","","","","","","","","","","","","","","ℓ","㎏","㎐","㏊","㎞","㎢","㍱","","","½","↉","⅓","⅔","¼","¾","⅕","⅖","⅗","⅘","⅙","⅚","⅐","⅛","⅑","⅒","☀","☁","☂","⛄","☖","☗","⛉","⛊","♦","♥","♣","♠","⛋","⨀","‼","⁉","⛅","☔","⛆","☃","⛇","⚡","⛈","","⚞","⚟","♬","☎","","","","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ","Ⅻ","⑰","⑱","⑲","⑳","⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","㉑","㉒","㉓","㉔","","","","","","","","","","","","","","","","","","","","","","","","","","","㉕","㉖","㉗","㉘","㉙","㉚","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","❶","❷","❸","❹","❺","❻","❼","❽","❾","❿","⓫","⓬","㉛",""],C=["㐂","","份","仿","侚","俉","傜","儞","冼","㔟","匇","卡","卬","詹","","呍","咖","咜","咩","唎","啊","噲","囤","圳","圴","塚","墀","姤","娣","婕","寬","﨑","㟢","庬","弴","彅","德","怗","恵","愰","昤","曈","曙","曺","曻","桒","鿄","椑","椻","橅","檑","櫛","","","","毱","泠","洮","海","涿","淊","淸","渚","潞","濹","灤","𤋮","","煇","燁","爀","玟","玨","珉","珖","琛","琡","琢","琦","琪","琬","琹","瑋","㻚","畵","疁","睲","䂓","磈","磠","祇","禮","鿆","䄃","鿅","秚","稞","筿","簱","䉤","綋","羡","脘","脺","舘","芮","葛","蓜","蓬","蕙","藎","蝕","蟬","蠋","裵","角","諶","跎","辻","迶","郝","鄧","鄭","醲","鈳","銈","錡","鍈","閒","雞","餃","饀","髙","鯖","鷗","麴","麵","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","⛌","⛍","❗","⛏","⛐","⛑","","⛒","⛕","⛓","⛔","","","","","","","","","⛖","⛗","⛘","⛙","⛚","⛛","⛜","⛝","⛞","⛟","⛠","⛡","⭕","㉈","㉉","㉊","㉋","㉌","㉍","㉎","㉏","","","","","⒑","⒒","⒓","","","","","","","","","","","","","","","","","⬛","⬤","","","","","","⚿","","","","","","","","","","","","㊙","","","","","","","","","","","","⛣","⭖","⭗","⭘","⭙","☓","㊋","〒","⛨","㉆","㉅","⛩","࿖","⛪","⛫","⛬","♨","⛭","⛮","⛯","⚓","✈","⛰","⛱","⛲","⛳","⛴","⛵","","Ⓓ","Ⓢ","⛶","","","","","","⛷","⛸","⛹","⛺","","☎","⛻","⛼","⛽","⛾","","⛿","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","➡","⬅","⬆","⬇","⬯","⬮","年","月","日","円","㎡","㎥","㎝","㎠","㎤","","⒈","⒉","⒊","⒋","⒌","⒍","⒎","⒏","⒐","","","","","","","","","","","","","","","","","㈳","㈶","㈲","㈱","㈹","㉄","▶","◀","〖","〗","⟐","²","³","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","㉇","","","℻","","","","㈪","㈫","㈬","㈭","㈮","㈯","㈰","㈷","㍾","㍽","㍼","㍻","№","℡","〶","⚾","","","","","","","","","","","","","","","","","","","","","","","ℓ","㎏","㎐","㏊","㎞","㎢","㍱","","","½","↉","⅓","⅔","¼","¾","⅕","⅖","⅗","⅘","⅙","⅚","⅐","⅛","⅑","⅒","☀","☁","☂","⛄","☖","☗","⛉","⛊","♦","♥","♣","♠","⛋","⨀","‼","⁉","⛅","☔","⛆","☃","⛇","⚡","⛈","","⚞","⚟","♬","☎","","","","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ","Ⅻ","⑰","⑱","⑲","⑳","⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","㉑","㉒","㉓","㉔","","","","","","","","","","","","","","","","","","","","","","","","","","","㉕","㉖","㉗","㉘","㉙","㉚","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","❶","❷","❸","❹","❺","❻","❼","❽","❾","❿","⓫","⓬","㉛",""],k=["㐂","𠅘","份","仿","侚","俉","傜","儞","冼","㔟","匇","卡","卬","詹","𠮷","呍","咖","咜","咩","唎","啊","噲","囤","圳","圴","塚","墀","姤","娣","婕","寬","﨑","㟢","庬","弴","彅","德","怗","恵","愰","昤","曈","曙","曺","曻","桒","鿄","椑","椻","橅","檑","櫛","𣏌","𣏾","𣗄","毱","泠","洮","海","涿","淊","淸","渚","潞","濹","灤","𤋮","𤋮","煇","燁","爀","玟","玨","珉","珖","琛","琡","琢","琦","琪","琬","琹","瑋","㻚","畵","疁","睲","䂓","磈","磠","祇","禮","鿆","䄃","鿅","秚","稞","筿","簱","䉤","綋","羡","脘","脺","舘","芮","葛","蓜","蓬","蕙","藎","蝕","蟬","蠋","裵","角","諶","跎","辻","迶","郝","鄧","鄭","醲","鈳","銈","錡","鍈","閒","雞","餃","饀","髙","鯖","鷗","麴","麵","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","⛌","⛍","❗","⛏","⛐","⛑","","⛒","⛕","⛓","⛔","","","","","🅿","🆊","","","⛖","⛗","⛘","⛙","⛚","⛛","⛜","⛝","⛞","⛟","⛠","⛡","⭕","㉈","㉉","㉊","㉋","㉌","㉍","㉎","㉏","","","","","⒑","⒒","⒓","🅊","🅌","🄿","🅆","🅋","🈐","🈑","🈒","🈓","🅂","🈔","🈕","🈖","🅍","🄱","🄽","⬛","⬤","🈗","🈘","🈙","🈚","🈛","⚿","🈜","🈝","🈞","🈟","🈠","🈡","🈢","🈣","🈤","🈥","🅎","㊙","🈀","","","","","","","","","","","⛣","⭖","⭗","⭘","⭙","☓","㊋","〒","⛨","㉆","㉅","⛩","࿖","⛪","⛫","⛬","♨","⛭","⛮","⛯","⚓","✈","⛰","⛱","⛲","⛳","⛴","⛵","🅗","Ⓓ","Ⓢ","⛶","🅟","🆋","🆍","🆌","🅹","⛷","⛸","⛹","⛺","🅻","☎","⛻","⛼","⛽","⛾","🅼","⛿","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","➡","⬅","⬆","⬇","⬯","⬮","年","月","日","円","㎡","㎥","㎝","㎠","㎤","🄀","⒈","⒉","⒊","⒋","⒌","⒍","⒎","⒏","⒐","","","","","","","🄁","🄂","🄃","🄄","🄅","🄆","🄇","🄈","🄉","🄊","㈳","㈶","㈲","㈱","㈹","㉄","▶","◀","〖","〗","⟐","²","³","🄭","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","🄬","🄫","㉇","🆐","🈦","℻","","","","㈪","㈫","㈬","㈭","㈮","㈯","㈰","㈷","㍾","㍽","㍼","㍻","№","℡","〶","⚾","🉀","🉁","🉂","🉃","🉄","🉅","🉆","🉇","🉈","🄪","🈧","🈨","🈩","🈔","🈪","🈫","🈬","🈭","🈮","🈯","🈰","🈱","ℓ","㎏","㎐","㏊","㎞","㎢","㍱","","","½","↉","⅓","⅔","¼","¾","⅕","⅖","⅗","⅘","⅙","⅚","⅐","⅛","⅑","⅒","☀","☁","☂","⛄","☖","☗","⛉","⛊","♦","♥","♣","♠","⛋","⨀","‼","⁉","⛅","☔","⛆","☃","⛇","⚡","⛈","","⚞","⚟","♬","☎","","","","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ","Ⅻ","⑰","⑱","⑲","⑳","⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","㉑","㉒","㉓","㉔","🄐","🄑","🄒","🄓","🄔","🄕","🄖","🄗","🄘","🄙","🄚","🄛","🄜","🄝","🄞","🄟","🄠","🄡","🄢","🄣","🄤","🄥","🄦","🄧","🄨","🄩","㉕","㉖","㉗","㉘","㉙","㉚","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","❶","❷","❸","❹","❺","❻","❼","❽","❾","❿","⓫","⓬","㉛",""],O=["！","＂","＃","＄","％","＆","＇","（","）","＊","＋","，","－","．","／","０","１","２","３","４","５","６","７","８","９","：","；","＜","＝","＞","？","＠","Ａ","Ｂ","Ｃ","Ｄ","Ｅ","Ｆ","Ｇ","Ｈ","Ｉ","Ｊ","Ｋ","Ｌ","Ｍ","Ｎ","Ｏ","Ｐ","Ｑ","Ｒ","Ｓ","Ｔ","Ｕ","Ｖ","Ｗ","Ｘ","Ｙ","Ｚ","［","￥","］","＾","＿","｀","ａ","ｂ","ｃ","ｄ","ｅ","ｆ","ｇ","ｈ","ｉ","ｊ","ｋ","ｌ","ｍ","ｎ","ｏ","ｐ","ｑ","ｒ","ｓ","ｔ","ｕ","ｖ","ｗ","ｘ","ｙ","ｚ","｛","｜","｝","～"],G=["ぁ","あ","ぃ","い","ぅ","う","ぇ","え","ぉ","お","か","が","き","ぎ","く","ぐ","け","げ","こ","ご","さ","ざ","し","じ","す","ず","せ","ぜ","そ","ぞ","た","だ","ち","ぢ","っ","つ","づ","て","で","と","ど","な","に","ぬ","ね","の","は","ば","ぱ","ひ","び","ぴ","ふ","ぶ","ぷ","へ","べ","ぺ","ほ","ぼ","ぽ","ま","み","む","め","も","ゃ","や","ゅ","ゆ","ょ","よ","ら","り","る","れ","ろ","ゎ","わ","ゐ","ゑ","を","ん","","","","ゝ","ゞ","ー","。","「","」","、","・"],B=["ァ","ア","ィ","イ","ゥ","ウ","ェ","エ","ォ","オ","カ","ガ","キ","ギ","ク","グ","ケ","ゲ","コ","ゴ","サ","ザ","シ","ジ","ス","ズ","セ","ゼ","ソ","ゾ","タ","ダ","チ","ヂ","ッ","ツ","ヅ","テ","デ","ト","ド","ナ","ニ","ヌ","ネ","ノ","ハ","バ","パ","ヒ","ビ","ピ","フ","ブ","プ","ヘ","ベ","ペ","ホ","ボ","ポ","マ","ミ","ム","メ","モ","ャ","ヤ","ュ","ユ","ョ","ヨ","ラ","リ","ル","レ","ロ","ヮ","ワ","ヰ","ヱ","ヲ","ン","ヴ","ヵ","ヶ","ヽ","ヾ","ー","。","「","」","、","・"],T=new Map([["022b6f43e2a414fd68f172da202bac9a","⚞"],["94fb7be756372db6b62e3e0a119083d5","⚞"],["12aecdea283e4d07f88b9f2b740e4f86","⚟"],["1a563501affbf7f5baec350a108d5505","⚟"],["556971570f40044fa4520df3289a1cf2","⚟"],["65b042886a563a771aa389b12af7bca7","⚟"],["bbda644d17efd3c020635ee3d90968a5","｟"],["5063561406195ca45f5992e3f7ad77d2","｟"],["9d15c0395a4738936af34308acf2d032","｟"],["2a063edc4770b3403f060b38166a0d4d","｟"],["54479aa90145b4713134b78d4fb98aa5","｟"],["12a2c7156da32fc972b5a451bb87b813","｟"],["c8d428ead557285b0b7088388b22519c","｟"],["7160f7419cba7acdacd23cbeb4834dbe","｟"],["3c49616fb9bf0b9052b30e118f8857ea","｟"],["71c94bb6d963e47443eac448a09d22ce","｟"],["7ec2179107ba4c58abb6ef92e7781365","｟"],["2eb49bd25d7eeada006afc0864350da4","｟"],["a341ee7fe8a368c9737a3341f016ac70","｟"],["f47048d669ac8d84eeb62477e8420f89","｟"],["38566b372f4c5a1aead4efa20decd079","｠"],["d84fc83615b75802ed422eda4ba39465","｠"],["5bb8b7731d9473ebd7c842334dfa24f2","｠"],["9ffa7e00cfc7e807a161ada460b8060c","｠"],["a58dc0e1271b03a5981b57a83271afa7","｠"],["e67210b0da0161d36b79e8c9be6a9d0c","｠"],["08de4be9569ebd6ac01709f552ae8a65","｠"],["e214599903c94c532684bdf54b62df61","｠"],["2a83209f8a7489081890c277397df425","｠"],["0294d50cea5197c8c4646d2cace3e78d","｠"],["0b808509e4d89a2b9d02252ca85f2e34","｠"],["2a74d4ad7292c858dc2bb559de67f2d9","｠"],["8c810b8cbe6159e837a88575bb4e6033","｠"],["dc66317cd6fff4f4221069a20f321fce","｠"],["563e1633d226c10ef4ec80638997e4a9","『"],["0993d5cdf910f481eeefa19e4f09d77c","『"],["7b80a8345c16e2d4f8ff2691e245c2b1","『"],["016669fa94786f9581342d47f317c02c","『"],["01d3eb52ab29f0eecc62ff74224fffd4","『"],["089aa1d87915ef8ad3c43982ac657c8c","『"],["30e8cb69cda3ad84e87943c4351c24b7","『"],["385927959c2621acf57f8d40140924f8","『"],["2c256506f406bac4c214318f196ad5db","『"],["2d3912e10113e5c7bef33df3249af4a7","『"],["8b6444be18f269ac615643b26f9e3041","『"],["9c8c1ff659b439f73c65cf4766ab2f14","『"],["e4caa1628ad6878f14be986761e06aaa","『"],["e702912587801d73d58cdb30e48debed","』"],["d70bb2b097f44c1ddefb93bf92bbb5cd","』"],["f2b927267947a75b891403f95db72005","』"],["4ec38a1d8d22e4df6c359f00f7ad8662","』"],["55c9ea9aa8eb630e5ecb793b2f85c927","』"],["70376e1ea05a3438a19c062ad49a7960","』"],["8fe7cb78ca24d1973419eecf99252a88","』"],["9ee59c7d2c202e0214836a0138f59e24","』"],["b56aaf7fc68c5e206ccbc2ee1442b3af","』"],["ba37f6b56d8fc8980c8236de9894fa61","』"],["cc9fde9238a2bf78fd1c13f65b098e77","』"],["f02e3e84dcd71c5d3bab2b7b4b99bd7e","』"],["f686e0b742abe806fccbd4d9b3fcc4cd","』"],["37f6ecf37a0a3ef8dff083ccc8754f81","♬"],["3336f18e849144658f212bd9399bec5f","♬"],["93efdc18683d8ecacb0a920d5f2fffb3","♬"],["9b8325b71aa6a000d24f88c4d7ec730d","♬"],["ab791ef796e6b5d66f13ed9aea3e8ab2","♬"],["6eb29f1917caea1cadf94f5496a4c374","↱"],["583134b86e7d90960f64c5b863196978","➡"],["4ba716a88c003ca0a069392be3b63951","➡"],["4e0fbe47e3ba0fd5949bda53f11b16a5","➡"],["61ec226a927ee80fffa12db219a43233","➡"],["8e5b873ac8e1bf84246b281b3548c2ff","↴"],["a78d9b65f46654601ce0145622164b47","↴"],["5d01e6804b9aaec0c276f77306888c54","↴"],["6168af1e81b6497fccb6b8d3226a8016","↴"],["4360c0b7364802b680f5a65fa415bdd6","↗"],["4dab788480bb9ac50d2454b58438e407","↗"],["bfb2d58ab8c469d2b8b5c42d81e4e3b7","↗"],["4c503a0873195bfe8d71c9d55669781b","→"],["caf36eff2cf3580cd66c5cd021ee4c09","→"],["f00be20caf0aaef3a6fbec90a0e71852","Ⅰ"],["e660e1e23a6ddc9a5d2e0e1ef7ac5b86","Ⅱ"],["a62583f621fb5405add08e8f0beb6db4","Ⅱ"],["0e761ebb18b9870383725b3712f5c8d4","Ⅱ"],["1f65debfbf9df96de52c6f80922b012b","Ⅱ"],["5c13facf2da9f38922a9419061771ed0","Ⅱ"],["75a65cc3171c4c7ca0141042846ab91a","Ⅱ"],["eae94a6301787ff7bf77786ae4424601","Ⅱ"],["f1add7809e18e064e4609783211c9815","Ⅲ"],["a7ee6f7f63d348e2b8fb7ee9503f3c5c","♡"],["9c8cfb5e9349b06f0939605638896f4e","♥"],["45ce7d6d5c779136d32d3e60e13e10cd","⅕"],["51f5fe58aaf460263b766e990fdbe979","⅕"],["db40b0a65939e462396822d5ab3c6d9c","⅕"],["d9e3a48d5a7c6ba6f8db18f56cf91f92","⅛"],["86586bcdf8f14883f846849e93ca274c","⅜"],["9d81f46e134081d56bc92f69eebfabd9","⅒"],["18dddb04a4fe9b3f5c7b79e68fb8ab4b","⅒"],["eff8659a150859b7b69682a023b283c1","⅒"],["6e5ccf08b2bc815b0923df83cf9fafa1","㎠"],["8a77e56517a074d3d2ba426b84a07bf4","㎠"],["2c381a0eab014487d50f6f8bae8f0b71","㎢"],["9d1a36a1bec1cd2b0b0765f93c1e4f3c","㎢"],["e03eb00c54de790d8cc9997527fde905","㎢"],["3bce2a06a6a8557082543a6c90a42fe0","〽"],["4898c7d9fe3a8a6f9859b0e6f85a4327","〽"],["98ab18764756c8ca7608e17f562b21ce","〽"],["3037aad230d8cdae3df6e0ebedc0db79","⁉"],["66e3474e6cbd8e817ba0a1f8920bf4e7","⁉"],["4360dd96063ce1a9660cc8437e8238e3","⁈"],["6ce68b7e389c5169309ee956ed0c98a8","⁈"],["737a19289d25d963e255f3692ded6536","⁈"],["14b18199bbc3f4bf65b72e316bc41d3c","！"],["6bf58c146b692aeb403ed1f7618a060a","！"],["7f12b67caaf7c8c5075b444bb2a16c70","！"],["bfd55f4031ad80cb7401d65937b1d5d9","〜"],["4a61f6f7da9e6c8e373f4112cbd453cf","〜"],["882ded8f0bb4cdfa4ce28a0b64056d2a","〜"],["7726ffbf3a6e953affe6353c24ffb085","〜"],["0e290ec6542b5d52c972775e3d7cfeaf","－"],["420f1d27972d7cc83929307fbbb6dd50","－"],["4aa0e459273a2fe3012d7b3d2e14e07e","－"],["030b487ae68da1f4da98046f4fed390f","一"],["21699fa18fd14735a312512dfea2bff4","一"],["559fc240f4efe5a1e64714ce09217a3e","一"],["b7352c3f33a77bc9d3fbf693efbb8095","一"],["fcdb30a244fb6aad5255ee2d32fdf7fc","一"],["15a0a0fb33aacd4ce730a9503c46df5f","㊙"],["9dad4982bd65fbf21525261a7efdf669","㊙"],["c3e68e6d08d5429e28ffd6592acf4519","ゔ"],["f022cfe594d6f6930d7a5b994e1a0b71","凜"],["407057c7b7b1a91d058d572d9a9d3aa5","凜"],["fc85b0622183795f89111219dfbc6281","凜"],["9707099e5828d97eb12ff2e6ba438558","凜"],["987c829b62eb31f467165827766c410d","凜"],["58371bb195aaa7a468c5c508351ac383","凜"],["32324012ed7274a15002b66ed1e464f8","蜻"],["0ffb731db8d4a6b711f97bbb08ed8819","蜻"],["d90aae9a752e9b61662a9cafa837961f","祓"],["23d6c6f231ac5d51f4cdaaaa26701956","祓"],["81cbedabd8f88d4494255b0631820dfd","祓"],["4185f93a5571e49433ca9c13ae588f96","魎"],["9ab74d6e8bda8723614017a7fce587fe","魎"],["e96a39a050b694e5f8aadb111420b698","𠮷"],["08c5eb5fac4f1d362b946689eb2e4edf","𠮷"],["2cef7e443c22f5835658e67749ae52d1","𠮷"],["4ab0dd1578c8c5fa25f45938ff0f8575","𠮷"],["4c392bb90a1f62796f8fba2c19b4a7de","𠮷"],["43856fd7c04a779e571fe24c47f02a6c","髙"],["265efc2a174c73ea229f9ffefa703f32","髙"],["5a7af09cce6b3005355e1c6c82df8858","髙"],["808e9b858294184933f8bf45d6291572","髙"],["27f0c69a76bf571d6dc25db389d20779","髙"],["46fb250f60436fd5f33808343893ca12","髙"],["8a8c4c67a6094d4dc6039e5fe931159c","髙"],["9257f3792fcfcd21b85524d5f86f624e","髙"],["d502a276d6f311449597ee9e576d9217","髙"],["eaa49075e50fbe1fa4b7f593dfd95620","髙"],["c01d2bafce469da1abbb612fdb16c1e3","元"],["e1ce03321fdb4eaca026a49a43e521a5","元"],["0cfa6c95283a90eff3733db1ac80f58a","元"],["52c1ad5b834821dc6b85ec27bdea1f76","元"],["ad088cffd260c1fccb655cae17b14803","元"],["a9ee52eaa5b4cc32d1891d540bfe93cc","塚"],["a00182f1de36aaee28cac80a3c89d067","塚"],["b03d44ca831a0c995116056ce23f82c5","塚"],["2d6b7d3b5ca6c02d94c5b48661045b7a","﨑"],["f5c6e02e235abd23a87f48ed6a64cdcc","﨑"],["e9a3b055bda7b9ae70bde4003a4c5885","﨑"],["cb17df533b4ebd698a038defeddecf8a","﨑"],["0ea39c05c35f96d5b5a48e9815974132","﨑"],["3f642f3778827e651c8b82a4e9f06fd3","﨑"],["447d8358f482a4e1d9495902ebe269b1","﨑"],["ca59a20f1e0ee55b74db34697f961385","﨑"],["d2eae5651260b39c4239bcf00c8a76c5","﨑"],["f55eb365a9ded45d1e620f83d9f9de26","﨑"],["2b385c2642704e44347f2f4db147c8fa","葛"],["5c3a8c3a891386a771ff8f00a239b4ba","葛"],["e8caa78518e2d690af54e2206c9538f8","彅"],["2e8659ae5e220240c5f8a97147d09df6","彅"],["7592e633260537c1dfa7e5af1000752a","彅"],["a57d3f7684c28d2a901fe6020145de32","彅"],["da3ab2d5da4d69c7d312c7d819e45856","彅"],["918e84ed41c2157aa5f5bbf9aa60514c","塡"],["b1e889986beb3a6518d8c2ea53547b7c","塡"],["d449ab392afa98c27eb817c40e2eb7ce","塡"],["e7158075f2976c353e4cf9247aae3abc","遁"],["f1a6fbb17f041cc15148163da34f541f","遁"],["a1779a3aaf215916fd0d8fbbb5bf5925","蟬"],["a3c09b57be535c0f5618d72f95884c50","蟬"],["4b9401a9f9a58c7d0f9c86120aa2dd23","鏢"],["fe00b640a48dd341573cafa94afeafa2","鏢"],["f4e1d8b42e3c49ea7c896049186d74bd","蟜"],["640130a634bd2a0f4347f933a8c5d6d6","蟜"],["62985aeebaec69314f03ff9d3080ada2","鷗"],["1bd027207977c585c5889a1e24cae94e","鷗"],["5c8022286d3bc941c12e9bbc475255dd","鷗"],["e4a837fe20dfa091e03afe4857e2482e","剝"],["bf2cccb40b985fe3af04281944beac1a","剝"],["d5451a035c4e516e5ccb9372cd533d81","剝"],["e13ae32f28d840df74a88432df9b122e","剝"],["41637d181cd99088e2120a4ec6fc18aa","嬴"],["de63abb1aaa44e6ab8a11470103377d5","嬴"],["3d32b12254e01c701c195412cb8ef37c","嬴"],["f67bc6318ccf43e7902df9a6f9622932","嬴"],["d4ce6847d78fc2f8241088b5c0be795c","嬴"],["c472e6ade04610e67904aca1b1fa1468","麃"],["db3d060943fbf888eb2fa7fd87340cba","麃"],["509cff0edcba46d5db30b2f2f45c49c9","瘣"],["4862270872e35184aab420c4d38169ad","瘣"],["def4d364d00d0f78577987eaebd42aef","齕"],["3cc113a87b49ce231a7b2ffbca4c1e18","齕"],["03dddff25be65f7c284ef8addb8a0a8b","驁"],["52aa815a5a57aff03085d31acd5afbc4","驁"],["4f0431c4c63a6a362646758e62521df8","煖"],["dbf1ab17c746c48d474b3730064ba6f2","煖"],["790c6b4da6a88f7f4fdb6fdab77fe045","煖"],["4d7ae77f2bbf9c8af03d49d466f74058","煖"],["0335ba124be8a9e0c501f4051ac5fcf5","龐"],["01d7892b430fd4362c8917ad921199b2","龐"],["e866fd7e605c8b7c8bf718c45a5438cf","龐"],["5df7d88e1e15018b3bce73e765ef72d6","槌"],["48478e1f69ea50c6f7709d47f15b4007","槌"],["4d7d276f23c92f94056b292e295ebd78","神"],["87d2b97034cf680cd86bc7fe7c500d93","神"],["f6300abbfcd6bd0db3abd41041499aaa","邂"],["26c476496eb73e15285527ab7c635f0b","邂"],["be33b9008a58bab485e17de9b2ab2626","逅"],["3a9b8b576fe8efca2dedc957732afa37","逅"],["b798637262a0c1a29c8de602d4b688c6","逅"],["a3785fd94f13646623554b180d08ac77","德"],["1f81885b0996be70410e5aa3e4aab3c6","德"],["88425dfcbd96fcb6d77ebb76f834d986","德"],["9f993f913cd0614a3a965d74e0f4c8d1","德"],["a8bb5f2f83d975edfc951a1e461befdc","德"],["cd2eadbb87d0aadf1d1cd71fed0ab02f","德"],["d22feeb00ace0a632e1a780682f937e8","德"],["c9f2fda15b722253c625aebe73f4b1d9","辻"],["04556b37bff1ccc2f3b395232e104934","辻"],["117bacaeb67e3508d23a650b98f3c143","辻"],["211d70374c1787c4bc62df15794a4692","辻"],["7ba50856c59d1de19cc9c88caaced915","辻"],["0d627ebf7693b13645336a88813fb7e3","祀"],["2c3c032660b20a485575c2d8c7d47956","祀"],["1aaec04e53f2978bdf0a127c01b34e9a","遼"],["e2c3bf09b755b0d59a8a25cba6dda273","遼"],["fb13879ba2f93a8b0a28b2cd5358d1ee","遼"],["20eff1fff8d986496b949efa604ec402","誾"],["8742940fcbdbd65aeff1566c1889ece7","誾"],["23e6ef0ecc7bbe8e9465b0b40e901c0d","厓"],["5a69785acb47d746fd1ae98bd511db81","厓"],["392b8afa18046fc06398b32a42641889","你"],["7ff2c821d31ef0ca7e9c430f3e659d46","你"],["44d8b7aacbfc1fc4c32d6526ab8012ee","祠"],["c9486b883ab870fc02e7a1f189454f49","祠"],["62e7447a02f797cf287a7a758d66563b","擲"],["7d767d2518431dd61e631941dea6bb5e","擲"],["914fa35485d5016adc8b799b0cb5e978","口"],["d50802fc331261feed1a140f3b70c4b3","口"],["eeff4833bdfc34b1cbfe6a9d98f38cb5","口"],["a6d6aaeaf5505676111390a52fa6be51","暲"],["bc534a1accc68d8876e9d47ad8d4b489","暲"],["b5e8cb114ccad281bcb4d86768d509df","銈"],["d2c0ab0242ae4ad8a08bffa71613a1a7","銈"],["f09031463933b2892be7ebbc501269d0","蕙"],["f1378529fe66a7f655031d7f5b8c4eb5","蕙"],["6b696a5ae7634c454aaa7dd833fdfaf9","眷"],["5012d099f110e5e7c0df78528686ae07","榮"],["bf27e95238dd789b05e38d56dc41cbf7","嵓"],["1d2eafa6be36dc6152cb1917cd2ac486","氏"],["8b1bd5636f709dfd6a95da9f463729c3","柀"],["0b49a77f459cf3783c5bac37a80518c5","份"],["8d1ba0e24b619cb4d377ddb7adb3e6fa","喼"],["dab4c329f3c540192f758a2e0008d275","鎚"],["5b6c90ad3012bfbbc2450b5ab930484d","翟"],["7eb78d5654f8335d0b1cf4cf78872097","鄭"],["c3852ea003683f2866abd56140fb5d84","錆"],["a78b8a79d8a32c925776c82955d168cc","郭"],["b6e773b060fdd575bc965369d509f4e0","煉"],["6d981a3b846347e2b3c9ca4d13794834","桒"],["d0ed8ffbc229f84dd796cdd6de36d2e4","䃯"],["d9aff359058ab474d552ce52e5a71ec8","卿"],["5417381484172c1607d7ca60765b62d2","蝕"],["b309cd2c649ce3ef6ea0ad2f5fc655cc","這"],["2a349ac3d6b94a8a64d904083fdd5c02","辿"],["0632283bfd909ef205b1f950e2b00f16","靑"],["d91c5a40619510b21610f523f9434269","淸"],["8dc47c6e65beb788da7ed9efd59f0934","買"],["e28d4c57d97fbe4a0d67aec2cc92e7c8","捥"],["9374173a2e4b7f1dcac75eccd5ee7e7f","榊"]]),L=(r(189),new Set(["⛌","⛍","❗","⛏","⛐","⛑","⛒","⛕","⛓","⛔","","","⛖","⛗","⛘","⛙","⛚","⛛","⛜","⛝","⛞","⛟","⛠","⛡","⭕","㉈","㉉","㉊","㉋","㉌","㉍","㉎","㉏","⒑","⒒","⒓","","","","","","","","","","","","","","","","","⬛","⬤","","","","","","⚿","","","","","","","","","","","","㊙","","⛣","⭖","⭗","⭘","⭙","☓","㊋","〒","⛨","㉆","㉅","⛩","࿖","⛪","⛫","⛬","♨","⛭","⛮","⛯","⚓","✈","⛰","⛱","⛲","⛳","⛴","⛵","","Ⓓ","Ⓢ","⛶","","","","","","⛷","⛸","⛹","⛺","","☎","⛻","⛼","⛽","⛾","","⛿","➡","⬅","⬆","⬇","⬯","⬮","","","","","㎡","㎥","㎝","㎠","㎤","","⒈","⒉","⒊","⒋","⒌","⒍","⒎","⒏","⒐","","","","","","","","","","","","","","","","","㈳","㈶","㈲","㈱","㈹","㉄","▶","◀","〖","〗","⟐","²","³","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","㉇","","","℻","㈪","㈫","㈬","㈭","㈮","㈯","㈰","㈷","㍾","㍽","㍼","㍻","№","℡","〶","⚾","","","","","","","","","","","","","","","","","","","","","","","ℓ","㎏","㎐","㏊","㎞","㎢","㍱","½","↉","⅓","⅔","¼","¾","⅕","⅖","⅗","⅘","⅙","⅚","⅐","⅛","⅑","⅒","☀","☁","☂","⛄","☖","☗","⛉","⛊","♦","♥","♣","♠","⛋","⨀","‼","⁉","⛅","☔","⛆","☃","⛇","⚡","⛈","⚞","⚟","♬","","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ","Ⅻ","⑰","⑱","⑲","⑳","⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","㉑","㉒","㉓","㉔","","","","","","","","","","","","","","","","","","","","","","","","","","","㉕","㉖","㉗","㉘","㉙","㉚","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","❶","❷","❸","❹","❺","❻","❼","❽","❾","❿","⓫","⓬","㉛","☎","⛌","⛍","❗","⛏","⛐","⛑","⛒","⛕","⛓","⛔","🅿","🆊","⛖","⛗","⛘","⛙","⛚","⛛","⛜","⛝","⛞","⛟","⛠","⛡","⭕","㉈","㉉","㉊","㉋","㉌","㉍","㉎","㉏","⒑","⒒","⒓","🅊","🅌","🄿","🅆","🅋","🈐","🈑","🈒","🈓","🅂","🈔","🈕","🈖","🅍","🄱","🄽","⬛","⬤","🈗","🈘","🈙","🈚","🈛","⚿","🈜","🈝","🈞","🈟","🈠","🈡","🈢","🈣","🈤","🈥","🅎","㊙","🈀","⛣","⭖","⭗","⭘","⭙","☓","㊋","⛨","㉆","㉅","⛩","࿖","⛪","⛫","⛬","⛭","⛮","⛯","⚓","✈","⛰","⛱","⛲","⛳","⛴","⛵","🅗","Ⓓ","Ⓢ","⛶","🅟","🆋","🆍","🆌","🅹","⛷","⛸","⛹","⛺","🅻","⛻","⛼","⛽","⛾","🅼","⛿","➡","⬅","⬆","⬇","⬯","⬮","㎥","㎠","㎤","🄀","⒈","⒉","⒊","⒋","⒌","⒍","⒎","⒏","⒐","🄁","🄂","🄃","🄄","🄅","🄆","🄇","🄈","🄉","🄊","㈳","㈶","㉄","⟐","🄭","🄬","🄫","㉇","🆐","🈦","℻","㈪","㈫","㈬","㈭","㈮","㈯","㈰","㈷","〶","⚾","🉀","🉁","🉂","🉃","🉄","🉅","🉆","🉇","🉈","🄪","🈧","🈨","🈩","🈔","🈪","🈫","🈬","🈭","🈮","🈯","🈰","🈱","㎐","㏊","㎢","㍱","↉","⅖","⅗","⅘","⅙","⅚","⅐","⅛","⅑","⅒","⛄","⛉","⛊","⛋","⨀","⛅","☔","⛆","⛇","⚡","⛈","⚞","⚟","⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","🄐","🄑","🄒","🄓","🄔","🄕","🄖","🄗","🄘","🄙","🄚","🄛","🄜","🄝","🄞","🄟","🄠","🄡","🄢","🄣","🄤","🄥","🄦","🄧","🄨","🄩"])),I=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],M=function(oe){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,H=arguments.length>2?arguments[2]:void 0;H==null&&(H=oe.length);for(var P=0,g=ge;g<H;g++)P=65535&(P<<8^I[255&(P>>8^oe[g])]);return P},K=function(oe,ge,H,P,g,N,Q,J){return 0|((ue=ge+oe(H,P,g)+N+Q|0)<<(de=J)|ue>>>32-de)+H;var ue,de},re=function(oe,ge,H){return oe&ge|~oe&H},ae=function(oe,ge,H){return oe&H|ge&~H},te=function(oe,ge,H){return oe^ge^H},ne=function(oe,ge,H){return ge^(oe|~H)},me=function(oe){var ge=15&oe;return"".concat(((240&oe)>>4).toString(16)).concat(ge.toString(16))},Ae=function(oe){var ge=64*Math.floor((oe.byteLength+8)/64+1),H=new Uint8Array(ge);H.set(new Uint8Array(oe),0);var P=new DataView(H.buffer);P.setUint8(oe.byteLength,128),P.setUint32(ge-8,8*oe.byteLength%Math.pow(2,32),!0),P.setUint32(ge-4,8*oe.byteLength/Math.pow(2,32),!0);for(var g=1732584193,N=-271733879,Q=-1732584194,J=271733878,ue=0;ue<ge;ue+=64){var de=g,Ce=N,Me=Q,Ge=J;g=K(re,g,N,Q,J,P.getUint32(ue+0,!0),3614090360,7),J=K(re,J,g,N,Q,P.getUint32(ue+4,!0),3905402710,12),Q=K(re,Q,J,g,N,P.getUint32(ue+8,!0),606105819,17),N=K(re,N,Q,J,g,P.getUint32(ue+12,!0),3250441966,22),g=K(re,g,N,Q,J,P.getUint32(ue+16,!0),4118548399,7),J=K(re,J,g,N,Q,P.getUint32(ue+20,!0),1200080426,12),Q=K(re,Q,J,g,N,P.getUint32(ue+24,!0),2821735955,17),N=K(re,N,Q,J,g,P.getUint32(ue+28,!0),4249261313,22),g=K(re,g,N,Q,J,P.getUint32(ue+32,!0),1770035416,7),J=K(re,J,g,N,Q,P.getUint32(ue+36,!0),2336552879,12),Q=K(re,Q,J,g,N,P.getUint32(ue+40,!0),4294925233,17),N=K(re,N,Q,J,g,P.getUint32(ue+44,!0),2304563134,22),g=K(re,g,N,Q,J,P.getUint32(ue+48,!0),1804603682,7),J=K(re,J,g,N,Q,P.getUint32(ue+52,!0),4254626195,12),Q=K(re,Q,J,g,N,P.getUint32(ue+56,!0),2792965006,17),N=K(re,N,Q,J,g,P.getUint32(ue+60,!0),1236535329,22),g=K(ae,g,N,Q,J,P.getUint32(ue+4,!0),4129170786,5),J=K(ae,J,g,N,Q,P.getUint32(ue+24,!0),3225465664,9),Q=K(ae,Q,J,g,N,P.getUint32(ue+44,!0),643717713,14),N=K(ae,N,Q,J,g,P.getUint32(ue+0,!0),3921069994,20),g=K(ae,g,N,Q,J,P.getUint32(ue+20,!0),3593408605,5),J=K(ae,J,g,N,Q,P.getUint32(ue+40,!0),38016083,9),Q=K(ae,Q,J,g,N,P.getUint32(ue+60,!0),3634488961,14),N=K(ae,N,Q,J,g,P.getUint32(ue+16,!0),3889429448,20),g=K(ae,g,N,Q,J,P.getUint32(ue+36,!0),568446438,5),J=K(ae,J,g,N,Q,P.getUint32(ue+56,!0),3275163606,9),Q=K(ae,Q,J,g,N,P.getUint32(ue+12,!0),4107603335,14),N=K(ae,N,Q,J,g,P.getUint32(ue+32,!0),1163531501,20),g=K(ae,g,N,Q,J,P.getUint32(ue+52,!0),2850285829,5),J=K(ae,J,g,N,Q,P.getUint32(ue+8,!0),4243563512,9),Q=K(ae,Q,J,g,N,P.getUint32(ue+28,!0),1735328473,14),N=K(ae,N,Q,J,g,P.getUint32(ue+48,!0),2368359562,20),g=K(te,g,N,Q,J,P.getUint32(ue+20,!0),4294588738,4),J=K(te,J,g,N,Q,P.getUint32(ue+32,!0),2272392833,11),Q=K(te,Q,J,g,N,P.getUint32(ue+44,!0),1839030562,16),N=K(te,N,Q,J,g,P.getUint32(ue+56,!0),4259657740,23),g=K(te,g,N,Q,J,P.getUint32(ue+4,!0),2763975236,4),J=K(te,J,g,N,Q,P.getUint32(ue+16,!0),1272893353,11),Q=K(te,Q,J,g,N,P.getUint32(ue+28,!0),4139469664,16),N=K(te,N,Q,J,g,P.getUint32(ue+40,!0),3200236656,23),g=K(te,g,N,Q,J,P.getUint32(ue+52,!0),681279174,4),J=K(te,J,g,N,Q,P.getUint32(ue+0,!0),3936430074,11),Q=K(te,Q,J,g,N,P.getUint32(ue+12,!0),3572445317,16),N=K(te,N,Q,J,g,P.getUint32(ue+24,!0),76029189,23),g=K(te,g,N,Q,J,P.getUint32(ue+36,!0),3654602809,4),J=K(te,J,g,N,Q,P.getUint32(ue+48,!0),3873151461,11),Q=K(te,Q,J,g,N,P.getUint32(ue+60,!0),530742520,16),N=K(te,N,Q,J,g,P.getUint32(ue+8,!0),3299628645,23),g=K(ne,g,N,Q,J,P.getUint32(ue+0,!0),4096336452,6),J=K(ne,J,g,N,Q,P.getUint32(ue+28,!0),1126891415,10),Q=K(ne,Q,J,g,N,P.getUint32(ue+56,!0),2878612391,15),N=K(ne,N,Q,J,g,P.getUint32(ue+20,!0),4237533241,21),g=K(ne,g,N,Q,J,P.getUint32(ue+48,!0),1700485571,6),J=K(ne,J,g,N,Q,P.getUint32(ue+12,!0),2399980690,10),Q=K(ne,Q,J,g,N,P.getUint32(ue+40,!0),4293915773,15),N=K(ne,N,Q,J,g,P.getUint32(ue+4,!0),2240044497,21),g=K(ne,g,N,Q,J,P.getUint32(ue+32,!0),1873313359,6),J=K(ne,J,g,N,Q,P.getUint32(ue+60,!0),4264355552,10),Q=K(ne,Q,J,g,N,P.getUint32(ue+24,!0),2734768916,15),N=K(ne,N,Q,J,g,P.getUint32(ue+52,!0),1309151649,21),g=K(ne,g,N,Q,J,P.getUint32(ue+16,!0),4149444226,6),J=K(ne,J,g,N,Q,P.getUint32(ue+44,!0),3174756917,10),Q=K(ne,Q,J,g,N,P.getUint32(ue+8,!0),718787259,15),N=K(ne,N,Q,J,g,P.getUint32(ue+36,!0),3951481745,21),g=de+g|0,N=Ce+N|0,Q=Me+Q|0,J=Ge+J|0}var Fe="";return Fe+=me((255&g)>>>0),Fe+=me((65280&g)>>>8),Fe+=me((16711680&g)>>>16),Fe+=me((4278190080&g)>>>24),Fe+=me((255&N)>>>0),Fe+=me((65280&N)>>>8),Fe+=me((16711680&N)>>>16),Fe+=me((4278190080&N)>>>24),Fe+=me((255&Q)>>>0),Fe+=me((65280&Q)>>>8),Fe+=me((16711680&Q)>>>16),Fe+=me((4278190080&Q)>>>24),Fe+=me((255&J)>>>0),Fe+=me((65280&J)>>>8),(Fe+=me((16711680&J)>>>16))+me((4278190080&J)>>>24)};function F(oe,ge){return function(H){if(Array.isArray(H))return H}(oe)||function(H,P){if(typeof Symbol<"u"&&Symbol.iterator in Object(H)){var g=[],N=!0,Q=!1,J=void 0;try{for(var ue,de=H[Symbol.iterator]();!(N=(ue=de.next()).done)&&(g.push(ue.value),!P||g.length!==P);N=!0);}catch(Ce){Q=!0,J=Ce}finally{try{N||de.return==null||de.return()}finally{if(Q)throw J}}return g}}(oe,ge)||function(H,P){if(H){if(typeof H=="string")return y(H,P);var g=Object.prototype.toString.call(H).slice(8,-1);return g==="Object"&&H.constructor&&(g=H.constructor.name),g==="Map"||g==="Set"?Array.from(H):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?y(H,P):void 0}}(oe,ge)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function y(oe,ge){(ge==null||ge>oe.length)&&(ge=oe.length);for(var H=0,P=new Array(ge);H<ge;H++)P[H]=oe[H];return P}function v(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var S=null,w=function(){function oe(g,N){(function(Q,J){if(!(Q instanceof J))throw new TypeError("Cannot call a class as a function")})(this,oe),this.option_canvas=null,this.render_canvas=null,this.render_text="",this.GL=0,this.GR=2,this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.DRCS_mapping=new Map([[15,new Map],[16,new Map],[17,new Map],[18,new Map],[19,new Map],[20,new Map],[21,new Map],[22,new Map],[23,new Map],[24,new Map],[25,new Map],[26,new Map],[27,new Map],[28,new Map],[29,new Map],[30,new Map]]),this.purpose_width=1920,this.purpose_height=1080,this.swf_x=1920,this.swf_y=1080,this.sdf_x=1920,this.sdf_y=1080,this.sdp_x=0,this.sdp_y=0,this.ssm_x=72,this.ssm_y=72,this.shs=8,this.svs=48,this.text_size_x=1,this.text_size_y=1,this.position_x=-1,this.position_y=-1,this.pallet=0,this.fg_color=A[this.pallet][7],this.bg_color=A[this.pallet][8],this.force_bg_color=null,this.hlc=0,this.stl=!1,this.orn=null,this.force_orn=null,this.non_spacing="",this.timeElapsed=0,this.endTime=null,this.rendered=!1,this.PRA=null,this.normalFont="sans-serif",this.gaijiFont=this.normalFont,this.drcsReplacement=!1,this.drcsReplaceMapping=new Map,this.useStroke=!1,this.usePUA=!1,this.pes=g,this.startTime=N}var ge,H,P;return ge=oe,P=[{key:"setEmbeddedGlyph",value:function(g){S=g}},{key:"detect",value:function(g,N){var Q,J,ue=(Q=N==null?void 0:N.data_identifier)!==null&&Q!==void 0?Q:128,de=(J=N==null?void 0:N.data_group_id)!==null&&J!==void 0?J:1;if(g.length<=0||g[0]!==ue||g.length<=2)return!1;var Ce=3+(15&g[2]);return!(g.length<=Ce||(15&(252&g[Ce+0])>>2)!==de||(M(g,Ce),0))}},{key:"getRGBAColorCode",value:function(g){if(g==null)return null;var N=document.createElement("canvas");N.width=N.height=1;var Q=N.getContext("2d");if(!Q)return null;Q.fillStyle=g,Q.fillRect(0,0,N.width,N.height);var J=F(Q.getImageData(0,0,1,1).data,4),ue=J[0],de=J[1],Ce=J[2],Me=J[3],Ge="#".concat(ue.toString(16).toUpperCase().padStart(2,"0")).concat(de.toString(16).toUpperCase().padStart(2,"0")).concat(Ce.toString(16).toUpperCase().padStart(2,"0")).concat(Me.toString(16).toUpperCase().padStart(2,"0"));return N.width=N.height=0,Ge}},{key:"fillAlphaColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16);return"#".concat(N.toString(16).toUpperCase().padStart(2,"0")).concat(Q.toString(16).toUpperCase().padStart(2,"0")).concat(J.toString(16).toUpperCase().padStart(2,"0"),"FF")}},{key:"getRGBAfromColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16),ue=Number.parseInt(g.substring(7,9),16);return"rgba(".concat(N,", ").concat(Q,", ").concat(J,", ").concat(ue/255,")")}}],(H=[{key:"initialize",value:function(){this.render_canvas=null,this.option_canvas=null,this.render_text="",this.GL=0,this.GR=2,this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.DRCS_mapping=new Map([[15,new Map],[16,new Map],[17,new Map],[18,new Map],[19,new Map],[20,new Map],[21,new Map],[22,new Map],[23,new Map],[24,new Map],[25,new Map],[26,new Map],[27,new Map],[28,new Map],[29,new Map],[30,new Map]]),this.purpose_width=1920,this.purpose_height=1080,this.swf_x=1920,this.swf_y=1080,this.sdf_x=1920,this.sdf_y=1080,this.sdp_x=0,this.sdp_y=0,this.ssm_x=72,this.ssm_y=72,this.shs=8,this.svs=48,this.text_size_x=1,this.text_size_y=1,this.position_x=-1,this.position_y=-1,this.pallet=0,this.fg_color=A[this.pallet][7],this.bg_color=A[this.pallet][8],this.force_bg_color=null,this.hlc=0,this.stl=!1,this.orn=null,this.force_orn=null,this.non_spacing="",this.timeElapsed=0,this.endTime=null,this.rendered=!1,this.PRA=null,this.normalFont="sans-serif",this.gaijiFont=this.normalFont,this.drcsReplacement=!1,this.drcsReplaceMapping=new Map,this.useStroke=!1,this.usePUA=!1}},{key:"width",value:function(){return Math.floor((this.shs+this.ssm_x)*this.text_size_x)}},{key:"height",value:function(){return Math.floor((this.svs+this.ssm_y)*this.text_size_y)}},{key:"width_magnification",value:function(){return Math.ceil(this.purpose_width/this.swf_x)}},{key:"height_magnification",value:function(){return Math.ceil(this.purpose_height/this.swf_y)}},{key:"canvas_width",value:function(){return this.swf_x*this.width_magnification()}},{key:"canvas_height",value:function(){return this.swf_y*this.height_magnification()}},{key:"move_absolute_dot",value:function(g,N){this.position_x=g,this.position_y=N}},{key:"move_absolute_pos",value:function(g,N){this.position_x=this.sdp_x+g*this.width(),this.position_y=this.sdp_y+(N+1)*this.height()}},{key:"move_relative_pos",value:function(g,N){for((this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs));g<0;)this.position_x-=this.width(),g++,this.position_x<this.sdp_x&&(this.position_x=this.sdp_x+this.sdf_x-this.width(),N--);for(;g>0;)this.position_x+=this.width(),g--,this.position_x>=this.sdp_x+this.sdf_x&&(this.position_x=this.sdp_x,N++);for(;N<0;)this.position_y-=this.height(),N++;for(;N>0;)this.position_y+=this.height(),N--}},{key:"move_newline",value:function(){(this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs)),this.position_x=this.sdp_x,this.position_y=this.position_y+this.height()}},{key:"render",value:function(g){var N,Q,J,ue,de,Ce,Me,Ge,Fe,Ye,ze,et,We,ct,it;this.initialize(),this.option_canvas=(N=g==null?void 0:g.canvas)!==null&&N!==void 0?N:null,this.force_orn=(Q=typeof(g==null?void 0:g.forceStrokeColor)=="boolean"?g==null?void 0:g.forceStrokeColor:oe.getRGBAColorCode(g==null?void 0:g.forceStrokeColor))!==null&&Q!==void 0?Q:null,this.force_bg_color=(J=oe.getRGBAColorCode(g==null?void 0:g.forceBackgroundColor))!==null&&J!==void 0?J:null,this.purpose_width=(ue=(de=g==null?void 0:g.width)!==null&&de!==void 0?de:g==null||(Ce=g.canvas)===null||Ce===void 0?void 0:Ce.width)!==null&&ue!==void 0?ue:this.purpose_width,this.purpose_height=(Me=(Ge=g==null?void 0:g.height)!==null&&Ge!==void 0?Ge:g==null||(Fe=g.canvas)===null||Fe===void 0?void 0:Fe.height)!==null&&Me!==void 0?Me:this.purpose_height,this.normalFont=(Ye=g==null?void 0:g.normalFont)!==null&&Ye!==void 0?Ye:"sans-serif",this.gaijiFont=(ze=g==null?void 0:g.gaijiFont)!==null&&ze!==void 0?ze:this.normalFont,this.drcsReplacement=(et=g==null?void 0:g.drcsReplacement)!==null&&et!==void 0&&et,this.drcsReplaceMapping=new Map(T);for(var xt,yt=Object.entries((xt=g==null?void 0:g.drcsReplaceMapping)!==null&&xt!==void 0?xt:{}),At=0;At<yt.length;At++){var wt=yt[At];this.drcsReplaceMapping.set(wt[0],wt[1])}if(this.useStroke=(We=g==null?void 0:g.useStroke)!==null&&We!==void 0&&We,this.usePUA=(ct=g==null?void 0:g.usePUA)!==null&&ct!==void 0&&ct,!oe.detect(this.pes,g))return null;for(var Et=3+(15&this.pes[2]),Ut=(this.pes[Et+0],(this.pes[Et+3]<<8)+this.pes[Et+4]),Ct=Et+9;Ct<Et+(5+Ut);){this.pes[Ct+0];var mt=this.pes[Ct+1],Qe=this.pes[Ct+2]<<16|this.pes[Ct+3]<<8|this.pes[Ct+4];mt===32?this.parseText(Ct+5,Ct+5+Qe):mt==48?this.parseDRCS(1,Ct+5,Ct+5+Qe):mt==49&&this.parseDRCS(2,Ct+5,Ct+5+Qe),Ct+=5+Qe}if(this.option_canvas){var bt=this.option_canvas.getContext("2d");if(bt&&(bt.clearRect(0,0,this.option_canvas.width,this.option_canvas.height),this.render_canvas))if(g!=null&&g.keepAspectRatio){var Ft=this.option_canvas.width/this.swf_x,Nt=this.option_canvas.height/this.swf_y,Bt=Math.min(Ft,Nt),Pt=this.swf_x*Bt,$t=this.swf_y*Bt,Xt=(this.option_canvas.width-Pt)/2,jt=(this.option_canvas.height-$t)/2;bt.drawImage(this.render_canvas,0,0,this.render_canvas.width,this.render_canvas.height,Xt,jt,Pt,$t)}else bt.drawImage(this.render_canvas,0,0,this.render_canvas.width,this.render_canvas.height,0,0,this.option_canvas.width,this.option_canvas.height)}return this.render_canvas&&(this.render_canvas.width=this.render_canvas.height=0,this.render_canvas=null),this.option_canvas=null,{startTime:this.startTime,endTime:(it=this.endTime)!==null&&it!==void 0?it:Number.POSITIVE_INFINITY,rendered:this.rendered,textContent:this.rendered?this.render_text:null,PRA:this.PRA}}},{key:"parseText",value:function(g,N){for(;g<N;)if(32<this.pes[g]&&this.pes[g]<127){var Q=0,J=this.G_BACK[this.GL];if(!J)return;for(var ue=0;ue<J.bytes;ue++)Q<<=8,Q|=127&this.pes[g+ue];this.renderCharacter(Q,J),g+=J.bytes}else if(160<this.pes[g]&&this.pes[g]<255){var de=0,Ce=this.G_BACK[this.GR];if(!Ce)return;for(var Me=0;Me<Ce.bytes;Me++)de<<=8,de|=127&this.pes[g+Me];this.renderCharacter(de,Ce),g+=Ce.bytes}else if(this.pes[g]===0)g+=1;else if(this.pes[g]===7)g+=1;else if(this.pes[g]===8)this.move_relative_pos(-1,0),g+=1;else if(this.pes[g]===9)this.move_relative_pos(1,0),g+=1;else if(this.pes[g]===10)this.move_relative_pos(0,1),g+=1;else if(this.pes[g]===11)this.move_relative_pos(0,-1),g+=1;else if(this.pes[g]===12)this.startTime!=null&&this.timeElapsed>0&&(this.endTime=this.startTime+this.timeElapsed),g+=1;else if(this.pes[g]===13)this.move_newline(),g+=1;else if(this.pes[g]===14)this.GL=1,g+=1;else if(this.pes[g]===15)this.GL=0,g+=1;else if(this.pes[g]===22){var Ge=63&this.pes[g+1];this.move_relative_pos(Ge,0),g+=2}else if(this.pes[g]===24)g+=1;else if(this.pes[g]===25){var Fe=0,Ye=this.G_BACK[2];if(!Ye)return;for(var ze=0;ze<Ye.bytes;ze++)Fe<<=8,Fe|=127&this.pes[g+1+ze];this.renderCharacter(Fe,Ye),g+=1+Ye.bytes}else if(this.pes[g]===27)if(this.pes[g+1]===110)this.GL=2,g+=2;else if(this.pes[g+1]==111)this.GL=3,g+=2;else if(this.pes[g+1]==126)this.GR=1,g+=2;else if(this.pes[g+1]==125)this.GR=2,g+=2;else if(this.pes[g+1]==124)this.GR=3,g+=2;else if(40<=this.pes[g+1]&&this.pes[g+1]<=43){var et=this.pes[g+1]-40;this.pes[g+2]===32?(this.G_BACK[et]=_.get(this.pes[g+3]),g+=4):(this.G_BACK[et]=m.get(this.pes[g+2]),g+=3)}else{if(this.pes[g+1]!==36)return;if(40<=this.pes[g+2]&&this.pes[g+2]<=43){var We=this.pes[g+2]-40;this.pes[g+3]===32?(this.G_BACK[We]=_.get(this.pes[g+4]),g+=5):(this.G_BACK[We]=m.get(this.pes[g+3]),g+=4)}else this.G_BACK[0]=m.get(this.pes[g+2]),g+=3}else if(this.pes[g]===28){var ct=63&this.pes[g+1],it=63&this.pes[g+2];this.move_absolute_pos(it,ct),g+=3}else if(this.pes[g]===29){var xt=0,yt=this.G_BACK[3];if(!yt)return;for(var At=0;At<yt.bytes;At++)xt<<=8,xt|=127&this.pes[g+1+At];this.renderCharacter(xt,yt),g+=1+yt.bytes}else if(this.pes[g]===30)g+=1;else if(this.pes[g]===31)g+=1;else if(this.pes[g]===32){var wt=u.get(0);if(!wt)return;this.renderCharacter(8481,wt),g+=1}else if(this.pes[g]===127)g+=1;else if(this.pes[g]===128)this.fg_color=A[this.pallet][0],g+=1;else if(this.pes[g]===129)this.fg_color=A[this.pallet][1],g+=1;else if(this.pes[g]===130)this.fg_color=A[this.pallet][2],g+=1;else if(this.pes[g]===131)this.fg_color=A[this.pallet][3],g+=1;else if(this.pes[g]===132)this.fg_color=A[this.pallet][4],g+=1;else if(this.pes[g]===133)this.fg_color=A[this.pallet][5],g+=1;else if(this.pes[g]===134)this.fg_color=A[this.pallet][6],g+=1;else if(this.pes[g]===135)this.fg_color=A[this.pallet][7],g+=1;else if(this.pes[g]===136)this.text_size_x=.5,this.text_size_y=.5,g+=1;else if(this.pes[g]===137)this.text_size_x=.5,this.text_size_y=1,g+=1;else if(this.pes[g]===138)this.text_size_x=1,this.text_size_y=1,g+=1;else{if(this.pes[g]===139)return;if(this.pes[g]===144){var Et=this.pes[g+1];if(Et==32){var Ut=15&this.pes[g+2];this.pallet=Ut,g+=3}else{var Ct=15&Et;(112&Et)==64?this.fg_color=A[this.pallet][Ct]:(112&Et)==80&&(this.bg_color=A[this.pallet][Ct]),g+=2}}else if(this.pes[g]===145)g+=2;else{if(this.pes[g]===146||this.pes[g]===147||this.pes[g]===148||this.pes[g]===149)return;if(this.pes[g]===151)this.hlc=15&this.pes[g+1],g+=2;else{if(this.pes[g]===152)return;if(this.pes[g]===153)this.stl=!1,g+=1;else if(this.pes[g]===154)this.stl=!0,g+=1;else if(this.pes[g]===155){for(var mt=g,Qe=-1,bt=-1;mt+1<N;)if(mt+=1,this.pes[mt]===32)Qe<0&&(Qe=mt);else if(this.pes[mt]===59)Qe<0&&bt<0&&(bt=mt);else{if(this.pes[mt]===66)break;if(this.pes[mt]===83){var Ft=g+1,Nt=0;if(bt>=0||Qe<0)return;for(;Ft<Qe;)Nt*=10,Nt+=15&this.pes[Ft],Ft++;if(Nt===5)this.swf_x=3840,this.swf_y=2160;else if(Nt===7)this.swf_x=1920,this.swf_y=1080;else{if(Nt!=9)return;this.swf_x=1440,this.swf_y=960}break}if(this.pes[mt]===84)break;if(this.pes[mt]===86){for(var Bt=g+1,Pt=0,$t=0;Bt<bt;)Pt*=10,Pt+=15&this.pes[Bt],Bt++;for(Bt++;Bt<Qe;)$t*=10,$t+=15&this.pes[Bt],Bt++;this.sdf_x=2*Pt,this.sdf_y=2*$t;break}if(this.pes[mt]===87){for(var Xt=g+1,jt=0,ei=0;Xt<bt;)jt*=10,jt+=15&this.pes[Xt],Xt++;for(Xt++;Xt<Qe;)ei*=10,ei+=15&this.pes[Xt],Xt++;this.ssm_x=2*jt,this.ssm_y=2*ei;break}if(this.pes[mt]===88){for(var ii=g+1,gi=0;ii<Qe;)gi*=10,gi+=15&this.pes[ii],ii++;this.shs=2*gi;break}if(this.pes[mt]===89){for(var vi=g+1,ni=0;vi<Qe;)ni*=10,ni+=15&this.pes[vi],vi++;this.svs=2*ni;break}if(this.pes[mt]===91||this.pes[mt]===92||this.pes[mt]===93||this.pes[mt]===94)break;if(this.pes[mt]===95){for(var ti=g+1,ri=0,ci=0;ti<bt;)ri*=10,ri+=15&this.pes[ti],ti++;for(ti++;ti<Qe;)ci*=10,ci+=15&this.pes[ti],ti++;this.sdp_x=2*ri,this.sdp_y=2*ci;break}if(this.pes[mt]===97){for(var ai=g+1,yi=0,si=0;ai<bt;)yi*=10,yi+=15&this.pes[ai],ai++;for(ai++;ai<Qe;)si*=10,si+=15&this.pes[ai],ai++;this.move_absolute_dot(2*yi,2*si);break}if(this.pes[mt]===98)break;if(this.pes[mt]===99){var ui=this.pes[g+1];if(ui==48)this.orn=null;else if(ui==49){var Jt=10*(15&this.pes[g+3])+(15&this.pes[g+4]),Bi=10*(15&this.pes[g+5])+(15&this.pes[g+6]);this.orn=A[Jt][Bi]}break}if(this.pes[mt]===100||this.pes[mt]===101||this.pes[mt]===102||this.pes[mt]===103)break;if(this.pes[mt]===104){for(var Wt=g+1,Mi=0;Wt<Qe;)Mi*=10,Mi+=15&this.pes[Wt],Wt++;this.PRA=Mi;break}if(this.pes[mt]===105||this.pes[mt]===106||this.pes[mt]===110||this.pes[mt]===111)break}g=mt+1}else{if(this.pes[g]!==157)return;if(this.pes[g+1]!=32)return void this.pes[g+1];var Ji=63&this.pes[g+2];this.timeElapsed+=Ji/10,g+=3}}}}}},{key:"parseDRCS",value:function(g,N,Q){for(this.pes[N+0],N+=1;N<Q;){var J=this.pes[N+0]<<8|this.pes[N+1],ue=this.pes[N+2];N+=3;for(var de=0;de<ue;de++){this.pes[N+0];var Ce=15&this.pes[N+0];if(Ce===0||Ce===1){var Me=this.pes[N+1]+2,Ge=this.pes[N+2],Fe=this.pes[N+3],Ye=Me.toString(2).length-Me.toString(2).replace(/0*$/,"").length,ze=Math.floor(Ge*Fe*Ye/8),et=new Uint8Array(Array.prototype.slice.call(this.pes,N+4,N+4+ze));if(g===1){var We,ct,it=64+((3840&J)>>8),xt=127&J,yt=(We=_.get(it))===null||We===void 0?void 0:We.alphabet;yt&&((ct=this.DRCS_mapping.get(yt))===null||ct===void 0||ct.set(xt,et))}else{var At,wt=32639&J;(At=this.DRCS_mapping.get(15))===null||At===void 0||At.set(wt,et)}N+=4+ze}}}}},{key:"renderCharacter",value:function(g,N){var Q;if((this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs)),this.option_canvas){this.option_canvas&&!this.render_canvas&&(this.render_canvas=document.createElement("canvas"),this.render_canvas.width=this.canvas_width(),this.render_canvas.height=this.canvas_height());var J=(Q=this.render_canvas)===null||Q===void 0?void 0:Q.getContext("2d");if(J){if(N.alphabet===0){var ue=((65280&g)>>8)-33,de=(255&g)-33;if(ue===0&&12<=de&&de<=17)return void(this.non_spacing=["́","　","̈","̂","̅","̲"][de-12]);if(ue===1&&de===93)return void(this.non_spacing+="⃝")}var Ce;if(N.alphabet!==31&&(this.rendered=!0,J.fillStyle=oe.getRGBAfromColorCode((Ce=this.force_bg_color)!==null&&Ce!==void 0?Ce:this.bg_color),J.fillRect(this.position_x*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),this.width()*this.width_magnification(),this.height()*this.height_magnification()),1&this.hlc&&(J.fillStyle=oe.getRGBAfromColorCode(this.fg_color),J.fillRect(this.position_x*this.width_magnification(),(this.position_y-1)*this.height_magnification(),this.width()*this.width_magnification(),1*this.height_magnification())),2&this.hlc&&(J.fillStyle=oe.getRGBAfromColorCode(this.fg_color),J.fillRect((this.position_x+this.width()-1)*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),1*this.width_magnification(),this.height()*this.height_magnification())),4&this.hlc&&(J.fillStyle=oe.getRGBAfromColorCode(this.fg_color),J.fillRect(this.position_x*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),this.width()*this.width_magnification(),1*this.height_magnification())),8&this.hlc&&(J.fillStyle=oe.getRGBAfromColorCode(this.fg_color),J.fillRect(this.position_x*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),1*this.width_magnification(),this.height()*this.height_magnification())),this.stl&&(J.fillStyle=oe.getRGBAfromColorCode(this.fg_color),J.fillRect(this.position_x*this.width_magnification(),(this.position_y-1)*this.height_magnification(),this.width()*this.width_magnification(),1*this.height_magnification()))),N.alphabet===0){var Me=94*(((65280&g)>>8)-33)+((255&g)-33),Ge=7896;if(Me<Ge){var Fe=E[Me];this.renderFont(Fe)}else if(this.usePUA){var Ye=C[Me-Ge];this.renderFont(Ye)}else{var ze=k[Me-Ge];this.renderFont(ze)}this.move_relative_pos(1,0)}else if(N.alphabet===1){var et=O[g-33];this.renderFont(et),this.move_relative_pos(1,0)}else if(N.alphabet===2){var We=G[g-33];this.renderFont(We),this.move_relative_pos(1,0)}else if(N.alphabet===3){var ct=B[g-33];this.renderFont(ct),this.move_relative_pos(1,0)}else{if(N.alphabet===31)return void(g===96?(this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===97?(this.G_BACK=[u.get(0),u.get(3),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===98?(this.G_BACK=[u.get(0),p.get(16),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===99?(this.G_BACK=[u.get(4),u.get(6),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===100?(this.G_BACK=[u.get(4),u.get(5),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===101?(this.G_BACK=[u.get(4),p.get(16),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===102?(this.G_BACK=[p.get(16),p.get(17),p.get(18),p.get(31)],this.GL=0,this.GR=2):g===103?(this.G_BACK=[p.get(19),p.get(20),p.get(21),p.get(31)],this.GL=0,this.GR=2):g===104?(this.G_BACK=[p.get(22),p.get(23),p.get(24),p.get(31)],this.GL=0,this.GR=2):g===105?(this.G_BACK=[p.get(25),p.get(26),p.get(27),p.get(31)],this.GL=0,this.GR=2):g===106?(this.G_BACK=[p.get(28),p.get(29),p.get(30),p.get(31)],this.GL=0,this.GR=2):g===107?(this.G_BACK=[u.get(0),p.get(17),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===108?(this.G_BACK=[u.get(0),p.get(18),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===109?(this.G_BACK=[u.get(0),p.get(19),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===110?(this.G_BACK=[u.get(3),u.get(2),u.get(1),p.get(31)],this.GL=0,this.GR=2):g===111&&(this.G_BACK=[u.get(1),u.get(4),p.get(16),p.get(31)],this.GL=0,this.GR=2));var it,xt=(it=this.DRCS_mapping.get(N.alphabet))===null||it===void 0?void 0:it.get(32639&g);if(!xt)return;var yt=Ae(xt.buffer);if(this.drcsReplacement&&this.drcsReplaceMapping.has(yt.toLowerCase()))this.renderFont(this.drcsReplaceMapping.get(yt.toLowerCase()));else if(this.drcsReplacement&&this.drcsReplaceMapping.has(yt.toUpperCase()))this.renderFont(this.drcsReplaceMapping.get(yt.toUpperCase()));else{var At=Math.floor(this.ssm_x*this.text_size_x/2),wt=Math.floor(this.ssm_y*this.text_size_y/2),Et=Math.floor(8*xt.length/(At*wt)),Ut=this.getOrnColorCode();if(Ut&&(!this.force_orn||this.force_orn===!0||this.force_orn!==this.fg_color)){J.fillStyle=oe.getRGBAfromColorCode(Ut);for(var Ct=-2*this.height_magnification();Ct<=2*this.height_magnification();Ct++)for(var mt=-2*this.width_magnification();mt<=2*this.width_magnification();mt++)for(var Qe=0;Qe<wt;Qe++)for(var bt=0;bt<At;bt++){for(var Ft=0,Nt=0;Nt<Et;Nt++){var Bt=7-((Qe*At+bt)*Et+Nt)%8;Ft*=2,Ft+=(xt[Math.floor(((Qe*At+bt)*Et+Nt)/8)]&1<<Bt)>>Bt}Ft>0&&J.fillRect((this.position_x-0+Math.floor(this.shs*this.text_size_x/2)+2*bt)*this.width_magnification()+2*mt,(this.position_y-this.height()+Math.floor(this.svs*this.text_size_y/2)+2*Qe)*this.height_magnification()+2*Ct,2*this.width_magnification(),2*this.height_magnification())}}J.fillStyle=oe.getRGBAfromColorCode(this.fg_color);for(var Pt=0;Pt<wt;Pt++)for(var $t=0;$t<At;$t++){for(var Xt=0,jt=0;jt<Et;jt++){var ei=7-((Pt*At+$t)*Et+jt)%8;Xt*=2,Xt+=(xt[Math.floor(((Pt*At+$t)*Et+jt)/8)]&1<<ei)>>ei}Xt>0&&J.fillRect((this.position_x-0+Math.floor(this.shs*this.text_size_x/2)+2*$t)*this.width_magnification(),(this.position_y-this.height()+Math.floor(this.svs*this.text_size_y/2)+2*Pt)*this.height_magnification(),2*this.width_magnification(),2*this.height_magnification())}}this.move_relative_pos(1,0)}}}}},{key:"renderFont",value:function(g){var N;if(g+=this.non_spacing,this.non_spacing="",this.text_size_x===.5&&this.text_size_y===.5&&(G.includes(g)||B.includes(g))||(this.render_text+=g),this.render_canvas)if(S!=null&&S.has(g)){var Q=S.get(g),J=Q.viewBox,ue=Q.path;this.renderPath(J,ue)}else{var de=L.has(g);de&&(g+="︎");var Ce=(N=this.render_canvas)===null||N===void 0?void 0:N.getContext("2d");if(Ce){var Me=(this.position_x+this.width()/2)*this.width_magnification(),Ge=(this.position_y-this.height()/2)*this.height_magnification();Ce.translate(Me,Ge),Ce.scale(this.text_size_x*this.width_magnification(),this.text_size_y*this.height_magnification());var Fe=this.getOrnColorCode();if(Fe&&(!this.force_orn||this.force_orn===!0||this.force_orn!==this.fg_color))if(this.useStroke)Ce.font="".concat(this.ssm_x,"px ").concat(de?this.gaijiFont:this.normalFont),Ce.strokeStyle=oe.getRGBAfromColorCode(Fe),Ce.lineJoin="round",Ce.textBaseline="middle",Ce.textAlign="center",Ce.lineWidth=8,Ce.strokeText(g,0,0);else{Ce.setTransform(1,0,0,1,0,0),Ce.translate(Me,Ge),Ce.scale(this.text_size_x,this.text_size_y*this.height_magnification()/this.width_magnification());for(var Ye=-4*this.width_magnification();Ye<=4*this.width_magnification();Ye++)for(var ze=-4*this.width_magnification();ze<=4*this.width_magnification();ze++)Ce.font="".concat(this.ssm_x*this.width_magnification(),"px ").concat(de?this.gaijiFont:this.normalFont),Ce.fillStyle=oe.getRGBAfromColorCode(Fe),Ce.textBaseline="middle",Ce.textAlign="center",Ce.fillText(g,0+ze,0+Ye);Ce.setTransform(1,0,0,1,0,0),Ce.translate(Me,Ge),Ce.scale(this.text_size_x*this.width_magnification(),this.text_size_y*this.height_magnification())}Ce.font="".concat(this.ssm_x,"px ").concat(de?this.gaijiFont:this.normalFont),Ce.fillStyle=oe.getRGBAfromColorCode(this.fg_color),Ce.textBaseline="middle",Ce.textAlign="center",Ce.fillText(g,0,0),Ce.setTransform(1,0,0,1,0,0)}}}},{key:"renderPath",value:function(g,N){var Q;if(this.render_canvas){var J=(Q=this.render_canvas)===null||Q===void 0?void 0:Q.getContext("2d");if(J){var ue=(this.position_x+this.shs/2)*this.width_magnification(),de=(this.position_y-this.height()+this.svs/2)*this.height_magnification();J.translate(ue,de);var Ce=F(g,4),Me=Ce[0],Ge=Ce[1],Fe=Ce[2]-Me,Ye=Ce[3]-Ge;J.scale(this.ssm_y/Fe,this.ssm_y/Ye),J.translate(Me,Ge);var ze=this.getOrnColorCode();if(ze&&(!this.force_orn||this.force_orn===!0||this.force_orn!==this.fg_color))if(this.useStroke)J.strokeStyle=oe.getRGBAfromColorCode(ze),J.lineJoin="round",J.lineWidth=4*Math.max(Fe/this.ssm_y,Ye/this.ssm_y)*2,J.stroke(new Path2D(N));else for(var et=-4*this.width_magnification();et<=4*this.width_magnification();et++)for(var We=-4*this.width_magnification();We<=4*this.width_magnification();We++)J.translate(We,et),J.fillStyle=oe.getRGBAfromColorCode(ze),J.fill(new Path2D(N)),J.translate(-We,-et);J.fillStyle=oe.getRGBAfromColorCode(this.fg_color),J.fill(new Path2D(N)),J.setTransform(1,0,0,1,0,0)}}}},{key:"getOrnColorCode",value:function(){return this.force_orn===!0?oe.fillAlphaColorCode(this.bg_color):this.force_orn===!1?this.orn:(g=this.force_orn)!==null&&g!==void 0?g:this.orn;var g}}])&&v(ge.prototype,H),P&&v(ge,P),oe}();function x(oe){return(x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ge){return typeof ge}:function(ge){return ge&&typeof Symbol=="function"&&ge.constructor===Symbol&&ge!==Symbol.prototype?"symbol":typeof ge})(oe)}function D(oe,ge){(ge==null||ge>oe.length)&&(ge=oe.length);for(var H=0,P=new Array(ge);H<ge;H++)P[H]=oe[H];return P}function U(oe,ge){if(!(oe instanceof ge))throw new TypeError("Cannot call a class as a function")}function j(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}function X(oe,ge,H){return ge&&j(oe.prototype,ge),oe}function ee(oe,ge){return!ge||x(ge)!=="object"&&typeof ge!="function"?function(H){if(H===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return H}(oe):ge}function ie(oe){var ge=typeof Map=="function"?new Map:void 0;return(ie=function(H){if(H===null||(P=H,Function.toString.call(P).indexOf("[native code]")===-1))return H;var P;if(typeof H!="function")throw new TypeError("Super expression must either be null or a function");if(ge!==void 0){if(ge.has(H))return ge.get(H);ge.set(H,g)}function g(){return be(H,arguments,He(this).constructor)}return g.prototype=Object.create(H.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),Oe(g,H)})(oe)}function be(oe,ge,H){return(be=Te()?Reflect.construct:function(P,g,N){var Q=[null];Q.push.apply(Q,g);var J=new(Function.bind.apply(P,Q));return N&&Oe(J,N.prototype),J}).apply(null,arguments)}function Te(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Oe(oe,ge){return(Oe=Object.setPrototypeOf||function(H,P){return H.__proto__=P,H})(oe,ge)}function He(oe){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(ge){return ge.__proto__||Object.getPrototypeOf(ge)})(oe)}r(7327),r(9826),r(4553),r(9554),r(2707),r(561),r(489),r(8304),r(4747);var st=function(oe){(function(N,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");N.prototype=Object.create(Q&&Q.prototype,{constructor:{value:N,writable:!0,configurable:!0}}),Q&&Oe(N,Q)})(g,oe);var ge,H,P=(ge=g,H=Te(),function(){var N,Q=He(ge);if(H){var J=He(this).constructor;N=Reflect.construct(Q,arguments,J)}else N=Q.apply(this,arguments);return ee(this,N)});function g(){return U(this,g),P.apply(this,arguments)}return X(g,[{key:"addCue",value:function(N){this.push(N)}},{key:"removeCue",value:function(N){var Q=this.findIndex(function(J){return J===N});Q<0||this.splice(Q,1)}},{key:"getCueById",value:function(N){var Q;return(Q=this.find(function(J){return J.id===N}))!==null&&Q!==void 0?Q:null}}]),g}(ie(Array)),Le=function(){function oe(ge){U(this,oe),this.all=new st,this.active=new st,this.polling_handler=this.polling.bind(this),this.polling_id=null,this.cues=this.all,this.oncuechange=null,this.id="",this.kind="metadata",this.label="",this.language="ja-JP",this.mode="hidden",this.inBandMetadataTrackDispatchType="",this.sourceBuffer=null,this.listeners=[],this.media=ge}return X(oe,[{key:"startPolling",value:function(){this.polling_id=window.requestAnimationFrame(this.polling_handler)}},{key:"stopPolling",value:function(){this.polling_id!=null&&(window.cancelAnimationFrame(this.polling_id),this.polling_id=null)}},{key:"polling",value:function(){var ge=this.active,H=this.activeCues;if(ge.length!==H.length){var P=null;try{P=new CustomEvent("cuechange")}catch{(P=document.createEvent("CustomEvent")).initCustomEvent("cuechange",!1,!1,{})}P!=null&&(this.dispatchEvent(P),this.oncuechange&&this.oncuechange.call(this,P))}else for(var g=0;g<H.length;g++)if(ge[g]!==H[g]){var N=null;try{N=new CustomEvent("cuechange")}catch{(N=document.createEvent("CustomEvent")).initCustomEvent("cuechange",!1,!1,{})}if(N!=null){this.dispatchEvent(N),this.oncuechange&&this.oncuechange.call(this,N);break}}this.polling_id=window.requestAnimationFrame(this.polling_handler)}},{key:"getCueById",value:function(ge){return this.all.getCueById(ge)}},{key:"addCue",value:function(ge){this.all.addCue(ge)}},{key:"removeCue",value:function(ge){this.all.removeCue(ge)}},{key:"addEventListener",value:function(ge,H){this.listeners.push(H)}},{key:"removeEventListener",value:function(ge,H){var P=this.listeners.findIndex(function(g){return g===H});P<0||this.listeners.splice(P,1)}},{key:"dispatchEvent",value:function(ge){var H=this;return ge.type!=="cuechange"||this.listeners.forEach(function(P){return P.call(H,ge)}),!0}},{key:"activeCues",get:function(){var ge,H=this,P=be(st,function(g){if(Array.isArray(g))return D(g)}(ge=this.all.filter(function(g){return g.startTime<=H.media.currentTime&&H.media.currentTime<=g.endTime}))||function(g){if(typeof Symbol<"u"&&Symbol.iterator in Object(g))return Array.from(g)}(ge)||function(g,N){if(g){if(typeof g=="string")return D(g,N);var Q=Object.prototype.toString.call(g).slice(8,-1);return Q==="Object"&&g.constructor&&(Q=g.constructor.name),Q==="Map"||Q==="Set"?Array.from(g):Q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q)?D(g,N):void 0}}(ge)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());return P.sort(function(g,N){return g.startTime===N.startTime?-(g.endTime-N.endTime):g.startTime-N.startTime}),this.active=P,this.active}}]),oe}();function rt(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var tt=function(){function oe(H,P){(function(g,N){if(!(g instanceof N))throw new TypeError("Cannot call a class as a function")})(this,oe),this.id="",this.pauseOnExit=!1,this.onenter=null,this.onexit=null,this.track=null,this.startTime=H,this.endTime=P}var ge;return(ge=[{key:"addEventListener",value:function(H,P,g){}},{key:"removeEventListener",value:function(H,P,g){}},{key:"dispatchEvent",value:function(H){return!1}}])&&rt(oe.prototype,ge),oe}();function Ee(oe,ge,H){for(var P=0,g=ge;g<H;g++)P<<=7,P|=127&oe[g];return P}function ft(oe,ge,H){for(var P="",g=ge;g<H;g++)P+="%".concat(oe[g].toString(16).padStart(2,"0"));return P}function pt(oe,ge,H){if(window.TextDecoder){var P=new TextDecoder("utf-8"),g=new Uint8Array(Array.prototype.slice.call(oe,ge,H));return P.decode(g)}return window.decodeURIComponent(ft(oe,ge,H))}function Ze(oe,ge,H){if(window.TextDecoder){var P=new TextDecoder("iso-8859-1"),g=new Uint8Array(Array.prototype.slice.call(oe,ge,H));return P.decode(g)}return window.unescape(ft(oe,ge,H))}function je(oe){for(var ge=window.atob(oe),H=new Uint8Array(ge.length),P=0;P<ge.length;P++)H[P]=ge.charCodeAt(P);return H}function he(oe,ge){var H=Object.keys(oe);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(oe);ge&&(P=P.filter(function(g){return Object.getOwnPropertyDescriptor(oe,g).enumerable})),H.push.apply(H,P)}return H}function _e(oe){for(var ge=1;ge<arguments.length;ge++){var H=arguments[ge]!=null?arguments[ge]:{};ge%2?he(Object(H),!0).forEach(function(P){Ne(oe,P,H[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(oe,Object.getOwnPropertyDescriptors(H)):he(Object(H)).forEach(function(P){Object.defineProperty(oe,P,Object.getOwnPropertyDescriptor(H,P))})}return oe}function Ne(oe,ge,H){return ge in oe?Object.defineProperty(oe,ge,{value:H,enumerable:!0,configurable:!0,writable:!0}):oe[ge]=H,oe}function fe(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var Je=function(){function oe(H){var P,g,N,Q,J;(function(ue,de){if(!(ue instanceof de))throw new TypeError("Cannot call a class as a function")})(this,oe),this.media=null,this.id3Track=null,this.b24Track=null,this.subtitleElement=null,this.viewCanvas=null,this.rawCanvas=null,this.textContent=null,this.resizeObserver=null,this.mutationObserver=null,this.prevCurrentTime=null,this.highResTimeupdatePollingId=null,this.isShowing=!0,this.isOnSeeking=!1,this.onB24CueChangeDrawed=!1,this.onID3AddtrackHandler=this.onID3Addtrack.bind(this),this.onID3CueChangeHandler=this.onID3CueChange.bind(this),this.onB24CueChangeHandler=this.onB24CueChange.bind(this),this.onHighResTimeupdateHandler=this.onHighResTimeupdate.bind(this),this.onTimeupdateHandler=this.onTimeupdate.bind(this),this.onCanplayHandler=this.onCanplay.bind(this),this.onPlayHandler=this.onPlay.bind(this),this.onPauseHandler=this.onPause.bind(this),this.onSeekingHandler=this.onSeeking.bind(this),this.onSeekedHandler=this.onSeeked.bind(this),this.onResizeHandler=this.onResize.bind(this),this.data_identifier=(P=H==null?void 0:H.data_identifier)!==null&&P!==void 0?P:128,this.data_group_id=(g=H==null?void 0:H.data_group_id)!==null&&g!==void 0?g:1,this.rendererOption=_e(_e({},H),{},{data_identifier:this.data_identifier,data_group_id:this.data_group_id,keepAspectRatio:(N=H==null?void 0:H.keepAspectRatio)===null||N===void 0||N,enableAutoInBandMetadataTextTrackDetection:(Q=H==null?void 0:H.enableAutoInBandMetadataTextTrackDetection)===null||Q===void 0||Q,useStroke:(J=H==null?void 0:H.useStroke)===null||J===void 0||J})}var ge;return(ge=[{key:"attachMedia",value:function(H,P){var g;this.detachMedia(),this.media=H,this.subtitleElement=P??H.parentElement,this.media.addEventListener("canplay",this.onCanplayHandler),(g=this.rendererOption)!==null&&g!==void 0&&g.useHighResTimeupdate?(this.media.addEventListener("play",this.onPlayHandler),this.media.addEventListener("pause",this.onPauseHandler)):this.media.addEventListener("timeupdate",this.onTimeupdateHandler),this.prevCurrentTime=null,this.setupTrack(),this.setupCanvas()}},{key:"detachMedia",value:function(){var H,P,g,N;this.cleanupCanvas(),this.cleanupTrack(),(H=this.media)===null||H===void 0||H.removeEventListener("canplay",this.onCanplayHandler),(P=this.media)===null||P===void 0||P.removeEventListener("play",this.onPlayHandler),(g=this.media)===null||g===void 0||g.removeEventListener("pause",this.onPauseHandler),this.onPause(),(N=this.media)===null||N===void 0||N.removeEventListener("timeupdate",this.onTimeupdateHandler),this.prevCurrentTime=null,this.media=this.subtitleElement=null}},{key:"dispose",value:function(){this.detachMedia()}},{key:"getViewCanvas",value:function(){return this.viewCanvas}},{key:"getRawCanvas",value:function(){return this.rawCanvas}},{key:"getTextContent",value:function(){return this.textContent}},{key:"refresh",value:function(){this.onResize()}},{key:"show",value:function(){this.isShowing=!0,this.onResize()}},{key:"hide",value:function(){if(this.isShowing=!1,this.viewCanvas){var H=this.viewCanvas.getContext("2d");H&&H.clearRect(0,0,this.viewCanvas.width,this.viewCanvas.height)}if(this.rawCanvas){var P=this.rawCanvas.getContext("2d");P&&P.clearRect(0,0,this.rawCanvas.width,this.rawCanvas.height)}}},{key:"isPresent",value:function(){return this.onB24CueChangeDrawed}},{key:"pushRawData",value:function(H,P){var g=new w(P,H).render(_e(_e({},this.rendererOption),{},{width:void 0,height:void 0}));if(g==null)return!1;var N=Number.isFinite(g.endTime)?g.endTime:Number.MAX_SAFE_INTEGER;return this.addB24Cue(H,N,P)}},{key:"pushBase64Data",value:function(H,P){var g=je(P);return this.pushRawData(H,g)}},{key:"pushData",value:function(H,P,g){return this.pushRawData(g,P)}},{key:"pushID3v2PRIVData",value:function(H,P,g){return P==="aribb24.js"&&this.pushRawData(H,g)}},{key:"pushID3v2TXXXData",value:function(H,P,g){return P==="aribb24.js"&&this.pushBase64Data(H,g)}},{key:"pushID3v2Data",value:function(H,P){for(var g=!1,N=0;N<P.length;){var Q=N;if(N+3>P.length)break;if(P[N+0]!==73||P[N+1]!==68||P[N+2]!==51){if(N===0){N+=5;continue}break}if((N+=6)+4>P.length)break;var J=Ee(P,N+0,N+4);N+=4;var ue=Q+3+2+1+4+J;if(ue>P.length)break;for(var de=N;de<ue;){var Ce=de;if(de+4>P.length)break;var Me=Ze(P,de+0,de+4);if((de+=4)+4>P.length)break;var Ge=Ee(P,de+0,de+4);de+=6;var Fe=Ce+4+4+2+Ge;if(Fe>P.length)break;if(Me==="PRIV"){for(var Ye=de,ze=Fe;P[de]!==0&&de<Fe;)de++;var et=Ze(P,Ye,de),We=new Uint8Array(Array.prototype.slice.call(P,de+1,ze));this.pushID3v2PRIVData(H,et,We)&&(g=!0)}else if(Me==="TXXX"){var ct=P[de+0],it=de+1;if(ct===3){for(;P[de]!==0&&de<Fe;)de++;for(var xt=de,yt=de+=1;P[de]!==0&&de<Fe;)de++;var At=de,wt=pt(P,it,xt),Et=pt(P,yt,At);this.pushID3v2TXXXData(H,wt,Et)&&(g=!0)}else if(ct===0){for(;P[de]!==0&&de<Fe;)de++;for(var Ut=de,Ct=de+=1;P[de]!==0&&de<Fe;)de++;var mt=de,Qe=Ze(P,it,Ut),bt=Ze(P,Ct,mt);this.pushID3v2TXXXData(H,Qe,bt)&&(g=!0)}}de=Fe}(N=Q+3+2+1+4+J)+3>P.length||P[N+0]===51&&P[N+1]===68&&P[N+2]===73&&(N+=10)}return g}},{key:"setInBandMetadataTextTrack",value:function(H){var P;(P=this.id3Track)===null||P===void 0||P.removeEventListener("cuechange",this.onID3CueChangeHandler),this.id3Track=H,this.id3Track.mode="hidden",this.id3Track.addEventListener("cuechange",this.onID3CueChangeHandler)}},{key:"pushID3v2Cue",value:function(H){if(!this.id3Track)return!1;var P=H.startTime,g=H;if(this.id3Track.inBandMetadataTrackDispatchType==="15260DFFFF49443320FF49443320000F")return this.pushID3v2Data(P,new Uint8Array(g.data));if(this.id3Track.inBandMetadataTrackDispatchType==="com.apple.streaming"){if(g.value.key==="PRIV")return this.pushID3v2PRIVData(P,g.value.info,new Uint8Array(g.value.data));if(g.value.key==="TXXX")return this.pushID3v2TXXXData(P,g.value.info,g.value.data)}else if(this.id3Track.label==="id3"){if(g.value.key==="PRIV")return this.pushID3v2PRIVData(P,g.value.info,new Uint8Array(g.value.data));if(g.value.key==="TXXX")return this.pushID3v2TXXXData(P,g.value.info,g.value.data)}else if(this.id3Track.label==="Timed Metadata"){if(g.frame.key==="PRIV")return this.pushID3v2PRIVData(P,g.frame.owner,new Uint8Array(g.frame.data));if(g.frame.key==="TXXX")return this.pushID3v2TXXXData(P,g.frame.description,g.frame.data)}return!1}},{key:"onID3CueChange",value:function(){this.id3Track&&(this.isOnSeeking||this.onTimeupdate())}},{key:"addB24Cue",value:function(H,P,g){var N;if(!this.b24Track||!w.detect(g,this.rendererOption))return!1;var Q=new((N=window.VTTCue)!==null&&N!==void 0?N:window.TextTrackCue)(H,P,"");if(Q.data=g,window.VTTCue)this.b24Track.addCue(Q);else if(window.TextTrackCue){var J;if(Array.prototype.some.call((J=this.b24Track.cues)!==null&&J!==void 0?J:[],function(Me){return Me.startTime===H}))return!1;if(this.b24Track.cues){for(var ue=[],de=this.b24Track.cues.length-1;de>=0;de--)this.b24Track.cues[de].startTime>=H&&(ue.push(this.b24Track.cues[de]),this.b24Track.removeCue(this.b24Track.cues[de]));this.b24Track.addCue(Q);for(var Ce=ue.length-1;Ce>=0;Ce--)this.b24Track.addCue(ue[Ce])}}return!0}},{key:"onB24CueChange",value:function(){if(this.media&&this.b24Track){if(this.viewCanvas){var H=this.viewCanvas.getContext("2d");H&&H.clearRect(0,0,this.viewCanvas.width,this.viewCanvas.height)}if(this.rawCanvas){var P=this.rawCanvas.getContext("2d");P&&P.clearRect(0,0,this.rawCanvas.width,this.rawCanvas.height)}if(this.b24Track.activeCues&&this.b24Track.activeCues.length>0){var g=this.b24Track.activeCues[this.b24Track.activeCues.length-1];if(g.startTime<=this.media.currentTime&&this.media.currentTime<=g.endTime&&!this.isOnSeeking){var N=new w(g.data,g.startTime),Q=!1;if(this.isShowing&&this.viewCanvas){var J,ue,de,Ce,Me,Ge,Fe,Ye,ze=N.render(_e(_e({},this.rendererOption),{},{canvas:this.viewCanvas,width:(J=(ue=this.rendererOption)===null||ue===void 0?void 0:ue.width)!==null&&J!==void 0?J:this.viewCanvas.width,height:(de=(Ce=this.rendererOption)===null||Ce===void 0?void 0:Ce.height)!==null&&de!==void 0?de:this.viewCanvas.height}));(ze==null?void 0:ze.PRA)!=null&&((Fe=this.rendererOption)===null||Fe===void 0||(Ye=Fe.PRACallback)===null||Ye===void 0||Ye.call(Fe,ze.PRA)),Q=(Me=ze==null?void 0:ze.rendered)!==null&&Me!==void 0&&Me,this.textContent=(Ge=ze==null?void 0:ze.textContent)!==null&&Ge!==void 0?Ge:null}this.isShowing&&this.rawCanvas&&N.render(_e(_e({},this.rendererOption),{},{canvas:this.rawCanvas,width:this.rawCanvas.width,height:this.rawCanvas.height,keepAspectRatio:!0})),this.onB24CueChangeDrawed=Q}else this.onB24CueChangeDrawed=!1,this.textContent=null;for(var et=this.b24Track.activeCues.length-2;et>=0;et--){var We=this.b24Track.activeCues[et];We.endTime=Math.min(We.endTime,g.startTime),We.startTime===We.endTime&&this.b24Track.removeCue(We)}}else this.onB24CueChangeDrawed=!1,this.textContent=null}else this.onB24CueChangeDrawed=!1}},{key:"onHighResTimeupdate",value:function(){this.onTimeupdate(),this.highResTimeupdatePollingId=window.requestAnimationFrame(this.onHighResTimeupdateHandler)}},{key:"onTimeupdate",value:function(){if(this.media)if(this.prevCurrentTime!=null)if(this.id3Track&&this.id3Track.cues&&this.id3Track.cues.length!==0)if(this.isOnSeeking)this.prevCurrentTime=this.media.currentTime;else if(Math.abs(this.media.currentTime-this.prevCurrentTime)>1)this.prevCurrentTime=this.media.currentTime;else{for(var H,P,g=new tt(Number.NEGATIVE_INFINITY,this.id3Track.cues[0].startTime),N=[g],Q=0;Q<this.id3Track.cues.length;Q++)N.push(this.id3Track.cues[Q]);for(var J=0,ue=N.length;J+1<ue;){var de=this.prevCurrentTime,Ce=Math.floor((J+ue)/2);de<N[Ce].startTime?ue=Ce:J=Ce}H=J;for(var Me=0,Ge=N.length;Me+1<Ge;){var Fe=this.media.currentTime,Ye=Math.floor((Me+Ge)/2);Fe<N[Ye].startTime?Ge=Ye:Me=Ye}if(P=Me,H!==null&&P!==null&&H!==P){if(H<P)for(var ze=P;ze>H;ze--){var et=N[ze];if(et!==g&&this.pushID3v2Cue(et))break}else for(var We=H;We<P;We++){var ct=N[We];if(ct!==g&&this.pushID3v2Cue(ct))break}this.prevCurrentTime=this.media.currentTime}else this.prevCurrentTime=this.media.currentTime}else this.prevCurrentTime=this.media.currentTime;else this.prevCurrentTime=this.media.currentTime}},{key:"onCanplay",value:function(){this.id3Track&&(this.id3Track.mode="hidden"),this.b24Track&&(this.b24Track.mode="hidden"),this.media!=null&&this.prevCurrentTime==null&&(this.prevCurrentTime=this.media.currentTime-Number.MIN_VALUE)}},{key:"onPlay",value:function(){this.highResTimeupdatePollingId==null&&this.onHighResTimeupdate()}},{key:"onPause",value:function(){this.highResTimeupdatePollingId!=null&&(window.cancelAnimationFrame(this.highResTimeupdatePollingId),this.highResTimeupdatePollingId=null)}},{key:"onSeeking",value:function(){this.isOnSeeking=!0,this.onB24CueChange()}},{key:"onSeeked",value:function(){this.isOnSeeking=!1}},{key:"onResize",value:function(){if(this.media){var H=window.getComputedStyle(this.media),P=Number.parseInt(H.width)*window.devicePixelRatio,g=Number.parseInt(H.height)*window.devicePixelRatio,N=this.media.videoWidth,Q=this.media.videoHeight;if(this.viewCanvas&&(this.viewCanvas.width=Math.round(P),this.viewCanvas.height=Math.round(g)),this.rawCanvas&&(this.rawCanvas.width=N,this.rawCanvas.height=Q),this.b24Track){if(this.viewCanvas){var J=this.viewCanvas.getContext("2d");J&&J.clearRect(0,0,this.viewCanvas.width,this.viewCanvas.height)}if(this.rawCanvas){var ue=this.rawCanvas.getContext("2d");ue&&ue.clearRect(0,0,this.rawCanvas.width,this.rawCanvas.height)}if(this.onB24CueChangeDrawed&&this.b24Track.activeCues&&this.b24Track.activeCues.length>0){var de=this.b24Track.activeCues[this.b24Track.activeCues.length-1];if(de.startTime<=this.media.currentTime&&this.media.currentTime<=de.endTime&&!this.isOnSeeking){var Ce,Me,Ge,Fe,Ye=new w(de.data,de.startTime);this.isShowing&&this.viewCanvas&&Ye.render(_e(_e({},this.rendererOption),{},{canvas:this.viewCanvas,width:(Ce=(Me=this.rendererOption)===null||Me===void 0?void 0:Me.width)!==null&&Ce!==void 0?Ce:this.viewCanvas.width,height:(Ge=(Fe=this.rendererOption)===null||Fe===void 0?void 0:Fe.height)!==null&&Ge!==void 0?Ge:this.viewCanvas.height})),this.isShowing&&this.rawCanvas&&Ye.render(_e(_e({},this.rendererOption),{},{canvas:this.rawCanvas,width:this.rawCanvas.width,height:this.rawCanvas.height,keepAspectRatio:!0}))}}}}}},{key:"onID3Addtrack",value:function(H){if(this.media){var P=H.track;P.kind==="metadata"&&(P.inBandMetadataTrackDispatchType!=="15260DFFFF49443320FF49443320000F"&&P.inBandMetadataTrackDispatchType!=="com.apple.streaming"&&P.label!=="id3"||this.setInBandMetadataTextTrack(P))}}},{key:"setupTrack",value:function(){var H,P;if(this.media){if((H=this.rendererOption)!==null&&H!==void 0&&H.useHighResTextTrack)this.b24Track=new Le(this.media),this.b24Track.startPolling();else{for(var g="ARIB B24 Japanese (data_identifier=0x".concat(this.data_identifier.toString(16),", data_group_id=").concat(this.data_group_id,")"),N=0;N<this.media.textTracks.length;N++){var Q=this.media.textTracks[N];if(Q.label===g){this.b24Track=Q;break}}this.b24Track||(this.b24Track=this.media.addTextTrack("metadata",g,"ja"),this.b24Track.mode="hidden")}if(this.b24Track.addEventListener("cuechange",this.onB24CueChangeHandler),(P=this.rendererOption)!==null&&P!==void 0&&P.enableAutoInBandMetadataTextTrackDetection){for(var J=0;J<this.media.textTracks.length;J++){var ue=this.media.textTracks[J];if(ue.kind==="metadata"&&(ue.inBandMetadataTrackDispatchType==="15260DFFFF49443320FF49443320000F"||ue.inBandMetadataTrackDispatchType==="com.apple.streaming"||ue.label==="id3")){this.setInBandMetadataTextTrack(ue);break}}this.media.textTracks.addEventListener("addtrack",this.onID3AddtrackHandler)}this.media.addEventListener("seeking",this.onSeekingHandler),this.media.addEventListener("seeked",this.onSeekedHandler)}}},{key:"setupCanvas",value:function(){var H,P=this;this.media&&this.subtitleElement&&(this.viewCanvas=document.createElement("canvas"),this.viewCanvas.style.position="absolute",this.viewCanvas.style.top=this.viewCanvas.style.left="0",this.viewCanvas.style.pointerEvents="none",this.viewCanvas.style.width="100%",this.viewCanvas.style.height="100%",(H=this.rendererOption)!==null&&H!==void 0&&H.enableRawCanvas&&(this.rawCanvas=document.createElement("canvas")),this.onResize(),this.subtitleElement.appendChild(this.viewCanvas),this.media.addEventListener("resize",this.onResizeHandler),window.ResizeObserver?(this.resizeObserver=new ResizeObserver(function(){P.onResize()}),this.resizeObserver.observe(this.media)):(window.addEventListener("resize",this.onResizeHandler),window.MutationObserver&&(this.mutationObserver=new MutationObserver(function(){P.onResize()}),this.mutationObserver.observe(this.media,{attributes:!0,attributeFilter:["class","style"]}))))}},{key:"cleanupTrack",value:function(){var H,P,g,N,Q,J;if(this.b24Track){if((J=this.rendererOption)!==null&&J!==void 0&&J.useHighResTextTrack)this.b24Track.stopPolling();else if(this.b24Track.cues)for(var ue=this.b24Track.cues.length-1;ue>=0;ue--)this.b24Track.removeCue(this.b24Track.cues[ue])}(H=this.b24Track)===null||H===void 0||H.removeEventListener("cuechange",this.onB24CueChangeHandler),(P=this.id3Track)===null||P===void 0||P.removeEventListener("cuechange",this.onID3CueChangeHandler),(g=this.media)===null||g===void 0||g.removeEventListener("seeking",this.onSeekingHandler),(N=this.media)===null||N===void 0||N.removeEventListener("seeked",this.onSeekedHandler),(Q=this.media)===null||Q===void 0||Q.textTracks.removeEventListener("addtrack",this.onID3AddtrackHandler),this.b24Track=this.id3Track=null}},{key:"cleanupCanvas",value:function(){var H;window.removeEventListener("resize",this.onResizeHandler),(H=this.media)===null||H===void 0||H.removeEventListener("resize",this.onResizeHandler),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.viewCanvas&&this.subtitleElement&&this.subtitleElement.removeChild(this.viewCanvas),this.viewCanvas&&(this.viewCanvas.width=this.viewCanvas.height=0),this.rawCanvas&&(this.rawCanvas.width=this.rawCanvas.height=0),this.viewCanvas=this.rawCanvas=null}}])&&fe(oe.prototype,ge),oe}();function ot(oe,ge,H){for(var P=-1,g=ge;g<H;g++){P^=oe[g];for(var N=0;N<8;N++)1&P?P=P>>>1^3988292384:P>>>=1}return~P}function nt(oe){return function(ge){if(Array.isArray(ge))return Z(ge)}(oe)||function(ge){if(typeof Symbol<"u"&&Symbol.iterator in Object(ge))return Array.from(ge)}(oe)||q(oe)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function q(oe,ge){if(oe){if(typeof oe=="string")return Z(oe,ge);var H=Object.prototype.toString.call(oe).slice(8,-1);return H==="Object"&&oe.constructor&&(H=oe.constructor.name),H==="Map"||H==="Set"?Array.from(oe):H==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H)?Z(oe,ge):void 0}}function Z(oe,ge){(ge==null||ge>oe.length)&&(ge=oe.length);for(var H=0,P=new Array(ge);H<ge;H++)P[H]=oe[H];return P}function z(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var $=null,ce=function(){function oe(g,N){(function(Q,J){if(!(Q instanceof J))throw new TypeError("Cannot call a class as a function")})(this,oe),this.text="",this.svg=null,this.groups=new Map,this.GL=0,this.GR=2,this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.DRCS_mapping=new Map([[15,new Map],[16,new Map],[17,new Map],[18,new Map],[19,new Map],[20,new Map],[21,new Map],[22,new Map],[23,new Map],[24,new Map],[25,new Map],[26,new Map],[27,new Map],[28,new Map],[29,new Map],[30,new Map]]),this.swf_x=1920,this.swf_y=1080,this.sdf_x=1920,this.sdf_y=1080,this.sdp_x=0,this.sdp_y=0,this.ssm_x=72,this.ssm_y=72,this.shs=8,this.svs=48,this.text_size_x=1,this.text_size_y=1,this.text_type="NSZ",this.position_x=-1,this.position_y=-1,this.pallet=0,this.fg_color=A[this.pallet][7],this.bg_color=A[this.pallet][8],this.force_bg_color=null,this.hlc=0,this.prev_hlc=0,this.stl=!1,this.orn=null,this.force_orn=null,this.flc=15,this.non_spacing="",this.timeElapsed=0,this.endTime=null,this.rendered=!1,this.PRA=null,this.normalFont="monospace",this.gaijiFont=this.normalFont,this.drcsReplacement=!1,this.drcsReplaceMapping=new Map,this.usePUA=!1,this.pes=g,this.startTime=N}var ge,H,P;return ge=oe,P=[{key:"setEmbeddedGlyph",value:function(g){$=g}},{key:"detect",value:function(g,N){var Q,J,ue=(Q=N==null?void 0:N.data_identifier)!==null&&Q!==void 0?Q:128,de=(J=N==null?void 0:N.data_group_id)!==null&&J!==void 0?J:1;if(g.length<=0||g[0]!==ue||g.length<=2)return!1;var Ce=3+(15&g[2]);return!(g.length<=Ce||(15&(252&g[Ce+0])>>2)!==de||(M(g,Ce),0))}},{key:"getRGBAColorCode",value:function(g){if(g==null)return null;var N=document.createElement("canvas");N.width=N.height=1;var Q=N.getContext("2d");if(!Q)return null;Q.fillStyle=g,Q.fillRect(0,0,N.width,N.height);var J,ue,de=(ue=4,function(ze){if(Array.isArray(ze))return ze}(J=Q.getImageData(0,0,1,1).data)||function(ze,et){if(typeof Symbol<"u"&&Symbol.iterator in Object(ze)){var We=[],ct=!0,it=!1,xt=void 0;try{for(var yt,At=ze[Symbol.iterator]();!(ct=(yt=At.next()).done)&&(We.push(yt.value),!et||We.length!==et);ct=!0);}catch(wt){it=!0,xt=wt}finally{try{ct||At.return==null||At.return()}finally{if(it)throw xt}}return We}}(J,ue)||q(J,ue)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),Ce=de[0],Me=de[1],Ge=de[2],Fe=de[3],Ye="#".concat(Ce.toString(16).toUpperCase().padStart(2,"0")).concat(Me.toString(16).toUpperCase().padStart(2,"0")).concat(Ge.toString(16).toUpperCase().padStart(2,"0")).concat(Fe.toString(16).toUpperCase().padStart(2,"0"));return N.width=N.height=0,Ye}},{key:"fillAlphaColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16);return"#".concat(N.toString(16).toUpperCase().padStart(2,"0")).concat(Q.toString(16).toUpperCase().padStart(2,"0")).concat(J.toString(16).toUpperCase().padStart(2,"0"),"FF")}},{key:"getRGBAfromColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16),ue=Number.parseInt(g.substring(7,9),16);return"rgba(".concat(N,", ").concat(Q,", ").concat(J,", ").concat(ue/255,")")}},{key:"getRGBfromColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16);return"rgb(".concat(N,", ").concat(Q,", ").concat(J,")")}},{key:"getAlphaFromColorCode",value:function(g){return g==null?Number.NaN:Number.parseInt(g.substring(7,9),16)}}],(H=[{key:"width",value:function(){return Math.floor((this.shs+this.ssm_x)*this.text_size_x)}},{key:"height",value:function(){return Math.floor((this.svs+this.ssm_y)*this.text_size_y)}},{key:"move_absolute_dot",value:function(g,N){this.position_x=g,this.position_y=N}},{key:"move_absolute_pos",value:function(g,N){this.position_x=this.sdp_x+g*this.width(),this.position_y=this.sdp_y+(N+1)*this.height()}},{key:"move_relative_pos",value:function(g,N){for((this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs));g<0;)this.position_x-=this.width(),g++,this.position_x<this.sdp_x&&(this.position_x=this.sdp_x+this.sdf_x-this.width(),N--);for(;g>0;)this.position_x+=this.width(),g--,this.position_x>=this.sdp_x+this.sdf_x&&(this.position_x=this.sdp_x,N++);for(;N<0;)this.position_y-=this.height(),N++;for(;N>0;)this.position_y+=this.height(),N--}},{key:"move_newline",value:function(){(this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs)),this.position_x=this.sdp_x,this.position_y=this.position_y+this.height()}},{key:"render",value:function(g){var N,Q,J,ue,de,Ce,Me,Ge;this.svg=(N=g==null?void 0:g.svg)!==null&&N!==void 0?N:null,this.force_orn=(Q=typeof(g==null?void 0:g.forceStrokeColor)=="boolean"?g==null?void 0:g.forceStrokeColor:oe.getRGBAColorCode(g==null?void 0:g.forceStrokeColor))!==null&&Q!==void 0?Q:null,this.force_bg_color=(J=oe.getRGBAColorCode(g==null?void 0:g.forceBackgroundColor))!==null&&J!==void 0?J:null,this.normalFont=(ue=g==null?void 0:g.normalFont)!==null&&ue!==void 0?ue:this.normalFont,this.gaijiFont=(de=g==null?void 0:g.gaijiFont)!==null&&de!==void 0?de:this.normalFont,this.drcsReplacement=(Ce=g==null?void 0:g.drcsReplacement)!==null&&Ce!==void 0&&Ce,this.drcsReplaceMapping=new Map(T);for(var Fe,Ye=Object.entries((Fe=g==null?void 0:g.drcsReplaceMapping)!==null&&Fe!==void 0?Fe:{}),ze=0;ze<Ye.length;ze++){var et=Ye[ze];this.drcsReplaceMapping.set(et[0],et[1])}if(this.usePUA=(Me=g==null?void 0:g.usePUA)!==null&&Me!==void 0&&Me,!oe.detect(this.pes,g))return null;if(this.svg)for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);for(var We=3+(15&this.pes[2]),ct=(this.pes[We+0],(this.pes[We+3]<<8)+this.pes[We+4]),it=We+9;it<We+(5+ct);){this.pes[it+0];var xt=this.pes[it+1],yt=this.pes[it+2]<<16|this.pes[it+3]<<8|this.pes[it+4];xt===32?this.parseText(it+5,it+5+yt):xt==48?this.parseDRCS(1,it+5,it+5+yt):xt==49?this.parseDRCS(2,it+5,it+5+yt):xt==53&&this.parseBitmap(it+5,it+5+yt),it+=5+yt}return{startTime:this.startTime,endTime:(Ge=this.endTime)!==null&&Ge!==void 0?Ge:Number.POSITIVE_INFINITY,rendered:this.rendered,textContent:this.rendered?this.text:null,PRA:this.PRA}}},{key:"parseText",value:function(g,N){for(;g<N;)if(32<this.pes[g]&&this.pes[g]<127){var Q=0,J=this.G_BACK[this.GL];if(!J)return;for(var ue=0;ue<J.bytes;ue++)Q<<=8,Q|=127&this.pes[g+ue];this.renderCharacter(Q,J),g+=J.bytes}else if(160<this.pes[g]&&this.pes[g]<255){var de=0,Ce=this.G_BACK[this.GR];if(!Ce)return;for(var Me=0;Me<Ce.bytes;Me++)de<<=8,de|=127&this.pes[g+Me];this.renderCharacter(de,Ce),g+=Ce.bytes}else if(this.pes[g]===0)g+=1;else if(this.pes[g]===7)g+=1;else if(this.pes[g]===8)this.move_relative_pos(-1,0),g+=1;else if(this.pes[g]===9)this.move_relative_pos(1,0),g+=1;else if(this.pes[g]===10)this.move_relative_pos(0,1),g+=1;else if(this.pes[g]===11)this.move_relative_pos(0,-1),g+=1;else if(this.pes[g]===12)this.startTime!=null&&this.timeElapsed>0&&(this.endTime=this.startTime+this.timeElapsed),g+=1;else if(this.pes[g]===13)this.move_newline(),g+=1;else if(this.pes[g]===14)this.GL=1,g+=1;else if(this.pes[g]===15)this.GL=0,g+=1;else if(this.pes[g]===22){var Ge=63&this.pes[g+1];this.move_relative_pos(Ge,0),g+=2}else if(this.pes[g]===24)g+=1;else if(this.pes[g]===25){var Fe=0,Ye=this.G_BACK[2];if(!Ye)return;for(var ze=0;ze<Ye.bytes;ze++)Fe<<=8,Fe|=127&this.pes[g+1+ze];this.renderCharacter(Fe,Ye),g+=1+Ye.bytes}else if(this.pes[g]===27)if(this.pes[g+1]===110)this.GL=2,g+=2;else if(this.pes[g+1]==111)this.GL=3,g+=2;else if(this.pes[g+1]==126)this.GR=1,g+=2;else if(this.pes[g+1]==125)this.GR=2,g+=2;else if(this.pes[g+1]==124)this.GR=3,g+=2;else if(40<=this.pes[g+1]&&this.pes[g+1]<=43){var et=this.pes[g+1]-40;this.pes[g+2]===32?(this.G_BACK[et]=_.get(this.pes[g+3]),g+=4):(this.G_BACK[et]=m.get(this.pes[g+2]),g+=3)}else{if(this.pes[g+1]!==36)return;if(40<=this.pes[g+2]&&this.pes[g+2]<=43){var We=this.pes[g+2]-40;this.pes[g+3]===32?(this.G_BACK[We]=_.get(this.pes[g+4]),g+=5):(this.G_BACK[We]=m.get(this.pes[g+3]),g+=4)}else this.G_BACK[0]=m.get(this.pes[g+2]),g+=3}else if(this.pes[g]===28){var ct=63&this.pes[g+1],it=63&this.pes[g+2];this.move_absolute_pos(it,ct),g+=3}else if(this.pes[g]===29){var xt=0,yt=this.G_BACK[3];if(!yt)return;for(var At=0;At<yt.bytes;At++)xt<<=8,xt|=127&this.pes[g+1+At];this.renderCharacter(xt,yt),g+=1+yt.bytes}else if(this.pes[g]===30)g+=1;else if(this.pes[g]===31)g+=1;else if(this.pes[g]===32){var wt=u.get(0);if(!wt)return;this.renderCharacter(8481,wt),g+=1}else if(this.pes[g]===127)g+=1;else if(this.pes[g]===128)this.fg_color=A[this.pallet][0],g+=1;else if(this.pes[g]===129)this.fg_color=A[this.pallet][1],g+=1;else if(this.pes[g]===130)this.fg_color=A[this.pallet][2],g+=1;else if(this.pes[g]===131)this.fg_color=A[this.pallet][3],g+=1;else if(this.pes[g]===132)this.fg_color=A[this.pallet][4],g+=1;else if(this.pes[g]===133)this.fg_color=A[this.pallet][5],g+=1;else if(this.pes[g]===134)this.fg_color=A[this.pallet][6],g+=1;else if(this.pes[g]===135)this.fg_color=A[this.pallet][7],g+=1;else if(this.pes[g]===136)this.text_size_x=.5,this.text_size_y=.5,this.text_type="SSZ",g+=1;else if(this.pes[g]===137)this.text_size_x=.5,this.text_size_y=1,this.text_type="MSZ",g+=1;else if(this.pes[g]===138)this.text_size_x=1,this.text_size_y=1,this.text_type="NSZ",g+=1;else{if(this.pes[g]===139)return;if(this.pes[g]===144){var Et=this.pes[g+1];if(Et==32){var Ut=15&this.pes[g+2];this.pallet=Ut,g+=3}else{var Ct=15&Et;(112&Et)==64?this.fg_color=A[this.pallet][Ct]:(112&Et)==80&&(this.bg_color=A[this.pallet][Ct]),g+=2}}else if(this.pes[g]===145){var mt=15&this.pes[g+1];this.flc=mt,g+=2}else{if(this.pes[g]===146||this.pes[g]===147||this.pes[g]===148||this.pes[g]===149)return;if(this.pes[g]===151)this.prev_hlc=this.hlc,this.hlc=15&this.pes[g+1],g+=2;else{if(this.pes[g]===152)return;if(this.pes[g]===153)this.stl=!1,g+=1;else if(this.pes[g]===154)this.stl=!0,g+=1;else if(this.pes[g]===155){for(var Qe=g,bt=-1,Ft=-1;Qe+1<N;)if(Qe+=1,this.pes[Qe]===32)bt<0&&(bt=Qe);else if(this.pes[Qe]===59)bt<0&&Ft<0&&(Ft=Qe);else{if(this.pes[Qe]===66)break;if(this.pes[Qe]===83){var Nt=g+1,Bt=0;if(Ft>=0||bt<0)return;for(;Nt<bt;)Bt*=10,Bt+=15&this.pes[Nt],Nt++;if(Bt===5)this.swf_x=3840,this.swf_y=2160;else if(Bt===7)this.swf_x=1920,this.swf_y=1080;else{if(Bt!=9)return;this.swf_x=1440,this.swf_y=960}break}if(this.pes[Qe]===84)break;if(this.pes[Qe]===86){for(var Pt=g+1,$t=0,Xt=0;Pt<Ft;)$t*=10,$t+=15&this.pes[Pt],Pt++;for(Pt++;Pt<bt;)Xt*=10,Xt+=15&this.pes[Pt],Pt++;this.sdf_x=2*$t,this.sdf_y=2*Xt;break}if(this.pes[Qe]===87){for(var jt=g+1,ei=0,ii=0;jt<Ft;)ei*=10,ei+=15&this.pes[jt],jt++;for(jt++;jt<bt;)ii*=10,ii+=15&this.pes[jt],jt++;this.ssm_x=2*ei,this.ssm_y=2*ii;break}if(this.pes[Qe]===88){for(var gi=g+1,vi=0;gi<bt;)vi*=10,vi+=15&this.pes[gi],gi++;this.shs=2*vi;break}if(this.pes[Qe]===89){for(var ni=g+1,ti=0;ni<bt;)ti*=10,ti+=15&this.pes[ni],ni++;this.svs=2*ti;break}if(this.pes[Qe]===91||this.pes[Qe]===92||this.pes[Qe]===93||this.pes[Qe]===94)break;if(this.pes[Qe]===95){for(var ri=g+1,ci=0,ai=0;ri<Ft;)ci*=10,ci+=15&this.pes[ri],ri++;for(ri++;ri<bt;)ai*=10,ai+=15&this.pes[ri],ri++;this.sdp_x=2*ci,this.sdp_y=2*ai;break}if(this.pes[Qe]===97){for(var yi=g+1,si=0,ui=0;yi<Ft;)si*=10,si+=15&this.pes[yi],yi++;for(yi++;yi<bt;)ui*=10,ui+=15&this.pes[yi],yi++;this.move_absolute_dot(2*si,2*ui);break}if(this.pes[Qe]===98)break;if(this.pes[Qe]===99){var Jt=this.pes[g+1];if(Jt==48)this.orn=null;else if(Jt==49){var Bi=10*(15&this.pes[g+3])+(15&this.pes[g+4]),Wt=10*(15&this.pes[g+5])+(15&this.pes[g+6]);this.orn=A[Bi][Wt]}break}if(this.pes[Qe]===100||this.pes[Qe]===101||this.pes[Qe]===102||this.pes[Qe]===103)break;if(this.pes[Qe]===104){for(var Mi=g+1,Ji=0;Mi<bt;)Ji*=10,Ji+=15&this.pes[Mi],Mi++;this.PRA=Ji;break}if(this.pes[Qe]===105||this.pes[Qe]===106||this.pes[Qe]===110||this.pes[Qe]===111)break}g=Qe+1}else{if(this.pes[g]!==157)return;if(this.pes[g+1]!=32)return void this.pes[g+1];var Qn=63&this.pes[g+2];this.timeElapsed+=Qn/10,g+=3}}}}}},{key:"parseDRCS",value:function(g,N,Q){for(this.pes[N+0],N+=1;N<Q;){var J=this.pes[N+0]<<8|this.pes[N+1],ue=this.pes[N+2];N+=3;for(var de=0;de<ue;de++){this.pes[N+0];var Ce=15&this.pes[N+0];if(Ce===0||Ce===1){var Me=this.pes[N+1]+2,Ge=this.pes[N+2],Fe=this.pes[N+3],Ye=Me.toString(2).length-Me.toString(2).replace(/0*$/,"").length,ze=Math.floor(Ge*Fe*Ye/8),et=new Uint8Array(Array.prototype.slice.call(this.pes,N+4,N+4+ze));if(g===1){var We,ct,it=64+((3840&J)>>8),xt=127&J,yt=(We=_.get(it))===null||We===void 0?void 0:We.alphabet;yt&&((ct=this.DRCS_mapping.get(yt))===null||ct===void 0||ct.set(xt,et))}else{var At,wt=32639&J;(At=this.DRCS_mapping.get(15))===null||At===void 0||At.set(wt,et)}N+=4+ze}}}}},{key:"renderCharacter",value:function(g,N){if((this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs)),this.svg!==null){if(N.alphabet===0){var Q=((65280&g)>>8)-33,J=(255&g)-33;if(Q===0&&12<=J&&J<=17)return void(this.non_spacing=["́","　","̈","̂","̅","̲"][J-12]);if(Q===1&&J===93)return void(this.non_spacing+="⃝")}if(N.alphabet!==31){this.rendered||this.svg.setAttribute("viewBox","0 0 ".concat(this.swf_x," ").concat(this.swf_y)),this.rendered=!0;var ue=this.force_bg_color||this.bg_color,de=oe.getAlphaFromColorCode(ue);if(!this.groups.has(de)){var Ce=document.createElementNS("http://www.w3.org/2000/svg","g");Ce.setAttribute("opacity","".concat(de/255)),this.groups.set(de,Ce),this.svg.appendChild(Ce)}var Me=this.groups.get(de),Ge=document.createElementNS("http://www.w3.org/2000/svg","rect");if(Ge.setAttribute("shape-rendering","crispEdges"),Ge.setAttribute("x","".concat(this.position_x)),Ge.setAttribute("y","".concat(this.position_y-this.height())),Ge.setAttribute("width","".concat(this.width()+1)),Ge.setAttribute("height","".concat(this.height()+1)),Ge.setAttribute("fill","".concat(oe.getRGBfromColorCode(ue))),Me.appendChild(Ge),1&this.hlc){var Fe=document.createElementNS("http://www.w3.org/2000/svg","line");Fe.setAttribute("shape-rendering","crispEdges"),Fe.setAttribute("x1","".concat(this.position_x)),Fe.setAttribute("y1","".concat(this.position_y-1)),Fe.setAttribute("x2","".concat(this.position_x+this.width())),Fe.setAttribute("y2","".concat(this.position_y-1)),Fe.setAttribute("stroke","".concat(oe.getRGBAfromColorCode(this.fg_color))),Fe.setAttribute("stroke-width","".concat(2)),this.svg.appendChild(Fe)}if(2&this.hlc){var Ye=document.createElementNS("http://www.w3.org/2000/svg","line");Ye.setAttribute("shape-rendering","crispEdges"),Ye.setAttribute("x1","".concat(this.position_x+this.width()-1)),Ye.setAttribute("y1","".concat(this.position_y-this.height())),Ye.setAttribute("x2","".concat(this.position_x+this.width()-1)),Ye.setAttribute("y2","".concat(this.position_y)),Ye.setAttribute("stroke","".concat(oe.getRGBAfromColorCode(this.fg_color))),Ye.setAttribute("stroke-width","".concat(2)),this.svg.appendChild(Ye)}if(4&this.hlc){var ze=document.createElementNS("http://www.w3.org/2000/svg","line");ze.setAttribute("shape-rendering","crispEdges"),ze.setAttribute("x1","".concat(this.position_x)),ze.setAttribute("y1","".concat(this.position_y-this.height()+1)),ze.setAttribute("x2","".concat(this.position_x+this.width())),ze.setAttribute("y2","".concat(this.position_y-this.height()+1)),ze.setAttribute("stroke","".concat(oe.getRGBAfromColorCode(this.fg_color))),ze.setAttribute("stroke-width","".concat(2)),this.svg.appendChild(ze)}if(8&this.hlc){var et=document.createElementNS("http://www.w3.org/2000/svg","line");et.setAttribute("shape-rendering","crispEdges"),et.setAttribute("x1","".concat(this.position_x+1)),et.setAttribute("y1","".concat(this.position_y-this.height())),et.setAttribute("x2","".concat(this.position_x+1)),et.setAttribute("y2","".concat(this.position_y)),et.setAttribute("stroke","".concat(oe.getRGBAfromColorCode(this.fg_color))),et.setAttribute("stroke-width","".concat(2)),this.svg.appendChild(et)}if(this.stl){var We=document.createElementNS("http://www.w3.org/2000/svg","line");We.setAttribute("shape-rendering","crispEdges"),We.setAttribute("x1","".concat(this.position_x)),We.setAttribute("y1","".concat(this.position_y-1)),We.setAttribute("x2","".concat(this.position_x+this.width())),We.setAttribute("y2","".concat(this.position_y-1)),We.setAttribute("stroke","".concat(oe.getRGBAfromColorCode(this.fg_color))),We.setAttribute("stroke-width","".concat(2)),this.svg.appendChild(We)}}if(N.alphabet===0){var ct=94*(((65280&g)>>8)-33)+((255&g)-33),it=7896;if(ct<it){var xt=E[ct];this.renderFont(xt)}else if(this.usePUA){var yt=C[ct-it];this.renderFont(yt)}else{var At=k[ct-it];this.renderFont(At)}this.move_relative_pos(1,0)}else if(N.alphabet===1){var wt=O[g-33];this.renderFont(wt),this.move_relative_pos(1,0)}else if(N.alphabet===2){var Et=G[g-33];this.renderFont(Et),this.move_relative_pos(1,0)}else if(N.alphabet===3){var Ut=B[g-33];this.renderFont(Ut),this.move_relative_pos(1,0)}else{if(N.alphabet===31)return void(g===96?(this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===97?(this.G_BACK=[u.get(0),u.get(3),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===98?(this.G_BACK=[u.get(0),p.get(16),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===99?(this.G_BACK=[u.get(4),u.get(6),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===100?(this.G_BACK=[u.get(4),u.get(5),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===101?(this.G_BACK=[u.get(4),p.get(16),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===102?(this.G_BACK=[p.get(16),p.get(17),p.get(18),p.get(31)],this.GL=0,this.GR=2):g===103?(this.G_BACK=[p.get(19),p.get(20),p.get(21),p.get(31)],this.GL=0,this.GR=2):g===104?(this.G_BACK=[p.get(22),p.get(23),p.get(24),p.get(31)],this.GL=0,this.GR=2):g===105?(this.G_BACK=[p.get(25),p.get(26),p.get(27),p.get(31)],this.GL=0,this.GR=2):g===106?(this.G_BACK=[p.get(28),p.get(29),p.get(30),p.get(31)],this.GL=0,this.GR=2):g===107?(this.G_BACK=[u.get(0),p.get(17),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===108?(this.G_BACK=[u.get(0),p.get(18),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===109?(this.G_BACK=[u.get(0),p.get(19),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===110?(this.G_BACK=[u.get(3),u.get(2),u.get(1),p.get(31)],this.GL=0,this.GR=2):g===111&&(this.G_BACK=[u.get(1),u.get(4),p.get(16),p.get(31)],this.GL=0,this.GR=2));var Ct,mt=(Ct=this.DRCS_mapping.get(N.alphabet))===null||Ct===void 0?void 0:Ct.get(32639&g);if(!mt)return;var Qe=Ae(mt.buffer);if(this.drcsReplacement&&this.drcsReplaceMapping.has(Qe.toLowerCase()))this.renderFont(this.drcsReplaceMapping.get(Qe.toLowerCase()));else if(this.drcsReplacement&&this.drcsReplaceMapping.has(Qe.toUpperCase()))this.renderFont(this.drcsReplaceMapping.get(Qe.toUpperCase()));else{var bt=document.createElement("canvas"),Ft=Math.floor(this.ssm_x*this.text_size_x/2),Nt=Math.floor(this.ssm_y*this.text_size_y/2),Bt=Math.floor(8*mt.length/(Ft*Nt));bt.width=2*(Ft+4),bt.height=2*(Nt+4);var Pt=bt.getContext("2d");if(!Pt)return;var $t=this.getOrnColorCode();if($t&&(!this.force_orn||this.force_orn===!0||this.force_orn!==this.fg_color)){Pt.fillStyle=oe.getRGBAfromColorCode($t);for(var Xt=-2;Xt<=2;Xt++)for(var jt=-2;jt<=2;jt++)for(var ei=0;ei<Nt;ei++)for(var ii=0;ii<Ft;ii++){for(var gi=0,vi=0;vi<Bt;vi++){var ni=7-((ei*Ft+ii)*Bt+vi)%8;gi*=2,gi+=(mt[Math.floor(((ei*Ft+ii)*Bt+vi)/8)]&1<<ni)>>ni}gi>0&&Pt.fillRect(2*(2+ii+jt),2*(2+ei+Xt),2,2)}}Pt.fillStyle=oe.getRGBAfromColorCode(this.fg_color);for(var ti=0;ti<Nt;ti++)for(var ri=0;ri<Ft;ri++){for(var ci=0,ai=0;ai<Bt;ai++){var yi=7-((ti*Ft+ri)*Bt+ai)%8;ci*=2,ci+=(mt[Math.floor(((ti*Ft+ri)*Bt+ai)/8)]&1<<yi)>>yi}ci>0&&Pt.fillRect(2*(2+ri),2*(2+ti),2,2)}var si=document.createElementNS("http://www.w3.org/2000/svg","image");if(si.setAttribute("href",bt.toDataURL()),si.setAttribute("x","".concat(this.position_x+Math.floor(this.shs*this.text_size_x/2)-4)),si.setAttribute("y","".concat(this.position_y+Math.floor(this.svs*this.text_size_y/2)-this.height()-4)),si.setAttribute("width","".concat(bt.width/2*2)),si.setAttribute("height","".concat(bt.height/2*2)),this.flc===0){var ui=document.createElementNS("http://www.w3.org/2000/svg","animate");ui.setAttribute("attributeName","opacity"),ui.setAttribute("values","1;0"),ui.setAttribute("dur","1s"),ui.setAttribute("calcMode","discrete"),ui.setAttribute("repeatCount","indefinite"),si.appendChild(ui)}else if(this.flc===7){var Jt=document.createElementNS("http://www.w3.org/2000/svg","animate");Jt.setAttribute("attributeName","opacity"),Jt.setAttribute("values","0;1"),Jt.setAttribute("dur","1s"),Jt.setAttribute("calcMode","discrete"),Jt.setAttribute("repeatCount","indefinite"),si.appendChild(Jt)}this.svg.appendChild(si)}this.move_relative_pos(1,0)}}}},{key:"renderFont",value:function(g){var N,Q;g+=this.non_spacing,this.non_spacing="",this.text_size_x===.5&&this.text_size_y===.5&&(G.includes(g)||B.includes(g))||(this.text+=g);var J=L.has(g),ue=J?this.gaijiFont:this.normalFont;if($!=null&&(N=$)!==null&&N!==void 0&&N.has(g)){var de=$.get(g),Ce=de.viewBox,Me=de.path;this.renderPath(Ce,Me)}else{J&&(g+="︎");var Ge=document.createElementNS("http://www.w3.org/2000/svg","text");if(Ge.setAttribute("x","0"),Ge.setAttribute("y","0"),Ge.setAttribute("transform","scale(".concat(this.text_size_x," ").concat(this.text_size_y,") translate(").concat((this.position_x+this.width()/2)/this.text_size_x," ").concat((this.position_y-this.height()/2)/this.text_size_y,")")),Ge.setAttribute("transform-origin","0 0"),Ge.setAttribute("font-size","".concat(this.ssm_x)),Ge.setAttribute("font-family",ue),Ge.setAttribute("dominant-baseline","central"),Ge.setAttribute("text-anchor","middle"),Ge.setAttribute("fill",oe.getRGBAfromColorCode(this.fg_color)),Ge.setAttribute("paint-order","stroke"),Ge.setAttribute("stroke-linejoin","round"),Ge.setAttribute("stroke-width",this.getOrnColorCode()?"".concat(8):"0"),Ge.setAttribute("stroke",this.getOrnColorCode()?oe.getRGBAfromColorCode(this.getOrnColorCode()):"transparent"),Ge.appendChild(document.createTextNode(g)),this.flc===0){var Fe=document.createElementNS("http://www.w3.org/2000/svg","animate");Fe.setAttribute("attributeName","opacity"),Fe.setAttribute("values","1;0"),Fe.setAttribute("dur","1s"),Fe.setAttribute("calcMode","discrete"),Fe.setAttribute("repeatCount","indefinite"),Ge.appendChild(Fe)}else if(this.flc===7){var Ye=document.createElementNS("http://www.w3.org/2000/svg","animate");Ye.setAttribute("attributeName","opacity"),Ye.setAttribute("values","0;1"),Ye.setAttribute("dur","1s"),Ye.setAttribute("calcMode","discrete"),Ye.setAttribute("repeatCount","indefinite"),Ge.appendChild(Ye)}(Q=this.svg)===null||Q===void 0||Q.appendChild(Ge)}}},{key:"renderPath",value:function(g,N){var Q;document.createElementNS("http://www.w3.org/2000/svg","svg").setAttribute("viewBox","".concat(g[0]," ").concat(g[1]," ").concat(g[2]," ").concat(g[3]));var J=this.ssm_x*this.text_size_x/(g[2]-g[0]),ue=this.ssm_y*this.text_size_y/(g[3]-g[1]),de=this.shs*this.text_size_x/2,Ce=this.svs*this.text_size_y/2,Me=document.createElementNS("http://www.w3.org/2000/svg","path");if(Me.setAttribute("d",N),Me.setAttribute("x","0"),Me.setAttribute("y","0"),Me.setAttribute("transform","scale(".concat(J," ").concat(ue,") translate(").concat((this.position_x+de)/J," ").concat((this.position_y+Ce-this.height())/ue,")")),Me.setAttribute("transform-origin","0 0"),Me.setAttribute("fill",oe.getRGBAfromColorCode(this.fg_color)),Me.setAttribute("paint-order","stroke"),Me.setAttribute("stroke-linejoin","round"),Me.setAttribute("stroke-width",this.getOrnColorCode()?"".concat(4/Math.min(J,ue)):"0"),Me.setAttribute("stroke",this.getOrnColorCode()?oe.getRGBAfromColorCode(this.getOrnColorCode()):"transparent"),this.flc===0){var Ge=document.createElementNS("http://www.w3.org/2000/svg","animate");Ge.setAttribute("attributeName","opacity"),Ge.setAttribute("values","1;0"),Ge.setAttribute("dur","1s"),Ge.setAttribute("calcMode","discrete"),Ge.setAttribute("repeatCount","indefinite"),Me.appendChild(Ge)}else if(this.flc===7){var Fe=document.createElementNS("http://www.w3.org/2000/svg","animate");Fe.setAttribute("attributeName","opacity"),Fe.setAttribute("values","0;1"),Fe.setAttribute("dur","1s"),Fe.setAttribute("calcMode","discrete"),Fe.setAttribute("repeatCount","indefinite"),Me.appendChild(Fe)}(Q=this.svg)===null||Q===void 0||Q.appendChild(Me)}},{key:"parseBitmap",value:function(g,N){if(this.svg!==null){this.rendered||this.svg.setAttribute("viewBox","0 0 ".concat(this.swf_x," ").concat(this.swf_y)),this.rendered=!0;var Q=this.pes[g]<<8|this.pes[g+1];g+=2;var J=this.pes[g]<<8|this.pes[g+1];g+=2;var ue=this.pes[g];g+=1;var de=new Set(this.pes.subarray(g,g+ue));if(!((g+=ue)+33>N)){var Ce=this.pes.subarray(g,g+33),Me=this.pes.subarray(g+33,N),Ge=new Uint8Array(Ce.byteLength+Me.byteLength+396+140),Fe=new DataView(Ge.buffer);Ge.set(Ce,0),Ge.set(Me,569);for(var Ye=0;Ye<8;Ye++)for(var ze=0;ze<16;ze++)if(!de.has(16*Ye+ze)){var et=A[Ye][ze],We=Number.parseInt(et.substring(1,3),16),ct=Number.parseInt(et.substring(3,5),16),it=Number.parseInt(et.substring(5,7),16),xt=Number.parseInt(et.substring(7,9),16);Ge[41+3*(16*Ye+ze)]=We,Ge[41+3*(16*Ye+ze)+1]=ct,Ge[41+3*(16*Ye+ze)+2]=it,Ge[437+(16*Ye+ze)]=xt}Fe.setInt32(33,384,!1),Ge[37]=80,Ge[38]=76,Ge[39]=84,Ge[40]=69,Fe.setInt32(429,128,!1),Ge[433]=116,Ge[434]=82,Ge[435]=78,Ge[436]=83,Fe.setInt32(425,ot(Ge,37,425),!1),Fe.setInt32(565,ot(Ge,433,565),!1);var yt=Fe.getInt32(16,!1),At=Fe.getInt32(20,!1),wt=document.createElementNS("http://www.w3.org/2000/svg","svg");wt.setAttribute("x","".concat(this.sdp_x)),wt.setAttribute("y","".concat(this.sdp_y)),wt.setAttribute("width","".concat(this.sdf_x)),wt.setAttribute("height","".concat(this.sdf_y)),wt.setAttribute("viewBox","0 0 ".concat(this.sdf_x," ").concat(this.sdf_y));var Et=document.createElementNS("http://www.w3.org/2000/svg","image");if(Et.setAttribute("href","data:image/png;base64,"+window.btoa(String.fromCharCode.apply(String,nt(Ge)))),Et.setAttribute("x","".concat(2*Q)),Et.setAttribute("y","".concat(2*J)),Et.setAttribute("width","".concat(2*yt)),Et.setAttribute("height","".concat(2*At)),wt.appendChild(Et),de.size>0){for(var Ut=0;Ut<8;Ut++)for(var Ct=0;Ct<16;Ct++)if(de.has(16*Ut+Ct)){var mt=A[Ut][Ct],Qe=Number.parseInt(mt.substring(1,3),16),bt=Number.parseInt(mt.substring(3,5),16),Ft=Number.parseInt(mt.substring(5,7),16),Nt=Number.parseInt(mt.substring(7,9),16);Ge[41+3*(16*Ut+Ct)]=Qe,Ge[41+3*(16*Ut+Ct)+1]=bt,Ge[41+3*(16*Ut+Ct)+2]=Ft,Ge[437+(16*Ut+Ct)]=Nt}else Ge[437+(16*Ut+Ct)]=0;Fe.setInt32(425,ot(Ge,37,425),!1),Fe.setInt32(565,ot(Ge,433,565),!1);var Bt=document.createElementNS("http://www.w3.org/2000/svg","image");Bt.setAttribute("href","data:image/png;base64,"+window.btoa(String.fromCharCode.apply(String,nt(Ge)))),Bt.setAttribute("x","".concat(2*Q)),Bt.setAttribute("y","".concat(2*J)),Bt.setAttribute("width","".concat(2*yt)),Bt.setAttribute("height","".concat(2*At));var Pt=document.createElementNS("http://www.w3.org/2000/svg","animate");Pt.setAttribute("attributeName","opacity"),Pt.setAttribute("values","1;0"),Pt.setAttribute("dur","1s"),Pt.setAttribute("calcMode","discrete"),Pt.setAttribute("repeatCount","indefinite"),Bt.appendChild(Pt),wt.appendChild(Bt)}this.svg.appendChild(wt)}}}},{key:"getOrnColorCode",value:function(){return this.force_orn===!0?oe.fillAlphaColorCode(this.bg_color):this.force_orn===!1?this.orn:(g=this.force_orn)!==null&&g!==void 0?g:this.orn;var g}}])&&z(ge.prototype,H),P&&z(ge,P),oe}();function Se(oe,ge){var H=Object.keys(oe);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(oe);ge&&(P=P.filter(function(g){return Object.getOwnPropertyDescriptor(oe,g).enumerable})),H.push.apply(H,P)}return H}function se(oe){for(var ge=1;ge<arguments.length;ge++){var H=arguments[ge]!=null?arguments[ge]:{};ge%2?Se(Object(H),!0).forEach(function(P){ve(oe,P,H[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(oe,Object.getOwnPropertyDescriptors(H)):Se(Object(H)).forEach(function(P){Object.defineProperty(oe,P,Object.getOwnPropertyDescriptor(H,P))})}return oe}function ve(oe,ge,H){return ge in oe?Object.defineProperty(oe,ge,{value:H,enumerable:!0,configurable:!0,writable:!0}):oe[ge]=H,oe}function Pe(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var ke=function(){function oe(H){var P,g,N,Q;(function(J,ue){if(!(J instanceof ue))throw new TypeError("Cannot call a class as a function")})(this,oe),this.media=null,this.id3Track=null,this.b24Track=null,this.subtitleElement=null,this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.textContent=null,this.prevCurrentTime=null,this.highResTimeupdatePollingId=null,this.isShowing=!0,this.isOnSeeking=!1,this.onB24CueChangeDrawed=!1,this.onID3AddtrackHandler=this.onID3Addtrack.bind(this),this.onID3CueChangeHandler=this.onID3CueChange.bind(this),this.onB24CueChangeHandler=this.onB24CueChange.bind(this),this.onHighResTimeupdateHandler=this.onHighResTimeupdate.bind(this),this.onTimeupdateHandler=this.onTimeupdate.bind(this),this.onCanplayHandler=this.onCanplay.bind(this),this.onPlayHandler=this.onPlay.bind(this),this.onPauseHandler=this.onPause.bind(this),this.onPauseAnimationHandler=this.onPauseAnimation.bind(this),this.onResumeAnimationHandler=this.onResumeAnimation.bind(this),this.onSeekingHandler=this.onSeeking.bind(this),this.onSeekedHandler=this.onSeeked.bind(this),this.data_identifier=(P=H==null?void 0:H.data_identifier)!==null&&P!==void 0?P:128,this.data_group_id=(g=H==null?void 0:H.data_group_id)!==null&&g!==void 0?g:1,this.rendererOption=se(se({},H),{},{data_identifier:this.data_identifier,data_group_id:this.data_group_id,keepAspectRatio:(N=H==null?void 0:H.keepAspectRatio)===null||N===void 0||N,enableAutoInBandMetadataTextTrackDetection:(Q=H==null?void 0:H.enableAutoInBandMetadataTextTrackDetection)===null||Q===void 0||Q})}var ge;return(ge=[{key:"attachMedia",value:function(H,P){var g;this.detachMedia(),this.media=H,this.subtitleElement=P??H.parentElement,this.media.addEventListener("canplay",this.onCanplayHandler),this.media.addEventListener("play",this.onResumeAnimationHandler),this.media.addEventListener("pause",this.onPauseAnimationHandler),(g=this.rendererOption)!==null&&g!==void 0&&g.useHighResTimeupdate?(this.media.addEventListener("play",this.onPlayHandler),this.media.addEventListener("pause",this.onPauseHandler)):this.media.addEventListener("timeupdate",this.onTimeupdateHandler),this.prevCurrentTime=null,this.setupTrack(),this.setupSVG()}},{key:"detachMedia",value:function(){var H,P,g,N,Q,J;this.cleanupSVG(),this.cleanupTrack(),(H=this.media)===null||H===void 0||H.removeEventListener("canplay",this.onCanplayHandler),(P=this.media)===null||P===void 0||P.removeEventListener("play",this.onPlayHandler),(g=this.media)===null||g===void 0||g.removeEventListener("pause",this.onPauseHandler),(N=this.media)===null||N===void 0||N.removeEventListener("play",this.onResumeAnimationHandler),(Q=this.media)===null||Q===void 0||Q.removeEventListener("pause",this.onPauseAnimationHandler),this.onPause(),(J=this.media)===null||J===void 0||J.removeEventListener("timeupdate",this.onTimeupdateHandler),this.prevCurrentTime=null,this.media=this.subtitleElement=null}},{key:"dispose",value:function(){this.detachMedia()}},{key:"getSVG",value:function(){return this.svg}},{key:"getTextContent",value:function(){return this.textContent}},{key:"show",value:function(){this.isShowing=!0,this.svg.style.visibility="visible"}},{key:"hide",value:function(){this.isShowing=!1,this.svg.style.visibility="hidden"}},{key:"isPresent",value:function(){return this.onB24CueChangeDrawed}},{key:"pushRawData",value:function(H,P){var g=new ce(P,H).render(se({},this.rendererOption));if(g==null)return!1;var N=Number.isFinite(g.endTime)?g.endTime:Number.MAX_SAFE_INTEGER;return this.addB24Cue(H,N,P)}},{key:"pushBase64Data",value:function(H,P){var g=je(P);return this.pushRawData(H,g)}},{key:"pushData",value:function(H,P,g){return this.pushRawData(g,P)}},{key:"pushID3v2PRIVData",value:function(H,P,g){return P==="aribb24.js"&&this.pushRawData(H,g)}},{key:"pushID3v2TXXXData",value:function(H,P,g){return P==="aribb24.js"&&this.pushBase64Data(H,g)}},{key:"pushID3v2Data",value:function(H,P){for(var g=!1,N=0;N<P.length;){var Q=N;if(N+3>P.length)break;if(P[N+0]!==73||P[N+1]!==68||P[N+2]!==51){if(N===0){N+=5;continue}break}if((N+=6)+4>P.length)break;var J=Ee(P,N+0,N+4);N+=4;var ue=Q+3+2+1+4+J;if(ue>P.length)break;for(var de=N;de<ue;){var Ce=de;if(de+4>P.length)break;var Me=Ze(P,de+0,de+4);if((de+=4)+4>P.length)break;var Ge=Ee(P,de+0,de+4);de+=6;var Fe=Ce+4+4+2+Ge;if(Fe>P.length)break;if(Me==="PRIV"){for(var Ye=de,ze=Fe;P[de]!==0&&de<Fe;)de++;var et=Ze(P,Ye,de),We=new Uint8Array(Array.prototype.slice.call(P,de+1,ze));this.pushID3v2PRIVData(H,et,We)&&(g=!0)}else if(Me==="TXXX"){var ct=P[de+0],it=de+1;if(ct===3){for(;P[de]!==0&&de<Fe;)de++;for(var xt=de,yt=de+=1;P[de]!==0&&de<Fe;)de++;var At=de,wt=pt(P,it,xt),Et=pt(P,yt,At);this.pushID3v2TXXXData(H,wt,Et)&&(g=!0)}else if(ct===0){for(;P[de]!==0&&de<Fe;)de++;for(var Ut=de,Ct=de+=1;P[de]!==0&&de<Fe;)de++;var mt=de,Qe=Ze(P,it,Ut),bt=Ze(P,Ct,mt);this.pushID3v2TXXXData(H,Qe,bt)&&(g=!0)}}de=Fe}(N=Q+3+2+1+4+J)+3>P.length||P[N+0]===51&&P[N+1]===68&&P[N+2]===73&&(N+=10)}return g}},{key:"setInBandMetadataTextTrack",value:function(H){var P;(P=this.id3Track)===null||P===void 0||P.removeEventListener("cuechange",this.onID3CueChangeHandler),this.id3Track=H,this.id3Track.mode="hidden",this.id3Track.addEventListener("cuechange",this.onID3CueChangeHandler)}},{key:"pushID3v2Cue",value:function(H){if(!this.id3Track)return!1;var P=H.startTime,g=H;if(this.id3Track.inBandMetadataTrackDispatchType==="15260DFFFF49443320FF49443320000F")return this.pushID3v2Data(P,new Uint8Array(g.data));if(this.id3Track.inBandMetadataTrackDispatchType==="com.apple.streaming"){if(g.value.key==="PRIV")return this.pushID3v2PRIVData(P,g.value.info,new Uint8Array(g.value.data));if(g.value.key==="TXXX")return this.pushID3v2TXXXData(P,g.value.info,g.value.data)}else if(this.id3Track.label==="id3"){if(g.value.key==="PRIV")return this.pushID3v2PRIVData(P,g.value.info,new Uint8Array(g.value.data));if(g.value.key==="TXXX")return this.pushID3v2TXXXData(P,g.value.info,g.value.data)}else if(this.id3Track.label==="Timed Metadata"){if(g.frame.key==="PRIV")return this.pushID3v2PRIVData(P,g.frame.owner,new Uint8Array(g.frame.data));if(g.frame.key==="TXXX")return this.pushID3v2TXXXData(P,g.frame.description,g.frame.data)}return!1}},{key:"onID3CueChange",value:function(){this.id3Track&&(this.isOnSeeking||this.onTimeupdate())}},{key:"addB24Cue",value:function(H,P,g){var N;if(!this.b24Track||!ce.detect(g,this.rendererOption))return!1;var Q=new((N=window.VTTCue)!==null&&N!==void 0?N:window.TextTrackCue)(H,P,"");if(Q.data=g,window.VTTCue)this.b24Track.addCue(Q);else if(window.TextTrackCue){var J;if(Array.prototype.some.call((J=this.b24Track.cues)!==null&&J!==void 0?J:[],function(Me){return Me.startTime===H}))return!1;if(this.b24Track.cues){for(var ue=[],de=this.b24Track.cues.length-1;de>=0;de--)this.b24Track.cues[de].startTime>=H&&(ue.push(this.b24Track.cues[de]),this.b24Track.removeCue(this.b24Track.cues[de]));this.b24Track.addCue(Q);for(var Ce=ue.length-1;Ce>=0;Ce--)this.b24Track.addCue(ue[Ce])}}return!0}},{key:"onB24CueChange",value:function(){if(this.media&&this.b24Track){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);if(this.b24Track.activeCues&&this.b24Track.activeCues.length>0){var H=this.b24Track.activeCues[this.b24Track.activeCues.length-1];if(H.startTime<=this.media.currentTime&&this.media.currentTime<=H.endTime&&!this.isOnSeeking){var P=new ce(H.data,H.startTime);if(this.isShowing){var g,N,Q,J=P.render(se(se({},this.rendererOption),{},{svg:this.svg}));(J==null?void 0:J.PRA)!=null&&((N=this.rendererOption)===null||N===void 0||(Q=N.PRACallback)===null||Q===void 0||Q.call(N,J.PRA)),J==null||J.rendered,this.textContent=(g=J==null?void 0:J.textContent)!==null&&g!==void 0?g:null}this.onB24CueChangeDrawed=!0}else this.onB24CueChangeDrawed=!1,this.textContent=null;for(var ue=this.b24Track.activeCues.length-2;ue>=0;ue--){var de=this.b24Track.activeCues[ue];de.endTime=Math.min(de.endTime,H.startTime),de.startTime===de.endTime&&this.b24Track.removeCue(de)}}else this.onB24CueChangeDrawed=!1,this.textContent=null}else this.onB24CueChangeDrawed=!1}},{key:"onHighResTimeupdate",value:function(){this.onTimeupdate(),this.highResTimeupdatePollingId=window.requestAnimationFrame(this.onHighResTimeupdateHandler)}},{key:"onTimeupdate",value:function(){if(this.media)if(this.prevCurrentTime!=null)if(this.id3Track&&this.id3Track.cues&&this.id3Track.cues.length!==0)if(this.isOnSeeking)this.prevCurrentTime=this.media.currentTime;else if(Math.abs(this.media.currentTime-this.prevCurrentTime)>1)this.prevCurrentTime=this.media.currentTime;else{for(var H,P,g=new tt(Number.NEGATIVE_INFINITY,this.id3Track.cues[0].startTime),N=[g],Q=0;Q<this.id3Track.cues.length;Q++)N.push(this.id3Track.cues[Q]);for(var J=0,ue=N.length;J+1<ue;){var de=this.prevCurrentTime,Ce=Math.floor((J+ue)/2);de<N[Ce].startTime?ue=Ce:J=Ce}H=J;for(var Me=0,Ge=N.length;Me+1<Ge;){var Fe=this.media.currentTime,Ye=Math.floor((Me+Ge)/2);Fe<N[Ye].startTime?Ge=Ye:Me=Ye}if(P=Me,H!==null&&P!==null&&H!==P){if(H<P)for(var ze=P;ze>H;ze--){var et=N[ze];if(et!==g&&this.pushID3v2Cue(et))break}else for(var We=H;We<P;We++){var ct=N[We];if(ct!==g&&this.pushID3v2Cue(ct))break}this.prevCurrentTime=this.media.currentTime}else this.prevCurrentTime=this.media.currentTime}else this.prevCurrentTime=this.media.currentTime;else this.prevCurrentTime=this.media.currentTime}},{key:"onCanplay",value:function(){this.id3Track&&(this.id3Track.mode="hidden"),this.b24Track&&(this.b24Track.mode="hidden"),this.media!=null&&this.prevCurrentTime==null&&(this.prevCurrentTime=this.media.currentTime-Number.MIN_VALUE)}},{key:"onPlay",value:function(){this.highResTimeupdatePollingId==null&&this.onHighResTimeupdate()}},{key:"onPause",value:function(){this.highResTimeupdatePollingId!=null&&(window.cancelAnimationFrame(this.highResTimeupdatePollingId),this.highResTimeupdatePollingId=null)}},{key:"onPauseAnimation",value:function(){this.svg.pauseAnimations()}},{key:"onResumeAnimation",value:function(){this.svg.unpauseAnimations()}},{key:"onSeeking",value:function(){this.isOnSeeking=!0,this.onB24CueChange()}},{key:"onSeeked",value:function(){this.isOnSeeking=!1}},{key:"onID3Addtrack",value:function(H){if(this.media){var P=H.track;P.kind==="metadata"&&(P.inBandMetadataTrackDispatchType!=="15260DFFFF49443320FF49443320000F"&&P.inBandMetadataTrackDispatchType!=="com.apple.streaming"&&P.label!=="id3"||this.setInBandMetadataTextTrack(P))}}},{key:"setupTrack",value:function(){var H,P;if(this.media){if((H=this.rendererOption)!==null&&H!==void 0&&H.useHighResTextTrack)this.b24Track=new Le(this.media),this.b24Track.startPolling();else{for(var g="ARIB B24 Japanese SVG (data_identifier=0x".concat(this.data_identifier.toString(16),", data_group_id=").concat(this.data_group_id,")"),N=0;N<this.media.textTracks.length;N++){var Q=this.media.textTracks[N];if(Q.label===g){this.b24Track=Q;break}}this.b24Track||(this.b24Track=this.media.addTextTrack("metadata",g,"ja"),this.b24Track.mode="hidden")}if(this.b24Track.addEventListener("cuechange",this.onB24CueChangeHandler),(P=this.rendererOption)!==null&&P!==void 0&&P.enableAutoInBandMetadataTextTrackDetection){for(var J=0;J<this.media.textTracks.length;J++){var ue=this.media.textTracks[J];if(ue.kind==="metadata"&&(ue.inBandMetadataTrackDispatchType==="15260DFFFF49443320FF49443320000F"||ue.inBandMetadataTrackDispatchType==="com.apple.streaming"||ue.label==="id3")){this.setInBandMetadataTextTrack(ue);break}}this.media.textTracks.addEventListener("addtrack",this.onID3AddtrackHandler)}this.media.addEventListener("seeking",this.onSeekingHandler),this.media.addEventListener("seeked",this.onSeekedHandler)}}},{key:"setupSVG",value:function(){this.media&&this.subtitleElement&&(this.svg.style.position="absolute",this.svg.style.top=this.svg.style.left="0",this.svg.style.pointerEvents="none",this.svg.style.width="100%",this.svg.style.height="100%",this.subtitleElement.appendChild(this.svg))}},{key:"cleanupTrack",value:function(){var H,P,g,N,Q,J;if(this.b24Track){if((J=this.rendererOption)!==null&&J!==void 0&&J.useHighResTextTrack)this.b24Track.stopPolling();else if(this.b24Track.cues)for(var ue=this.b24Track.cues.length-1;ue>=0;ue--)this.b24Track.removeCue(this.b24Track.cues[ue])}(H=this.b24Track)===null||H===void 0||H.removeEventListener("cuechange",this.onB24CueChangeHandler),(P=this.id3Track)===null||P===void 0||P.removeEventListener("cuechange",this.onID3CueChangeHandler),(g=this.media)===null||g===void 0||g.removeEventListener("seeking",this.onSeekingHandler),(N=this.media)===null||N===void 0||N.removeEventListener("seeked",this.onSeekedHandler),(Q=this.media)===null||Q===void 0||Q.textTracks.removeEventListener("addtrack",this.onID3AddtrackHandler),this.b24Track=this.id3Track=null}},{key:"cleanupSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild)}}])&&Pe(oe.prototype,ge),oe}();function xe(oe,ge){(ge==null||ge>oe.length)&&(ge=oe.length);for(var H=0,P=new Array(ge);H<ge;H++)P[H]=oe[H];return P}function Re(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var Be=null,Ue=function(){function oe(g,N){(function(Q,J){if(!(Q instanceof J))throw new TypeError("Cannot call a class as a function")})(this,oe),this.text="",this.table=null,this.cells=null,this.GL=0,this.GR=2,this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.DRCS_mapping=new Map([[15,new Map],[16,new Map],[17,new Map],[18,new Map],[19,new Map],[20,new Map],[21,new Map],[22,new Map],[23,new Map],[24,new Map],[25,new Map],[26,new Map],[27,new Map],[28,new Map],[29,new Map],[30,new Map]]),this.swf_x=1920,this.swf_y=1080,this.sdf_x=1920,this.sdf_y=1080,this.sdp_x=0,this.sdp_y=0,this.ssm_x=72,this.ssm_y=72,this.shs=8,this.svs=48,this.text_size_x=1,this.text_size_y=1,this.text_type="NSZ",this.position_x=-1,this.position_y=-1,this.pallet=0,this.fg_color=A[this.pallet][7],this.bg_color=A[this.pallet][8],this.force_bg_color=null,this.hlc=0,this.prev_hlc=0,this.stl=!1,this.orn=null,this.force_orn=null,this.flc=15,this.non_spacing="",this.timeElapsed=0,this.endTime=null,this.rendered=!1,this.PRA=null,this.normalFont="monospace",this.gaijiFont=this.normalFont,this.drcsReplacement=!1,this.drcsReplaceMapping=new Map,this.usePUA=!1,this.pes=g,this.startTime=N}var ge,H,P;return ge=oe,P=[{key:"setEmbeddedGlyph",value:function(g){Be=g}},{key:"detect",value:function(g,N){var Q,J,ue=(Q=N==null?void 0:N.data_identifier)!==null&&Q!==void 0?Q:128,de=(J=N==null?void 0:N.data_group_id)!==null&&J!==void 0?J:1;if(g.length<=0||g[0]!==ue||g.length<=2)return!1;var Ce=3+(15&g[2]);return!(g.length<=Ce||(15&(252&g[Ce+0])>>2)!==de||(M(g,Ce),0))}},{key:"getRGBAColorCode",value:function(g){if(g==null)return null;var N=document.createElement("canvas");N.width=N.height=1;var Q=N.getContext("2d");if(!Q)return null;Q.fillStyle=g,Q.fillRect(0,0,N.width,N.height);var J,ue,de=(ue=4,function(ze){if(Array.isArray(ze))return ze}(J=Q.getImageData(0,0,1,1).data)||function(ze,et){if(typeof Symbol<"u"&&Symbol.iterator in Object(ze)){var We=[],ct=!0,it=!1,xt=void 0;try{for(var yt,At=ze[Symbol.iterator]();!(ct=(yt=At.next()).done)&&(We.push(yt.value),!et||We.length!==et);ct=!0);}catch(wt){it=!0,xt=wt}finally{try{ct||At.return==null||At.return()}finally{if(it)throw xt}}return We}}(J,ue)||function(ze,et){if(ze){if(typeof ze=="string")return xe(ze,et);var We=Object.prototype.toString.call(ze).slice(8,-1);return We==="Object"&&ze.constructor&&(We=ze.constructor.name),We==="Map"||We==="Set"?Array.from(ze):We==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(We)?xe(ze,et):void 0}}(J,ue)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),Ce=de[0],Me=de[1],Ge=de[2],Fe=de[3],Ye="#".concat(Ce.toString(16).toUpperCase().padStart(2,"0")).concat(Me.toString(16).toUpperCase().padStart(2,"0")).concat(Ge.toString(16).toUpperCase().padStart(2,"0")).concat(Fe.toString(16).toUpperCase().padStart(2,"0"));return N.width=N.height=0,Ye}},{key:"fillAlphaColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16);return"#".concat(N.toString(16).toUpperCase().padStart(2,"0")).concat(Q.toString(16).toUpperCase().padStart(2,"0")).concat(J.toString(16).toUpperCase().padStart(2,"0"),"FF")}},{key:"getRGBAfromColorCode",value:function(g){if(g==null)return"";var N=Number.parseInt(g.substring(1,3),16),Q=Number.parseInt(g.substring(3,5),16),J=Number.parseInt(g.substring(5,7),16),ue=Number.parseInt(g.substring(7,9),16);return"rgba(".concat(N,", ").concat(Q,", ").concat(J,", ").concat(ue/255,")")}}],(H=[{key:"width",value:function(){return Math.floor((this.shs+this.ssm_x)*this.text_size_x)}},{key:"height",value:function(){return Math.floor((this.svs+this.ssm_y)*this.text_size_y)}},{key:"move_absolute_dot",value:function(g,N){this.position_x=g,this.position_y=N}},{key:"move_absolute_pos",value:function(g,N){this.position_x=this.sdp_x+g*this.width(),this.position_y=this.sdp_y+(N+1)*this.height()}},{key:"move_relative_pos",value:function(g,N){for((this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs));g<0;)this.position_x-=this.width(),g++,this.position_x<this.sdp_x&&(this.position_x=this.sdp_x+this.sdf_x-this.width(),N--);for(;g>0;)this.position_x+=this.width(),g--,this.position_x>=this.sdp_x+this.sdf_x&&(this.position_x=this.sdp_x,N++);for(;N<0;)this.position_y-=this.height(),N++;for(;N>0;)this.position_y+=this.height(),N--}},{key:"move_newline",value:function(){(this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs)),this.position_x=this.sdp_x,this.position_y=this.position_y+this.height()}},{key:"render",value:function(g){var N,Q,J,ue,de,Ce,Me,Ge;this.table=(N=g==null?void 0:g.table)!==null&&N!==void 0?N:null,this.force_orn=(Q=typeof(g==null?void 0:g.forceStrokeColor)=="boolean"?g==null?void 0:g.forceStrokeColor:oe.getRGBAColorCode(g==null?void 0:g.forceStrokeColor))!==null&&Q!==void 0?Q:null,this.force_bg_color=(J=oe.getRGBAColorCode(g==null?void 0:g.forceBackgroundColor))!==null&&J!==void 0?J:null,this.normalFont=(ue=g==null?void 0:g.normalFont)!==null&&ue!==void 0?ue:this.normalFont,this.gaijiFont=(de=g==null?void 0:g.gaijiFont)!==null&&de!==void 0?de:this.normalFont,this.drcsReplacement=(Ce=g==null?void 0:g.drcsReplacement)!==null&&Ce!==void 0&&Ce,this.drcsReplaceMapping=new Map(T);for(var Fe,Ye=Object.entries((Fe=g==null?void 0:g.drcsReplaceMapping)!==null&&Fe!==void 0?Fe:{}),ze=0;ze<Ye.length;ze++){var et=Ye[ze];this.drcsReplaceMapping.set(et[0],et[1])}if(this.usePUA=(Me=g==null?void 0:g.usePUA)!==null&&Me!==void 0&&Me,!oe.detect(this.pes,g))return null;if(this.table)for(;this.table.firstChild;)this.table.removeChild(this.table.firstChild);for(var We=3+(15&this.pes[2]),ct=(this.pes[We+0],(this.pes[We+3]<<8)+this.pes[We+4]),it=We+9;it<We+(5+ct);){this.pes[it+0];var xt=this.pes[it+1],yt=this.pes[it+2]<<16|this.pes[it+3]<<8|this.pes[it+4];xt===32?this.parseText(it+5,it+5+yt):xt==48?this.parseDRCS(1,it+5,it+5+yt):xt==49&&this.parseDRCS(2,it+5,it+5+yt),it+=5+yt}return{startTime:this.startTime,endTime:(Ge=this.endTime)!==null&&Ge!==void 0?Ge:Number.POSITIVE_INFINITY,rendered:this.rendered,textContent:this.rendered?this.text:null,PRA:this.PRA}}},{key:"parseText",value:function(g,N){for(;g<N;)if(32<this.pes[g]&&this.pes[g]<127){var Q=0,J=this.G_BACK[this.GL];if(!J)return;for(var ue=0;ue<J.bytes;ue++)Q<<=8,Q|=127&this.pes[g+ue];this.renderCharacter(Q,J),g+=J.bytes}else if(160<this.pes[g]&&this.pes[g]<255){var de=0,Ce=this.G_BACK[this.GR];if(!Ce)return;for(var Me=0;Me<Ce.bytes;Me++)de<<=8,de|=127&this.pes[g+Me];this.renderCharacter(de,Ce),g+=Ce.bytes}else if(this.pes[g]===0)g+=1;else if(this.pes[g]===7)g+=1;else if(this.pes[g]===8)this.move_relative_pos(-1,0),g+=1;else if(this.pes[g]===9)this.move_relative_pos(1,0),g+=1;else if(this.pes[g]===10)this.move_relative_pos(0,1),g+=1;else if(this.pes[g]===11)this.move_relative_pos(0,-1),g+=1;else if(this.pes[g]===12)this.startTime!=null&&this.timeElapsed>0&&(this.endTime=this.startTime+this.timeElapsed),g+=1;else if(this.pes[g]===13)this.move_newline(),g+=1;else if(this.pes[g]===14)this.GL=1,g+=1;else if(this.pes[g]===15)this.GL=0,g+=1;else if(this.pes[g]===22){var Ge=63&this.pes[g+1];this.move_relative_pos(Ge,0),g+=2}else if(this.pes[g]===24)g+=1;else if(this.pes[g]===25){var Fe=0,Ye=this.G_BACK[2];if(!Ye)return;for(var ze=0;ze<Ye.bytes;ze++)Fe<<=8,Fe|=127&this.pes[g+1+ze];this.renderCharacter(Fe,Ye),g+=1+Ye.bytes}else if(this.pes[g]===27)if(this.pes[g+1]===110)this.GL=2,g+=2;else if(this.pes[g+1]==111)this.GL=3,g+=2;else if(this.pes[g+1]==126)this.GR=1,g+=2;else if(this.pes[g+1]==125)this.GR=2,g+=2;else if(this.pes[g+1]==124)this.GR=3,g+=2;else if(40<=this.pes[g+1]&&this.pes[g+1]<=43){var et=this.pes[g+1]-40;this.pes[g+2]===32?(this.G_BACK[et]=_.get(this.pes[g+3]),g+=4):(this.G_BACK[et]=m.get(this.pes[g+2]),g+=3)}else{if(this.pes[g+1]!==36)return;if(40<=this.pes[g+2]&&this.pes[g+2]<=43){var We=this.pes[g+2]-40;this.pes[g+3]===32?(this.G_BACK[We]=_.get(this.pes[g+4]),g+=5):(this.G_BACK[We]=m.get(this.pes[g+3]),g+=4)}else this.G_BACK[0]=m.get(this.pes[g+2]),g+=3}else if(this.pes[g]===28){var ct=63&this.pes[g+1],it=63&this.pes[g+2];this.move_absolute_pos(it,ct),g+=3}else if(this.pes[g]===29){var xt=0,yt=this.G_BACK[3];if(!yt)return;for(var At=0;At<yt.bytes;At++)xt<<=8,xt|=127&this.pes[g+1+At];this.renderCharacter(xt,yt),g+=1+yt.bytes}else if(this.pes[g]===30)g+=1;else if(this.pes[g]===31)g+=1;else if(this.pes[g]===32){var wt=u.get(0);if(!wt)return;this.renderCharacter(8481,wt),g+=1}else if(this.pes[g]===127)g+=1;else if(this.pes[g]===128)this.fg_color=A[this.pallet][0],g+=1;else if(this.pes[g]===129)this.fg_color=A[this.pallet][1],g+=1;else if(this.pes[g]===130)this.fg_color=A[this.pallet][2],g+=1;else if(this.pes[g]===131)this.fg_color=A[this.pallet][3],g+=1;else if(this.pes[g]===132)this.fg_color=A[this.pallet][4],g+=1;else if(this.pes[g]===133)this.fg_color=A[this.pallet][5],g+=1;else if(this.pes[g]===134)this.fg_color=A[this.pallet][6],g+=1;else if(this.pes[g]===135)this.fg_color=A[this.pallet][7],g+=1;else if(this.pes[g]===136)this.text_size_x=.5,this.text_size_y=.5,this.text_type="SSZ",g+=1;else if(this.pes[g]===137)this.text_size_x=.5,this.text_size_y=1,this.text_type="MSZ",g+=1;else if(this.pes[g]===138)this.text_size_x=1,this.text_size_y=1,this.text_type="NSZ",g+=1;else{if(this.pes[g]===139)return;if(this.pes[g]===144){var Et=this.pes[g+1];if(Et==32){var Ut=15&this.pes[g+2];this.pallet=Ut,g+=3}else{var Ct=15&Et;(112&Et)==64?this.fg_color=A[this.pallet][Ct]:(112&Et)==80&&(this.bg_color=A[this.pallet][Ct]),g+=2}}else if(this.pes[g]===145){var mt=15&this.pes[g];this.flc=mt,g+=2}else{if(this.pes[g]===146||this.pes[g]===147||this.pes[g]===148||this.pes[g]===149)return;if(this.pes[g]===151)this.prev_hlc=this.hlc,this.hlc=15&this.pes[g+1],g+=2;else{if(this.pes[g]===152)return;if(this.pes[g]===153)this.stl=!1,g+=1;else if(this.pes[g]===154)this.stl=!0,g+=1;else if(this.pes[g]===155){for(var Qe=g+1;this.pes[Qe]!==66;){if(this.pes[Qe]===83){for(var bt=g+1,Ft=0;this.pes[bt]!=59&&this.pes[bt]!=32;)Ft*=10,Ft+=15&this.pes[bt],bt++;if(this.pes[bt]!==32)return;if(Ft===5)this.swf_x=3840,this.swf_y=2160;else if(Ft===7)this.swf_x=1920,this.swf_y=1080;else{if(Ft!=9)return;this.swf_x=1440,this.swf_y=960}break}if(this.pes[Qe]===84)break;if(this.pes[Qe]===86){for(var Nt=g+1,Bt=0,Pt=0;this.pes[Nt]!=59;)Bt*=10,Bt+=15&this.pes[Nt],Nt++;for(Nt++;this.pes[Nt]!=32;)Pt*=10,Pt+=15&this.pes[Nt],Nt++;this.sdf_x=2*Bt,this.sdf_y=2*Pt;break}if(this.pes[Qe]===87){for(var $t=g+1,Xt=0,jt=0;this.pes[$t]!=59;)Xt*=10,Xt+=15&this.pes[$t],$t++;for($t++;this.pes[$t]!=32;)jt*=10,jt+=15&this.pes[$t],$t++;this.ssm_x=2*Xt,this.ssm_y=2*jt;break}if(this.pes[Qe]===88){for(var ei=g+1,ii=0;this.pes[ei]!=32;)ii*=10,ii+=15&this.pes[ei],ei++;this.shs=2*ii;break}if(this.pes[Qe]===89){for(var gi=g+1,vi=0;this.pes[gi]!=32;)vi*=10,vi+=15&this.pes[gi],gi++;this.svs=2*vi;break}if(this.pes[Qe]===91||this.pes[Qe]===92||this.pes[Qe]===93||this.pes[Qe]===94)break;if(this.pes[Qe]===95){for(var ni=g+1,ti=0,ri=0;this.pes[ni]!=59;)ti*=10,ti+=15&this.pes[ni],ni++;for(ni++;this.pes[ni]!=32;)ri*=10,ri+=15&this.pes[ni],ni++;this.sdp_x=2*ti,this.sdp_y=2*ri;break}if(this.pes[Qe]===97){for(var ci=g+1,ai=0,yi=0;this.pes[ci]!=59;)ai*=10,ai+=15&this.pes[ci],ci++;for(ci++;this.pes[ci]!=32;)yi*=10,yi+=15&this.pes[ci],ci++;this.move_absolute_dot(2*ai,2*yi);break}if(this.pes[Qe]===98)break;if(this.pes[Qe]===99){var si=this.pes[g+1];if(si==48)this.orn=null;else if(si==49){var ui=10*(15&this.pes[g+3])+(15&this.pes[g+4]),Jt=10*(15&this.pes[g+5])+(15&this.pes[g+6]);this.orn=A[ui][Jt]}break}if(this.pes[Qe]===100||this.pes[Qe]===101||this.pes[Qe]===102||this.pes[Qe]===103)break;if(this.pes[Qe]===104){for(var Bi=g+1,Wt=0;this.pes[Bi]!=32;)Wt*=10,Wt+=15&this.pes[Bi],Bi++;this.PRA=Wt;break}if(this.pes[Qe]===105||this.pes[Qe]===106||this.pes[Qe]===110||this.pes[Qe]===111)break;Qe+=1}g=Qe+1}else{if(this.pes[g]!==157)return;if(this.pes[g+1]!=32)return void this.pes[g+1];var Mi=63&this.pes[g+2];this.timeElapsed+=Mi/10,g+=3}}}}}},{key:"parseDRCS",value:function(g,N,Q){for(this.pes[N+0],N+=1;N<Q;){var J=this.pes[N+0]<<8|this.pes[N+1],ue=this.pes[N+2];N+=3;for(var de=0;de<ue;de++){this.pes[N+0];var Ce=15&this.pes[N+0];if(Ce===0||Ce===1){var Me=this.pes[N+1]+2,Ge=this.pes[N+2],Fe=this.pes[N+3],Ye=Me.toString(2).length-Me.toString(2).replace(/0*$/,"").length,ze=Math.floor(Ge*Fe*Ye/8),et=new Uint8Array(Array.prototype.slice.call(this.pes,N+4,N+4+ze));if(g===1){var We,ct,it=64+((3840&J)>>8),xt=127&J,yt=(We=_.get(it))===null||We===void 0?void 0:We.alphabet;yt&&((ct=this.DRCS_mapping.get(yt))===null||ct===void 0||ct.set(xt,et))}else{var At,wt=32639&J;(At=this.DRCS_mapping.get(15))===null||At===void 0||At.set(wt,et)}N+=4+ze}}}}},{key:"renderCharacter",value:function(g,N){if((this.position_x<0||this.position_y<0)&&this.move_absolute_dot(this.sdp_x,this.sdp_y+(this.ssm_y+this.svs)),N.alphabet===0){var Q=((65280&g)>>8)-33,J=(255&g)-33;if(Q===0&&12<=J&&J<=17)return void(this.non_spacing=["́","　","̈","̂","̅","̲"][J-12]);if(Q===1&&J===93)return void(this.non_spacing+="⃝")}if(this.table!==null){if(this.cells===null){this.table.parentElement&&(this.table.parentElement.style.position="absolute",this.table.parentElement.style.width="".concat(this.swf_x,"px"),this.table.parentElement.style.height="".concat(this.swf_y,"px")),this.table.style.willChange="transform",this.table.style.position="absolute",this.table.style.left="".concat(this.sdp_x,"px"),this.table.style.top="".concat(this.sdp_y,"px"),this.table.style.width="".concat(this.sdf_x,"px"),this.table.style.height="".concat(this.sdf_y,"px"),this.table.style.boxSizing="border-box",this.table.style.border="none",this.table.style.borderCollapse="collapse";for(var ue=[],de=0,Ce=0;de<this.sdf_y;de+=Math.floor((this.ssm_y+this.svs)/2),Ce+=1){var Me=document.createElement("tr");ue.push([]),Me.style.position="relative",Me.style.height="".concat(Math.floor((this.ssm_y+this.svs)/2),"px"),Me.style.width="100%",Me.style.boxSizing="border-box",Me.style.border="none";for(var Ge=0;Ge<this.sdf_x;Ge+=Math.floor((this.ssm_x+this.shs)/2)){var Fe=document.createElement("td");Fe.style.height="".concat(Math.floor((this.ssm_y+this.svs)/2),"px"),Fe.style.width="".concat(Math.floor((this.ssm_x+this.shs)/2),"px"),Fe.style.padding="0px",Fe.style.boxSizing="border-box",Fe.style.border="none",Me.appendChild(Fe),ue[Ce].push(Fe)}this.table.appendChild(Me)}this.cells=ue}if(N.alphabet!==31&&(this.rendered=!0),N.alphabet===0){var Ye=94*(((65280&g)>>8)-33)+((255&g)-33),ze=7896;if(Ye<ze){var et=E[Ye];this.renderFont(et)}else if(this.usePUA){var We=C[Ye-ze];this.renderFont(We)}else{var ct=k[Ye-ze];this.renderFont(ct)}this.move_relative_pos(1,0)}else if(N.alphabet===1){var it=O[g-33];this.renderFont(it),this.move_relative_pos(1,0)}else if(N.alphabet===2){var xt=G[g-33];this.renderFont(xt),this.move_relative_pos(1,0)}else if(N.alphabet===3){var yt=B[g-33];this.renderFont(yt),this.move_relative_pos(1,0)}else{if(N.alphabet===31)return void(g===96?(this.G_BACK=[u.get(0),u.get(1),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===97?(this.G_BACK=[u.get(0),u.get(3),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===98?(this.G_BACK=[u.get(0),p.get(16),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===99?(this.G_BACK=[u.get(4),u.get(6),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===100?(this.G_BACK=[u.get(4),u.get(5),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===101?(this.G_BACK=[u.get(4),p.get(16),u.get(7),p.get(31)],this.GL=0,this.GR=2):g===102?(this.G_BACK=[p.get(16),p.get(17),p.get(18),p.get(31)],this.GL=0,this.GR=2):g===103?(this.G_BACK=[p.get(19),p.get(20),p.get(21),p.get(31)],this.GL=0,this.GR=2):g===104?(this.G_BACK=[p.get(22),p.get(23),p.get(24),p.get(31)],this.GL=0,this.GR=2):g===105?(this.G_BACK=[p.get(25),p.get(26),p.get(27),p.get(31)],this.GL=0,this.GR=2):g===106?(this.G_BACK=[p.get(28),p.get(29),p.get(30),p.get(31)],this.GL=0,this.GR=2):g===107?(this.G_BACK=[u.get(0),p.get(17),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===108?(this.G_BACK=[u.get(0),p.get(18),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===109?(this.G_BACK=[u.get(0),p.get(19),u.get(2),p.get(31)],this.GL=0,this.GR=2):g===110?(this.G_BACK=[u.get(3),u.get(2),u.get(1),p.get(31)],this.GL=0,this.GR=2):g===111&&(this.G_BACK=[u.get(1),u.get(4),p.get(16),p.get(31)],this.GL=0,this.GR=2));var At,wt=(At=this.DRCS_mapping.get(N.alphabet))===null||At===void 0?void 0:At.get(32639&g);if(!wt)return;var Et=Ae(wt.buffer);if(this.drcsReplacement&&this.drcsReplaceMapping.has(Et.toLowerCase()))this.renderFont(this.drcsReplaceMapping.get(Et.toLowerCase()));else if(this.drcsReplacement&&this.drcsReplaceMapping.has(Et.toUpperCase()))this.renderFont(this.drcsReplaceMapping.get(Et.toUpperCase()));else{var Ut=document.createElement("canvas"),Ct=Math.floor(this.ssm_x/2),mt=Math.floor(this.ssm_y/2),Qe=Math.floor(8*wt.length/(Ct*mt));Ut.width=Ct+4/this.text_size_x,Ut.height=mt+4/this.text_size_y,Ut.style.width="".concat(this.ssm_x+4/this.text_size_x*2,"px"),Ut.style.height="".concat(this.ssm_y+4/this.text_size_y*2,"px");var bt=Ut.getContext("2d");if(!bt)return;var Ft=this.getOrnColorCode();if(Ft&&(!this.force_orn||this.force_orn===!0||this.force_orn!==this.fg_color)){bt.fillStyle=oe.getRGBAfromColorCode(Ft);for(var Nt=-2/this.text_size_y;Nt<=2/this.text_size_y;Nt++)for(var Bt=-2/this.text_size_x;Bt<=2/this.text_size_x;Bt++)for(var Pt=0;Pt<mt;Pt++)for(var $t=0;$t<Ct;$t++){for(var Xt=0,jt=0;jt<Qe;jt++){var ei=7-((Pt*Ct+$t)*Qe+jt)%8;Xt*=2,Xt+=(wt[Math.floor(((Pt*Ct+$t)*Qe+jt)/8)]&1<<ei)>>ei}Xt>0&&bt.fillRect(2/this.text_size_x+$t+Bt,2/this.text_size_y+Pt+Nt,1,1)}}bt.fillStyle=oe.getRGBAfromColorCode(this.fg_color);for(var ii=0;ii<mt;ii++)for(var gi=0;gi<Ct;gi++){for(var vi=0,ni=0;ni<Qe;ni++){var ti=7-((ii*Ct+gi)*Qe+ni)%8;vi*=2,vi+=(wt[Math.floor(((ii*Ct+gi)*Qe+ni)/8)]&1<<ti)>>ti}vi>0&&bt.fillRect(2/this.text_size_x+gi,2/this.text_size_y+ii,1,1)}for(var ri=Math.floor(2*this.text_size_x),ci=Math.floor(2*this.text_size_y),ai=Math.round((this.position_x-this.sdp_x)/(this.ssm_x+this.shs)*2),yi=Math.round((this.position_y-this.height()-this.sdp_y)/(this.ssm_y+this.svs)*2),si=0;si<ci;si++)for(var ui=0;ui<ri;ui++){var Jt=this.cells[yi+si][ai+ui];if(si===0&&ui===0){var Bi;Jt.setAttribute("rowspan","".concat(ci)),Jt.setAttribute("colspan","".concat(ri)),Jt.style.textAlign="center",Jt.style.verticalAlign="top";var Wt=document.createElement("div");Wt.appendChild(Ut),Wt.style.display="flex",Wt.style.alignItems="center",Wt.style.justifyContent="middle",Wt.style.width="".concat(this.ssm_x+this.shs,"px"),Wt.style.height="".concat(this.ssm_y+this.svs,"px"),Wt.style.lineHeight="".concat(this.height(),"px"),Wt.style.fontSize="".concat(this.ssm_x,"px"),Wt.style.transform="scale(".concat(this.text_size_x,", ").concat(this.text_size_y,")"),Wt.style.transformOrigin="0 0",Wt.style.marginRight="-".concat(this.ssm_x+this.shs-this.width(),"px"),Wt.style.marginBottom="-".concat(this.ssm_y+this.svs-this.height(),"px"),Wt.style.color=oe.getRGBAfromColorCode(this.fg_color),1&this.hlc&&(Jt.style.borderBottom="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),2&this.hlc&&(Jt.style.borderRight="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),4&this.hlc&&(Jt.style.borderTop="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),8&this.hlc&&(Jt.style.borderLeft="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),this.stl&&(Jt.style.borderBottom="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),Jt.style.backgroundColor=oe.getRGBAfromColorCode((Bi=this.force_bg_color)!==null&&Bi!==void 0?Bi:this.bg_color),Jt.appendChild(Wt)}else Jt.parentNode!=null&&Jt.parentNode.removeChild(Jt)}}this.move_relative_pos(1,0)}}}},{key:"renderFont",value:function(g){var N;if(g+=this.non_spacing,this.non_spacing="",this.text_size_x===.5&&this.text_size_y===.5&&(G.includes(g)||B.includes(g))||(this.text+=g),this.cells!==null){var Q=L.has(g),J=Q?this.gaijiFont:this.normalFont;if(Be!=null&&(N=Be)!==null&&N!==void 0&&N.has(g)){var ue=Be.get(g),de=ue.viewBox,Ce=ue.path;this.renderPath(de,Ce)}else{Q&&(g+="︎");for(var Me=Math.floor(2*this.text_size_x),Ge=Math.floor(2*this.text_size_y),Fe=Math.round((this.position_x-this.sdp_x)/(this.ssm_x+this.shs)*2),Ye=Math.round((this.position_y-this.height()-this.sdp_y)/(this.ssm_y+this.svs)*2),ze=0;ze<Ge;ze++)for(var et=0;et<Me;et++){var We=this.cells[Ye+ze][Fe+et];if(ze===0&&et===0){var ct;We.setAttribute("rowspan","".concat(Ge)),We.setAttribute("colspan","".concat(Me)),We.style.textAlign="center",We.style.verticalAlign="top";var it=document.createElement("div");it.textContent=g,it.style.display="flex",it.style.alignItems="center",it.style.justifyContent="middle",it.style.width="".concat(this.ssm_x+this.shs,"px"),it.style.height="".concat(this.ssm_y+this.svs,"px"),it.style.fontFamily="".concat(J),it.style.lineHeight="".concat(this.height(),"px"),it.style.fontSize="".concat(this.ssm_x,"px"),it.style.transform="scale(".concat(this.text_size_x,", ").concat(this.text_size_y,")"),it.style.transformOrigin="0 0",it.style.marginRight="-".concat(this.ssm_x+this.shs-this.width(),"px"),it.style.marginBottom="-".concat(this.ssm_y+this.svs-this.height(),"px"),it.style.color=oe.getRGBAfromColorCode(this.fg_color);var xt=this.getOrnColorCode();if(xt&&(!this.force_orn||this.force_orn===!0||this.force_orn!==this.fg_color)){for(var yt="",At=!0,wt=-4;wt<=4;wt++)for(var Et=-4;Et<=4;Et++)wt===0&&Et===0||(yt+="".concat(At?"":",").concat(Et,"px ").concat(wt,"px 0 ").concat(oe.getRGBAfromColorCode(xt)),At=!1);it.style.textShadow=yt}1&this.hlc&&(We.style.borderBottom="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),2&this.hlc&&(We.style.borderRight="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),4&this.hlc&&(We.style.borderTop="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),8&this.hlc&&(We.style.borderLeft="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),this.stl&&(We.style.borderBottom="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),We.style.backgroundColor=oe.getRGBAfromColorCode((ct=this.force_bg_color)!==null&&ct!==void 0?ct:this.bg_color),We.appendChild(it)}else We.parentNode!=null&&We.parentNode.removeChild(We)}}}}},{key:"renderPath",value:function(g,N){if(this.cells!==null){var Q=document.createElementNS("http://www.w3.org/2000/svg","svg");Q.setAttribute("viewBox","".concat(g[0]," ").concat(g[1]," ").concat(g[2]," ").concat(g[3])),Q.style.width="".concat(this.ssm_x+this.shs,"px"),Q.style.height="".concat(this.ssm_y,"px");var J=document.createElementNS("http://www.w3.org/2000/svg","path");J.setAttribute("d",N),J.setAttribute("fill","".concat(oe.getRGBAfromColorCode(this.fg_color)));var ue=this.getOrnColorCode();if(!ue||this.force_orn&&this.force_orn!==!0&&this.force_orn===this.fg_color)J.setAttribute("stroke","transparent");else{var de=4*Math.max((g[2]-g[0])/this.ssm_x,(g[3]-g[1])/this.ssm_y);J.setAttribute("stroke","".concat(oe.getRGBAfromColorCode(ue))),J.setAttribute("stroke-width","".concat(de))}Q.appendChild(J);for(var Ce=Math.floor(2*this.text_size_x),Me=Math.floor(2*this.text_size_y),Ge=Math.round((this.position_x-this.sdp_x)/(this.ssm_x+this.shs)*2),Fe=Math.round((this.position_y-this.height()-this.sdp_y)/(this.ssm_y+this.svs)*2),Ye=0;Ye<Me;Ye++)for(var ze=0;ze<Ce;ze++){var et=this.cells[Fe+Ye][Ge+ze];if(Ye===0&&ze===0){var We;et.setAttribute("rowspan","".concat(Me)),et.setAttribute("colspan","".concat(Ce)),et.style.textAlign="center",et.style.verticalAlign="top";var ct=document.createElement("div");ct.appendChild(Q),ct.style.display="flex",ct.style.alignItems="center",ct.style.justifyContent="middle",ct.style.width="".concat(this.ssm_x+this.shs,"px"),ct.style.height="".concat(this.ssm_y+this.svs,"px"),ct.style.lineHeight="".concat(this.height(),"px"),ct.style.fontSize="".concat(this.ssm_x,"px"),ct.style.transform="scale(".concat(this.text_size_x,", ").concat(this.text_size_y,")"),ct.style.transformOrigin="0 0",ct.style.marginRight="-".concat(this.ssm_x+this.shs-this.width(),"px"),ct.style.marginBottom="-".concat(this.ssm_y+this.svs-this.height(),"px"),ct.style.color=oe.getRGBAfromColorCode(this.fg_color),1&this.hlc&&(et.style.borderBottom="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),2&this.hlc&&(et.style.borderRight="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),4&this.hlc&&(et.style.borderTop="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),8&this.hlc&&(et.style.borderLeft="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),this.stl&&(et.style.borderBottom="1px solid ".concat(oe.getRGBAColorCode(this.fg_color))),et.style.backgroundColor=oe.getRGBAfromColorCode((We=this.force_bg_color)!==null&&We!==void 0?We:this.bg_color),et.appendChild(ct)}else et.parentNode!=null&&et.parentNode.removeChild(et)}}}},{key:"getOrnColorCode",value:function(){return this.force_orn===!0?oe.fillAlphaColorCode(this.bg_color):this.force_orn===!1?this.orn:(g=this.force_orn)!==null&&g!==void 0?g:this.orn;var g}}])&&Re(ge.prototype,H),P&&Re(ge,P),oe}();function at(oe,ge){var H=Object.keys(oe);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(oe);ge&&(P=P.filter(function(g){return Object.getOwnPropertyDescriptor(oe,g).enumerable})),H.push.apply(H,P)}return H}function gt(oe){for(var ge=1;ge<arguments.length;ge++){var H=arguments[ge]!=null?arguments[ge]:{};ge%2?at(Object(H),!0).forEach(function(P){Yt(oe,P,H[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(oe,Object.getOwnPropertyDescriptors(H)):at(Object(H)).forEach(function(P){Object.defineProperty(oe,P,Object.getOwnPropertyDescriptor(H,P))})}return oe}function Yt(oe,ge,H){return ge in oe?Object.defineProperty(oe,ge,{value:H,enumerable:!0,configurable:!0,writable:!0}):oe[ge]=H,oe}function Ht(oe,ge){for(var H=0;H<ge.length;H++){var P=ge[H];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(oe,P.key,P)}}var zt=function(){function oe(H){var P,g,N,Q,J;(function(ue,de){if(!(ue instanceof de))throw new TypeError("Cannot call a class as a function")})(this,oe),this.media=null,this.id3Track=null,this.b24Track=null,this.subtitleElement=null,this.table=null,this.textContent=null,this.wrapper=null,this.resizeObserver=null,this.mutationObserver=null,this.prevCurrentTime=null,this.highResTimeupdatePollingId=null,this.isShowing=!0,this.isOnSeeking=!1,this.onB24CueChangeDrawed=!1,this.onID3AddtrackHandler=this.onID3Addtrack.bind(this),this.onID3CueChangeHandler=this.onID3CueChange.bind(this),this.onB24CueChangeHandler=this.onB24CueChange.bind(this),this.onHighResTimeupdateHandler=this.onHighResTimeupdate.bind(this),this.onTimeupdateHandler=this.onTimeupdate.bind(this),this.onCanplayHandler=this.onCanplay.bind(this),this.onPlayHandler=this.onPlay.bind(this),this.onPauseHandler=this.onPause.bind(this),this.onSeekingHandler=this.onSeeking.bind(this),this.onSeekedHandler=this.onSeeked.bind(this),this.onResizeHandler=this.onResize.bind(this),this.data_identifier=(P=H==null?void 0:H.data_identifier)!==null&&P!==void 0?P:128,this.data_group_id=(g=H==null?void 0:H.data_group_id)!==null&&g!==void 0?g:1,this.rendererOption=gt(gt({},H),{},{data_identifier:this.data_identifier,data_group_id:this.data_group_id,keepAspectRatio:(N=H==null?void 0:H.keepAspectRatio)===null||N===void 0||N,enableAutoInBandMetadataTextTrackDetection:(Q=H==null?void 0:H.enableAutoInBandMetadataTextTrackDetection)===null||Q===void 0||Q,useStroke:(J=H==null?void 0:H.useStroke)===null||J===void 0||J})}var ge;return(ge=[{key:"attachMedia",value:function(H,P){var g;this.detachMedia(),this.media=H,this.subtitleElement=P??H.parentElement,this.media.addEventListener("canplay",this.onCanplayHandler),(g=this.rendererOption)!==null&&g!==void 0&&g.useHighResTimeupdate?(this.media.addEventListener("play",this.onPlayHandler),this.media.addEventListener("pause",this.onPauseHandler)):this.media.addEventListener("timeupdate",this.onTimeupdateHandler),this.prevCurrentTime=null,this.setupTrack(),this.setupTable()}},{key:"detachMedia",value:function(){var H,P,g,N;this.cleanupTable(),this.cleanupTrack(),(H=this.media)===null||H===void 0||H.removeEventListener("canplay",this.onCanplayHandler),(P=this.media)===null||P===void 0||P.removeEventListener("play",this.onPlayHandler),(g=this.media)===null||g===void 0||g.removeEventListener("pause",this.onPauseHandler),this.onPause(),(N=this.media)===null||N===void 0||N.removeEventListener("timeupdate",this.onTimeupdateHandler),this.prevCurrentTime=null,this.media=this.subtitleElement=null}},{key:"dispose",value:function(){this.detachMedia()}},{key:"getTextContent",value:function(){return this.textContent}},{key:"refresh",value:function(){this.onResize()}},{key:"show",value:function(){this.isShowing=!0,this.table&&(this.table.style.visibility="visible")}},{key:"hide",value:function(){this.isShowing=!1,this.table&&(this.table.style.visibility="hidden")}},{key:"isPresent",value:function(){return this.onB24CueChangeDrawed}},{key:"pushRawData",value:function(H,P){var g=new Ue(P,H).render(this.rendererOption);if(g==null)return!1;var N=Number.isFinite(g.endTime)?g.endTime:Number.MAX_SAFE_INTEGER;return this.addB24Cue(H,N,P)}},{key:"pushBase64Data",value:function(H,P){var g=je(P);return this.pushRawData(H,g)}},{key:"pushData",value:function(H,P,g){return this.pushRawData(g,P)}},{key:"pushID3v2PRIVData",value:function(H,P,g){return P==="aribb24.js"&&this.pushRawData(H,g)}},{key:"pushID3v2TXXXData",value:function(H,P,g){return P==="aribb24.js"&&this.pushBase64Data(H,g)}},{key:"pushID3v2Data",value:function(H,P){for(var g=!1,N=0;N<P.length;){var Q=N;if(N+3>P.length)break;if(P[N+0]!==73||P[N+1]!==68||P[N+2]!==51){if(N===0){N+=5;continue}break}if((N+=6)+4>P.length)break;var J=Ee(P,N+0,N+4);N+=4;var ue=Q+3+2+1+4+J;if(ue>P.length)break;for(var de=N;de<ue;){var Ce=de;if(de+4>P.length)break;var Me=Ze(P,de+0,de+4);if((de+=4)+4>P.length)break;var Ge=Ee(P,de+0,de+4);de+=6;var Fe=Ce+4+4+2+Ge;if(Fe>P.length)break;if(Me==="PRIV"){for(var Ye=de,ze=Fe;P[de]!==0&&de<Fe;)de++;var et=Ze(P,Ye,de),We=new Uint8Array(Array.prototype.slice.call(P,de+1,ze));this.pushID3v2PRIVData(H,et,We)&&(g=!0)}else if(Me==="TXXX"){var ct=P[de+0],it=de+1;if(ct===3){for(;P[de]!==0&&de<Fe;)de++;for(var xt=de,yt=de+=1;P[de]!==0&&de<Fe;)de++;var At=de,wt=pt(P,it,xt),Et=pt(P,yt,At);this.pushID3v2TXXXData(H,wt,Et)&&(g=!0)}else if(ct===0){for(;P[de]!==0&&de<Fe;)de++;for(var Ut=de,Ct=de+=1;P[de]!==0&&de<Fe;)de++;var mt=de,Qe=Ze(P,it,Ut),bt=Ze(P,Ct,mt);this.pushID3v2TXXXData(H,Qe,bt)&&(g=!0)}}de=Fe}(N=Q+3+2+1+4+J)+3>P.length||P[N+0]===51&&P[N+1]===68&&P[N+2]===73&&(N+=10)}return g}},{key:"setInBandMetadataTextTrack",value:function(H){var P;(P=this.id3Track)===null||P===void 0||P.removeEventListener("cuechange",this.onID3CueChangeHandler),this.id3Track=H,this.id3Track.mode="hidden",this.id3Track.addEventListener("cuechange",this.onID3CueChangeHandler)}},{key:"pushID3v2Cue",value:function(H){if(!this.id3Track)return!1;var P=H.startTime,g=H;if(this.id3Track.inBandMetadataTrackDispatchType==="15260DFFFF49443320FF49443320000F")return this.pushID3v2Data(P,new Uint8Array(g.data));if(this.id3Track.inBandMetadataTrackDispatchType==="com.apple.streaming"){if(g.value.key==="PRIV")return this.pushID3v2PRIVData(P,g.value.info,new Uint8Array(g.value.data));if(g.value.key==="TXXX")return this.pushID3v2TXXXData(P,g.value.info,g.value.data)}else if(this.id3Track.label==="id3"){if(g.value.key==="PRIV")return this.pushID3v2PRIVData(P,g.value.info,new Uint8Array(g.value.data));if(g.value.key==="TXXX")return this.pushID3v2TXXXData(P,g.value.info,g.value.data)}else if(this.id3Track.label==="Timed Metadata"){if(g.frame.key==="PRIV")return this.pushID3v2PRIVData(P,g.frame.owner,new Uint8Array(g.frame.data));if(g.frame.key==="TXXX")return this.pushID3v2TXXXData(P,g.frame.description,g.frame.data)}return!1}},{key:"onID3CueChange",value:function(){this.id3Track&&(this.isOnSeeking||this.onTimeupdate())}},{key:"addB24Cue",value:function(H,P,g){var N;if(!this.b24Track||!Ue.detect(g,this.rendererOption))return!1;var Q=new((N=window.VTTCue)!==null&&N!==void 0?N:window.TextTrackCue)(H,P,"");if(Q.data=g,window.VTTCue)this.b24Track.addCue(Q);else if(window.TextTrackCue){var J;if(Array.prototype.some.call((J=this.b24Track.cues)!==null&&J!==void 0?J:[],function(Me){return Me.startTime===H}))return!1;if(this.b24Track.cues){for(var ue=[],de=this.b24Track.cues.length-1;de>=0;de--)this.b24Track.cues[de].startTime>=H&&(ue.push(this.b24Track.cues[de]),this.b24Track.removeCue(this.b24Track.cues[de]));this.b24Track.addCue(Q);for(var Ce=ue.length-1;Ce>=0;Ce--)this.b24Track.addCue(ue[Ce])}}return!0}},{key:"onB24CueChange",value:function(){if(this.media&&this.b24Track){if(this.table)for(;this.table.firstChild;)this.table.removeChild(this.table.firstChild);if(this.b24Track.activeCues&&this.b24Track.activeCues.length>0){var H=this.b24Track.activeCues[this.b24Track.activeCues.length-1];if(H.startTime<=this.media.currentTime&&this.media.currentTime<=H.endTime&&!this.isOnSeeking){var P,g,N,Q,J,ue=new Ue(H.data,H.startTime).render(gt(gt({},this.rendererOption),{},{table:(P=this.table)!==null&&P!==void 0?P:void 0}));(ue==null?void 0:ue.PRA)!=null&&((Q=this.rendererOption)===null||Q===void 0||(J=Q.PRACallback)===null||J===void 0||J.call(Q,ue.PRA)),ue!=null&&ue.rendered&&this.onResize(),this.onB24CueChangeDrawed=(g=ue==null?void 0:ue.rendered)!==null&&g!==void 0&&g,this.textContent=(N=ue==null?void 0:ue.textContent)!==null&&N!==void 0?N:null}else this.onB24CueChangeDrawed=!1,this.textContent=null;for(var de=this.b24Track.activeCues.length-2;de>=0;de--){var Ce=this.b24Track.activeCues[de];Ce.endTime=Math.min(Ce.endTime,H.startTime),Ce.startTime===Ce.endTime&&this.b24Track.removeCue(Ce)}}else this.onB24CueChangeDrawed=!1,this.textContent=null}else this.onB24CueChangeDrawed=!1}},{key:"onHighResTimeupdate",value:function(){this.onTimeupdate(),this.highResTimeupdatePollingId=window.requestAnimationFrame(this.onHighResTimeupdateHandler)}},{key:"onTimeupdate",value:function(){if(this.media)if(this.prevCurrentTime!=null)if(this.id3Track&&this.id3Track.cues&&this.id3Track.cues.length!==0)if(this.isOnSeeking)this.prevCurrentTime=this.media.currentTime;else if(Math.abs(this.media.currentTime-this.prevCurrentTime)>1)this.prevCurrentTime=this.media.currentTime;else{for(var H,P,g=new tt(Number.NEGATIVE_INFINITY,this.id3Track.cues[0].startTime),N=[g],Q=0;Q<this.id3Track.cues.length;Q++)N.push(this.id3Track.cues[Q]);for(var J=0,ue=N.length;J+1<ue;){var de=this.prevCurrentTime,Ce=Math.floor((J+ue)/2);de<N[Ce].startTime?ue=Ce:J=Ce}H=J;for(var Me=0,Ge=N.length;Me+1<Ge;){var Fe=this.media.currentTime,Ye=Math.floor((Me+Ge)/2);Fe<N[Ye].startTime?Ge=Ye:Me=Ye}if(P=Me,H!==null&&P!==null&&H!==P){if(H<P)for(var ze=P;ze>H;ze--){var et=N[ze];if(et!==g&&this.pushID3v2Cue(et))break}else for(var We=H;We<P;We++){var ct=N[We];if(ct!==g&&this.pushID3v2Cue(ct))break}this.prevCurrentTime=this.media.currentTime}else this.prevCurrentTime=this.media.currentTime}else this.prevCurrentTime=this.media.currentTime;else this.prevCurrentTime=this.media.currentTime}},{key:"onCanplay",value:function(){this.id3Track&&(this.id3Track.mode="hidden"),this.b24Track&&(this.b24Track.mode="hidden"),this.media!=null&&this.prevCurrentTime==null&&(this.prevCurrentTime=this.media.currentTime-Number.MIN_VALUE)}},{key:"onPlay",value:function(){this.highResTimeupdatePollingId==null&&this.onHighResTimeupdate()}},{key:"onPause",value:function(){this.highResTimeupdatePollingId!=null&&(window.cancelAnimationFrame(this.highResTimeupdatePollingId),this.highResTimeupdatePollingId=null)}},{key:"onSeeking",value:function(){this.isOnSeeking=!0,this.onB24CueChange()}},{key:"onSeeked",value:function(){this.isOnSeeking=!1}},{key:"onResize",value:function(){var H;if(this.media&&this.wrapper){var P=window.getComputedStyle(this.media),g=Number.parseInt(P.width),N=Number.parseInt(P.height),Q=this.wrapper.offsetWidth,J=this.wrapper.offsetHeight,ue=g/Q,de=N/J;if((H=this.rendererOption)!==null&&H!==void 0&&H.keepAspectRatio){var Ce=Math.min(ue,de);this.wrapper.style.top="".concat((N-J*Ce)/2,"px"),this.wrapper.style.left="".concat((g-Q*Ce)/2,"px"),this.wrapper.style.transform="scale(".concat(Ce,")"),this.wrapper.style.transformOrigin="0 0"}else this.wrapper.style.top="0px",this.wrapper.style.left="0px",this.wrapper.style.transform="scale(".concat(ue,", ").concat(de,")"),this.wrapper.style.transformOrigin="0 0"}}},{key:"onID3Addtrack",value:function(H){if(this.media){var P=H.track;P.kind==="metadata"&&(P.inBandMetadataTrackDispatchType!=="15260DFFFF49443320FF49443320000F"&&P.inBandMetadataTrackDispatchType!=="com.apple.streaming"&&P.label!=="id3"||this.setInBandMetadataTextTrack(P))}}},{key:"setupTrack",value:function(){var H,P;if(this.media){if((H=this.rendererOption)!==null&&H!==void 0&&H.useHighResTextTrack)this.b24Track=new Le(this.media),this.b24Track.startPolling();else{for(var g="ARIB B24 Japanese (data_identifier=0x".concat(this.data_identifier.toString(16),", data_group_id=").concat(this.data_group_id,")"),N=0;N<this.media.textTracks.length;N++){var Q=this.media.textTracks[N];if(Q.label===g){this.b24Track=Q;break}}this.b24Track||(this.b24Track=this.media.addTextTrack("metadata",g,"ja"),this.b24Track.mode="hidden")}if(this.b24Track.addEventListener("cuechange",this.onB24CueChangeHandler),(P=this.rendererOption)!==null&&P!==void 0&&P.enableAutoInBandMetadataTextTrackDetection){for(var J=0;J<this.media.textTracks.length;J++){var ue=this.media.textTracks[J];if(ue.kind==="metadata"&&(ue.inBandMetadataTrackDispatchType==="15260DFFFF49443320FF49443320000F"||ue.inBandMetadataTrackDispatchType==="com.apple.streaming"||ue.label==="id3")){this.setInBandMetadataTextTrack(ue);break}}this.media.textTracks.addEventListener("addtrack",this.onID3AddtrackHandler)}this.media.addEventListener("seeking",this.onSeekingHandler),this.media.addEventListener("seeked",this.onSeekedHandler)}}},{key:"setupTable",value:function(){var H=this;this.media&&this.subtitleElement&&(this.wrapper=document.createElement("div"),this.table=document.createElement("table"),this.wrapper.style.pointerEvents="none",this.wrapper.appendChild(this.table),this.subtitleElement.appendChild(this.wrapper),this.media.addEventListener("resize",this.onResizeHandler),window.ResizeObserver?(this.resizeObserver=new ResizeObserver(function(){H.onResize()}),this.resizeObserver.observe(this.media)):(window.addEventListener("resize",this.onResizeHandler),window.MutationObserver&&(this.mutationObserver=new MutationObserver(function(){H.onResize()}),this.mutationObserver.observe(this.media,{attributes:!0,attributeFilter:["class","style"]}))))}},{key:"cleanupTrack",value:function(){var H,P,g,N,Q,J;if(this.b24Track){if((J=this.rendererOption)!==null&&J!==void 0&&J.useHighResTextTrack)this.b24Track.stopPolling();else if(this.b24Track.cues)for(var ue=this.b24Track.cues.length-1;ue>=0;ue--)this.b24Track.removeCue(this.b24Track.cues[ue])}(H=this.b24Track)===null||H===void 0||H.removeEventListener("cuechange",this.onB24CueChangeHandler),(P=this.id3Track)===null||P===void 0||P.removeEventListener("cuechange",this.onID3CueChangeHandler),(g=this.media)===null||g===void 0||g.removeEventListener("seeking",this.onSeekingHandler),(N=this.media)===null||N===void 0||N.removeEventListener("seeked",this.onSeekedHandler),(Q=this.media)===null||Q===void 0||Q.textTracks.removeEventListener("addtrack",this.onID3AddtrackHandler),this.b24Track=this.id3Track=null}},{key:"cleanupTable",value:function(){var H;window.removeEventListener("resize",this.onResizeHandler),(H=this.media)===null||H===void 0||H.removeEventListener("resize",this.onResizeHandler),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.table&&this.wrapper&&this.wrapper.removeChild(this.table),this.wrapper&&this.subtitleElement&&this.subtitleElement.removeChild(this.wrapper),this.wrapper=this.table=null}}])&&Ht(oe.prototype,ge),oe}()},3099:function(l){l.exports=function(h){if(typeof h!="function")throw TypeError(String(h)+" is not a function");return h}},6077:function(l,h,r){var u=r(111);l.exports=function(m){if(!u(m)&&m!==null)throw TypeError("Can't set "+String(m)+" as a prototype");return m}},1223:function(l,h,r){var u=r(5112),m=r(30),p=r(3070),_=u("unscopables"),A=Array.prototype;A[_]==null&&p.f(A,_,{configurable:!0,value:m(null)}),l.exports=function(E){A[_][E]=!0}},1530:function(l,h,r){var u=r(8710).charAt;l.exports=function(m,p,_){return p+(_?u(m,p).length:1)}},5787:function(l){l.exports=function(h,r,u){if(!(h instanceof r))throw TypeError("Incorrect "+(u?u+" ":"")+"invocation");return h}},9670:function(l,h,r){var u=r(111);l.exports=function(m){if(!u(m))throw TypeError(String(m)+" is not an object");return m}},4019:function(l){l.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},260:function(l,h,r){var u,m=r(4019),p=r(9781),_=r(7854),A=r(111),E=r(6656),C=r(648),k=r(8880),O=r(1320),G=r(3070).f,B=r(9518),T=r(7674),L=r(5112),I=r(9711),M=_.Int8Array,K=M&&M.prototype,re=_.Uint8ClampedArray,ae=re&&re.prototype,te=M&&B(M),ne=K&&B(K),me=Object.prototype,Ae=me.isPrototypeOf,F=L("toStringTag"),y=I("TYPED_ARRAY_TAG"),v=m&&!!T&&C(_.opera)!=="Opera",S=!1,w={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},x={BigInt64Array:8,BigUint64Array:8},D=function(U){if(!A(U))return!1;var j=C(U);return E(w,j)||E(x,j)};for(u in w)_[u]||(v=!1);if((!v||typeof te!="function"||te===Function.prototype)&&(te=function(){throw TypeError("Incorrect invocation")},v))for(u in w)_[u]&&T(_[u],te);if((!v||!ne||ne===me)&&(ne=te.prototype,v))for(u in w)_[u]&&T(_[u].prototype,ne);if(v&&B(ae)!==ne&&T(ae,ne),p&&!E(ne,F))for(u in S=!0,G(ne,F,{get:function(){return A(this)?this[y]:void 0}}),w)_[u]&&k(_[u],y,u);l.exports={NATIVE_ARRAY_BUFFER_VIEWS:v,TYPED_ARRAY_TAG:S&&y,aTypedArray:function(U){if(D(U))return U;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(U){if(T){if(Ae.call(te,U))return U}else for(var j in w)if(E(w,u)){var X=_[j];if(X&&(U===X||Ae.call(X,U)))return U}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(U,j,X){if(p){if(X)for(var ee in w){var ie=_[ee];ie&&E(ie.prototype,U)&&delete ie.prototype[U]}ne[U]&&!X||O(ne,U,X?j:v&&K[U]||j)}},exportTypedArrayStaticMethod:function(U,j,X){var ee,ie;if(p){if(T){if(X)for(ee in w)(ie=_[ee])&&E(ie,U)&&delete ie[U];if(te[U]&&!X)return;try{return O(te,U,X?j:v&&M[U]||j)}catch{}}for(ee in w)!(ie=_[ee])||ie[U]&&!X||O(ie,U,j)}},isView:function(U){if(!A(U))return!1;var j=C(U);return j==="DataView"||E(w,j)||E(x,j)},isTypedArray:D,TypedArray:te,TypedArrayPrototype:ne}},3331:function(l,h,r){var u=r(7854),m=r(9781),p=r(4019),_=r(8880),A=r(2248),E=r(7293),C=r(5787),k=r(9958),O=r(7466),G=r(7067),B=r(1179),T=r(9518),L=r(7674),I=r(8006).f,M=r(3070).f,K=r(1285),re=r(8003),ae=r(9909),te=ae.get,ne=ae.set,me="ArrayBuffer",Ae="DataView",F="Wrong index",y=u.ArrayBuffer,v=y,S=u.DataView,w=S&&S.prototype,x=Object.prototype,D=u.RangeError,U=B.pack,j=B.unpack,X=function(je){return[255&je]},ee=function(je){return[255&je,je>>8&255]},ie=function(je){return[255&je,je>>8&255,je>>16&255,je>>24&255]},be=function(je){return je[3]<<24|je[2]<<16|je[1]<<8|je[0]},Te=function(je){return U(je,23,4)},Oe=function(je){return U(je,52,8)},He=function(je,he){M(je.prototype,he,{get:function(){return te(this)[he]}})},st=function(je,he,_e,Ne){var fe=G(_e),Je=te(je);if(fe+he>Je.byteLength)throw D(F);var ot=te(Je.buffer).bytes,nt=fe+Je.byteOffset,q=ot.slice(nt,nt+he);return Ne?q:q.reverse()},Le=function(je,he,_e,Ne,fe,Je){var ot=G(_e),nt=te(je);if(ot+he>nt.byteLength)throw D(F);for(var q=te(nt.buffer).bytes,Z=ot+nt.byteOffset,z=Ne(+fe),$=0;$<he;$++)q[Z+$]=z[Je?$:he-$-1]};if(p){if(!E(function(){y(1)})||!E(function(){new y(-1)})||E(function(){return new y,new y(1.5),new y(NaN),y.name!=me})){for(var rt,tt=(v=function(je){return C(this,v),new y(G(je))}).prototype=y.prototype,Ee=I(y),ft=0;Ee.length>ft;)(rt=Ee[ft++])in v||_(v,rt,y[rt]);tt.constructor=v}L&&T(w)!==x&&L(w,x);var pt=new S(new v(2)),Ze=w.setInt8;pt.setInt8(0,2147483648),pt.setInt8(1,2147483649),!pt.getInt8(0)&&pt.getInt8(1)||A(w,{setInt8:function(je,he){Ze.call(this,je,he<<24>>24)},setUint8:function(je,he){Ze.call(this,je,he<<24>>24)}},{unsafe:!0})}else v=function(je){C(this,v,me);var he=G(je);ne(this,{bytes:K.call(new Array(he),0),byteLength:he}),m||(this.byteLength=he)},S=function(je,he,_e){C(this,S,Ae),C(je,v,Ae);var Ne=te(je).byteLength,fe=k(he);if(fe<0||fe>Ne)throw D("Wrong offset");if(fe+(_e=_e===void 0?Ne-fe:O(_e))>Ne)throw D("Wrong length");ne(this,{buffer:je,byteLength:_e,byteOffset:fe}),m||(this.buffer=je,this.byteLength=_e,this.byteOffset=fe)},m&&(He(v,"byteLength"),He(S,"buffer"),He(S,"byteLength"),He(S,"byteOffset")),A(S.prototype,{getInt8:function(je){return st(this,1,je)[0]<<24>>24},getUint8:function(je){return st(this,1,je)[0]},getInt16:function(je){var he=st(this,2,je,arguments.length>1?arguments[1]:void 0);return(he[1]<<8|he[0])<<16>>16},getUint16:function(je){var he=st(this,2,je,arguments.length>1?arguments[1]:void 0);return he[1]<<8|he[0]},getInt32:function(je){return be(st(this,4,je,arguments.length>1?arguments[1]:void 0))},getUint32:function(je){return be(st(this,4,je,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(je){return j(st(this,4,je,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(je){return j(st(this,8,je,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(je,he){Le(this,1,je,X,he)},setUint8:function(je,he){Le(this,1,je,X,he)},setInt16:function(je,he){Le(this,2,je,ee,he,arguments.length>2?arguments[2]:void 0)},setUint16:function(je,he){Le(this,2,je,ee,he,arguments.length>2?arguments[2]:void 0)},setInt32:function(je,he){Le(this,4,je,ie,he,arguments.length>2?arguments[2]:void 0)},setUint32:function(je,he){Le(this,4,je,ie,he,arguments.length>2?arguments[2]:void 0)},setFloat32:function(je,he){Le(this,4,je,Te,he,arguments.length>2?arguments[2]:void 0)},setFloat64:function(je,he){Le(this,8,je,Oe,he,arguments.length>2?arguments[2]:void 0)}});re(v,me),re(S,Ae),l.exports={ArrayBuffer:v,DataView:S}},1048:function(l,h,r){var u=r(7908),m=r(1400),p=r(7466),_=Math.min;l.exports=[].copyWithin||function(A,E){var C=u(this),k=p(C.length),O=m(A,k),G=m(E,k),B=arguments.length>2?arguments[2]:void 0,T=_((B===void 0?k:m(B,k))-G,k-O),L=1;for(G<O&&O<G+T&&(L=-1,G+=T-1,O+=T-1);T-- >0;)G in C?C[O]=C[G]:delete C[O],O+=L,G+=L;return C}},1285:function(l,h,r){var u=r(7908),m=r(1400),p=r(7466);l.exports=function(_){for(var A=u(this),E=p(A.length),C=arguments.length,k=m(C>1?arguments[1]:void 0,E),O=C>2?arguments[2]:void 0,G=O===void 0?E:m(O,E);G>k;)A[k++]=_;return A}},8533:function(l,h,r){var u=r(2092).forEach,m=r(9341),p=r(9207),_=m("forEach"),A=p("forEach");l.exports=_&&A?[].forEach:function(E){return u(this,E,arguments.length>1?arguments[1]:void 0)}},1318:function(l,h,r){var u=r(5656),m=r(7466),p=r(1400),_=function(A){return function(E,C,k){var O,G=u(E),B=m(G.length),T=p(k,B);if(A&&C!=C){for(;B>T;)if((O=G[T++])!=O)return!0}else for(;B>T;T++)if((A||T in G)&&G[T]===C)return A||T||0;return!A&&-1}};l.exports={includes:_(!0),indexOf:_(!1)}},2092:function(l,h,r){var u=r(9974),m=r(8361),p=r(7908),_=r(7466),A=r(5417),E=[].push,C=function(k){var O=k==1,G=k==2,B=k==3,T=k==4,L=k==6,I=k==7,M=k==5||L;return function(K,re,ae,te){for(var ne,me,Ae=p(K),F=m(Ae),y=u(re,ae,3),v=_(F.length),S=0,w=te||A,x=O?w(K,v):G||I?w(K,0):void 0;v>S;S++)if((M||S in F)&&(me=y(ne=F[S],S,Ae),k))if(O)x[S]=me;else if(me)switch(k){case 3:return!0;case 5:return ne;case 6:return S;case 2:E.call(x,ne)}else switch(k){case 4:return!1;case 7:E.call(x,ne)}return L?-1:B||T?T:x}};l.exports={forEach:C(0),map:C(1),filter:C(2),some:C(3),every:C(4),find:C(5),findIndex:C(6),filterOut:C(7)}},6583:function(l,h,r){var u=r(5656),m=r(9958),p=r(7466),_=r(9341),A=r(9207),E=Math.min,C=[].lastIndexOf,k=!!C&&1/[1].lastIndexOf(1,-0)<0,O=_("lastIndexOf"),G=A("indexOf",{ACCESSORS:!0,1:0}),B=k||!O||!G;l.exports=B?function(T){if(k)return C.apply(this,arguments)||0;var L=u(this),I=p(L.length),M=I-1;for(arguments.length>1&&(M=E(M,m(arguments[1]))),M<0&&(M=I+M);M>=0;M--)if(M in L&&L[M]===T)return M||0;return-1}:C},1194:function(l,h,r){var u=r(7293),m=r(5112),p=r(7392),_=m("species");l.exports=function(A){return p>=51||!u(function(){var E=[];return(E.constructor={})[_]=function(){return{foo:1}},E[A](Boolean).foo!==1})}},9341:function(l,h,r){var u=r(7293);l.exports=function(m,p){var _=[][m];return!!_&&u(function(){_.call(null,p||function(){throw 1},1)})}},9207:function(l,h,r){var u=r(9781),m=r(7293),p=r(6656),_=Object.defineProperty,A={},E=function(C){throw C};l.exports=function(C,k){if(p(A,C))return A[C];k||(k={});var O=[][C],G=!!p(k,"ACCESSORS")&&k.ACCESSORS,B=p(k,0)?k[0]:E,T=p(k,1)?k[1]:void 0;return A[C]=!!O&&!m(function(){if(G&&!u)return!0;var L={length:-1};G?_(L,1,{enumerable:!0,get:E}):L[1]=1,O.call(L,B,T)})}},3671:function(l,h,r){var u=r(3099),m=r(7908),p=r(8361),_=r(7466),A=function(E){return function(C,k,O,G){u(k);var B=m(C),T=p(B),L=_(B.length),I=E?L-1:0,M=E?-1:1;if(O<2)for(;;){if(I in T){G=T[I],I+=M;break}if(I+=M,E?I<0:L<=I)throw TypeError("Reduce of empty array with no initial value")}for(;E?I>=0:L>I;I+=M)I in T&&(G=k(G,T[I],I,B));return G}};l.exports={left:A(!1),right:A(!0)}},5417:function(l,h,r){var u=r(111),m=r(3157),p=r(5112)("species");l.exports=function(_,A){var E;return m(_)&&(typeof(E=_.constructor)!="function"||E!==Array&&!m(E.prototype)?u(E)&&(E=E[p])===null&&(E=void 0):E=void 0),new(E===void 0?Array:E)(A===0?0:A)}},7072:function(l,h,r){var u=r(5112)("iterator"),m=!1;try{var p=0,_={next:function(){return{done:!!p++}},return:function(){m=!0}};_[u]=function(){return this},Array.from(_,function(){throw 2})}catch{}l.exports=function(A,E){if(!E&&!m)return!1;var C=!1;try{var k={};k[u]=function(){return{next:function(){return{done:C=!0}}}},A(k)}catch{}return C}},4326:function(l){var h={}.toString;l.exports=function(r){return h.call(r).slice(8,-1)}},648:function(l,h,r){var u=r(1694),m=r(4326),p=r(5112)("toStringTag"),_=m(function(){return arguments}())=="Arguments";l.exports=u?m:function(A){var E,C,k;return A===void 0?"Undefined":A===null?"Null":typeof(C=function(O,G){try{return O[G]}catch{}}(E=Object(A),p))=="string"?C:_?m(E):(k=m(E))=="Object"&&typeof E.callee=="function"?"Arguments":k}},5631:function(l,h,r){var u=r(3070).f,m=r(30),p=r(2248),_=r(9974),A=r(5787),E=r(408),C=r(654),k=r(6340),O=r(9781),G=r(2423).fastKey,B=r(9909),T=B.set,L=B.getterFor;l.exports={getConstructor:function(I,M,K,re){var ae=I(function(Ae,F){A(Ae,ae,M),T(Ae,{type:M,index:m(null),first:void 0,last:void 0,size:0}),O||(Ae.size=0),F!=null&&E(F,Ae[re],{that:Ae,AS_ENTRIES:K})}),te=L(M),ne=function(Ae,F,y){var v,S,w=te(Ae),x=me(Ae,F);return x?x.value=y:(w.last=x={index:S=G(F,!0),key:F,value:y,previous:v=w.last,next:void 0,removed:!1},w.first||(w.first=x),v&&(v.next=x),O?w.size++:Ae.size++,S!=="F"&&(w.index[S]=x)),Ae},me=function(Ae,F){var y,v=te(Ae),S=G(F);if(S!=="F")return v.index[S];for(y=v.first;y;y=y.next)if(y.key==F)return y};return p(ae.prototype,{clear:function(){for(var Ae=te(this),F=Ae.index,y=Ae.first;y;)y.removed=!0,y.previous&&(y.previous=y.previous.next=void 0),delete F[y.index],y=y.next;Ae.first=Ae.last=void 0,O?Ae.size=0:this.size=0},delete:function(Ae){var F=this,y=te(F),v=me(F,Ae);if(v){var S=v.next,w=v.previous;delete y.index[v.index],v.removed=!0,w&&(w.next=S),S&&(S.previous=w),y.first==v&&(y.first=S),y.last==v&&(y.last=w),O?y.size--:F.size--}return!!v},forEach:function(Ae){for(var F,y=te(this),v=_(Ae,arguments.length>1?arguments[1]:void 0,3);F=F?F.next:y.first;)for(v(F.value,F.key,this);F&&F.removed;)F=F.previous},has:function(Ae){return!!me(this,Ae)}}),p(ae.prototype,K?{get:function(Ae){var F=me(this,Ae);return F&&F.value},set:function(Ae,F){return ne(this,Ae===0?0:Ae,F)}}:{add:function(Ae){return ne(this,Ae=Ae===0?0:Ae,Ae)}}),O&&u(ae.prototype,"size",{get:function(){return te(this).size}}),ae},setStrong:function(I,M,K){var re=M+" Iterator",ae=L(M),te=L(re);C(I,M,function(ne,me){T(this,{type:re,target:ne,state:ae(ne),kind:me,last:void 0})},function(){for(var ne=te(this),me=ne.kind,Ae=ne.last;Ae&&Ae.removed;)Ae=Ae.previous;return ne.target&&(ne.last=Ae=Ae?Ae.next:ne.state.first)?me=="keys"?{value:Ae.key,done:!1}:me=="values"?{value:Ae.value,done:!1}:{value:[Ae.key,Ae.value],done:!1}:(ne.target=void 0,{value:void 0,done:!0})},K?"entries":"values",!K,!0),k(M)}}},7710:function(l,h,r){var u=r(2109),m=r(7854),p=r(4705),_=r(1320),A=r(2423),E=r(408),C=r(5787),k=r(111),O=r(7293),G=r(7072),B=r(8003),T=r(9587);l.exports=function(L,I,M){var K=L.indexOf("Map")!==-1,re=L.indexOf("Weak")!==-1,ae=K?"set":"add",te=m[L],ne=te&&te.prototype,me=te,Ae={},F=function(D){var U=ne[D];_(ne,D,D=="add"?function(j){return U.call(this,j===0?0:j),this}:D=="delete"?function(j){return!(re&&!k(j))&&U.call(this,j===0?0:j)}:D=="get"?function(j){return re&&!k(j)?void 0:U.call(this,j===0?0:j)}:D=="has"?function(j){return!(re&&!k(j))&&U.call(this,j===0?0:j)}:function(j,X){return U.call(this,j===0?0:j,X),this})};if(p(L,typeof te!="function"||!(re||ne.forEach&&!O(function(){new te().entries().next()}))))me=M.getConstructor(I,L,K,ae),A.REQUIRED=!0;else if(p(L,!0)){var y=new me,v=y[ae](re?{}:-0,1)!=y,S=O(function(){y.has(1)}),w=G(function(D){new te(D)}),x=!re&&O(function(){for(var D=new te,U=5;U--;)D[ae](U,U);return!D.has(-0)});w||((me=I(function(D,U){C(D,me,L);var j=T(new te,D,me);return U!=null&&E(U,j[ae],{that:j,AS_ENTRIES:K}),j})).prototype=ne,ne.constructor=me),(S||x)&&(F("delete"),F("has"),K&&F("get")),(x||v)&&F(ae),re&&ne.clear&&delete ne.clear}return Ae[L]=me,u({global:!0,forced:me!=te},Ae),B(me,L),re||M.setStrong(me,L,K),me}},9920:function(l,h,r){var u=r(6656),m=r(3887),p=r(1236),_=r(3070);l.exports=function(A,E){for(var C=m(E),k=_.f,O=p.f,G=0;G<C.length;G++){var B=C[G];u(A,B)||k(A,B,O(E,B))}}},4964:function(l,h,r){var u=r(5112)("match");l.exports=function(m){var p=/./;try{"/./"[m](p)}catch{try{return p[u]=!1,"/./"[m](p)}catch{}}return!1}},8544:function(l,h,r){var u=r(7293);l.exports=!u(function(){function m(){}return m.prototype.constructor=null,Object.getPrototypeOf(new m)!==m.prototype})},4994:function(l,h,r){var u=r(3383).IteratorPrototype,m=r(30),p=r(9114),_=r(8003),A=r(7497),E=function(){return this};l.exports=function(C,k,O){var G=k+" Iterator";return C.prototype=m(u,{next:p(1,O)}),_(C,G,!1,!0),A[G]=E,C}},8880:function(l,h,r){var u=r(9781),m=r(3070),p=r(9114);l.exports=u?function(_,A,E){return m.f(_,A,p(1,E))}:function(_,A,E){return _[A]=E,_}},9114:function(l){l.exports=function(h,r){return{enumerable:!(1&h),configurable:!(2&h),writable:!(4&h),value:r}}},6135:function(l,h,r){var u=r(7593),m=r(3070),p=r(9114);l.exports=function(_,A,E){var C=u(A);C in _?m.f(_,C,p(0,E)):_[C]=E}},654:function(l,h,r){var u=r(2109),m=r(4994),p=r(9518),_=r(7674),A=r(8003),E=r(8880),C=r(1320),k=r(5112),O=r(1913),G=r(7497),B=r(3383),T=B.IteratorPrototype,L=B.BUGGY_SAFARI_ITERATORS,I=k("iterator"),M="keys",K="values",re="entries",ae=function(){return this};l.exports=function(te,ne,me,Ae,F,y,v){m(me,ne,Ae);var S,w,x,D=function(Te){if(Te===F&&ie)return ie;if(!L&&Te in X)return X[Te];switch(Te){case M:case K:case re:return function(){return new me(this,Te)}}return function(){return new me(this)}},U=ne+" Iterator",j=!1,X=te.prototype,ee=X[I]||X["@@iterator"]||F&&X[F],ie=!L&&ee||D(F),be=ne=="Array"&&X.entries||ee;if(be&&(S=p(be.call(new te)),T!==Object.prototype&&S.next&&(O||p(S)===T||(_?_(S,T):typeof S[I]!="function"&&E(S,I,ae)),A(S,U,!0,!0),O&&(G[U]=ae))),F==K&&ee&&ee.name!==K&&(j=!0,ie=function(){return ee.call(this)}),O&&!v||X[I]===ie||E(X,I,ie),G[ne]=ie,F)if(w={values:D(K),keys:y?ie:D(M),entries:D(re)},v)for(x in w)(L||j||!(x in X))&&C(X,x,w[x]);else u({target:ne,proto:!0,forced:L||j},w);return w}},7235:function(l,h,r){var u=r(857),m=r(6656),p=r(6061),_=r(3070).f;l.exports=function(A){var E=u.Symbol||(u.Symbol={});m(E,A)||_(E,A,{value:p.f(A)})}},9781:function(l,h,r){var u=r(7293);l.exports=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:function(l,h,r){var u=r(7854),m=r(111),p=u.document,_=m(p)&&m(p.createElement);l.exports=function(A){return _?p.createElement(A):{}}},8324:function(l){l.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8113:function(l,h,r){var u=r(5005);l.exports=u("navigator","userAgent")||""},7392:function(l,h,r){var u,m,p=r(7854),_=r(8113),A=p.process,E=A&&A.versions,C=E&&E.v8;C?m=(u=C.split("."))[0]+u[1]:_&&(!(u=_.match(/Edge\/(\d+)/))||u[1]>=74)&&(u=_.match(/Chrome\/(\d+)/))&&(m=u[1]),l.exports=m&&+m},748:function(l){l.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(l,h,r){var u=r(7854),m=r(1236).f,p=r(8880),_=r(1320),A=r(3505),E=r(9920),C=r(4705);l.exports=function(k,O){var G,B,T,L,I,M=k.target,K=k.global,re=k.stat;if(G=K?u:re?u[M]||A(M,{}):(u[M]||{}).prototype)for(B in O){if(L=O[B],T=k.noTargetGet?(I=m(G,B))&&I.value:G[B],!C(K?B:M+(re?".":"#")+B,k.forced)&&T!==void 0){if(typeof L==typeof T)continue;E(L,T)}(k.sham||T&&T.sham)&&p(L,"sham",!0),_(G,B,L,k)}}},7293:function(l){l.exports=function(h){try{return!!h()}catch{return!0}}},7007:function(l,h,r){r(4916);var u=r(1320),m=r(7293),p=r(5112),_=r(2261),A=r(8880),E=p("species"),C=!m(function(){var T=/./;return T.exec=function(){var L=[];return L.groups={a:"7"},L},"".replace(T,"$<a>")!=="7"}),k="a".replace(/./,"$0")==="$0",O=p("replace"),G=!!/./[O]&&/./[O]("a","$0")==="",B=!m(function(){var T=/(?:)/,L=T.exec;T.exec=function(){return L.apply(this,arguments)};var I="ab".split(T);return I.length!==2||I[0]!=="a"||I[1]!=="b"});l.exports=function(T,L,I,M){var K=p(T),re=!m(function(){var F={};return F[K]=function(){return 7},""[T](F)!=7}),ae=re&&!m(function(){var F=!1,y=/a/;return T==="split"&&((y={}).constructor={},y.constructor[E]=function(){return y},y.flags="",y[K]=/./[K]),y.exec=function(){return F=!0,null},y[K](""),!F});if(!re||!ae||T==="replace"&&(!C||!k||G)||T==="split"&&!B){var te=/./[K],ne=I(K,""[T],function(F,y,v,S,w){return y.exec===_?re&&!w?{done:!0,value:te.call(y,v,S)}:{done:!0,value:F.call(v,y,S)}:{done:!1}},{REPLACE_KEEPS_$0:k,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:G}),me=ne[0],Ae=ne[1];u(String.prototype,T,me),u(RegExp.prototype,K,L==2?function(F,y){return Ae.call(F,this,y)}:function(F){return Ae.call(F,this)})}M&&A(RegExp.prototype[K],"sham",!0)}},6677:function(l,h,r){var u=r(7293);l.exports=!u(function(){return Object.isExtensible(Object.preventExtensions({}))})},9974:function(l,h,r){var u=r(3099);l.exports=function(m,p,_){if(u(m),p===void 0)return m;switch(_){case 0:return function(){return m.call(p)};case 1:return function(A){return m.call(p,A)};case 2:return function(A,E){return m.call(p,A,E)};case 3:return function(A,E,C){return m.call(p,A,E,C)}}return function(){return m.apply(p,arguments)}}},5005:function(l,h,r){var u=r(857),m=r(7854),p=function(_){return typeof _=="function"?_:void 0};l.exports=function(_,A){return arguments.length<2?p(u[_])||p(m[_]):u[_]&&u[_][A]||m[_]&&m[_][A]}},1246:function(l,h,r){var u=r(648),m=r(7497),p=r(5112)("iterator");l.exports=function(_){if(_!=null)return _[p]||_["@@iterator"]||m[u(_)]}},647:function(l,h,r){var u=r(7908),m=Math.floor,p="".replace,_=/\$([$&'`]|\d\d?|<[^>]*>)/g,A=/\$([$&'`]|\d\d?)/g;l.exports=function(E,C,k,O,G,B){var T=k+E.length,L=O.length,I=A;return G!==void 0&&(G=u(G),I=_),p.call(B,I,function(M,K){var re;switch(K.charAt(0)){case"$":return"$";case"&":return E;case"`":return C.slice(0,k);case"'":return C.slice(T);case"<":re=G[K.slice(1,-1)];break;default:var ae=+K;if(ae===0)return M;if(ae>L){var te=m(ae/10);return te===0?M:te<=L?O[te-1]===void 0?K.charAt(1):O[te-1]+K.charAt(1):M}re=O[ae-1]}return re===void 0?"":re})}},7854:function(l,h,r){var u=function(m){return m&&m.Math==Math&&m};l.exports=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof r.g=="object"&&r.g)||function(){return this}()||Function("return this")()},6656:function(l){var h={}.hasOwnProperty;l.exports=function(r,u){return h.call(r,u)}},3501:function(l){l.exports={}},490:function(l,h,r){var u=r(5005);l.exports=u("document","documentElement")},4664:function(l,h,r){var u=r(9781),m=r(7293),p=r(317);l.exports=!u&&!m(function(){return Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a!=7})},1179:function(l){var h=1/0,r=Math.abs,u=Math.pow,m=Math.floor,p=Math.log,_=Math.LN2;l.exports={pack:function(A,E,C){var k,O,G,B=new Array(C),T=8*C-E-1,L=(1<<T)-1,I=L>>1,M=E===23?u(2,-24)-u(2,-77):0,K=A<0||A===0&&1/A<0?1:0,re=0;for((A=r(A))!=A||A===h?(O=A!=A?1:0,k=L):(k=m(p(A)/_),A*(G=u(2,-k))<1&&(k--,G*=2),(A+=k+I>=1?M/G:M*u(2,1-I))*G>=2&&(k++,G/=2),k+I>=L?(O=0,k=L):k+I>=1?(O=(A*G-1)*u(2,E),k+=I):(O=A*u(2,I-1)*u(2,E),k=0));E>=8;B[re++]=255&O,O/=256,E-=8);for(k=k<<E|O,T+=E;T>0;B[re++]=255&k,k/=256,T-=8);return B[--re]|=128*K,B},unpack:function(A,E){var C,k=A.length,O=8*k-E-1,G=(1<<O)-1,B=G>>1,T=O-7,L=k-1,I=A[L--],M=127&I;for(I>>=7;T>0;M=256*M+A[L],L--,T-=8);for(C=M&(1<<-T)-1,M>>=-T,T+=E;T>0;C=256*C+A[L],L--,T-=8);if(M===0)M=1-B;else{if(M===G)return C?NaN:I?-1/0:h;C+=u(2,E),M-=B}return(I?-1:1)*C*u(2,M-E)}}},8361:function(l,h,r){var u=r(7293),m=r(4326),p="".split;l.exports=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(_){return m(_)=="String"?p.call(_,""):Object(_)}:Object},9587:function(l,h,r){var u=r(111),m=r(7674);l.exports=function(p,_,A){var E,C;return m&&typeof(E=_.constructor)=="function"&&E!==A&&u(C=E.prototype)&&C!==A.prototype&&m(p,C),p}},2788:function(l,h,r){var u=r(5465),m=Function.toString;typeof u.inspectSource!="function"&&(u.inspectSource=function(p){return m.call(p)}),l.exports=u.inspectSource},2423:function(l,h,r){var u=r(3501),m=r(111),p=r(6656),_=r(3070).f,A=r(9711),E=r(6677),C=A("meta"),k=0,O=Object.isExtensible||function(){return!0},G=function(T){_(T,C,{value:{objectID:"O"+ ++k,weakData:{}}})},B=l.exports={REQUIRED:!1,fastKey:function(T,L){if(!m(T))return typeof T=="symbol"?T:(typeof T=="string"?"S":"P")+T;if(!p(T,C)){if(!O(T))return"F";if(!L)return"E";G(T)}return T[C].objectID},getWeakData:function(T,L){if(!p(T,C)){if(!O(T))return!0;if(!L)return!1;G(T)}return T[C].weakData},onFreeze:function(T){return E&&B.REQUIRED&&O(T)&&!p(T,C)&&G(T),T}};u[C]=!0},9909:function(l,h,r){var u,m,p,_=r(8536),A=r(7854),E=r(111),C=r(8880),k=r(6656),O=r(5465),G=r(6200),B=r(3501),T=A.WeakMap;if(_){var L=O.state||(O.state=new T),I=L.get,M=L.has,K=L.set;u=function(ae,te){return te.facade=ae,K.call(L,ae,te),te},m=function(ae){return I.call(L,ae)||{}},p=function(ae){return M.call(L,ae)}}else{var re=G("state");B[re]=!0,u=function(ae,te){return te.facade=ae,C(ae,re,te),te},m=function(ae){return k(ae,re)?ae[re]:{}},p=function(ae){return k(ae,re)}}l.exports={set:u,get:m,has:p,enforce:function(ae){return p(ae)?m(ae):u(ae,{})},getterFor:function(ae){return function(te){var ne;if(!E(te)||(ne=m(te)).type!==ae)throw TypeError("Incompatible receiver, "+ae+" required");return ne}}}},7659:function(l,h,r){var u=r(5112),m=r(7497),p=u("iterator"),_=Array.prototype;l.exports=function(A){return A!==void 0&&(m.Array===A||_[p]===A)}},3157:function(l,h,r){var u=r(4326);l.exports=Array.isArray||function(m){return u(m)=="Array"}},4705:function(l,h,r){var u=r(7293),m=/#|\.prototype\./,p=function(k,O){var G=A[_(k)];return G==C||G!=E&&(typeof O=="function"?u(O):!!O)},_=p.normalize=function(k){return String(k).replace(m,".").toLowerCase()},A=p.data={},E=p.NATIVE="N",C=p.POLYFILL="P";l.exports=p},111:function(l){l.exports=function(h){return typeof h=="object"?h!==null:typeof h=="function"}},1913:function(l){l.exports=!1},7850:function(l,h,r){var u=r(111),m=r(4326),p=r(5112)("match");l.exports=function(_){var A;return u(_)&&((A=_[p])!==void 0?!!A:m(_)=="RegExp")}},408:function(l,h,r){var u=r(9670),m=r(7659),p=r(7466),_=r(9974),A=r(1246),E=r(9212),C=function(k,O){this.stopped=k,this.result=O};l.exports=function(k,O,G){var B,T,L,I,M,K,re,ae=G&&G.that,te=!(!G||!G.AS_ENTRIES),ne=!(!G||!G.IS_ITERATOR),me=!(!G||!G.INTERRUPTED),Ae=_(O,ae,1+te+me),F=function(v){return B&&E(B),new C(!0,v)},y=function(v){return te?(u(v),me?Ae(v[0],v[1],F):Ae(v[0],v[1])):me?Ae(v,F):Ae(v)};if(ne)B=k;else{if(typeof(T=A(k))!="function")throw TypeError("Target is not iterable");if(m(T)){for(L=0,I=p(k.length);I>L;L++)if((M=y(k[L]))&&M instanceof C)return M;return new C(!1)}B=T.call(k)}for(K=B.next;!(re=K.call(B)).done;){try{M=y(re.value)}catch(v){throw E(B),v}if(typeof M=="object"&&M&&M instanceof C)return M}return new C(!1)}},9212:function(l,h,r){var u=r(9670);l.exports=function(m){var p=m.return;if(p!==void 0)return u(p.call(m)).value}},3383:function(l,h,r){var u,m,p,_=r(7293),A=r(9518),E=r(8880),C=r(6656),k=r(5112),O=r(1913),G=k("iterator"),B=!1;[].keys&&("next"in(p=[].keys())?(m=A(A(p)))!==Object.prototype&&(u=m):B=!0);var T=u==null||_(function(){var L={};return u[G].call(L)!==L});T&&(u={}),O&&!T||C(u,G)||E(u,G,function(){return this}),l.exports={IteratorPrototype:u,BUGGY_SAFARI_ITERATORS:B}},7497:function(l){l.exports={}},133:function(l,h,r){var u=r(7293);l.exports=!!Object.getOwnPropertySymbols&&!u(function(){return!String(Symbol())})},8536:function(l,h,r){var u=r(7854),m=r(2788),p=u.WeakMap;l.exports=typeof p=="function"&&/native code/.test(m(p))},3929:function(l,h,r){var u=r(7850);l.exports=function(m){if(u(m))throw TypeError("The method doesn't accept regular expressions");return m}},7023:function(l,h,r){var u=r(7854).isFinite;l.exports=Number.isFinite||function(m){return typeof m=="number"&&u(m)}},3009:function(l,h,r){var u=r(7854),m=r(3111).trim,p=r(1361),_=u.parseInt,A=/^[+-]?0[Xx]/,E=_(p+"08")!==8||_(p+"0x16")!==22;l.exports=E?function(C,k){var O=m(String(C));return _(O,k>>>0||(A.test(O)?16:10))}:_},30:function(l,h,r){var u,m=r(9670),p=r(6048),_=r(748),A=r(3501),E=r(490),C=r(317),k=r(6200)("IE_PROTO"),O=function(){},G=function(T){return"<script>"+T+"<\/script>"},B=function(){try{u=document.domain&&new ActiveXObject("htmlfile")}catch{}var T,L;B=u?function(M){M.write(G("")),M.close();var K=M.parentWindow.Object;return M=null,K}(u):((L=C("iframe")).style.display="none",E.appendChild(L),L.src="javascript:",(T=L.contentWindow.document).open(),T.write(G("document.F=Object")),T.close(),T.F);for(var I=_.length;I--;)delete B.prototype[_[I]];return B()};A[k]=!0,l.exports=Object.create||function(T,L){var I;return T!==null?(O.prototype=m(T),I=new O,O.prototype=null,I[k]=T):I=B(),L===void 0?I:p(I,L)}},6048:function(l,h,r){var u=r(9781),m=r(3070),p=r(9670),_=r(1956);l.exports=u?Object.defineProperties:function(A,E){p(A);for(var C,k=_(E),O=k.length,G=0;O>G;)m.f(A,C=k[G++],E[C]);return A}},3070:function(l,h,r){var u=r(9781),m=r(4664),p=r(9670),_=r(7593),A=Object.defineProperty;h.f=u?A:function(E,C,k){if(p(E),C=_(C,!0),p(k),m)try{return A(E,C,k)}catch{}if("get"in k||"set"in k)throw TypeError("Accessors not supported");return"value"in k&&(E[C]=k.value),E}},1236:function(l,h,r){var u=r(9781),m=r(5296),p=r(9114),_=r(5656),A=r(7593),E=r(6656),C=r(4664),k=Object.getOwnPropertyDescriptor;h.f=u?k:function(O,G){if(O=_(O),G=A(G,!0),C)try{return k(O,G)}catch{}if(E(O,G))return p(!m.f.call(O,G),O[G])}},1156:function(l,h,r){var u=r(5656),m=r(8006).f,p={}.toString,_=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];l.exports.f=function(A){return _&&p.call(A)=="[object Window]"?function(E){try{return m(E)}catch{return _.slice()}}(A):m(u(A))}},8006:function(l,h,r){var u=r(6324),m=r(748).concat("length","prototype");h.f=Object.getOwnPropertyNames||function(p){return u(p,m)}},5181:function(l,h){h.f=Object.getOwnPropertySymbols},9518:function(l,h,r){var u=r(6656),m=r(7908),p=r(6200),_=r(8544),A=p("IE_PROTO"),E=Object.prototype;l.exports=_?Object.getPrototypeOf:function(C){return C=m(C),u(C,A)?C[A]:typeof C.constructor=="function"&&C instanceof C.constructor?C.constructor.prototype:C instanceof Object?E:null}},6324:function(l,h,r){var u=r(6656),m=r(5656),p=r(1318).indexOf,_=r(3501);l.exports=function(A,E){var C,k=m(A),O=0,G=[];for(C in k)!u(_,C)&&u(k,C)&&G.push(C);for(;E.length>O;)u(k,C=E[O++])&&(~p(G,C)||G.push(C));return G}},1956:function(l,h,r){var u=r(6324),m=r(748);l.exports=Object.keys||function(p){return u(p,m)}},5296:function(l,h){var r={}.propertyIsEnumerable,u=Object.getOwnPropertyDescriptor,m=u&&!r.call({1:2},1);h.f=m?function(p){var _=u(this,p);return!!_&&_.enumerable}:r},7674:function(l,h,r){var u=r(9670),m=r(6077);l.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var p,_=!1,A={};try{(p=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(A,[]),_=A instanceof Array}catch{}return function(E,C){return u(E),m(C),_?p.call(E,C):E.__proto__=C,E}}():void 0)},4699:function(l,h,r){var u=r(9781),m=r(1956),p=r(5656),_=r(5296).f,A=function(E){return function(C){for(var k,O=p(C),G=m(O),B=G.length,T=0,L=[];B>T;)k=G[T++],u&&!_.call(O,k)||L.push(E?[k,O[k]]:O[k]);return L}};l.exports={entries:A(!0),values:A(!1)}},288:function(l,h,r){var u=r(1694),m=r(648);l.exports=u?{}.toString:function(){return"[object "+m(this)+"]"}},3887:function(l,h,r){var u=r(5005),m=r(8006),p=r(5181),_=r(9670);l.exports=u("Reflect","ownKeys")||function(A){var E=m.f(_(A)),C=p.f;return C?E.concat(C(A)):E}},857:function(l,h,r){var u=r(7854);l.exports=u},2248:function(l,h,r){var u=r(1320);l.exports=function(m,p,_){for(var A in p)u(m,A,p[A],_);return m}},1320:function(l,h,r){var u=r(7854),m=r(8880),p=r(6656),_=r(3505),A=r(2788),E=r(9909),C=E.get,k=E.enforce,O=String(String).split("String");(l.exports=function(G,B,T,L){var I,M=!!L&&!!L.unsafe,K=!!L&&!!L.enumerable,re=!!L&&!!L.noTargetGet;typeof T=="function"&&(typeof B!="string"||p(T,"name")||m(T,"name",B),(I=k(T)).source||(I.source=O.join(typeof B=="string"?B:""))),G!==u?(M?!re&&G[B]&&(K=!0):delete G[B],K?G[B]=T:m(G,B,T)):K?G[B]=T:_(B,T)})(Function.prototype,"toString",function(){return typeof this=="function"&&C(this).source||A(this)})},7651:function(l,h,r){var u=r(4326),m=r(2261);l.exports=function(p,_){var A=p.exec;if(typeof A=="function"){var E=A.call(p,_);if(typeof E!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return E}if(u(p)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return m.call(p,_)}},2261:function(l,h,r){var u,m,p=r(7066),_=r(2999),A=RegExp.prototype.exec,E=String.prototype.replace,C=A,k=(u=/a/,m=/b*/g,A.call(u,"a"),A.call(m,"a"),u.lastIndex!==0||m.lastIndex!==0),O=_.UNSUPPORTED_Y||_.BROKEN_CARET,G=/()??/.exec("")[1]!==void 0;(k||G||O)&&(C=function(B){var T,L,I,M,K=this,re=O&&K.sticky,ae=p.call(K),te=K.source,ne=0,me=B;return re&&((ae=ae.replace("y","")).indexOf("g")===-1&&(ae+="g"),me=String(B).slice(K.lastIndex),K.lastIndex>0&&(!K.multiline||K.multiline&&B[K.lastIndex-1]!==`
`)&&(te="(?: "+te+")",me=" "+me,ne++),L=new RegExp("^(?:"+te+")",ae)),G&&(L=new RegExp("^"+te+"$(?!\\s)",ae)),k&&(T=K.lastIndex),I=A.call(re?L:K,me),re?I?(I.input=I.input.slice(ne),I[0]=I[0].slice(ne),I.index=K.lastIndex,K.lastIndex+=I[0].length):K.lastIndex=0:k&&I&&(K.lastIndex=K.global?I.index+I[0].length:T),G&&I&&I.length>1&&E.call(I[0],L,function(){for(M=1;M<arguments.length-2;M++)arguments[M]===void 0&&(I[M]=void 0)}),I}),l.exports=C},7066:function(l,h,r){var u=r(9670);l.exports=function(){var m=u(this),p="";return m.global&&(p+="g"),m.ignoreCase&&(p+="i"),m.multiline&&(p+="m"),m.dotAll&&(p+="s"),m.unicode&&(p+="u"),m.sticky&&(p+="y"),p}},2999:function(l,h,r){var u=r(7293);function m(p,_){return RegExp(p,_)}h.UNSUPPORTED_Y=u(function(){var p=m("a","y");return p.lastIndex=2,p.exec("abcd")!=null}),h.BROKEN_CARET=u(function(){var p=m("^r","gy");return p.lastIndex=2,p.exec("str")!=null})},4488:function(l){l.exports=function(h){if(h==null)throw TypeError("Can't call method on "+h);return h}},3505:function(l,h,r){var u=r(7854),m=r(8880);l.exports=function(p,_){try{m(u,p,_)}catch{u[p]=_}return _}},6340:function(l,h,r){var u=r(5005),m=r(3070),p=r(5112),_=r(9781),A=p("species");l.exports=function(E){var C=u(E),k=m.f;_&&C&&!C[A]&&k(C,A,{configurable:!0,get:function(){return this}})}},8003:function(l,h,r){var u=r(3070).f,m=r(6656),p=r(5112)("toStringTag");l.exports=function(_,A,E){_&&!m(_=E?_:_.prototype,p)&&u(_,p,{configurable:!0,value:A})}},6200:function(l,h,r){var u=r(2309),m=r(9711),p=u("keys");l.exports=function(_){return p[_]||(p[_]=m(_))}},5465:function(l,h,r){var u=r(7854),m=r(3505),p="__core-js_shared__",_=u[p]||m(p,{});l.exports=_},2309:function(l,h,r){var u=r(1913),m=r(5465);(l.exports=function(p,_){return m[p]||(m[p]=_!==void 0?_:{})})("versions",[]).push({version:"3.8.3",mode:u?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},6707:function(l,h,r){var u=r(9670),m=r(3099),p=r(5112)("species");l.exports=function(_,A){var E,C=u(_).constructor;return C===void 0||(E=u(C)[p])==null?A:m(E)}},8710:function(l,h,r){var u=r(9958),m=r(4488),p=function(_){return function(A,E){var C,k,O=String(m(A)),G=u(E),B=O.length;return G<0||G>=B?_?"":void 0:(C=O.charCodeAt(G))<55296||C>56319||G+1===B||(k=O.charCodeAt(G+1))<56320||k>57343?_?O.charAt(G):C:_?O.slice(G,G+2):k-56320+(C-55296<<10)+65536}};l.exports={codeAt:p(!1),charAt:p(!0)}},4986:function(l,h,r){var u=r(8113);l.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(u)},6650:function(l,h,r){var u=r(7466),m=r(8415),p=r(4488),_=Math.ceil,A=function(E){return function(C,k,O){var G,B,T=String(p(C)),L=T.length,I=O===void 0?" ":String(O),M=u(k);return M<=L||I==""?T:(G=M-L,(B=m.call(I,_(G/I.length))).length>G&&(B=B.slice(0,G)),E?T+B:B+T)}};l.exports={start:A(!1),end:A(!0)}},8415:function(l,h,r){var u=r(9958),m=r(4488);l.exports="".repeat||function(p){var _=String(m(this)),A="",E=u(p);if(E<0||E==1/0)throw RangeError("Wrong number of repetitions");for(;E>0;(E>>>=1)&&(_+=_))1&E&&(A+=_);return A}},3111:function(l,h,r){var u=r(4488),m="["+r(1361)+"]",p=RegExp("^"+m+m+"*"),_=RegExp(m+m+"*$"),A=function(E){return function(C){var k=String(u(C));return 1&E&&(k=k.replace(p,"")),2&E&&(k=k.replace(_,"")),k}};l.exports={start:A(1),end:A(2),trim:A(3)}},1400:function(l,h,r){var u=r(9958),m=Math.max,p=Math.min;l.exports=function(_,A){var E=u(_);return E<0?m(E+A,0):p(E,A)}},7067:function(l,h,r){var u=r(9958),m=r(7466);l.exports=function(p){if(p===void 0)return 0;var _=u(p),A=m(_);if(_!==A)throw RangeError("Wrong length or index");return A}},5656:function(l,h,r){var u=r(8361),m=r(4488);l.exports=function(p){return u(m(p))}},9958:function(l){var h=Math.ceil,r=Math.floor;l.exports=function(u){return isNaN(u=+u)?0:(u>0?r:h)(u)}},7466:function(l,h,r){var u=r(9958),m=Math.min;l.exports=function(p){return p>0?m(u(p),9007199254740991):0}},7908:function(l,h,r){var u=r(4488);l.exports=function(m){return Object(u(m))}},4590:function(l,h,r){var u=r(3002);l.exports=function(m,p){var _=u(m);if(_%p)throw RangeError("Wrong offset");return _}},3002:function(l,h,r){var u=r(9958);l.exports=function(m){var p=u(m);if(p<0)throw RangeError("The argument can't be less than 0");return p}},7593:function(l,h,r){var u=r(111);l.exports=function(m,p){if(!u(m))return m;var _,A;if(p&&typeof(_=m.toString)=="function"&&!u(A=_.call(m))||typeof(_=m.valueOf)=="function"&&!u(A=_.call(m))||!p&&typeof(_=m.toString)=="function"&&!u(A=_.call(m)))return A;throw TypeError("Can't convert object to primitive value")}},1694:function(l,h,r){var u={};u[r(5112)("toStringTag")]="z",l.exports=String(u)==="[object z]"},9843:function(l,h,r){var u=r(2109),m=r(7854),p=r(9781),_=r(3832),A=r(260),E=r(3331),C=r(5787),k=r(9114),O=r(8880),G=r(7466),B=r(7067),T=r(4590),L=r(7593),I=r(6656),M=r(648),K=r(111),re=r(30),ae=r(7674),te=r(8006).f,ne=r(7321),me=r(2092).forEach,Ae=r(6340),F=r(3070),y=r(1236),v=r(9909),S=r(9587),w=v.get,x=v.set,D=F.f,U=y.f,j=Math.round,X=m.RangeError,ee=E.ArrayBuffer,ie=E.DataView,be=A.NATIVE_ARRAY_BUFFER_VIEWS,Te=A.TYPED_ARRAY_TAG,Oe=A.TypedArray,He=A.TypedArrayPrototype,st=A.aTypedArrayConstructor,Le=A.isTypedArray,rt="BYTES_PER_ELEMENT",tt="Wrong length",Ee=function(_e,Ne){for(var fe=0,Je=Ne.length,ot=new(st(_e))(Je);Je>fe;)ot[fe]=Ne[fe++];return ot},ft=function(_e,Ne){D(_e,Ne,{get:function(){return w(this)[Ne]}})},pt=function(_e){var Ne;return _e instanceof ee||(Ne=M(_e))=="ArrayBuffer"||Ne=="SharedArrayBuffer"},Ze=function(_e,Ne){return Le(_e)&&typeof Ne!="symbol"&&Ne in _e&&String(+Ne)==String(Ne)},je=function(_e,Ne){return Ze(_e,Ne=L(Ne,!0))?k(2,_e[Ne]):U(_e,Ne)},he=function(_e,Ne,fe){return!(Ze(_e,Ne=L(Ne,!0))&&K(fe)&&I(fe,"value"))||I(fe,"get")||I(fe,"set")||fe.configurable||I(fe,"writable")&&!fe.writable||I(fe,"enumerable")&&!fe.enumerable?D(_e,Ne,fe):(_e[Ne]=fe.value,_e)};p?(be||(y.f=je,F.f=he,ft(He,"buffer"),ft(He,"byteOffset"),ft(He,"byteLength"),ft(He,"length")),u({target:"Object",stat:!0,forced:!be},{getOwnPropertyDescriptor:je,defineProperty:he}),l.exports=function(_e,Ne,fe){var Je=_e.match(/\d+$/)[0]/8,ot=_e+(fe?"Clamped":"")+"Array",nt="get"+_e,q="set"+_e,Z=m[ot],z=Z,$=z&&z.prototype,ce={},Se=function(se,ve){D(se,ve,{get:function(){return function(Pe,ke){var xe=w(Pe);return xe.view[nt](ke*Je+xe.byteOffset,!0)}(this,ve)},set:function(Pe){return function(ke,xe,Re){var Be=w(ke);fe&&(Re=(Re=j(Re))<0?0:Re>255?255:255&Re),Be.view[q](xe*Je+Be.byteOffset,Re,!0)}(this,ve,Pe)},enumerable:!0})};be?_&&(z=Ne(function(se,ve,Pe,ke){return C(se,z,ot),S(K(ve)?pt(ve)?ke!==void 0?new Z(ve,T(Pe,Je),ke):Pe!==void 0?new Z(ve,T(Pe,Je)):new Z(ve):Le(ve)?Ee(z,ve):ne.call(z,ve):new Z(B(ve)),se,z)}),ae&&ae(z,Oe),me(te(Z),function(se){se in z||O(z,se,Z[se])}),z.prototype=$):(z=Ne(function(se,ve,Pe,ke){C(se,z,ot);var xe,Re,Be,Ue=0,at=0;if(K(ve)){if(!pt(ve))return Le(ve)?Ee(z,ve):ne.call(z,ve);xe=ve,at=T(Pe,Je);var gt=ve.byteLength;if(ke===void 0){if(gt%Je||(Re=gt-at)<0)throw X(tt)}else if((Re=G(ke)*Je)+at>gt)throw X(tt);Be=Re/Je}else Be=B(ve),xe=new ee(Re=Be*Je);for(x(se,{buffer:xe,byteOffset:at,byteLength:Re,length:Be,view:new ie(xe)});Ue<Be;)Se(se,Ue++)}),ae&&ae(z,Oe),$=z.prototype=re(He)),$.constructor!==z&&O($,"constructor",z),Te&&O($,Te,ot),ce[ot]=z,u({global:!0,forced:z!=Z,sham:!be},ce),rt in z||O(z,rt,Je),rt in $||O($,rt,Je),Ae(ot)}):l.exports=function(){}},3832:function(l,h,r){var u=r(7854),m=r(7293),p=r(7072),_=r(260).NATIVE_ARRAY_BUFFER_VIEWS,A=u.ArrayBuffer,E=u.Int8Array;l.exports=!_||!m(function(){E(1)})||!m(function(){new E(-1)})||!p(function(C){new E,new E(null),new E(1.5),new E(C)},!0)||m(function(){return new E(new A(2),1,void 0).length!==1})},7321:function(l,h,r){var u=r(7908),m=r(7466),p=r(1246),_=r(7659),A=r(9974),E=r(260).aTypedArrayConstructor;l.exports=function(C){var k,O,G,B,T,L,I=u(C),M=arguments.length,K=M>1?arguments[1]:void 0,re=K!==void 0,ae=p(I);if(ae!=null&&!_(ae))for(L=(T=ae.call(I)).next,I=[];!(B=L.call(T)).done;)I.push(B.value);for(re&&M>2&&(K=A(K,arguments[2],2)),O=m(I.length),G=new(E(this))(O),k=0;O>k;k++)G[k]=re?K(I[k],k):I[k];return G}},9711:function(l){var h=0,r=Math.random();l.exports=function(u){return"Symbol("+String(u===void 0?"":u)+")_"+(++h+r).toString(36)}},3307:function(l,h,r){var u=r(133);l.exports=u&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},6061:function(l,h,r){var u=r(5112);h.f=u},5112:function(l,h,r){var u=r(7854),m=r(2309),p=r(6656),_=r(9711),A=r(133),E=r(3307),C=m("wks"),k=u.Symbol,O=E?k:k&&k.withoutSetter||_;l.exports=function(G){return p(C,G)||(A&&p(k,G)?C[G]=k[G]:C[G]=O("Symbol."+G)),C[G]}},1361:function(l){l.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},9575:function(l,h,r){var u=r(2109),m=r(7293),p=r(3331),_=r(9670),A=r(1400),E=r(7466),C=r(6707),k=p.ArrayBuffer,O=p.DataView,G=k.prototype.slice;u({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:m(function(){return!new k(2).slice(1,void 0).byteLength})},{slice:function(B,T){if(G!==void 0&&T===void 0)return G.call(_(this),B);for(var L=_(this).byteLength,I=A(B,L),M=A(T===void 0?L:T,L),K=new(C(this,k))(E(M-I)),re=new O(this),ae=new O(K),te=0;I<M;)ae.setUint8(te++,re.getUint8(I++));return K}})},2222:function(l,h,r){var u=r(2109),m=r(7293),p=r(3157),_=r(111),A=r(7908),E=r(7466),C=r(6135),k=r(5417),O=r(1194),G=r(5112),B=r(7392),T=G("isConcatSpreadable"),L=9007199254740991,I="Maximum allowed index exceeded",M=B>=51||!m(function(){var ae=[];return ae[T]=!1,ae.concat()[0]!==ae}),K=O("concat"),re=function(ae){if(!_(ae))return!1;var te=ae[T];return te!==void 0?!!te:p(ae)};u({target:"Array",proto:!0,forced:!M||!K},{concat:function(ae){var te,ne,me,Ae,F,y=A(this),v=k(y,0),S=0;for(te=-1,me=arguments.length;te<me;te++)if(re(F=te===-1?y:arguments[te])){if(S+(Ae=E(F.length))>L)throw TypeError(I);for(ne=0;ne<Ae;ne++,S++)ne in F&&C(v,S,F[ne])}else{if(S>=L)throw TypeError(I);C(v,S++,F)}return v.length=S,v}})},3290:function(l,h,r){var u=r(2109),m=r(1285),p=r(1223);u({target:"Array",proto:!0},{fill:m}),p("fill")},7327:function(l,h,r){var u=r(2109),m=r(2092).filter,p=r(1194),_=r(9207),A=p("filter"),E=_("filter");u({target:"Array",proto:!0,forced:!A||!E},{filter:function(C){return m(this,C,arguments.length>1?arguments[1]:void 0)}})},4553:function(l,h,r){var u=r(2109),m=r(2092).findIndex,p=r(1223),_=r(9207),A="findIndex",E=!0,C=_(A);A in[]&&Array(1).findIndex(function(){E=!1}),u({target:"Array",proto:!0,forced:E||!C},{findIndex:function(k){return m(this,k,arguments.length>1?arguments[1]:void 0)}}),p(A)},9826:function(l,h,r){var u=r(2109),m=r(2092).find,p=r(1223),_=r(9207),A="find",E=!0,C=_(A);A in[]&&Array(1).find(function(){E=!1}),u({target:"Array",proto:!0,forced:E||!C},{find:function(k){return m(this,k,arguments.length>1?arguments[1]:void 0)}}),p(A)},9554:function(l,h,r){var u=r(2109),m=r(8533);u({target:"Array",proto:!0,forced:[].forEach!=m},{forEach:m})},6699:function(l,h,r){var u=r(2109),m=r(1318).includes,p=r(1223);u({target:"Array",proto:!0,forced:!r(9207)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(_){return m(this,_,arguments.length>1?arguments[1]:void 0)}}),p("includes")},6992:function(l,h,r){var u=r(5656),m=r(1223),p=r(7497),_=r(9909),A=r(654),E="Array Iterator",C=_.set,k=_.getterFor(E);l.exports=A(Array,"Array",function(O,G){C(this,{type:E,target:u(O),index:0,kind:G})},function(){var O=k(this),G=O.target,B=O.kind,T=O.index++;return!G||T>=G.length?(O.target=void 0,{value:void 0,done:!0}):B=="keys"?{value:T,done:!1}:B=="values"?{value:G[T],done:!1}:{value:[T,G[T]],done:!1}},"values"),p.Arguments=p.Array,m("keys"),m("values"),m("entries")},7042:function(l,h,r){var u=r(2109),m=r(111),p=r(3157),_=r(1400),A=r(7466),E=r(5656),C=r(6135),k=r(5112),O=r(1194),G=r(9207),B=O("slice"),T=G("slice",{ACCESSORS:!0,0:0,1:2}),L=k("species"),I=[].slice,M=Math.max;u({target:"Array",proto:!0,forced:!B||!T},{slice:function(K,re){var ae,te,ne,me=E(this),Ae=A(me.length),F=_(K,Ae),y=_(re===void 0?Ae:re,Ae);if(p(me)&&(typeof(ae=me.constructor)!="function"||ae!==Array&&!p(ae.prototype)?m(ae)&&(ae=ae[L])===null&&(ae=void 0):ae=void 0,ae===Array||ae===void 0))return I.call(me,F,y);for(te=new(ae===void 0?Array:ae)(M(y-F,0)),ne=0;F<y;F++,ne++)F in me&&C(te,ne,me[F]);return te.length=ne,te}})},5212:function(l,h,r){var u=r(2109),m=r(2092).some,p=r(9341),_=r(9207),A=p("some"),E=_("some");u({target:"Array",proto:!0,forced:!A||!E},{some:function(C){return m(this,C,arguments.length>1?arguments[1]:void 0)}})},2707:function(l,h,r){var u=r(2109),m=r(3099),p=r(7908),_=r(7293),A=r(9341),E=[],C=E.sort,k=_(function(){E.sort(void 0)}),O=_(function(){E.sort(null)}),G=A("sort");u({target:"Array",proto:!0,forced:k||!O||!G},{sort:function(B){return B===void 0?C.call(p(this)):C.call(p(this),m(B))}})},561:function(l,h,r){var u=r(2109),m=r(1400),p=r(9958),_=r(7466),A=r(7908),E=r(5417),C=r(6135),k=r(1194),O=r(9207),G=k("splice"),B=O("splice",{ACCESSORS:!0,0:0,1:2}),T=Math.max,L=Math.min,I=9007199254740991,M="Maximum allowed length exceeded";u({target:"Array",proto:!0,forced:!G||!B},{splice:function(K,re){var ae,te,ne,me,Ae,F,y=A(this),v=_(y.length),S=m(K,v),w=arguments.length;if(w===0?ae=te=0:w===1?(ae=0,te=v-S):(ae=w-2,te=L(T(p(re),0),v-S)),v+ae-te>I)throw TypeError(M);for(ne=E(y,te),me=0;me<te;me++)(Ae=S+me)in y&&C(ne,me,y[Ae]);if(ne.length=te,ae<te){for(me=S;me<v-te;me++)F=me+ae,(Ae=me+te)in y?y[F]=y[Ae]:delete y[F];for(me=v;me>v-te+ae;me--)delete y[me-1]}else if(ae>te)for(me=v-te;me>S;me--)F=me+ae-1,(Ae=me+te-1)in y?y[F]=y[Ae]:delete y[F];for(me=0;me<ae;me++)y[me+S]=arguments[me+2];return y.length=v-te+ae,ne}})},1532:function(l,h,r){var u=r(7710),m=r(5631);l.exports=u("Map",function(p){return function(){return p(this,arguments.length?arguments[0]:void 0)}},m)},9653:function(l,h,r){var u=r(9781),m=r(7854),p=r(4705),_=r(1320),A=r(6656),E=r(4326),C=r(9587),k=r(7593),O=r(7293),G=r(30),B=r(8006).f,T=r(1236).f,L=r(3070).f,I=r(3111).trim,M="Number",K=m.Number,re=K.prototype,ae=E(G(re))==M,te=function(y){var v,S,w,x,D,U,j,X,ee=k(y,!1);if(typeof ee=="string"&&ee.length>2){if((v=(ee=I(ee)).charCodeAt(0))===43||v===45){if((S=ee.charCodeAt(2))===88||S===120)return NaN}else if(v===48){switch(ee.charCodeAt(1)){case 66:case 98:w=2,x=49;break;case 79:case 111:w=8,x=55;break;default:return+ee}for(U=(D=ee.slice(2)).length,j=0;j<U;j++)if((X=D.charCodeAt(j))<48||X>x)return NaN;return parseInt(D,w)}}return+ee};if(p(M,!K(" 0o1")||!K("0b1")||K("+0x1"))){for(var ne,me=function(y){var v=arguments.length<1?0:y,S=this;return S instanceof me&&(ae?O(function(){re.valueOf.call(S)}):E(S)!=M)?C(new K(te(v)),S,me):te(v)},Ae=u?B(K):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),F=0;Ae.length>F;F++)A(K,ne=Ae[F])&&!A(me,ne)&&L(me,ne,T(K,ne));me.prototype=re,re.constructor=me,_(m,M,me)}},5192:function(l,h,r){r(2109)({target:"Number",stat:!0},{isFinite:r(7023)})},4363:function(l,h,r){r(2109)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},9494:function(l,h,r){var u=r(2109),m=r(3009);u({target:"Number",stat:!0,forced:Number.parseInt!=m},{parseInt:m})},9720:function(l,h,r){var u=r(2109),m=r(4699).entries;u({target:"Object",stat:!0},{entries:function(p){return m(p)}})},489:function(l,h,r){var u=r(2109),m=r(7293),p=r(7908),_=r(9518),A=r(8544);u({target:"Object",stat:!0,forced:m(function(){_(1)}),sham:!A},{getPrototypeOf:function(E){return _(p(E))}})},8304:function(l,h,r){r(2109)({target:"Object",stat:!0},{setPrototypeOf:r(7674)})},1539:function(l,h,r){var u=r(1694),m=r(1320),p=r(288);u||m(Object.prototype,"toString",p,{unsafe:!0})},4916:function(l,h,r){var u=r(2109),m=r(2261);u({target:"RegExp",proto:!0,forced:/./.exec!==m},{exec:m})},9714:function(l,h,r){var u=r(1320),m=r(9670),p=r(7293),_=r(7066),A="toString",E=RegExp.prototype,C=E.toString,k=p(function(){return C.call({source:"a",flags:"b"})!="/a/b"}),O=C.name!=A;(k||O)&&u(RegExp.prototype,A,function(){var G=m(this),B=String(G.source),T=G.flags;return"/"+B+"/"+String(T===void 0&&G instanceof RegExp&&!("flags"in E)?_.call(G):T)},{unsafe:!0})},189:function(l,h,r){var u=r(7710),m=r(5631);l.exports=u("Set",function(p){return function(){return p(this,arguments.length?arguments[0]:void 0)}},m)},2023:function(l,h,r){var u=r(2109),m=r(3929),p=r(4488);u({target:"String",proto:!0,forced:!r(4964)("includes")},{includes:function(_){return!!~String(p(this)).indexOf(m(_),arguments.length>1?arguments[1]:void 0)}})},8783:function(l,h,r){var u=r(8710).charAt,m=r(9909),p=r(654),_="String Iterator",A=m.set,E=m.getterFor(_);p(String,"String",function(C){A(this,{type:_,string:String(C),index:0})},function(){var C,k=E(this),O=k.string,G=k.index;return G>=O.length?{value:void 0,done:!0}:(C=u(O,G),k.index+=C.length,{value:C,done:!1})})},3112:function(l,h,r){var u=r(2109),m=r(6650).start;u({target:"String",proto:!0,forced:r(4986)},{padStart:function(p){return m(this,p,arguments.length>1?arguments[1]:void 0)}})},5306:function(l,h,r){var u=r(7007),m=r(9670),p=r(7466),_=r(9958),A=r(4488),E=r(1530),C=r(647),k=r(7651),O=Math.max,G=Math.min;u("replace",2,function(B,T,L,I){var M=I.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,K=I.REPLACE_KEEPS_$0,re=M?"$":"$0";return[function(ae,te){var ne=A(this),me=ae==null?void 0:ae[B];return me!==void 0?me.call(ae,ne,te):T.call(String(ne),ae,te)},function(ae,te){if(!M&&K||typeof te=="string"&&te.indexOf(re)===-1){var ne=L(T,ae,this,te);if(ne.done)return ne.value}var me=m(ae),Ae=String(this),F=typeof te=="function";F||(te=String(te));var y=me.global;if(y){var v=me.unicode;me.lastIndex=0}for(var S=[];;){var w=k(me,Ae);if(w===null||(S.push(w),!y))break;String(w[0])===""&&(me.lastIndex=E(Ae,p(me.lastIndex),v))}for(var x,D="",U=0,j=0;j<S.length;j++){w=S[j];for(var X=String(w[0]),ee=O(G(_(w.index),Ae.length),0),ie=[],be=1;be<w.length;be++)ie.push((x=w[be])===void 0?x:String(x));var Te=w.groups;if(F){var Oe=[X].concat(ie,ee,Ae);Te!==void 0&&Oe.push(Te);var He=String(te.apply(void 0,Oe))}else He=C(X,Ae,ee,ie,Te,te);ee>=U&&(D+=Ae.slice(U,ee)+He,U=ee+X.length)}return D+Ae.slice(U)}]})},1817:function(l,h,r){var u=r(2109),m=r(9781),p=r(7854),_=r(6656),A=r(111),E=r(3070).f,C=r(9920),k=p.Symbol;if(m&&typeof k=="function"&&(!("description"in k.prototype)||k().description!==void 0)){var O={},G=function(){var M=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),K=this instanceof G?new k(M):M===void 0?k():k(M);return M===""&&(O[K]=!0),K};C(G,k);var B=G.prototype=k.prototype;B.constructor=G;var T=B.toString,L=String(k("test"))=="Symbol(test)",I=/^Symbol\((.*)\)[^)]+$/;E(B,"description",{configurable:!0,get:function(){var M=A(this)?this.valueOf():this,K=T.call(M);if(_(O,M))return"";var re=L?K.slice(7,-1):K.replace(I,"$1");return re===""?void 0:re}}),u({global:!0,forced:!0},{Symbol:G})}},2526:function(l,h,r){var u=r(2109),m=r(7854),p=r(5005),_=r(1913),A=r(9781),E=r(133),C=r(3307),k=r(7293),O=r(6656),G=r(3157),B=r(111),T=r(9670),L=r(7908),I=r(5656),M=r(7593),K=r(9114),re=r(30),ae=r(1956),te=r(8006),ne=r(1156),me=r(5181),Ae=r(1236),F=r(3070),y=r(5296),v=r(8880),S=r(1320),w=r(2309),x=r(6200),D=r(3501),U=r(9711),j=r(5112),X=r(6061),ee=r(7235),ie=r(8003),be=r(9909),Te=r(2092).forEach,Oe=x("hidden"),He="Symbol",st=j("toPrimitive"),Le=be.set,rt=be.getterFor(He),tt=Object.prototype,Ee=m.Symbol,ft=p("JSON","stringify"),pt=Ae.f,Ze=F.f,je=ne.f,he=y.f,_e=w("symbols"),Ne=w("op-symbols"),fe=w("string-to-symbol-registry"),Je=w("symbol-to-string-registry"),ot=w("wks"),nt=m.QObject,q=!nt||!nt.prototype||!nt.prototype.findChild,Z=A&&k(function(){return re(Ze({},"a",{get:function(){return Ze(this,"a",{value:7}).a}})).a!=7})?function(xe,Re,Be){var Ue=pt(tt,Re);Ue&&delete tt[Re],Ze(xe,Re,Be),Ue&&xe!==tt&&Ze(tt,Re,Ue)}:Ze,z=function(xe,Re){var Be=_e[xe]=re(Ee.prototype);return Le(Be,{type:He,tag:xe,description:Re}),A||(Be.description=Re),Be},$=C?function(xe){return typeof xe=="symbol"}:function(xe){return Object(xe)instanceof Ee},ce=function(xe,Re,Be){xe===tt&&ce(Ne,Re,Be),T(xe);var Ue=M(Re,!0);return T(Be),O(_e,Ue)?(Be.enumerable?(O(xe,Oe)&&xe[Oe][Ue]&&(xe[Oe][Ue]=!1),Be=re(Be,{enumerable:K(0,!1)})):(O(xe,Oe)||Ze(xe,Oe,K(1,{})),xe[Oe][Ue]=!0),Z(xe,Ue,Be)):Ze(xe,Ue,Be)},Se=function(xe,Re){T(xe);var Be=I(Re),Ue=ae(Be).concat(ke(Be));return Te(Ue,function(at){A&&!se.call(Be,at)||ce(xe,at,Be[at])}),xe},se=function(xe){var Re=M(xe,!0),Be=he.call(this,Re);return!(this===tt&&O(_e,Re)&&!O(Ne,Re))&&(!(Be||!O(this,Re)||!O(_e,Re)||O(this,Oe)&&this[Oe][Re])||Be)},ve=function(xe,Re){var Be=I(xe),Ue=M(Re,!0);if(Be!==tt||!O(_e,Ue)||O(Ne,Ue)){var at=pt(Be,Ue);return!at||!O(_e,Ue)||O(Be,Oe)&&Be[Oe][Ue]||(at.enumerable=!0),at}},Pe=function(xe){var Re=je(I(xe)),Be=[];return Te(Re,function(Ue){O(_e,Ue)||O(D,Ue)||Be.push(Ue)}),Be},ke=function(xe){var Re=xe===tt,Be=je(Re?Ne:I(xe)),Ue=[];return Te(Be,function(at){!O(_e,at)||Re&&!O(tt,at)||Ue.push(_e[at])}),Ue};E||(S((Ee=function(){if(this instanceof Ee)throw TypeError("Symbol is not a constructor");var xe=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,Re=U(xe),Be=function(Ue){this===tt&&Be.call(Ne,Ue),O(this,Oe)&&O(this[Oe],Re)&&(this[Oe][Re]=!1),Z(this,Re,K(1,Ue))};return A&&q&&Z(tt,Re,{configurable:!0,set:Be}),z(Re,xe)}).prototype,"toString",function(){return rt(this).tag}),S(Ee,"withoutSetter",function(xe){return z(U(xe),xe)}),y.f=se,F.f=ce,Ae.f=ve,te.f=ne.f=Pe,me.f=ke,X.f=function(xe){return z(j(xe),xe)},A&&(Ze(Ee.prototype,"description",{configurable:!0,get:function(){return rt(this).description}}),_||S(tt,"propertyIsEnumerable",se,{unsafe:!0}))),u({global:!0,wrap:!0,forced:!E,sham:!E},{Symbol:Ee}),Te(ae(ot),function(xe){ee(xe)}),u({target:He,stat:!0,forced:!E},{for:function(xe){var Re=String(xe);if(O(fe,Re))return fe[Re];var Be=Ee(Re);return fe[Re]=Be,Je[Be]=Re,Be},keyFor:function(xe){if(!$(xe))throw TypeError(xe+" is not a symbol");if(O(Je,xe))return Je[xe]},useSetter:function(){q=!0},useSimple:function(){q=!1}}),u({target:"Object",stat:!0,forced:!E,sham:!A},{create:function(xe,Re){return Re===void 0?re(xe):Se(re(xe),Re)},defineProperty:ce,defineProperties:Se,getOwnPropertyDescriptor:ve}),u({target:"Object",stat:!0,forced:!E},{getOwnPropertyNames:Pe,getOwnPropertySymbols:ke}),u({target:"Object",stat:!0,forced:k(function(){me.f(1)})},{getOwnPropertySymbols:function(xe){return me.f(L(xe))}}),ft&&u({target:"JSON",stat:!0,forced:!E||k(function(){var xe=Ee();return ft([xe])!="[null]"||ft({a:xe})!="{}"||ft(Object(xe))!="{}"})},{stringify:function(xe,Re,Be){for(var Ue,at=[xe],gt=1;arguments.length>gt;)at.push(arguments[gt++]);if(Ue=Re,(B(Re)||xe!==void 0)&&!$(xe))return G(Re)||(Re=function(Yt,Ht){if(typeof Ue=="function"&&(Ht=Ue.call(this,Yt,Ht)),!$(Ht))return Ht}),at[1]=Re,ft.apply(null,at)}}),Ee.prototype[st]||v(Ee.prototype,st,Ee.prototype.valueOf),ie(Ee,He),D[Oe]=!0},2990:function(l,h,r){var u=r(260),m=r(1048),p=u.aTypedArray;(0,u.exportTypedArrayMethod)("copyWithin",function(_,A){return m.call(p(this),_,A,arguments.length>2?arguments[2]:void 0)})},8927:function(l,h,r){var u=r(260),m=r(2092).every,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("every",function(_){return m(p(this),_,arguments.length>1?arguments[1]:void 0)})},3105:function(l,h,r){var u=r(260),m=r(1285),p=u.aTypedArray;(0,u.exportTypedArrayMethod)("fill",function(_){return m.apply(p(this),arguments)})},5035:function(l,h,r){var u=r(260),m=r(2092).filter,p=r(6707),_=u.aTypedArray,A=u.aTypedArrayConstructor;(0,u.exportTypedArrayMethod)("filter",function(E){for(var C=m(_(this),E,arguments.length>1?arguments[1]:void 0),k=p(this,this.constructor),O=0,G=C.length,B=new(A(k))(G);G>O;)B[O]=C[O++];return B})},7174:function(l,h,r){var u=r(260),m=r(2092).findIndex,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("findIndex",function(_){return m(p(this),_,arguments.length>1?arguments[1]:void 0)})},4345:function(l,h,r){var u=r(260),m=r(2092).find,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("find",function(_){return m(p(this),_,arguments.length>1?arguments[1]:void 0)})},2846:function(l,h,r){var u=r(260),m=r(2092).forEach,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("forEach",function(_){m(p(this),_,arguments.length>1?arguments[1]:void 0)})},4731:function(l,h,r){var u=r(260),m=r(1318).includes,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("includes",function(_){return m(p(this),_,arguments.length>1?arguments[1]:void 0)})},7209:function(l,h,r){var u=r(260),m=r(1318).indexOf,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("indexOf",function(_){return m(p(this),_,arguments.length>1?arguments[1]:void 0)})},6319:function(l,h,r){var u=r(7854),m=r(260),p=r(6992),_=r(5112)("iterator"),A=u.Uint8Array,E=p.values,C=p.keys,k=p.entries,O=m.aTypedArray,G=m.exportTypedArrayMethod,B=A&&A.prototype[_],T=!!B&&(B.name=="values"||B.name==null),L=function(){return E.call(O(this))};G("entries",function(){return k.call(O(this))}),G("keys",function(){return C.call(O(this))}),G("values",L,!T),G(_,L,!T)},8867:function(l,h,r){var u=r(260),m=u.aTypedArray,p=u.exportTypedArrayMethod,_=[].join;p("join",function(A){return _.apply(m(this),arguments)})},7789:function(l,h,r){var u=r(260),m=r(6583),p=u.aTypedArray;(0,u.exportTypedArrayMethod)("lastIndexOf",function(_){return m.apply(p(this),arguments)})},3739:function(l,h,r){var u=r(260),m=r(2092).map,p=r(6707),_=u.aTypedArray,A=u.aTypedArrayConstructor;(0,u.exportTypedArrayMethod)("map",function(E){return m(_(this),E,arguments.length>1?arguments[1]:void 0,function(C,k){return new(A(p(C,C.constructor)))(k)})})},4483:function(l,h,r){var u=r(260),m=r(3671).right,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("reduceRight",function(_){return m(p(this),_,arguments.length,arguments.length>1?arguments[1]:void 0)})},9368:function(l,h,r){var u=r(260),m=r(3671).left,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("reduce",function(_){return m(p(this),_,arguments.length,arguments.length>1?arguments[1]:void 0)})},2056:function(l,h,r){var u=r(260),m=u.aTypedArray,p=u.exportTypedArrayMethod,_=Math.floor;p("reverse",function(){for(var A,E=this,C=m(E).length,k=_(C/2),O=0;O<k;)A=E[O],E[O++]=E[--C],E[C]=A;return E})},3462:function(l,h,r){var u=r(260),m=r(7466),p=r(4590),_=r(7908),A=r(7293),E=u.aTypedArray;(0,u.exportTypedArrayMethod)("set",function(C){E(this);var k=p(arguments.length>1?arguments[1]:void 0,1),O=this.length,G=_(C),B=m(G.length),T=0;if(B+k>O)throw RangeError("Wrong length");for(;T<B;)this[k+T]=G[T++]},A(function(){new Int8Array(1).set({})}))},678:function(l,h,r){var u=r(260),m=r(6707),p=r(7293),_=u.aTypedArray,A=u.aTypedArrayConstructor,E=u.exportTypedArrayMethod,C=[].slice;E("slice",function(k,O){for(var G=C.call(_(this),k,O),B=m(this,this.constructor),T=0,L=G.length,I=new(A(B))(L);L>T;)I[T]=G[T++];return I},p(function(){new Int8Array(1).slice()}))},7462:function(l,h,r){var u=r(260),m=r(2092).some,p=u.aTypedArray;(0,u.exportTypedArrayMethod)("some",function(_){return m(p(this),_,arguments.length>1?arguments[1]:void 0)})},3824:function(l,h,r){var u=r(260),m=u.aTypedArray,p=u.exportTypedArrayMethod,_=[].sort;p("sort",function(A){return _.call(m(this),A)})},5021:function(l,h,r){var u=r(260),m=r(7466),p=r(1400),_=r(6707),A=u.aTypedArray;(0,u.exportTypedArrayMethod)("subarray",function(E,C){var k=A(this),O=k.length,G=p(E,O);return new(_(k,k.constructor))(k.buffer,k.byteOffset+G*k.BYTES_PER_ELEMENT,m((C===void 0?O:p(C,O))-G))})},2974:function(l,h,r){var u=r(7854),m=r(260),p=r(7293),_=u.Int8Array,A=m.aTypedArray,E=m.exportTypedArrayMethod,C=[].toLocaleString,k=[].slice,O=!!_&&p(function(){C.call(new _(1))});E("toLocaleString",function(){return C.apply(O?k.call(A(this)):A(this),arguments)},p(function(){return[1,2].toLocaleString()!=new _([1,2]).toLocaleString()})||!p(function(){_.prototype.toLocaleString.call([1,2])}))},5016:function(l,h,r){var u=r(260).exportTypedArrayMethod,m=r(7293),p=r(7854).Uint8Array,_=p&&p.prototype||{},A=[].toString,E=[].join;m(function(){A.call({})})&&(A=function(){return E.call(this)});var C=_.toString!=A;u("toString",A,C)},2472:function(l,h,r){r(9843)("Uint8",function(u){return function(m,p,_){return u(this,m,p,_)}})},4747:function(l,h,r){var u=r(7854),m=r(8324),p=r(8533),_=r(8880);for(var A in m){var E=u[A],C=E&&E.prototype;if(C&&C.forEach!==p)try{_(C,"forEach",p)}catch{C.forEach=p}}},3948:function(l,h,r){var u=r(7854),m=r(8324),p=r(6992),_=r(8880),A=r(5112),E=A("iterator"),C=A("toStringTag"),k=p.values;for(var O in m){var G=u[O],B=G&&G.prototype;if(B){if(B[E]!==k)try{_(B,E,k)}catch{B[E]=k}if(B[C]||_(B,C,O),m[O]){for(var T in p)if(B[T]!==p[T])try{_(B,T,p[T])}catch{B[T]=p[T]}}}}}},d={};function f(l){if(d[l])return d[l].exports;var h=d[l]={exports:{}};return c[l](h,h.exports,f),h.exports}return f.d=function(l,h){for(var r in h)f.o(h,r)&&!f.o(l,r)&&Object.defineProperty(l,r,{enumerable:!0,get:h[r]})},f.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),f.o=function(l,h){return Object.prototype.hasOwnProperty.call(l,h)},f.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},f(9798)}()},845:(a,c,d)=>{/*! art-template@runtime | https://github.com/aui/art-template */var f=typeof self<"u"?self:typeof window<"u"?window:d.g!==void 0?d.g:{},l=Object.create(f),h=/["&'<>]/;function r(u){return typeof u!="string"&&(u=u==null?"":typeof u=="function"?r(u.call(u)):JSON.stringify(u)),u}l.$escape=function(u){return function(m){var p=""+m,_=h.exec(p);if(!_)return m;var A="",E=void 0,C=void 0,k=void 0;for(E=_.index,C=0;E<p.length;E++){switch(p.charCodeAt(E)){case 34:k="&#34;";break;case 38:k="&#38;";break;case 39:k="&#39;";break;case 60:k="&#60;";break;case 62:k="&#62;";break;default:continue}C!==E&&(A+=p.substring(C,E)),C=E+1,A+=k}return C!==E?A+p.substring(C,E):A}(r(u))},l.$each=function(u,m){if(Array.isArray(u))for(var p=0,_=u.length;p<_;p++)m(u[p],p);else for(var A in u)m(u[A],A)},a.exports=l},143:(a,c,d)=>{a.exports=d(845)},122:a=>{a.exports=function(c){var d=[];return d.toString=function(){return this.map(function(f){var l="",h=f[5]!==void 0;return f[4]&&(l+="@supports (".concat(f[4],") {")),f[2]&&(l+="@media ".concat(f[2]," {")),h&&(l+="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {")),l+=c(f),h&&(l+="}"),f[2]&&(l+="}"),f[4]&&(l+="}"),l}).join("")},d.i=function(f,l,h,r,u){typeof f=="string"&&(f=[[null,f,void 0]]);var m={};if(h)for(var p=0;p<this.length;p++){var _=this[p][0];_!=null&&(m[_]=!0)}for(var A=0;A<f.length;A++){var E=[].concat(f[A]);h&&m[E[0]]||(u!==void 0&&(E[5]===void 0||(E[1]="@layer".concat(E[5].length>0?" ".concat(E[5]):""," {").concat(E[1],"}")),E[5]=u),l&&(E[2]&&(E[1]="@media ".concat(E[2]," {").concat(E[1],"}")),E[2]=l),r&&(E[4]?(E[1]="@supports (".concat(E[4],") {").concat(E[1],"}"),E[4]=r):E[4]="".concat(r)),d.push(E))}},d}},34:a=>{a.exports=function(c){var d=c[1],f=c[3];if(!f)return d;if(typeof btoa=="function"){var l=btoa(unescape(encodeURIComponent(JSON.stringify(f)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),r="/*# ".concat(h," */");return[d].concat([r]).join(`
`)}return[d].join(`
`)}},72:a=>{var c=[];function d(h){for(var r=-1,u=0;u<c.length;u++)if(c[u].identifier===h){r=u;break}return r}function f(h,r){for(var u={},m=[],p=0;p<h.length;p++){var _=h[p],A=r.base?_[0]+r.base:_[0],E=u[A]||0,C="".concat(A," ").concat(E);u[A]=E+1;var k=d(C),O={css:_[1],media:_[2],sourceMap:_[3],supports:_[4],layer:_[5]};if(k!==-1)c[k].references++,c[k].updater(O);else{var G=l(O,r);r.byIndex=p,c.splice(p,0,{identifier:C,updater:G,references:1})}m.push(C)}return m}function l(h,r){var u=r.domAPI(r);return u.update(h),function(m){if(m){if(m.css===h.css&&m.media===h.media&&m.sourceMap===h.sourceMap&&m.supports===h.supports&&m.layer===h.layer)return;u.update(h=m)}else u.remove()}}a.exports=function(h,r){var u=f(h=h||[],r=r||{});return function(m){m=m||[];for(var p=0;p<u.length;p++){var _=d(u[p]);c[_].references--}for(var A=f(m,r),E=0;E<u.length;E++){var C=d(u[E]);c[C].references===0&&(c[C].updater(),c.splice(C,1))}u=A}}},659:a=>{var c={};a.exports=function(d,f){var l=function(h){if(c[h]===void 0){var r=document.querySelector(h);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch{r=null}c[h]=r}return c[h]}(d);if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(f)}},540:a=>{a.exports=function(c){var d=document.createElement("style");return c.setAttributes(d,c.attributes),c.insert(d,c.options),d}},56:(a,c,d)=>{a.exports=function(f){var l=d.nc;l&&f.setAttribute("nonce",l)}},825:a=>{a.exports=function(c){if(typeof document>"u")return{update:function(){},remove:function(){}};var d=c.insertStyleElement(c);return{update:function(f){(function(l,h,r){var u="";r.supports&&(u+="@supports (".concat(r.supports,") {")),r.media&&(u+="@media ".concat(r.media," {"));var m=r.layer!==void 0;m&&(u+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),u+=r.css,m&&(u+="}"),r.media&&(u+="}"),r.supports&&(u+="}");var p=r.sourceMap;p&&typeof btoa<"u"&&(u+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(p))))," */")),h.styleTagTransform(u,l,h.options)})(d,c,f)},remove:function(){(function(f){if(f.parentNode===null)return!1;f.parentNode.removeChild(f)})(d)}}}},113:a=>{a.exports=function(c,d){if(d.styleSheet)d.styleSheet.cssText=c;else{for(;d.firstChild;)d.removeChild(d.firstChild);d.appendChild(document.createTextNode(c))}}},28:a=>{a.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},177:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 512 512"><path d="M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z"></path></svg>'},631:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},642:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 24 24"><path d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></svg>'},165:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},1:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},833:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 512 512"><path d="M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z"></path></svg>'},928:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},717:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},105:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32" transform="scale(-1,1)"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},454:a=>{a.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="dplayer-loading-dot dplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="dplayer-loading-dot dplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="dplayer-loading-dot dplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="dplayer-loading-dot dplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="dplayer-loading-dot dplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="dplayer-loading-dot dplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="dplayer-loading-dot dplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="dplayer-loading-dot dplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},137:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},32:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},657:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M26.3,15.1H14.5v8.6h11.8V15.1z M32.2,26.6V6.4c0-1.6-1.3-2.8-2.9-2.8H2.8c-1.6,0-2.9,1.3-2.9,2.8v20.1c0,1.6,1.3,2.9,2.9,2.9h26.4C30.8,29.4,32.2,28.1,32.2,26.6z M29.2,26.6H2.8V6.4h26.4V26.6z"></path></svg>'},416:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},460:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},484:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},894:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},30:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},513:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},204:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},278:a=>{a.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'}},i={};function n(a){var c=i[a];if(c!==void 0)return c.exports;var d=i[a]={id:a,exports:{}};return t[a].call(d.exports,d,d.exports,n),d.exports}n.n=a=>{var c=a&&a.__esModule?()=>a.default:()=>a;return n.d(c,{a:c}),c},n.d=(a,c)=>{for(var d in c)n.o(c,d)&&!n.o(a,d)&&Object.defineProperty(a,d,{enumerable:!0,get:c[d]})},n.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),n.o=(a,c)=>Object.prototype.hasOwnProperty.call(a,c),n.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},n.nc=void 0;var o={};return(()=>{n.d(o,{default:()=>pu});var a={};n.r(a),n.d(a,{hasBrowserEnv:()=>gt,hasStandardBrowserEnv:()=>Yt,hasStandardBrowserWebWorkerEnv:()=>zt,origin:()=>oe});var c=n(72),d=n.n(c),f=n(825),l=n.n(f),h=n(659),r=n.n(h),u=n(56),m=n.n(u),p=n(540),_=n.n(p),A=n(113),E=n.n(A),C=n(420),k={};k.styleTagTransform=E(),k.setAttributes=m(),k.insert=r().bind(null,"head"),k.domAPI=l(),k.insertStyleElement=_(),d()(C.A,k),C.A&&C.A.locals&&C.A.locals;var O=n(149);const G=/iPhone|iPad|iPod|Windows|Macintosh|Android|Mobile/i.test(navigator.userAgent)&&"ontouchend"in document,B={secondToTime:b=>{if((b=b||0)===0||b===1/0||b.toString()==="NaN")return"00:00";const R=Math.floor(b/3600),V=Math.floor((b-3600*R)/60),Y=Math.floor(b-3600*R-60*V);return(R>0?[R,V,Y]:[V,Y]).map(le=>le<10?"0"+le:""+le).join(":")},getVideoDuration:(b,R)=>{let V=b.duration;return V===1/0&&(b.seekable.length>0?(R.dtime.textContent=B.secondToTime(b.seekable.end(0)),V=b.seekable.end(0)):b.buffered.length>0&&(R.dtime.textContent=B.secondToTime(b.buffered.end(0)),V=b.buffered.end(0))),V},getElementViewLeft:b=>{let R=b.offsetLeft,V=b.offsetParent;const Y=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.webkitFullscreenElement)for(;V!==null&&V!==b;)R+=V.offsetLeft,V=V.offsetParent;else for(;V!==null;)R+=V.offsetLeft,V=V.offsetParent;return R-Y},getBoundingClientRectViewLeft(b){const R=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(b.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){let le=document.createElement("div");le.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(le),this.getBoundingClientRectViewLeft.offset=-le.getBoundingClientRect().top-R,document.body.removeChild(le),le=null}const V=b.getBoundingClientRect(),Y=this.getBoundingClientRectViewLeft.offset;return V.left+Y}return this.getElementViewLeft(b)},getScrollPosition:()=>({left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}),setScrollPosition({left:b=0,top:R=0}){this.isFirefox?(document.documentElement.scrollLeft=b,document.documentElement.scrollTop=R):window.scrollTo(b,R)},isMobile:G,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),storage:{set:(b,R)=>{localStorage.setItem(b,R)},get:b=>localStorage.getItem(b)},nameMap:{dragStart:G?"touchstart":"mousedown",dragMove:G?"touchmove":"mousemove",dragEnd:G?"touchend":"mouseup"},color2Number:b=>(b[0]==="#"&&(b=b.substr(1)),b.length===3&&(b=`${b[0]}${b[0]}${b[1]}${b[1]}${b[2]}${b[2]}`),parseInt(b,16)+0&16777215),number2Color:b=>"#"+("00000"+b.toString(16)).slice(-6),number2Type:b=>{switch(b){case 0:default:return"right";case 1:return"top";case 2:return"bottom"}}},T=B;function L(b,R){return function(){return b.apply(R,arguments)}}const{toString:I}=Object.prototype,{getPrototypeOf:M}=Object,K=(re=Object.create(null),b=>{const R=I.call(b);return re[R]||(re[R]=R.slice(8,-1).toLowerCase())});var re;const ae=b=>(b=b.toLowerCase(),R=>K(R)===b),te=b=>R=>typeof R===b,{isArray:ne}=Array,me=te("undefined"),Ae=ae("ArrayBuffer"),F=te("string"),y=te("function"),v=te("number"),S=b=>b!==null&&typeof b=="object",w=b=>{if(K(b)!=="object")return!1;const R=M(b);return!(R!==null&&R!==Object.prototype&&Object.getPrototypeOf(R)!==null||Symbol.toStringTag in b||Symbol.iterator in b)},x=ae("Date"),D=ae("File"),U=ae("Blob"),j=ae("FileList"),X=ae("URLSearchParams"),[ee,ie,be,Te]=["ReadableStream","Request","Response","Headers"].map(ae);function Oe(b,R,{allOwnKeys:V=!1}={}){if(b==null)return;let Y,le;if(typeof b!="object"&&(b=[b]),ne(b))for(Y=0,le=b.length;Y<le;Y++)R.call(null,b[Y],Y,b);else{const pe=V?Object.getOwnPropertyNames(b):Object.keys(b),we=pe.length;let Ke;for(Y=0;Y<we;Y++)Ke=pe[Y],R.call(null,b[Ke],Ke,b)}}function He(b,R){R=R.toLowerCase();const V=Object.keys(b);let Y,le=V.length;for(;le-- >0;)if(Y=V[le],R===Y.toLowerCase())return Y;return null}const st=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ks,Le=b=>!me(b)&&b!==st,rt=(tt=typeof Uint8Array<"u"&&M(Uint8Array),b=>tt&&b instanceof tt);var tt;const Ee=ae("HTMLFormElement"),ft=(({hasOwnProperty:b})=>(R,V)=>b.call(R,V))(Object.prototype),pt=ae("RegExp"),Ze=(b,R)=>{const V=Object.getOwnPropertyDescriptors(b),Y={};Oe(V,(le,pe)=>{let we;(we=R(le,pe,b))!==!1&&(Y[pe]=we||le)}),Object.defineProperties(b,Y)},je="abcdefghijklmnopqrstuvwxyz",he="0123456789",_e={DIGIT:he,ALPHA:je,ALPHA_DIGIT:je+je.toUpperCase()+he},Ne=ae("AsyncFunction"),fe={isArray:ne,isArrayBuffer:Ae,isBuffer:function(b){return b!==null&&!me(b)&&b.constructor!==null&&!me(b.constructor)&&y(b.constructor.isBuffer)&&b.constructor.isBuffer(b)},isFormData:b=>{let R;return b&&(typeof FormData=="function"&&b instanceof FormData||y(b.append)&&((R=K(b))==="formdata"||R==="object"&&y(b.toString)&&b.toString()==="[object FormData]"))},isArrayBufferView:function(b){let R;return R=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(b):b&&b.buffer&&Ae(b.buffer),R},isString:F,isNumber:v,isBoolean:b=>b===!0||b===!1,isObject:S,isPlainObject:w,isReadableStream:ee,isRequest:ie,isResponse:be,isHeaders:Te,isUndefined:me,isDate:x,isFile:D,isBlob:U,isRegExp:pt,isFunction:y,isStream:b=>S(b)&&y(b.pipe),isURLSearchParams:X,isTypedArray:rt,isFileList:j,forEach:Oe,merge:function b(){const{caseless:R}=Le(this)&&this||{},V={},Y=(le,pe)=>{const we=R&&He(V,pe)||pe;w(V[we])&&w(le)?V[we]=b(V[we],le):w(le)?V[we]=b({},le):ne(le)?V[we]=le.slice():V[we]=le};for(let le=0,pe=arguments.length;le<pe;le++)arguments[le]&&Oe(arguments[le],Y);return V},extend:(b,R,V,{allOwnKeys:Y}={})=>(Oe(R,(le,pe)=>{V&&y(le)?b[pe]=L(le,V):b[pe]=le},{allOwnKeys:Y}),b),trim:b=>b.trim?b.trim():b.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:b=>(b.charCodeAt(0)===65279&&(b=b.slice(1)),b),inherits:(b,R,V,Y)=>{b.prototype=Object.create(R.prototype,Y),b.prototype.constructor=b,Object.defineProperty(b,"super",{value:R.prototype}),V&&Object.assign(b.prototype,V)},toFlatObject:(b,R,V,Y)=>{let le,pe,we;const Ke={};if(R=R||{},b==null)return R;do{for(le=Object.getOwnPropertyNames(b),pe=le.length;pe-- >0;)we=le[pe],Y&&!Y(we,b,R)||Ke[we]||(R[we]=b[we],Ke[we]=!0);b=V!==!1&&M(b)}while(b&&(!V||V(b,R))&&b!==Object.prototype);return R},kindOf:K,kindOfTest:ae,endsWith:(b,R,V)=>{b=String(b),(V===void 0||V>b.length)&&(V=b.length),V-=R.length;const Y=b.indexOf(R,V);return Y!==-1&&Y===V},toArray:b=>{if(!b)return null;if(ne(b))return b;let R=b.length;if(!v(R))return null;const V=new Array(R);for(;R-- >0;)V[R]=b[R];return V},forEachEntry:(b,R)=>{const V=(b&&b[Symbol.iterator]).call(b);let Y;for(;(Y=V.next())&&!Y.done;){const le=Y.value;R.call(b,le[0],le[1])}},matchAll:(b,R)=>{let V;const Y=[];for(;(V=b.exec(R))!==null;)Y.push(V);return Y},isHTMLForm:Ee,hasOwnProperty:ft,hasOwnProp:ft,reduceDescriptors:Ze,freezeMethods:b=>{Ze(b,(R,V)=>{if(y(b)&&["arguments","caller","callee"].indexOf(V)!==-1)return!1;const Y=b[V];y(Y)&&(R.enumerable=!1,"writable"in R?R.writable=!1:R.set||(R.set=()=>{throw Error("Can not rewrite read-only method '"+V+"'")}))})},toObjectSet:(b,R)=>{const V={},Y=le=>{le.forEach(pe=>{V[pe]=!0})};return ne(b)?Y(b):Y(String(b).split(R)),V},toCamelCase:b=>b.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(R,V,Y){return V.toUpperCase()+Y}),noop:()=>{},toFiniteNumber:(b,R)=>b!=null&&Number.isFinite(b=+b)?b:R,findKey:He,global:st,isContextDefined:Le,ALPHABET:_e,generateString:(b=16,R=_e.ALPHA_DIGIT)=>{let V="";const{length:Y}=R;for(;b--;)V+=R[Math.random()*Y|0];return V},isSpecCompliantForm:function(b){return!!(b&&y(b.append)&&b[Symbol.toStringTag]==="FormData"&&b[Symbol.iterator])},toJSONObject:b=>{const R=new Array(10),V=(Y,le)=>{if(S(Y)){if(R.indexOf(Y)>=0)return;if(!("toJSON"in Y)){R[le]=Y;const pe=ne(Y)?[]:{};return Oe(Y,(we,Ke)=>{const lt=V(we,le+1);!me(lt)&&(pe[Ke]=lt)}),R[le]=void 0,pe}}return Y};return V(b,0)},isAsyncFn:Ne,isThenable:b=>b&&(S(b)||y(b))&&y(b.then)&&y(b.catch)};function Je(b,R,V,Y,le){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=b,this.name="AxiosError",R&&(this.code=R),V&&(this.config=V),Y&&(this.request=Y),le&&(this.response=le)}fe.inherits(Je,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const ot=Je.prototype,nt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(b=>{nt[b]={value:b}}),Object.defineProperties(Je,nt),Object.defineProperty(ot,"isAxiosError",{value:!0}),Je.from=(b,R,V,Y,le,pe)=>{const we=Object.create(ot);return fe.toFlatObject(b,we,function(Ke){return Ke!==Error.prototype},Ke=>Ke!=="isAxiosError"),Je.call(we,b.message,R,V,Y,le),we.cause=b,we.name=b.name,pe&&Object.assign(we,pe),we};const q=Je;function Z(b){return fe.isPlainObject(b)||fe.isArray(b)}function z(b){return fe.endsWith(b,"[]")?b.slice(0,-2):b}function $(b,R,V){return b?b.concat(R).map(function(Y,le){return Y=z(Y),!V&&le?"["+Y+"]":Y}).join(V?".":""):R}const ce=fe.toFlatObject(fe,{},null,function(b){return/^is[A-Z]/.test(b)}),Se=function(b,R,V){if(!fe.isObject(b))throw new TypeError("target must be an object");R=R||new FormData;const Y=(V=fe.toFlatObject(V,{metaTokens:!0,dots:!1,indexes:!1},!1,function(dt,ut){return!fe.isUndefined(ut[dt])})).metaTokens,le=V.visitor||$e,pe=V.dots,we=V.indexes,Ke=(V.Blob||typeof Blob<"u"&&Blob)&&fe.isSpecCompliantForm(R);if(!fe.isFunction(le))throw new TypeError("visitor must be a function");function lt(dt){if(dt===null)return"";if(fe.isDate(dt))return dt.toISOString();if(!Ke&&fe.isBlob(dt))throw new q("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(dt)||fe.isTypedArray(dt)?Ke&&typeof Blob=="function"?new Blob([dt]):Buffer.from(dt):dt}function $e(dt,ut,It){let Ti=dt;if(dt&&!It&&typeof dt=="object"){if(fe.endsWith(ut,"{}"))ut=Y?ut:ut.slice(0,-2),dt=JSON.stringify(dt);else if(fe.isArray(dt)&&function(qt){return fe.isArray(qt)&&!qt.some(Z)}(dt)||(fe.isFileList(dt)||fe.endsWith(ut,"[]"))&&(Ti=fe.toArray(dt)))return ut=z(ut),Ti.forEach(function(qt,Gt){!fe.isUndefined(qt)&&qt!==null&&R.append(we===!0?$([ut],Gt,pe):we===null?ut:ut+"[]",lt(qt))}),!1}return!!Z(dt)||(R.append($(It,ut,pe),lt(dt)),!1)}const ht=[],Tt=Object.assign(ce,{defaultVisitor:$e,convertValue:lt,isVisitable:Z});if(!fe.isObject(b))throw new TypeError("data must be an object");return function dt(ut,It){if(!fe.isUndefined(ut)){if(ht.indexOf(ut)!==-1)throw Error("Circular reference detected in "+It.join("."));ht.push(ut),fe.forEach(ut,function(Ti,qt){(!(fe.isUndefined(Ti)||Ti===null)&&le.call(R,Ti,fe.isString(qt)?qt.trim():qt,It,Tt))===!0&&dt(Ti,It?It.concat(qt):[qt])}),ht.pop()}}(b),R};function se(b){const R={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(b).replace(/[!'()~]|%20|%00/g,function(V){return R[V]})}function ve(b,R){this._pairs=[],b&&Se(b,this,R)}const Pe=ve.prototype;Pe.append=function(b,R){this._pairs.push([b,R])},Pe.toString=function(b){const R=b?function(V){return b.call(this,V,se)}:se;return this._pairs.map(function(V){return R(V[0])+"="+R(V[1])},"").join("&")};const ke=ve;function xe(b){return encodeURIComponent(b).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Re(b,R,V){if(!R)return b;const Y=V&&V.encode||xe,le=V&&V.serialize;let pe;if(pe=le?le(R,V):fe.isURLSearchParams(R)?R.toString():new ke(R,V).toString(Y),pe){const we=b.indexOf("#");we!==-1&&(b=b.slice(0,we)),b+=(b.indexOf("?")===-1?"?":"&")+pe}return b}const Be=class{constructor(){this.handlers=[]}use(b,R,V){return this.handlers.push({fulfilled:b,rejected:R,synchronous:!!V&&V.synchronous,runWhen:V?V.runWhen:null}),this.handlers.length-1}eject(b){this.handlers[b]&&(this.handlers[b]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(b){fe.forEach(this.handlers,function(R){R!==null&&b(R)})}},Ue={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},at={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:ke,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},gt=typeof window<"u"&&typeof document<"u",Yt=(Ht=typeof navigator<"u"&&navigator.product,gt&&["ReactNative","NativeScript","NS"].indexOf(Ht)<0);var Ht;const zt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",oe=gt&&window.location.href||"http://localhost",ge={...a,...at},H=function(b){function R(V,Y,le,pe){let we=V[pe++];if(we==="__proto__")return!0;const Ke=Number.isFinite(+we),lt=pe>=V.length;return we=!we&&fe.isArray(le)?le.length:we,lt?(fe.hasOwnProp(le,we)?le[we]=[le[we],Y]:le[we]=Y,!Ke):(le[we]&&fe.isObject(le[we])||(le[we]=[]),R(V,Y,le[we],pe)&&fe.isArray(le[we])&&(le[we]=function($e){const ht={},Tt=Object.keys($e);let dt;const ut=Tt.length;let It;for(dt=0;dt<ut;dt++)It=Tt[dt],ht[It]=$e[It];return ht}(le[we])),!Ke)}if(fe.isFormData(b)&&fe.isFunction(b.entries)){const V={};return fe.forEachEntry(b,(Y,le)=>{R(function(pe){return fe.matchAll(/\w+|\[(\w*)]/g,pe).map(we=>we[0]==="[]"?"":we[1]||we[0])}(Y),le,V,0)}),V}return null},P={transitional:Ue,adapter:["xhr","http","fetch"],transformRequest:[function(b,R){const V=R.getContentType()||"",Y=V.indexOf("application/json")>-1,le=fe.isObject(b);if(le&&fe.isHTMLForm(b)&&(b=new FormData(b)),fe.isFormData(b))return Y?JSON.stringify(H(b)):b;if(fe.isArrayBuffer(b)||fe.isBuffer(b)||fe.isStream(b)||fe.isFile(b)||fe.isBlob(b)||fe.isReadableStream(b))return b;if(fe.isArrayBufferView(b))return b.buffer;if(fe.isURLSearchParams(b))return R.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),b.toString();let pe;if(le){if(V.indexOf("application/x-www-form-urlencoded")>-1)return function(we,Ke){return Se(we,new ge.classes.URLSearchParams,Object.assign({visitor:function(lt,$e,ht,Tt){return ge.isNode&&fe.isBuffer(lt)?(this.append($e,lt.toString("base64")),!1):Tt.defaultVisitor.apply(this,arguments)}},Ke))}(b,this.formSerializer).toString();if((pe=fe.isFileList(b))||V.indexOf("multipart/form-data")>-1){const we=this.env&&this.env.FormData;return Se(pe?{"files[]":b}:b,we&&new we,this.formSerializer)}}return le||Y?(R.setContentType("application/json",!1),function(we,Ke,lt){if(fe.isString(we))try{return(Ke||JSON.parse)(we),fe.trim(we)}catch($e){if($e.name!=="SyntaxError")throw $e}return(0,JSON.stringify)(we)}(b)):b}],transformResponse:[function(b){const R=this.transitional||P.transitional,V=R&&R.forcedJSONParsing,Y=this.responseType==="json";if(fe.isResponse(b)||fe.isReadableStream(b))return b;if(b&&fe.isString(b)&&(V&&!this.responseType||Y)){const le=!(R&&R.silentJSONParsing)&&Y;try{return JSON.parse(b)}catch(pe){if(le)throw pe.name==="SyntaxError"?q.from(pe,q.ERR_BAD_RESPONSE,this,null,this.response):pe}}return b}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ge.classes.FormData,Blob:ge.classes.Blob},validateStatus:function(b){return b>=200&&b<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],b=>{P.headers[b]={}});const g=P,N=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Q=Symbol("internals");function J(b){return b&&String(b).trim().toLowerCase()}function ue(b){return b===!1||b==null?b:fe.isArray(b)?b.map(ue):String(b)}function de(b,R,V,Y,le){return fe.isFunction(Y)?Y.call(this,R,V):(le&&(R=V),fe.isString(R)?fe.isString(Y)?R.indexOf(Y)!==-1:fe.isRegExp(Y)?Y.test(R):void 0:void 0)}class Ce{constructor(R){R&&this.set(R)}set(R,V,Y){const le=this;function pe(Ke,lt,$e){const ht=J(lt);if(!ht)throw new Error("header name must be a non-empty string");const Tt=fe.findKey(le,ht);(!Tt||le[Tt]===void 0||$e===!0||$e===void 0&&le[Tt]!==!1)&&(le[Tt||lt]=ue(Ke))}const we=(Ke,lt)=>fe.forEach(Ke,($e,ht)=>pe($e,ht,lt));if(fe.isPlainObject(R)||R instanceof this.constructor)we(R,V);else if(fe.isString(R)&&(R=R.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(R.trim()))we((Ke=>{const lt={};let $e,ht,Tt;return Ke&&Ke.split(`
`).forEach(function(dt){Tt=dt.indexOf(":"),$e=dt.substring(0,Tt).trim().toLowerCase(),ht=dt.substring(Tt+1).trim(),!$e||lt[$e]&&N[$e]||($e==="set-cookie"?lt[$e]?lt[$e].push(ht):lt[$e]=[ht]:lt[$e]=lt[$e]?lt[$e]+", "+ht:ht)}),lt})(R),V);else if(fe.isHeaders(R))for(const[Ke,lt]of R.entries())pe(lt,Ke,Y);else R!=null&&pe(V,R,Y);return this}get(R,V){if(R=J(R)){const Y=fe.findKey(this,R);if(Y){const le=this[Y];if(!V)return le;if(V===!0)return function(pe){const we=Object.create(null),Ke=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let lt;for(;lt=Ke.exec(pe);)we[lt[1]]=lt[2];return we}(le);if(fe.isFunction(V))return V.call(this,le,Y);if(fe.isRegExp(V))return V.exec(le);throw new TypeError("parser must be boolean|regexp|function")}}}has(R,V){if(R=J(R)){const Y=fe.findKey(this,R);return!(!Y||this[Y]===void 0||V&&!de(0,this[Y],Y,V))}return!1}delete(R,V){const Y=this;let le=!1;function pe(we){if(we=J(we)){const Ke=fe.findKey(Y,we);!Ke||V&&!de(0,Y[Ke],Ke,V)||(delete Y[Ke],le=!0)}}return fe.isArray(R)?R.forEach(pe):pe(R),le}clear(R){const V=Object.keys(this);let Y=V.length,le=!1;for(;Y--;){const pe=V[Y];R&&!de(0,this[pe],pe,R,!0)||(delete this[pe],le=!0)}return le}normalize(R){const V=this,Y={};return fe.forEach(this,(le,pe)=>{const we=fe.findKey(Y,pe);if(we)return V[we]=ue(le),void delete V[pe];const Ke=R?function(lt){return lt.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,($e,ht,Tt)=>ht.toUpperCase()+Tt)}(pe):String(pe).trim();Ke!==pe&&delete V[pe],V[Ke]=ue(le),Y[Ke]=!0}),this}concat(...R){return this.constructor.concat(this,...R)}toJSON(R){const V=Object.create(null);return fe.forEach(this,(Y,le)=>{Y!=null&&Y!==!1&&(V[le]=R&&fe.isArray(Y)?Y.join(", "):Y)}),V}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([R,V])=>R+": "+V).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(R){return R instanceof this?R:new this(R)}static concat(R,...V){const Y=new this(R);return V.forEach(le=>Y.set(le)),Y}static accessor(R){const V=(this[Q]=this[Q]={accessors:{}}).accessors,Y=this.prototype;function le(pe){const we=J(pe);V[we]||(function(Ke,lt){const $e=fe.toCamelCase(" "+lt);["get","set","has"].forEach(ht=>{Object.defineProperty(Ke,ht+$e,{value:function(Tt,dt,ut){return this[ht].call(this,lt,Tt,dt,ut)},configurable:!0})})}(Y,pe),V[we]=!0)}return fe.isArray(R)?R.forEach(le):le(R),this}}Ce.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),fe.reduceDescriptors(Ce.prototype,({value:b},R)=>{let V=R[0].toUpperCase()+R.slice(1);return{get:()=>b,set(Y){this[V]=Y}}}),fe.freezeMethods(Ce);const Me=Ce;function Ge(b,R){const V=this||g,Y=R||V,le=Me.from(Y.headers);let pe=Y.data;return fe.forEach(b,function(we){pe=we.call(V,pe,le.normalize(),R?R.status:void 0)}),le.normalize(),pe}function Fe(b){return!(!b||!b.__CANCEL__)}function Ye(b,R,V){q.call(this,b??"canceled",q.ERR_CANCELED,R,V),this.name="CanceledError"}fe.inherits(Ye,q,{__CANCEL__:!0});const ze=Ye;function et(b,R,V){const Y=V.config.validateStatus;V.status&&Y&&!Y(V.status)?R(new q("Request failed with status code "+V.status,[q.ERR_BAD_REQUEST,q.ERR_BAD_RESPONSE][Math.floor(V.status/100)-4],V.config,V.request,V)):b(V)}const We=function(b,R){b=b||10;const V=new Array(b),Y=new Array(b);let le,pe=0,we=0;return R=R!==void 0?R:1e3,function(Ke){const lt=Date.now(),$e=Y[we];le||(le=lt),V[pe]=Ke,Y[pe]=lt;let ht=we,Tt=0;for(;ht!==pe;)Tt+=V[ht++],ht%=b;if(pe=(pe+1)%b,pe===we&&(we=(we+1)%b),lt-le<R)return;const dt=$e&&lt-$e;return dt?Math.round(1e3*Tt/dt):void 0}},ct=function(b,R){let V=0;const Y=1e3/R;let le=null;return function(){const pe=this===!0,we=Date.now();if(pe||we-V>Y)return le&&(clearTimeout(le),le=null),V=we,b.apply(null,arguments);le||(le=setTimeout(()=>(le=null,V=Date.now(),b.apply(null,arguments)),Y-(we-V)))}},it=(b,R,V=3)=>{let Y=0;const le=We(50,250);return ct(pe=>{const we=pe.loaded,Ke=pe.lengthComputable?pe.total:void 0,lt=we-Y,$e=le(lt);Y=we;const ht={loaded:we,total:Ke,progress:Ke?we/Ke:void 0,bytes:lt,rate:$e||void 0,estimated:$e&&Ke&&we<=Ke?(Ke-we)/$e:void 0,event:pe,lengthComputable:Ke!=null};ht[R?"download":"upload"]=!0,b(ht)},V)},xt=ge.hasStandardBrowserEnv?function(){const b=/(msie|trident)/i.test(navigator.userAgent),R=document.createElement("a");let V;function Y(le){let pe=le;return b&&(R.setAttribute("href",pe),pe=R.href),R.setAttribute("href",pe),{href:R.href,protocol:R.protocol?R.protocol.replace(/:$/,""):"",host:R.host,search:R.search?R.search.replace(/^\?/,""):"",hash:R.hash?R.hash.replace(/^#/,""):"",hostname:R.hostname,port:R.port,pathname:R.pathname.charAt(0)==="/"?R.pathname:"/"+R.pathname}}return V=Y(window.location.href),function(le){const pe=fe.isString(le)?Y(le):le;return pe.protocol===V.protocol&&pe.host===V.host}}():function(){return!0},yt=ge.hasStandardBrowserEnv?{write(b,R,V,Y,le,pe){const we=[b+"="+encodeURIComponent(R)];fe.isNumber(V)&&we.push("expires="+new Date(V).toGMTString()),fe.isString(Y)&&we.push("path="+Y),fe.isString(le)&&we.push("domain="+le),pe===!0&&we.push("secure"),document.cookie=we.join("; ")},read(b){const R=document.cookie.match(new RegExp("(^|;\\s*)("+b+")=([^;]*)"));return R?decodeURIComponent(R[3]):null},remove(b){this.write(b,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function At(b,R){return b&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(R)?function(V,Y){return Y?V.replace(/\/?\/$/,"")+"/"+Y.replace(/^\/+/,""):V}(b,R):R}const wt=b=>b instanceof Me?{...b}:b;function Et(b,R){R=R||{};const V={};function Y($e,ht,Tt){return fe.isPlainObject($e)&&fe.isPlainObject(ht)?fe.merge.call({caseless:Tt},$e,ht):fe.isPlainObject(ht)?fe.merge({},ht):fe.isArray(ht)?ht.slice():ht}function le($e,ht,Tt){return fe.isUndefined(ht)?fe.isUndefined($e)?void 0:Y(void 0,$e,Tt):Y($e,ht,Tt)}function pe($e,ht){if(!fe.isUndefined(ht))return Y(void 0,ht)}function we($e,ht){return fe.isUndefined(ht)?fe.isUndefined($e)?void 0:Y(void 0,$e):Y(void 0,ht)}function Ke($e,ht,Tt){return Tt in R?Y($e,ht):Tt in b?Y(void 0,$e):void 0}const lt={url:pe,method:pe,data:pe,baseURL:we,transformRequest:we,transformResponse:we,paramsSerializer:we,timeout:we,timeoutMessage:we,withCredentials:we,withXSRFToken:we,adapter:we,responseType:we,xsrfCookieName:we,xsrfHeaderName:we,onUploadProgress:we,onDownloadProgress:we,decompress:we,maxContentLength:we,maxBodyLength:we,beforeRedirect:we,transport:we,httpAgent:we,httpsAgent:we,cancelToken:we,socketPath:we,responseEncoding:we,validateStatus:Ke,headers:($e,ht)=>le(wt($e),wt(ht),!0)};return fe.forEach(Object.keys(Object.assign({},b,R)),function($e){const ht=lt[$e]||le,Tt=ht(b[$e],R[$e],$e);fe.isUndefined(Tt)&&ht!==Ke||(V[$e]=Tt)}),V}const Ut=b=>{const R=Et({},b);let V,{data:Y,withXSRFToken:le,xsrfHeaderName:pe,xsrfCookieName:we,headers:Ke,auth:lt}=R;if(R.headers=Ke=Me.from(Ke),R.url=Re(At(R.baseURL,R.url),b.params,b.paramsSerializer),lt&&Ke.set("Authorization","Basic "+btoa((lt.username||"")+":"+(lt.password?unescape(encodeURIComponent(lt.password)):""))),fe.isFormData(Y)){if(ge.hasStandardBrowserEnv||ge.hasStandardBrowserWebWorkerEnv)Ke.setContentType(void 0);else if((V=Ke.getContentType())!==!1){const[$e,...ht]=V?V.split(";").map(Tt=>Tt.trim()).filter(Boolean):[];Ke.setContentType([$e||"multipart/form-data",...ht].join("; "))}}if(ge.hasStandardBrowserEnv&&(le&&fe.isFunction(le)&&(le=le(R)),le||le!==!1&&xt(R.url))){const $e=pe&&we&&yt.read(we);$e&&Ke.set(pe,$e)}return R},Ct=typeof XMLHttpRequest<"u"&&function(b){return new Promise(function(R,V){const Y=Ut(b);let le=Y.data;const pe=Me.from(Y.headers).normalize();let we,{responseType:Ke}=Y;function lt(){Y.cancelToken&&Y.cancelToken.unsubscribe(we),Y.signal&&Y.signal.removeEventListener("abort",we)}let $e=new XMLHttpRequest;function ht(){if(!$e)return;const dt=Me.from("getAllResponseHeaders"in $e&&$e.getAllResponseHeaders());et(function(ut){R(ut),lt()},function(ut){V(ut),lt()},{data:Ke&&Ke!=="text"&&Ke!=="json"?$e.response:$e.responseText,status:$e.status,statusText:$e.statusText,headers:dt,config:b,request:$e}),$e=null}$e.open(Y.method.toUpperCase(),Y.url,!0),$e.timeout=Y.timeout,"onloadend"in $e?$e.onloadend=ht:$e.onreadystatechange=function(){$e&&$e.readyState===4&&($e.status!==0||$e.responseURL&&$e.responseURL.indexOf("file:")===0)&&setTimeout(ht)},$e.onabort=function(){$e&&(V(new q("Request aborted",q.ECONNABORTED,Y,$e)),$e=null)},$e.onerror=function(){V(new q("Network Error",q.ERR_NETWORK,Y,$e)),$e=null},$e.ontimeout=function(){let dt=Y.timeout?"timeout of "+Y.timeout+"ms exceeded":"timeout exceeded";const ut=Y.transitional||Ue;Y.timeoutErrorMessage&&(dt=Y.timeoutErrorMessage),V(new q(dt,ut.clarifyTimeoutError?q.ETIMEDOUT:q.ECONNABORTED,Y,$e)),$e=null},le===void 0&&pe.setContentType(null),"setRequestHeader"in $e&&fe.forEach(pe.toJSON(),function(dt,ut){$e.setRequestHeader(ut,dt)}),fe.isUndefined(Y.withCredentials)||($e.withCredentials=!!Y.withCredentials),Ke&&Ke!=="json"&&($e.responseType=Y.responseType),typeof Y.onDownloadProgress=="function"&&$e.addEventListener("progress",it(Y.onDownloadProgress,!0)),typeof Y.onUploadProgress=="function"&&$e.upload&&$e.upload.addEventListener("progress",it(Y.onUploadProgress)),(Y.cancelToken||Y.signal)&&(we=dt=>{$e&&(V(!dt||dt.type?new ze(null,b,$e):dt),$e.abort(),$e=null)},Y.cancelToken&&Y.cancelToken.subscribe(we),Y.signal&&(Y.signal.aborted?we():Y.signal.addEventListener("abort",we)));const Tt=function(dt){const ut=/^([-+\w]{1,25})(:?\/\/|:)/.exec(dt);return ut&&ut[1]||""}(Y.url);Tt&&ge.protocols.indexOf(Tt)===-1?V(new q("Unsupported protocol "+Tt+":",q.ERR_BAD_REQUEST,b)):$e.send(le||null)})},mt=(b,R)=>{let V,Y=new AbortController;const le=function(lt){if(!V){V=!0,we();const $e=lt instanceof Error?lt:this.reason;Y.abort($e instanceof q?$e:new ze($e instanceof Error?$e.message:$e))}};let pe=R&&setTimeout(()=>{le(new q(`timeout ${R} of ms exceeded`,q.ETIMEDOUT))},R);const we=()=>{b&&(pe&&clearTimeout(pe),pe=null,b.forEach(lt=>{lt&&(lt.removeEventListener?lt.removeEventListener("abort",le):lt.unsubscribe(le))}),b=null)};b.forEach(lt=>lt&&lt.addEventListener&&lt.addEventListener("abort",le));const{signal:Ke}=Y;return Ke.unsubscribe=we,[Ke,()=>{pe&&clearTimeout(pe),pe=null}]},Qe=function*(b,R){let V=b.byteLength;if(V<R)return void(yield b);let Y,le=0;for(;le<V;)Y=le+R,yield b.slice(le,Y),le=Y},bt=(b,R,V,Y,le)=>{const pe=async function*(Ke,lt,$e){for await(const ht of Ke)yield*Qe(ArrayBuffer.isView(ht)?ht:await $e(String(ht)),lt)}(b,R,le);let we=0;return new ReadableStream({type:"bytes",async pull(Ke){const{done:lt,value:$e}=await pe.next();if(lt)return Ke.close(),void Y();let ht=$e.byteLength;V&&V(we+=ht),Ke.enqueue(new Uint8Array($e))},cancel:Ke=>(Y(Ke),pe.return())},{highWaterMark:2})},Ft=(b,R)=>{const V=b!=null;return Y=>setTimeout(()=>R({lengthComputable:V,total:b,loaded:Y}))},Nt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Bt=Nt&&typeof ReadableStream=="function",Pt=Nt&&(typeof TextEncoder=="function"?($t=new TextEncoder,b=>$t.encode(b)):async b=>new Uint8Array(await new Response(b).arrayBuffer()));var $t;const Xt=Bt&&(()=>{let b=!1;const R=new Request(ge.origin,{body:new ReadableStream,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!R})(),jt=Bt&&!!(()=>{try{return fe.isReadableStream(new Response("").body)}catch{}})(),ei={stream:jt&&(b=>b.body)};var ii;Nt&&(ii=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!ei[b]&&(ei[b]=fe.isFunction(ii[b])?R=>R[b]():(R,V)=>{throw new q(`Response type '${b}' is not supported`,q.ERR_NOT_SUPPORT,V)})}));const gi=async(b,R)=>{const V=fe.toFiniteNumber(b.getContentLength());return V??(async Y=>Y==null?0:fe.isBlob(Y)?Y.size:fe.isSpecCompliantForm(Y)?(await new Request(Y).arrayBuffer()).byteLength:fe.isArrayBufferView(Y)?Y.byteLength:(fe.isURLSearchParams(Y)&&(Y+=""),fe.isString(Y)?(await Pt(Y)).byteLength:void 0))(R)},vi=Nt&&(async b=>{let{url:R,method:V,data:Y,signal:le,cancelToken:pe,timeout:we,onDownloadProgress:Ke,onUploadProgress:lt,responseType:$e,headers:ht,withCredentials:Tt="same-origin",fetchOptions:dt}=Ut(b);$e=$e?($e+"").toLowerCase():"text";let ut,It,[Ti,qt]=le||pe||we?mt([le,pe],we):[];const Gt=()=>{!ut&&setTimeout(()=>{Ti&&Ti.unsubscribe()}),ut=!0};let xi;try{if(lt&&Xt&&V!=="get"&&V!=="head"&&(xi=await gi(ht,Y))!==0){let An,bn=new Request(R,{method:"POST",body:Y,duplex:"half"});fe.isFormData(Y)&&(An=bn.headers.get("content-type"))&&ht.setContentType(An),bn.body&&(Y=bt(bn.body,65536,Ft(xi,it(lt)),null,Pt))}fe.isString(Tt)||(Tt=Tt?"cors":"omit"),It=new Request(R,{...dt,signal:Ti,method:V.toUpperCase(),headers:ht.normalize().toJSON(),body:Y,duplex:"half",withCredentials:Tt});let fi=await fetch(It);const oa=jt&&($e==="stream"||$e==="response");if(jt&&(Ke||oa)){const An={};["status","statusText","headers"].forEach(oo=>{An[oo]=fi[oo]});const bn=fe.toFiniteNumber(fi.headers.get("content-length"));fi=new Response(bt(fi.body,65536,Ke&&Ft(bn,it(Ke,!0)),oa&&Gt,Pt),An)}$e=$e||"text";let mu=await ei[fe.findKey(ei,$e)||"text"](fi,b);return!oa&&Gt(),qt&&qt(),await new Promise((An,bn)=>{et(An,bn,{data:mu,headers:Me.from(fi.headers),status:fi.status,statusText:fi.statusText,config:b,request:It})})}catch(fi){throw Gt(),fi&&fi.name==="TypeError"&&/fetch/i.test(fi.message)?Object.assign(new q("Network Error",q.ERR_NETWORK,b,It),{cause:fi.cause||fi}):q.from(fi,fi&&fi.code,b,It)}}),ni={http:null,xhr:Ct,fetch:vi};fe.forEach(ni,(b,R)=>{if(b){try{Object.defineProperty(b,"name",{value:R})}catch{}Object.defineProperty(b,"adapterName",{value:R})}});const ti=b=>`- ${b}`,ri=b=>fe.isFunction(b)||b===null||b===!1,ci=b=>{b=fe.isArray(b)?b:[b];const{length:R}=b;let V,Y;const le={};for(let pe=0;pe<R;pe++){let we;if(V=b[pe],Y=V,!ri(V)&&(Y=ni[(we=String(V)).toLowerCase()],Y===void 0))throw new q(`Unknown adapter '${we}'`);if(Y)break;le[we||"#"+pe]=Y}if(!Y){const pe=Object.entries(le).map(([Ke,lt])=>`adapter ${Ke} `+(lt===!1?"is not supported by the environment":"is not available in the build"));let we=R?pe.length>1?`since :
`+pe.map(ti).join(`
`):" "+ti(pe[0]):"as no adapter specified";throw new q("There is no suitable adapter to dispatch the request "+we,"ERR_NOT_SUPPORT")}return Y};function ai(b){if(b.cancelToken&&b.cancelToken.throwIfRequested(),b.signal&&b.signal.aborted)throw new ze(null,b)}function yi(b){return ai(b),b.headers=Me.from(b.headers),b.data=Ge.call(b,b.transformRequest),["post","put","patch"].indexOf(b.method)!==-1&&b.headers.setContentType("application/x-www-form-urlencoded",!1),ci(b.adapter||g.adapter)(b).then(function(R){return ai(b),R.data=Ge.call(b,b.transformResponse,R),R.headers=Me.from(R.headers),R},function(R){return Fe(R)||(ai(b),R&&R.response&&(R.response.data=Ge.call(b,b.transformResponse,R.response),R.response.headers=Me.from(R.response.headers))),Promise.reject(R)})}const si="1.7.2",ui={};["object","boolean","number","function","string","symbol"].forEach((b,R)=>{ui[b]=function(V){return typeof V===b||"a"+(R<1?"n ":" ")+b}});const Jt={};ui.transitional=function(b,R,V){function Y(le,pe){return"[Axios v1.7.2] Transitional option '"+le+"'"+pe+(V?". "+V:"")}return(le,pe,we)=>{if(b===!1)throw new q(Y(pe," has been removed"+(R?" in "+R:"")),q.ERR_DEPRECATED);return R&&!Jt[pe]&&(Jt[pe]=!0,console.warn(Y(pe," has been deprecated since v"+R+" and will be removed in the near future"))),!b||b(le,pe,we)}};const Bi={assertOptions:function(b,R,V){if(typeof b!="object")throw new q("options must be an object",q.ERR_BAD_OPTION_VALUE);const Y=Object.keys(b);let le=Y.length;for(;le-- >0;){const pe=Y[le],we=R[pe];if(we){const Ke=b[pe],lt=Ke===void 0||we(Ke,pe,b);if(lt!==!0)throw new q("option "+pe+" must be "+lt,q.ERR_BAD_OPTION_VALUE)}else if(V!==!0)throw new q("Unknown option "+pe,q.ERR_BAD_OPTION)}},validators:ui},Wt=Bi.validators;class Mi{constructor(R){this.defaults=R,this.interceptors={request:new Be,response:new Be}}async request(R,V){try{return await this._request(R,V)}catch(Y){if(Y instanceof Error){let le;Error.captureStackTrace?Error.captureStackTrace(le={}):le=new Error;const pe=le.stack?le.stack.replace(/^.+\n/,""):"";try{Y.stack?pe&&!String(Y.stack).endsWith(pe.replace(/^.+\n.+\n/,""))&&(Y.stack+=`
`+pe):Y.stack=pe}catch{}}throw Y}}_request(R,V){typeof R=="string"?(V=V||{}).url=R:V=R||{},V=Et(this.defaults,V);const{transitional:Y,paramsSerializer:le,headers:pe}=V;Y!==void 0&&Bi.assertOptions(Y,{silentJSONParsing:Wt.transitional(Wt.boolean),forcedJSONParsing:Wt.transitional(Wt.boolean),clarifyTimeoutError:Wt.transitional(Wt.boolean)},!1),le!=null&&(fe.isFunction(le)?V.paramsSerializer={serialize:le}:Bi.assertOptions(le,{encode:Wt.function,serialize:Wt.function},!0)),V.method=(V.method||this.defaults.method||"get").toLowerCase();let we=pe&&fe.merge(pe.common,pe[V.method]);pe&&fe.forEach(["delete","get","head","post","put","patch","common"],It=>{delete pe[It]}),V.headers=Me.concat(we,pe);const Ke=[];let lt=!0;this.interceptors.request.forEach(function(It){typeof It.runWhen=="function"&&It.runWhen(V)===!1||(lt=lt&&It.synchronous,Ke.unshift(It.fulfilled,It.rejected))});const $e=[];let ht;this.interceptors.response.forEach(function(It){$e.push(It.fulfilled,It.rejected)});let Tt,dt=0;if(!lt){const It=[yi.bind(this),void 0];for(It.unshift.apply(It,Ke),It.push.apply(It,$e),Tt=It.length,ht=Promise.resolve(V);dt<Tt;)ht=ht.then(It[dt++],It[dt++]);return ht}Tt=Ke.length;let ut=V;for(dt=0;dt<Tt;){const It=Ke[dt++],Ti=Ke[dt++];try{ut=It(ut)}catch(qt){Ti.call(this,qt);break}}try{ht=yi.call(this,ut)}catch(It){return Promise.reject(It)}for(dt=0,Tt=$e.length;dt<Tt;)ht=ht.then($e[dt++],$e[dt++]);return ht}getUri(R){return Re(At((R=Et(this.defaults,R)).baseURL,R.url),R.params,R.paramsSerializer)}}fe.forEach(["delete","get","head","options"],function(b){Mi.prototype[b]=function(R,V){return this.request(Et(V||{},{method:b,url:R,data:(V||{}).data}))}}),fe.forEach(["post","put","patch"],function(b){function R(V){return function(Y,le,pe){return this.request(Et(pe||{},{method:b,headers:V?{"Content-Type":"multipart/form-data"}:{},url:Y,data:le}))}}Mi.prototype[b]=R(),Mi.prototype[b+"Form"]=R(!0)});const Ji=Mi;class Qn{constructor(R){if(typeof R!="function")throw new TypeError("executor must be a function.");let V;this.promise=new Promise(function(le){V=le});const Y=this;this.promise.then(le=>{if(!Y._listeners)return;let pe=Y._listeners.length;for(;pe-- >0;)Y._listeners[pe](le);Y._listeners=null}),this.promise.then=le=>{let pe;const we=new Promise(Ke=>{Y.subscribe(Ke),pe=Ke}).then(le);return we.cancel=function(){Y.unsubscribe(pe)},we},R(function(le,pe,we){Y.reason||(Y.reason=new ze(le,pe,we),V(Y.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(R){this.reason?R(this.reason):this._listeners?this._listeners.push(R):this._listeners=[R]}unsubscribe(R){if(!this._listeners)return;const V=this._listeners.indexOf(R);V!==-1&&this._listeners.splice(V,1)}static source(){let R;return{token:new Qn(function(V){R=V}),cancel:R}}}const Qd=Qn,aa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(aa).forEach(([b,R])=>{aa[R]=b});const Zd=aa,bi=function b(R){const V=new Ji(R),Y=L(Ji.prototype.request,V);return fe.extend(Y,Ji.prototype,V,{allOwnKeys:!0}),fe.extend(Y,V,null,{allOwnKeys:!0}),Y.create=function(le){return b(Et(R,le))},Y}(g);bi.Axios=Ji,bi.CanceledError=ze,bi.CancelToken=Qd,bi.isCancel=Fe,bi.VERSION=si,bi.toFormData=Se,bi.AxiosError=q,bi.Cancel=bi.CanceledError,bi.all=function(b){return Promise.all(b)},bi.spread=function(b){return function(R){return b.apply(null,R)}},bi.isAxiosError=function(b){return fe.isObject(b)&&b.isAxiosError===!0},bi.mergeConfig=Et,bi.AxiosHeaders=Me,bi.formToJSON=b=>H(fe.isHTMLForm(b)?new FormData(b):b),bi.getAdapter=ci,bi.HttpStatusCode=Zd,bi.default=bi;const ao=bi,eh={send:b=>{b.url!==void 0?ao.post(b.url,b.data).then(R=>{const V=R.data;V&&V.code===0?b.success&&b.success():b.error&&b.error(V&&V.msg)}).catch(R=>{console.error(R),b.error&&b.error()}):b.error&&b.error()},read:b=>{b.url!==void 0?ao.get(b.url).then(R=>{const V=R.data;V&&V.code===0?V.data?b.success&&b.success(V.data.map(Y=>({author:Y[3],time:Y[0],text:Y[4],color:Y[2],type:Y[1],size:Y[5]&&(Y[5]==="big"||Y[5]==="small")?Y[5]:"medium"}))):b.success&&b.success([{author:"",time:0,text:"",color:"#ffeaea",type:"right",size:"medium"}]):b.error&&b.error(V&&V.msg)}).catch(R=>{console.error(R),b.error&&b.error()}):b.error&&b.error()}},th=eh,sa={"zh-cn":{"Danmaku is loading":"弹幕加载中",Top:"顶部",Bottom:"底部",Rolling:"滚动",Big:"大的",Medium:"中等的",Small:"小的","Input danmaku, hit Enter":"输入弹幕，回车发送","About author":"关于作者","DPlayer feedback":"播放器意见反馈","About DPlayer":"关于 DPlayer 播放器",Loop:"洗脑循环",Speed:"速度",Audio:"音频","Primary audio":"主要音频","Secondary audio":"辅助音频","Opacity for danmaku":"弹幕透明度",Normal:"正常","Please input danmaku content!":"要输入弹幕内容啊喂！","Set danmaku color":"设置弹幕颜色","Set danmaku type":"设置弹幕类型","Set danmaku size":"设置弹幕大小","Show danmaku":"显示弹幕","Video load failed":"视频加载失败","Danmaku load failed":"弹幕加载失败","Danmaku send failed":"弹幕发送失败","Switching to":"正在切换至","Switched to":"已经切换至",Synchronize:"同步",Synchronized:"同步的",Quality:"画质",quality:"画质",FF:"快进",REW:"快退","Unlimited danmaku":"海量弹幕","Send danmaku":"发送弹幕",Setting:"设置","Full screen":"全屏","Web full screen":"页面全屏","Picture-in-Picture":"子母画面",Send:"发送",Screenshot:"截图",AirPlay:"无线投屏",s:"秒","Show comment":"显示弹幕","Hide comment":"隐藏弹幕","Show subtitle":"显示字幕","Hide subtitle":"隐藏字幕",Volume:"音量",Live:"直播","Video info":"视频统计信息"},"zh-tw":{"Danmaku is loading":"彈幕載入中",Top:"頂部",Bottom:"底部",Rolling:"滾動",Big:"大的",Medium:"中等的",Small:"小的","Input danmaku, hit Enter":"輸入彈幕，Enter 發送","About author":"關於作者","DPlayer feedback":"播放器意見回饋","About DPlayer":"關於 DPlayer 播放器",Loop:"循環播放",Speed:"速度",Audio:"音頻","Primary audio":"主要音頻","Secondary audio":"輔助音頻","Opacity for danmaku":"彈幕透明度",Normal:"正常","Please input danmaku content!":"請輸入彈幕內容啊！","Set danmaku color":"設定彈幕顏色","Set danmaku type":"設定彈幕類型","Set danmaku size":"设置弹幕大小","Show danmaku":"顯示彈幕","Video load failed":"影片載入失敗","Danmaku load failed":"彈幕載入失敗","Danmaku send failed":"彈幕發送失敗","Switching to":"正在切換至","Switched to":"已經切換至",Synchronize:"同步",Synchronized:"同步的",Quality:"畫質",quality:"畫質",FF:"快進",REW:"快退","Unlimited danmaku":"巨量彈幕","Send danmaku":"發送彈幕",Setting:"設定","Full screen":"全螢幕","Web full screen":"頁面全螢幕","Picture-in-Picture":"子母畫面",Send:"發送",Screenshot:"截圖",AirPlay:"無線投屏",s:"秒","Show comment":"顯示彈幕","Hide comment":"隱藏彈幕","Show subtitle":"顯示字幕","Hide subtitle":"隱藏字幕",Volume:"音量",Live:"直播","Video info":"影片統計訊息"},"ja-jp":{"Danmaku is loading":"コメントを読み込み中…",Top:"上固定",Bottom:"下固定",Rolling:"スクロール",Big:"大きめ",Medium:"標準",Small:"小さめ","Input danmaku, hit Enter":"右のボタンを押すとコメントできます","About author":"作者について","DPlayer feedback":"フィードバック","About DPlayer":"DPlayer について",Loop:"リピート再生",Speed:"再生速度",Audio:"音声","Primary audio":"主音声","Secondary audio":"副音声","Opacity for danmaku":"コメントの透明度",Normal:"標準","Please input danmaku content!":"コメント内容を入力して下さい！","Set danmaku color":"コメントの色","Set danmaku type":"コメントの位置","Set danmaku size":"コメントのサイズ","Show danmaku":"コメントを表示","Video load failed":"動画の読み込みに失敗しました…","Danmaku load failed":"コメントの読み込みに失敗しました…","Danmaku send failed":"コメントの送信に失敗しました…","Switching to":"画質を切り替えています…","Switched to":"画質を切り替えました",Synchronize:"同期する",Synchronized:"同期しました",Quality:"画質",quality:"画質",FF:"早送り",REW:"巻き戻し","Unlimited danmaku":"コメントを無制限に表示","Send danmaku":"コメントする",Setting:"設定","Full screen":"フルスクリーン","Web full screen":"ブラウザフルスクリーン","Picture-in-Picture":"Picture-in-Picture",Send:"コメントする",Screenshot:"スクリーンショット",s:"秒","Show comment":"コメントを表示する","Hide comment":"コメントを表示しない","Show subtitle":"字幕を表示する","Hide subtitle":"字幕を表示しない",Volume:"音量",Live:"Live","Video info":"動画の統計情報"}},ih=function(b){this.lang=b,this.lang==="ja"&&(this.lang="ja-jp"),this.tran=R=>sa[this.lang]&&sa[this.lang][R]?sa[this.lang][R]:R};var nh=n(416),rh=n.n(nh),ah=n(32),sh=n.n(ah),oh=n(177),lh=n.n(oh),ch=n(833),dh=n.n(ch),hh=n(278),uh=n.n(hh),fh=n(513),ph=n.n(fh),mh=n(204),gh=n.n(mh),yh=n(717),_h=n.n(yh),vh=n(928),Ah=n.n(vh),bh=n(657),Sh=n.n(bh),Eh=n(894),xh=n.n(Eh),Ch=n(105),wh=n.n(Ch),Th=n(460),kh=n.n(Th),Rh=n(642),Lh=n.n(Rh),Ih=n(1),Dh=n.n(Ih),Oh=n(165),Ph=n.n(Oh),Bh=n(484),Mh=n.n(Bh),Fh=n(137),Nh=n.n(Fh),Uh=n(631),Gh=n.n(Uh),$h=n(28),Vh=n.n($h),jh=n(30),Hh=n.n(jh),zh=n(454),qh=n.n(zh);const zi={play:rh(),pause:sh(),backward:lh(),forward:dh(),volumeUp:uh(),volumeDown:ph(),volumeOff:gh(),full:_h(),fullWeb:Ah(),pip:Sh(),setting:xh(),left:wh(),right:kh(),check:Lh(),comment:Dh(),commentOff:Ph(),send:Mh(),pallette:Nh(),camera:Gh(),subtitle:Hh(),loading:qh(),airplay:Vh()};var Kh=n(456),Wh=n.n(Kh);const Yh=class{constructor(b){ye(this,"container");ye(this,"options");ye(this,"index");ye(this,"tran");ye(this,"volumeBar");ye(this,"volumeBarWrap");ye(this,"volumeBarWrapWrap");ye(this,"volumeButton");ye(this,"volumeButtonIcon");ye(this,"volumeIcon");ye(this,"playedBar");ye(this,"loadedBar");ye(this,"playedBarWrap");ye(this,"playedBarTime");ye(this,"danmaku");ye(this,"danmakuLoading");ye(this,"video");ye(this,"bezel");ye(this,"playButton");ye(this,"mobileBackwardButton");ye(this,"mobilePlayButton");ye(this,"mobileForwardButton");ye(this,"videoWrap");ye(this,"videoWrapAspect");ye(this,"controllerMask");ye(this,"ptime");ye(this,"settingButton");ye(this,"settingBox");ye(this,"settingOriginPanel");ye(this,"mask");ye(this,"syncButton");ye(this,"loop");ye(this,"loopToggle");ye(this,"showDanmaku");ye(this,"showDanmakuToggle");ye(this,"unlimitDanmaku");ye(this,"unlimitDanmakuToggle");ye(this,"quality");ye(this,"qualityValue");ye(this,"qualityHeader");ye(this,"qualityItem");ye(this,"speed");ye(this,"speedValue");ye(this,"speedHeader");ye(this,"speedItem");ye(this,"audio");ye(this,"audioValue");ye(this,"audioHeader");ye(this,"audioItem");ye(this,"danmakuOpacityBar");ye(this,"danmakuOpacityBarWrap");ye(this,"danmakuOpacityBarWrapWrap");ye(this,"danmakuOpacityBox");ye(this,"danmakuOpacityValue");ye(this,"dtime");ye(this,"controller");ye(this,"commentInput");ye(this,"commentButton");ye(this,"commentSettingBox");ye(this,"commentSettingButton");ye(this,"commentSettingFill");ye(this,"commentSendButton");ye(this,"commentSendFill");ye(this,"commentColorSettingBox");ye(this,"browserFullButton");ye(this,"webFullButton");ye(this,"pipButton");ye(this,"menu");ye(this,"menuItem");ye(this,"cameraButton");ye(this,"airplayButton");ye(this,"subtitleButton");ye(this,"subtitleButtonInner");ye(this,"subtitle");ye(this,"barPreview");ye(this,"barWrap");ye(this,"notice");ye(this,"infoPanel");ye(this,"infoPanelClose");ye(this,"infoMimeType");ye(this,"infoVersion");ye(this,"infoVideoFPS");ye(this,"infoPageFPS");ye(this,"infoDroppedFrames");ye(this,"infoType");ye(this,"infoUrl");ye(this,"infoResolution");ye(this,"infoDuration");ye(this,"infoBufferRemain");ye(this,"infoDownloadSpeed");this.container=b.container,this.options=b.options,this.index=b.index,this.tran=b.tran,this.init()}init(){this.container.innerHTML=Wh()({options:this.options,index:this.index,tran:this.tran,icons:zi,mobile:T.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:this.options.airplay,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle,crossOrigin:this.options.crossOrigin}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobileBackwardButton=this.container.querySelector(".dplayer-mobile-icon-backward"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-icon-play"),this.mobileForwardButton=this.container.querySelector(".dplayer-mobile-icon-forward"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.videoWrapAspect=this.container.querySelector(".dplayer-video-wrap-aspect"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.settingOriginPanel=this.container.querySelector(".dplayer-setting-origin-panel"),this.mask=this.container.querySelector(".dplayer-mask"),this.syncButton=this.container.querySelector(".dplayer-live-badge"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.quality=this.container.querySelector(".dplayer-setting-quality"),this.qualityValue=this.container.querySelector(".dplayer-setting-quality .dplayer-label-value"),this.qualityHeader=this.container.querySelector(".dplayer-setting-quality-header"),this.qualityItem=this.container.querySelectorAll(".dplayer-setting-quality-item"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedValue=this.container.querySelector(".dplayer-setting-speed .dplayer-label-value"),this.speedHeader=this.container.querySelector(".dplayer-setting-speed-header"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.audio=this.container.querySelector(".dplayer-setting-audio"),this.audioValue=this.container.querySelector(".dplayer-setting-audio .dplayer-label-value"),this.audioHeader=this.container.querySelector(".dplayer-setting-audio-header"),this.audioItem=this.container.querySelectorAll(".dplayer-setting-audio-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.danmakuOpacityValue=this.container.querySelector(".dplayer-setting-danmaku .dplayer-label-value"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.pipButton=this.container.querySelector(".dplayer-pip-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.cameraButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.notice=this.container.querySelector(".dplayer-notice"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoMimeType=this.container.querySelector(".dplayer-info-panel-item-mimetype .dplayer-info-panel-item-data"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoVideoFPS=this.container.querySelector(".dplayer-info-panel-item-video-fps .dplayer-info-panel-item-data"),this.infoPageFPS=this.container.querySelector(".dplayer-info-panel-item-page-fps .dplayer-info-panel-item-data"),this.infoDroppedFrames=this.container.querySelector(".dplayer-info-panel-item-dropped-frames .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoBufferRemain=this.container.querySelector(".dplayer-info-panel-item-buffer-remain .dplayer-info-panel-item-data"),this.infoDownloadSpeed=this.container.querySelector(".dplayer-info-panel-item-download-speed .dplayer-info-panel-item-data")}},Xh=class{constructor(b){ye(this,"options");ye(this,"player");ye(this,"container");ye(this,"danTunnel");ye(this,"danIndex");ye(this,"danFontSize");ye(this,"dan");ye(this,"_opacity");ye(this,"events");ye(this,"unlimited");ye(this,"context",null);ye(this,"showing");ye(this,"paused",!1);this.options=b,this.player=this.options.player,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.danFontSize=24,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited===1,this._measure("",0),this.load()}load(){let b;b=this.options.api.maximum?`${this.options.api.address}?id=${this.options.api.id}&max=${this.options.api.maximum}`:`${this.options.api.address}?id=${this.options.api.id}`;const R=(this.options.api.addition||[]).slice(0);R.push(b),this.events&&this.events.trigger("danmaku_load_start",R),this._readAllEndpoints(R,V=>{this.dan=[].concat(...V).sort((Y,le)=>Y.time-le.time),window.requestAnimationFrame(()=>{this.frame()}),this.options.callback(),this.events&&this.events.trigger("danmaku_load_end")})}reload(b){this.options.api=b,this.dan=[],this.clear(),this.load()}_readAllEndpoints(b,R){const V=[];let Y=0;for(let le=0;le<b.length;++le)this.options.apiBackend.read({url:b[le],success:pe=>{V[le]=pe,++Y,Y===b.length&&R(V)},error:pe=>{this.options.error(pe||this.options.tran("Danmaku load failed")),V[le]=[],++Y,Y===b.length&&R(V)}})}send(b,R,V=!1){const Y={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:b.text,color:b.color,type:b.type,size:b.size};this.options.apiBackend.send({url:this.options.api.address,data:Y,success:()=>{this.dan.splice(this.danIndex,0,Y),this.danIndex++,this.draw({text:Y.text,color:Y.color,type:Y.type,size:Y.size,border:!0}),this.events&&this.events.trigger("danmaku_send",Y),R()},error:le=>{this.options.error(le||this.options.tran("Danmaku send failed")),V===!0&&R()}})}frame(){if(this.dan.length&&!this.paused&&this.showing){let b=this.dan[this.danIndex];const R=[];for(;b&&this.options.time()>(typeof b.time=="number"?b.time:parseFloat(b.time));)R.push(b),b=this.dan[++this.danIndex];this.draw(R)}window.requestAnimationFrame(()=>{this.frame()})}opacity(b){return b!==void 0&&(this.container.style.setProperty("--dplayer-danmaku-opacity",`${b}`),this._opacity=b,this.events&&this.events.trigger("danmaku_opacity",this._opacity)),this._opacity}draw(b){if(this.showing){let R;R=Object.prototype.toString.call(b)!=="[object Array]"?[b]:b;let Y=this.container.offsetWidth/1024*1.25;Y>=1&&(Y=1);let le=this.options.fontSize*Y;const pe=le+6*Y,we=this.container.offsetWidth,Ke=this.container.offsetHeight/pe,lt=dt=>{const ut=dt.offsetWidth||parseInt(dt.style.width),It=dt.getBoundingClientRect().right||this.container.getBoundingClientRect().right+ut;return this.container.getBoundingClientRect().right-It},$e=dt=>(we+dt)/5,ht=(dt,ut,It)=>{const Ti=we/$e(It);for(let qt=0;this.unlimited||qt<Ke;qt++){const Gt=this.danTunnel[ut][qt+""];if(!Gt||!Gt.length)return this.danTunnel[ut][qt+""]=[dt],dt.addEventListener("animationend",()=>{this.danTunnel[ut][qt+""].splice(0,1)}),qt%Ke;if(ut==="right")for(let xi=0;xi<Gt.length;xi++){const fi=lt(Gt[xi])-10;if(fi<=we-Ti*$e(parseInt(Gt[xi].style.width))||fi<=0)break;if(xi===Gt.length-1)return this.danTunnel[ut][qt+""].push(dt),dt.addEventListener("animationend",()=>{this.danTunnel[ut][qt+""].splice(0,1)}),qt%Ke}}return-1},Tt=document.createDocumentFragment();for(let dt=0;dt<R.length;dt++){const ut=R[dt];switch(typeof ut.color=="number"&&isFinite(ut.color)&&(ut.color=T.number2Color(ut.color)),typeof ut.type=="number"&&isFinite(ut.type)&&(ut.type=T.number2Type(ut.type)),ut.color||(ut.color="#ffeaea"),(!ut.type||ut.type!=="right"&&ut.type!=="top"&&ut.type!=="bottom")&&(ut.type="right"),ut.size||(ut.size="medium"),ut.size){case"big":le*=1.25;break;case"small":le*=.8}const It=(()=>{let qt=0;for(const Gt of ut.text.split(`
`)){const xi=this._measure(Gt,le);xi>qt&&(qt=xi)}return qt})(),Ti=ut.text.split(`
`);for(const qt of ut.type==="bottom"?Ti.reverse():Ti){const Gt=document.createElement("div");if(Gt.classList.add("dplayer-danmaku-item"),Gt.classList.add(`dplayer-danmaku-${ut.type}`),Gt.classList.add(`dplayer-danmaku-size-${ut.size}`),Gt.style.color=ut.color,"border"in ut&&ut.border){const fi=document.createElement("span");fi.style.border=`2px solid ${this.options.borderColor}`,fi.textContent=qt,Gt.appendChild(fi)}else Gt.textContent=qt;Gt.addEventListener("animationend",()=>{this.container.removeChild(Gt)});const xi=ht(Gt,ut.type,It);switch(ut.type){case"right":xi>=0&&(Gt.style.width=It+1+"px",Gt.style.top=pe*xi+8+"px",Gt.style.transform=`translateX(-${we}px)`,Gt.style.willChange="transform");break;case"top":xi>=0&&(Gt.style.width=It+1+"px",Gt.style.top=pe*xi+8+"px",Gt.style.willChange="visibility");break;case"bottom":xi>=0&&(Gt.style.width=It+1+"px",Gt.style.bottom=pe*xi+8+"px",Gt.style.willChange="visibility");break;default:console.error(`Can't handled danmaku type: ${ut.type}`)}xi>=0&&(Gt.classList.add("dplayer-danmaku-move"),Gt.style.animationDuration=this._danAnimation(ut.type),Tt.appendChild(Gt))}}return this.container.style.setProperty("--dplayer-danmaku-font-size",`${le}px`),this.container.appendChild(Tt),Tt}return null}play(){this.paused=!1}pause(){this.paused=!0}_measure(b,R){this.context&&this.danFontSize===R||(this.danFontSize=R,this.context=document.createElement("canvas").getContext("2d"),this.context.font=`bold ${this.danFontSize}px "Segoe UI", Arial`);const V=b.split(`
`);let Y=0;for(let le=0;le<V.length;le++)Y=Math.max(Y,this.context.measureText(V[le]).width);return Y}seek(){this.clear();for(let b=0;b<this.dan.length;b++){if(this.dan[b].time>=this.options.time()){this.danIndex=b;break}this.danIndex=this.dan.length}}clear(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}resize(){const b=this.container.offsetWidth,R=this.container.querySelectorAll(".dplayer-danmaku-item");for(let V=0;V<R.length;V++)R[V].style.transform=`translateX(-${b}px)`}hide(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}show(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}toggle(){this.showing?this.hide():this.show()}unlimit(b){this.unlimited=b}speed(b){this.options.speedRate=b}_danAnimation(b){const R=this.options.speedRate,V=this.player.fullScreen.isFullScreen("browser")||this.player.fullScreen.isFullScreen("web");return{top:(V?4.5:4)/R+"s",right:(V?5.5:5)/R+"s",bottom:(V?4.5:4)/R+"s"}[b]}},Jh=class{constructor(){ye(this,"events");ye(this,"videoEvents");ye(this,"playerEvents");this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_load_start","danmaku_load_end","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}on(b,R,V=!1){this.type(b)&&typeof R=="function"&&(this.events[b]||(this.events[b]=[]),this.events[b].push({callback:R,once:V}))}off(b,R){if(this.type(b)&&typeof R=="function"&&this.events[b])for(const V of this.events[b])V.callback===R&&this.events[b].splice(this.events[b].indexOf(V),1)}trigger(b,R){if(this.events[b]&&this.events[b].length)for(const V of this.events[b])V.callback(R),V.once&&this.off(b,V.callback)}type(b){return this.playerEvents.indexOf(b)!==-1?"player":this.videoEvents.indexOf(b)!==-1?"video":(console.error(`Unknown event name: ${b}`),null)}},Qh=class{constructor(b){ye(this,"player");ye(this,"lastScrollPosition");ye(this,"fullscreenchange");this.player=b,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",()=>{this.player.resize()}),this.player.events.on("webfullscreen_cancel",()=>{this.player.resize(),T.setScrollPosition(this.lastScrollPosition)}),this.fullscreenchange=()=>{this.player.resize(),this.isFullScreen("browser")?this.player.events.trigger("fullscreen"):(T.setScrollPosition(this.lastScrollPosition),this.player.container.classList.remove("dplayer-fulled-browser"),this.player.events.trigger("fullscreen_cancel"))},this.player.container.onfullscreenchange!==void 0?this.player.container.addEventListener("fullscreenchange",this.fullscreenchange):this.player.container.addEventListener("webkitfullscreenchange",this.fullscreenchange)}isFullScreen(b="browser"){switch(b){case"browser":{const R=document.fullscreenElement||document.webkitFullscreenElement;return!(!R||R!==this.player.container)}case"web":return this.player.container.classList.contains("dplayer-fulled")}}request(b="browser"){const R=b==="browser"?"web":"browser",V=this.isFullScreen(R);switch(V||(this.lastScrollPosition=T.getScrollPosition()),b){case"browser":if(this.player.container.requestFullscreen=this.player.container.requestFullscreen||this.player.container.webkitRequestFullscreen,this.player.container.requestFullscreen!==void 0?this.player.container.requestFullscreen():this.player.video.webkitEnterFullscreen&&this.player.video.webkitEnterFullscreen(),screen.orientation)try{screen.orientation.lock("landscape").catch(()=>{})}catch{}this.player.container.requestFullscreen!==void 0&&this.player.container.classList.add("dplayer-fulled-browser");break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}V&&this.cancel(R)}cancel(b="browser"){switch(b){case"browser":if(document.exitFullscreen=document.exitFullscreen||document.webkitExitFullscreen,document.exitFullscreen&&document.exitFullscreen(),screen.orientation)try{screen.orientation.unlock()}catch{}this.player.container.classList.remove("dplayer-fulled-browser");break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}toggle(b="browser"){this.isFullScreen(b)?this.cancel(b):this.request(b)}destroy(){this.player.container.removeEventListener("fullscreenchange",this.fullscreenchange),this.player.container.removeEventListener("webkitfullscreenchange",this.fullscreenchange)}},Zh=class{constructor(b){ye(this,"storageName");ye(this,"default");ye(this,"data");this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:1,volume:Object.prototype.hasOwnProperty.call(b.options,"volume")?b.options.volume:1,unlimited:(b.options.danmaku&&b.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}init(){for(const b in this.storageName){const R=this.storageName[b];this.data[b]=parseFloat(T.storage.get(R)||this.default[b].toString())}}get(b){return this.data[b]}set(b,R){this.data[b]=R,T.storage.set(this.storageName[b],R)}},eu=class{constructor(b,R,V,Y,le){ye(this,"container");ye(this,"video");ye(this,"plugins");ye(this,"options");ye(this,"events");this.container=b,this.video=R,this.plugins=V,this.options=Y,this.events=le,this.init()}init(){if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.options.type==="webvtt"&&this.video.textTracks&&this.video.textTracks[0]){const b=this.video.textTracks[0];b.oncuechange=()=>{if(!b.activeCues)return;const R=b.activeCues[0];if(this.container.innerHTML="",R){const V=document.createElement("div");V.appendChild(R.getCueAsHTML());const Y=V.innerHTML.split(/\r?\n/).map(le=>`<p>${le}</p>`).join("");this.container.innerHTML=Y}this.events.trigger("subtitle_change")}}}show(){this.container.classList.remove("dplayer-subtitle-hide"),this.options.type==="aribb24"&&this.plugins.aribb24Caption&&this.plugins.aribb24Caption.show(),this.events.trigger("subtitle_show")}hide(){this.container.classList.add("dplayer-subtitle-hide"),this.options.type==="aribb24"&&this.plugins.aribb24Caption&&this.plugins.aribb24Caption.hide(),this.events.trigger("subtitle_hide")}toggle(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}},tu=class{constructor(b){ye(this,"elements");this.elements={},this.elements.volume=b.volumeBar,this.elements.played=b.playedBar,this.elements.loaded=b.loadedBar,this.elements.danmaku=b.danmakuOpacityBar}set(b,R,V){R=Math.max(R,0),R=Math.min(R,1),this.elements[b].style[V]=100*R+"%"}get(b){return parseFloat(this.elements[b].style.width)/100}},iu=class{constructor(b){ye(this,"player");ye(this,"types");ye(this,"enablefpsChecker");ye(this,"enableinfoChecker");ye(this,"enableloadingChecker");ye(this,"fpsIndex");ye(this,"fpsStart");ye(this,"fpsChecker");ye(this,"infoChecker");ye(this,"loadingChecker");this.player=b,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(R){window.setTimeout(R,1e3/60)},this.types=["loading","info","fps"],this.init()}init(){this.types.map(b=>(b!=="fps"&&this[`init${b}Checker`](),b))}initloadingChecker(){let b=0,R=0,V=!1;this.loadingChecker=window.setInterval(()=>{this.enableloadingChecker&&(R=this.player.video.currentTime,V||R!==b||this.player.video.paused||(this.player.container.classList.add("dplayer-loading"),V=!0),V&&R>b&&!this.player.video.paused&&(this.player.container.classList.remove("dplayer-loading"),V=!1),b=R)},100)}initfpsChecker(){window.requestAnimationFrame(()=>{if(this.enablefpsChecker)if(this.initfpsChecker(),this.fpsStart){this.fpsIndex++;const b=new Date;b-this.fpsStart>1e3&&(this.player.infoPanel.fps(this.fpsIndex/(b-this.fpsStart)*1e3),this.fpsStart=new Date,this.fpsIndex=0)}else this.fpsStart=new Date,this.fpsIndex=0;else this.fpsStart=0,this.fpsIndex=0})}initinfoChecker(){this.infoChecker=window.setInterval(()=>{this.enableinfoChecker&&this.player.infoPanel.update()},1e3)}enable(b){this[`enable${b}Checker`]=!0,b==="fps"&&this.initfpsChecker()}disable(b){this[`enable${b}Checker`]=!1}destroy(){this.types.map(b=>(this[`enable${b}Checker`]=!1,this[`${b}Checker`]&&window.clearInterval(this[`${b}Checker`]),b))}},nu=class{constructor(b){ye(this,"container");this.container=b,this.container.addEventListener("animationend",()=>{this.container.classList.remove("dplayer-bezel-transition")})}switch(b){this.container.innerHTML=b,this.container.classList.add("dplayer-bezel-transition")}},ru=class{constructor(b){ye(this,"container");ye(this,"barWidth");ye(this,"events");this.container=b.container,this.barWidth=b.barWidth,this.container.style.backgroundImage=`url('${b.url}')`,this.events=b.events}resize(b,R,V){this.container.style.width=`${b}px`,this.container.style.height=`${R}px`,this.container.style.top=2-R+"px",this.barWidth=V}show(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}move(b){this.container.style.backgroundPosition=`-${160*(Math.ceil(b/this.barWidth*100)-1)}px 0`,this.container.style.left=`${Math.min(Math.max(b-this.container.offsetWidth/2,-10),this.barWidth-150)}px`}hide(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}},au=class{constructor(b){ye(this,"player");ye(this,"disableAutoHide",!1);ye(this,"autoHideTimer");ye(this,"mobileSkipTimer");ye(this,"mobileBackwardTime");ye(this,"mobileForwardTime");ye(this,"setAutoHideHandler");ye(this,"thumbnails",null);this.player=b,this.autoHideTimer=0,this.mobileSkipTimer=0,this.mobileBackwardTime=0,this.mobileForwardTime=0,this.setAutoHideHandler=()=>this.setAutoHide(),T.isMobile?this.player.container.addEventListener("touchmove",this.setAutoHideHandler):(this.player.container.addEventListener("mousemove",this.setAutoHideHandler),this.player.container.addEventListener("click",this.setAutoHideHandler)),this.player.on("play",this.setAutoHideHandler),this.player.on("pause",this.setAutoHideHandler),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initPipButton(),this.initSyncButton(),this.initScreenshotButton(),this.initSubtitleButton(),this.initHighlights(),this.initAirplayButton(),T.isMobile||this.initVolumeButton()}initPlayButton(){this.player.template.playButton.addEventListener("click",()=>{this.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",()=>{this.player.toggle()}),T.isMobile?(this.player.template.videoWrap.addEventListener("click",()=>{this.toggle(),this.isShow()&&this.setAutoHide()}),this.player.template.controllerMask.addEventListener("click",()=>{this.toggle(),this.isShow()&&this.setAutoHide()})):(this.player.template.videoWrap.addEventListener("click",()=>{this.player.toggle()}),this.player.template.controllerMask.addEventListener("click",()=>{this.player.toggle()})),this.player.template.mobileBackwardButton.addEventListener("click",()=>{this.mobileBackwardTime+=10,this.player.seek(this.player.video.currentTime-10),this.player.notice(`${this.player.tran("REW")} ${this.mobileBackwardTime.toFixed(0)} ${this.player.tran("s")}`),window.clearTimeout(this.mobileSkipTimer),this.mobileSkipTimer=window.setTimeout(()=>{this.mobileBackwardTime=0},1e3),this.setAutoHide()}),this.player.template.mobileForwardButton.addEventListener("click",()=>{this.mobileForwardTime+=10,this.player.seek(this.player.video.currentTime+10),this.player.notice(`${this.player.tran("FF")} ${this.mobileForwardTime.toFixed(0)} ${this.player.tran("s")}`),window.clearTimeout(this.mobileSkipTimer),this.mobileSkipTimer=window.setTimeout(()=>{this.mobileForwardTime=0},1e3),this.setAutoHide()})}initHighlights(){this.player.on("durationchange",()=>{if(this.player.video.duration!==1&&this.player.video.duration!==1/0&&this.player.options.highlight){const b=this.player.template.playedBarWrap.querySelectorAll(".dplayer-highlight");[].slice.call(b,0).forEach(R=>{this.player.template.playedBarWrap.removeChild(R)});for(let R=0;R<this.player.options.highlight.length;R++){if(!this.player.options.highlight[R].text||!this.player.options.highlight[R].time)continue;const V=document.createElement("div");V.classList.add("dplayer-highlight"),V.style.left=this.player.options.highlight[R].time/this.player.video.duration*100+"%";const Y=document.createElement("span");Y.classList.add("dplayer-highlight-text"),Y.textContent=this.player.options.highlight[R].text,V.appendChild(Y),this.player.template.playedBarWrap.insertBefore(V,this.player.template.playedBarTime)}}})}initThumbnails(){this.player.options.video.thumbnails&&(this.thumbnails=new ru({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",()=>{this.thumbnails.resize(160,this.player.video.videoHeight/this.player.video.videoWidth*160,this.player.template.barWrap.offsetWidth)}))}initPlayedBar(){let b;const R=Y=>{let le=((Y.clientX||Y.changedTouches&&Y.changedTouches[0].clientX)-T.getBoundingClientRectViewLeft(this.player.template.playedBarWrap))/this.player.template.playedBarWrap.clientWidth;le=Math.max(le,0),le=Math.min(le,1),this.player.bar.set("played",le,"width");const pe=T.getVideoDuration(this.player.video,this.player.template);this.player.template.ptime.textContent=T.secondToTime(le*pe),this.player.container.classList.add("dplayer-seeking"),this.player.video.paused||this.player.video.pause()},V=Y=>{document.removeEventListener(T.nameMap.dragEnd,V),document.removeEventListener(T.nameMap.dragMove,R);let le=((Y.clientX||Y.changedTouches&&Y.changedTouches[0].clientX)-T.getBoundingClientRectViewLeft(this.player.template.playedBarWrap))/this.player.template.playedBarWrap.clientWidth;le=Math.max(le,0),le=Math.min(le,1),this.player.bar.set("played",le,"width");const pe=T.getVideoDuration(this.player.video,this.player.template);this.player.seek(this.player.bar.get("played")*pe),b||this.player.video.play(),this.player.container.classList.remove("dplayer-seeking")};this.player.template.playedBarWrap.addEventListener(T.nameMap.dragStart,()=>{b=this.player.video.paused,document.addEventListener(T.nameMap.dragMove,R),document.addEventListener(T.nameMap.dragEnd,V)}),this.player.template.playedBarWrap.addEventListener(T.nameMap.dragMove,Y=>{const le=T.getVideoDuration(this.player.video,this.player.template);if(le){const pe=this.player.template.playedBarWrap.getBoundingClientRect().left,we=(Y.clientX||Y.changedTouches[0].clientX)-pe;if(we<0||we>this.player.template.playedBarWrap.offsetWidth)return;const Ke=le*(we/this.player.template.playedBarWrap.offsetWidth);T.isMobile&&this.thumbnails&&this.thumbnails.show(),this.thumbnails&&this.thumbnails.move(we),this.player.template.playedBarTime.style.left=we-(Ke>=3600?25:20)+"px",this.player.template.playedBarTime.textContent=T.secondToTime(Ke),this.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(T.nameMap.dragEnd,()=>{T.isMobile&&this.thumbnails&&this.thumbnails.hide()}),T.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",()=>{this.player.video.duration&&(this.thumbnails&&this.thumbnails.show(),this.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",()=>{this.player.video.duration&&(this.thumbnails&&this.thumbnails.hide(),this.player.template.playedBarTime.classList.add("hidden"))}))}initFullButton(){this.player.template.browserFullButton.addEventListener("click",()=>{this.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",()=>{this.player.fullScreen.toggle("web")})}initPipButton(){document.pictureInPictureEnabled?this.player.template.pipButton.addEventListener("click",()=>{document.pictureInPictureElement?document.exitPictureInPicture():this.player.video.requestPictureInPicture().catch(b=>{console.error(b),this.player.options.lang==="ja"||this.player.options.lang==="ja-jp"?this.player.notice("Picture-in-Picture を開始できませんでした。",void 0,void 0,"#FF6F6A"):this.player.notice("Picture-in-Picture could not be started.",void 0,void 0,"#FF6F6A")})}):this.player.template.pipButton.style.display="none"}initVolumeButton(){const b=V=>{const Y=V||window.event,le=((Y.clientX||Y.changedTouches[0].clientX)-T.getBoundingClientRectViewLeft(this.player.template.volumeBarWrap)-5.5)/35;this.player.volume(le)},R=()=>{document.removeEventListener(T.nameMap.dragEnd,R),document.removeEventListener(T.nameMap.dragMove,b),this.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",V=>{const Y=V||window.event,le=((Y.clientX||Y.changedTouches[0].clientX)-T.getBoundingClientRectViewLeft(this.player.template.volumeBarWrap)-5.5)/35;this.player.volume(le)}),this.player.template.volumeBarWrapWrap.addEventListener(T.nameMap.dragStart,()=>{document.addEventListener(T.nameMap.dragMove,b),document.addEventListener(T.nameMap.dragEnd,R),this.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",()=>{this.player.video.muted?(this.player.video.muted=!1,this.player.switchVolumeIcon(),this.player.bar.set("volume",this.player.volume(),"width")):(this.player.video.muted=!0,this.player.template.volumeIcon.innerHTML=zi.volumeOff,this.player.bar.set("volume",0,"width"))})}initSyncButton(){this.player.options.live&&this.player.template.syncButton.addEventListener("click",()=>{this.player.sync()})}initScreenshotButton(){this.player.options.screenshot&&this.player.template.cameraButton.addEventListener("click",()=>{const b=document.createElement("canvas");b.width=this.player.video.videoWidth,b.height=this.player.video.videoHeight,b.getContext("2d").drawImage(this.player.video,0,0,b.width,b.height),b.toBlob(R=>{if(R===null)return;const V=new Date,Y=`Capture_${V.getFullYear()}${("0"+(V.getMonth()+1)).slice(-2)}${("0"+V.getDate()).slice(-2)}-${("0"+V.getHours()).slice(-2)}${("0"+V.getMinutes()).slice(-2)}${("0"+V.getSeconds()).slice(-2)}.jpg`,le=URL.createObjectURL(R),pe=document.createElement("a");pe.download!==void 0?(pe.download=Y,pe.href=le,pe.click(),URL.revokeObjectURL(le),this.player.events.trigger("screenshot",R)):this.player.notice("Error: Screenshot download is not supported.",void 0,void 0,"#FF6F6A")},"image/jpeg",1)})}initAirplayButton(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",(function(b){b.availability==="available"?this.template.airplayButton.disable=!1:this.template.airplayButton.disable=!0,this.template.airplayButton.addEventListener("click",(function(){this.video.webkitShowPlaybackTargetPicker()}).bind(this))}).bind(this.player)):this.player.template.airplayButton.style.display="none")}initSubtitleButton(){this.player.options.subtitle&&(this.player.events.on("subtitle_show",()=>{this.player.template.subtitleButton.ariaLabel=this.player.tran("Hide subtitle"),this.player.template.subtitleButtonInner.style.opacity="",this.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",()=>{this.player.template.subtitleButton.ariaLabel=this.player.tran("Show subtitle"),this.player.template.subtitleButtonInner.style.opacity="0.4",this.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",()=>{this.player.subtitle!==null&&this.player.subtitle.toggle()}))}setAutoHide(b=3e3){this.show(),window.clearTimeout(this.autoHideTimer),this.autoHideTimer=window.setTimeout(()=>{!this.player.video.played.length||this.player.paused||this.disableAutoHide||this.hide()},b)}show(){this.player.container.classList.remove("dplayer-hide-controller")}hide(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}isShow(){return!this.player.container.classList.contains("dplayer-hide-controller")}toggle(){this.isShow()?this.hide():this.show()}destroy(){T.isMobile?this.player.container.removeEventListener("touchmove",this.setAutoHideHandler):(this.player.container.removeEventListener("mousemove",this.setAutoHideHandler),this.player.container.removeEventListener("click",this.setAutoHideHandler)),window.clearTimeout(this.autoHideTimer)}},su=class{constructor(b){ye(this,"player");ye(this,"loop");ye(this,"showDanmaku");ye(this,"unlimitDanmaku");ye(this,"currentAudio","primary");ye(this,"resizeObserver");this.player=b,this.player.template.mask.addEventListener("click",()=>{this.hide()}),this.player.template.settingButton.addEventListener("click",()=>{this.show()});const R=()=>{const V=this.player.template.settingOriginPanel.scrollHeight;this.player.template.settingBox.style.clipPath=`inset(calc(100% - ${V}px) 0 0 round 7px)`};if(R(),this.resizeObserver=new ResizeObserver(R),this.resizeObserver.observe(this.player.template.settingOriginPanel),this.player.options.video.quality){this.player.template.quality.addEventListener("click",()=>{this.player.template.settingBox.classList.add("dplayer-setting-box-quality")}),this.player.template.qualityHeader.addEventListener("click",()=>{this.player.template.settingBox.classList.remove("dplayer-setting-box-quality")});for(let V=0;V<this.player.template.qualityItem.length;V++)this.player.template.qualityItem[V].addEventListener("click",()=>{this.player.switchingQuality||this.player.switchQuality(parseInt(this.player.template.qualityItem[V].dataset.index))})}this.player.template.speed.addEventListener("click",()=>{this.player.template.settingBox.classList.add("dplayer-setting-box-speed")}),this.player.template.speedHeader.addEventListener("click",()=>{this.player.template.settingBox.classList.remove("dplayer-setting-box-speed")});for(let V=0;V<this.player.template.speedItem.length;V++)this.player.template.speedItem[V].addEventListener("click",Y=>{this.player.speed(parseFloat(Y.target.dataset.speed))});this.player.template.audio.addEventListener("click",()=>{this.player.template.settingBox.classList.add("dplayer-setting-box-audio")}),this.player.template.audioHeader.addEventListener("click",()=>{this.player.template.settingBox.classList.remove("dplayer-setting-box-audio")});for(let V=0;V<this.player.template.audioItem.length;V++)this.player.template.audioItem[V].addEventListener("click",()=>{if(this.player.plugins.mpegts||this.player.plugins.liveLLHLSForKonomiTV){if(this.player.template.audioItem[V].dataset.audio===this.currentAudio)return;this.player.template.audioItem[V].dataset.audio==="primary"?(this.currentAudio="primary",this.player.template.audioItem[0].classList.add("dplayer-setting-audio-current"),this.player.template.audioItem[1].classList.remove("dplayer-setting-audio-current"),this.player.template.audioValue.textContent=this.player.tran("Primary audio"),window.mpegts&&this.player.plugins.mpegts&&this.player.plugins.mpegts instanceof window.mpegts.MSEPlayer?this.player.plugins.mpegts.switchPrimaryAudio():this.player.plugins.liveLLHLSForKonomiTV&&this.player.plugins.liveLLHLSForKonomiTV.switchPrimaryAudio()):this.player.template.audioItem[V].dataset.audio==="secondary"&&(this.currentAudio="secondary",this.player.template.audioItem[0].classList.remove("dplayer-setting-audio-current"),this.player.template.audioItem[1].classList.add("dplayer-setting-audio-current"),this.player.template.audioValue.textContent=this.player.tran("Secondary audio"),window.mpegts&&this.player.plugins.mpegts&&this.player.plugins.mpegts instanceof window.mpegts.MSEPlayer?this.player.plugins.mpegts.switchSecondaryAudio():this.player.plugins.liveLLHLSForKonomiTV&&this.player.plugins.liveLLHLSForKonomiTV.switchSecondaryAudio()),this.player.template.settingBox.classList.remove("dplayer-setting-box-audio")}});if(this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",()=>{this.player.template.loopToggle.checked=!this.player.template.loopToggle.checked,this.player.template.loopToggle.checked?this.loop=!0:this.loop=!1}),this.showDanmaku=this.player.user.get("danmaku")===1,this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",()=>{this.player.template.showDanmakuToggle.checked=!this.player.template.showDanmakuToggle.checked,this.player.template.showDanmakuToggle.checked?(this.showDanmaku=!0,this.player.danmaku!==null&&this.player.danmaku.show()):(this.showDanmaku=!1,this.player.danmaku!==null&&this.player.danmaku.hide()),this.player.user.set("danmaku",this.showDanmaku?1:0)}),this.unlimitDanmaku=this.player.user.get("unlimited")===1,this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",()=>{this.player.template.unlimitDanmakuToggle.checked=!this.player.template.unlimitDanmakuToggle.checked,this.player.template.unlimitDanmakuToggle.checked?(this.unlimitDanmaku=!0,this.player.danmaku!==null&&this.player.danmaku.unlimit(!0)):(this.unlimitDanmaku=!1,this.player.danmaku!==null&&this.player.danmaku.unlimit(!1)),this.player.user.set("unlimited",this.unlimitDanmaku?1:0)}),this.player.danmaku){this.player.on("danmaku_opacity",pe=>{this.player.bar.set("danmaku",pe,"width"),this.player.user.set("opacity",pe),this.player.template.danmakuOpacityValue.textContent=pe.toFixed(1)}),this.player.danmaku.opacity(this.player.user.get("opacity")),this.player.template.danmakuOpacityValue.textContent=this.player.user.get("opacity").toFixed(1);const Y=pe=>{const we=pe||window.event;let Ke=((we.clientX||we.changedTouches[0].clientX)-T.getBoundingClientRectViewLeft(this.player.template.danmakuOpacityBarWrap))/190;Ke=Math.max(Ke,0),Ke=Math.min(Ke,1),this.player.danmaku!==null&&this.player.danmaku.opacity(Ke)},le=()=>{document.removeEventListener(T.nameMap.dragEnd,le),document.removeEventListener(T.nameMap.dragMove,Y),this.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",pe=>{const we=pe||window.event;let Ke=((we.clientX||we.changedTouches[0].clientX)-T.getBoundingClientRectViewLeft(this.player.template.danmakuOpacityBarWrap))/190;Ke=Math.max(Ke,0),Ke=Math.min(Ke,1),this.player.danmaku!==null&&this.player.danmaku.opacity(Ke)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(T.nameMap.dragStart,()=>{document.addEventListener(T.nameMap.dragMove,Y),document.addEventListener(T.nameMap.dragEnd,le),this.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}hide(){this.player.template.container.classList.remove("dplayer-show-controller"),this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),window.setTimeout(()=>{this.player.template.settingBox.classList.remove("dplayer-setting-box-speed"),this.player.template.settingBox.classList.remove("dplayer-setting-box-audio")},300),this.player.controller.disableAutoHide=!1}show(){this.player.template.container.classList.add("dplayer-show-controller"),this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}destroy(){this.resizeObserver.disconnect()}},ou=class{constructor(b){ye(this,"player");this.player=b,this.player.template.mask.addEventListener("click",()=>{this.hide()}),this.player.template.commentButton.addEventListener("click",()=>{this.show()}),this.player.template.commentSettingButton.addEventListener("click",()=>{this.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",()=>{if(this.player.template.commentColorSettingBox.querySelector("input:checked+span")){const R=this.player.template.commentColorSettingBox.querySelector("input:checked").value;this.player.template.commentSettingFill.style.fill=R,this.player.template.commentInput.style.color=R,this.player.template.commentSendFill.style.fill=R}}),this.player.template.commentInput.addEventListener("click",()=>{this.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",R=>{(R||window.event).keyCode===13&&this.send()}),this.player.template.commentSendButton.addEventListener("click",()=>{this.send()})}show(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}hide(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}showSetting(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}hideSetting(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}toggleSetting(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}send(){var b;((b=this.player.options.danmaku)==null?void 0:b.closeCommentFormAfterSend)===!0&&this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?(this.player.danmaku!==null&&this.player.danmaku.send({text:this.player.template.commentInput.value,color:this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value,type:this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value,size:this.player.container.querySelector(".dplayer-comment-setting-size input:checked").value},()=>{var R;((R=this.player.options.danmaku)==null?void 0:R.closeCommentFormAfterSend)===!0&&(this.hide(),this.player.controller.setAutoHide(750))},!0),this.player.template.commentInput.value=""):this.player.notice(this.player.tran("Please input danmaku content!"),void 0,void 0,"#FF6F6A")}},lu=class{constructor(b){ye(this,"player");ye(this,"doHotKeyHandler");ye(this,"cancelFullScreenHandler");this.player=b,this.doHotKeyHandler=this.doHotKey.bind(this),this.cancelFullScreenHandler=this.cancelFullScreen.bind(this),this.player.options.hotkey&&document.addEventListener("keydown",this.doHotKeyHandler),document.addEventListener("keydown",this.cancelFullScreenHandler)}doHotKey(b){var Y,le;const R=(Y=document.activeElement)==null?void 0:Y.tagName.toUpperCase(),V=(le=document.activeElement)==null?void 0:le.getAttribute("contenteditable");if(R!=="INPUT"&&R!=="TEXTAREA"&&V!==""&&V!=="true"){const pe=b||window.event;let we;switch(pe.keyCode){case 32:(this.player.focus||this.player.options.hotkey)&&(pe.preventDefault(),this.player.toggle());break;case 37:(this.player.focus||this.player.options.hotkey)&&(pe.preventDefault(),pe.altKey?this.player.seek(this.player.video.currentTime-60):pe.shiftKey?this.player.seek(this.player.video.currentTime-30):pe.ctrlKey||pe.metaKey?this.player.seek(this.player.video.currentTime-15):this.player.seek(this.player.video.currentTime-5),this.player.controller.setAutoHide());break;case 39:(this.player.focus||this.player.options.hotkey)&&(pe.preventDefault(),pe.altKey?this.player.seek(this.player.video.currentTime+60):pe.shiftKey?this.player.seek(this.player.video.currentTime+30):pe.ctrlKey||pe.metaKey?this.player.seek(this.player.video.currentTime+15):this.player.seek(this.player.video.currentTime+5),this.player.controller.setAutoHide());break;case 38:this.player.focus&&(pe.preventDefault(),we=this.player.volume()+.1,this.player.volume(we));break;case 40:this.player.focus&&(pe.preventDefault(),we=this.player.volume()-.1,this.player.volume(we));break;case 70:pe.ctrlKey||pe.metaKey||(pe.preventDefault(),this.player.fullScreen.toggle("browser"));break;case 87:pe.ctrlKey||pe.metaKey||(pe.preventDefault(),this.player.fullScreen.toggle("web"));break;case 76:this.player.options.live&&(pe.preventDefault(),this.player.sync());break;case 80:this.player.options.pictureInPicture&&document.pictureInPictureEnabled&&(pe.preventDefault(),this.player.template.pipButton.click());break;case 67:typeof this.player.options.danmaku=="object"&&this.player.options.danmaku&&(pe.ctrlKey||pe.metaKey||(pe.preventDefault(),this.player.controller.show(),this.player.comment!=null&&this.player.comment.show()));break;case 68:typeof this.player.options.danmaku=="object"&&this.player.options.danmaku&&(pe.ctrlKey||pe.metaKey||(pe.preventDefault(),this.player.template.showDanmaku.click(),this.player.template.showDanmakuToggle.checked?this.player.notice(`${this.player.tran("Show comment")}`):this.player.notice(`${this.player.tran("Hide comment")}`)));break;case 83:this.player.options.subtitle&&(pe.ctrlKey||pe.metaKey||(pe.preventDefault(),this.player.subtitle!==null&&(this.player.subtitle.container.classList.contains("dplayer-subtitle-hide")?this.player.notice(`${this.player.tran("Show subtitle")}`):this.player.notice(`${this.player.tran("Hide subtitle")}`),this.player.subtitle.toggle())))}}}cancelFullScreen(b){(b||window.event).keyCode===27&&this.player.fullScreen.isFullScreen("web")&&this.player.fullScreen.cancel("web")}destroy(){this.player.options.hotkey&&document.removeEventListener("keydown",this.doHotKeyHandler),document.removeEventListener("keydown",this.cancelFullScreenHandler)}},cu=class{constructor(b){ye(this,"contextmenuHandler");ye(this,"player");ye(this,"shown");this.player=b,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach((R,V)=>{this.player.options.contextmenu[V].click&&R.addEventListener("click",()=>{const Y=this.player.options.contextmenu[V];Y.click&&Y.click(this.player),this.hide()})}),this.contextmenuHandler=R=>{const V=R||window.event;if(V.preventDefault(),this.shown)return void this.hide();const Y=this.player.container.getBoundingClientRect();this.show(V.clientX-Y.left,V.clientY-Y.top),this.player.template.mask.addEventListener("click",()=>{this.hide()})},this.player.container.addEventListener("contextmenu",this.contextmenuHandler)}show(b,R){this.player.template.menu.classList.add("dplayer-menu-show");const V=this.player.container.getBoundingClientRect();b+this.player.template.menu.offsetWidth>=V.width?(this.player.template.menu.style.right=V.width-b+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=b+"px",this.player.template.menu.style.right="initial"),R+this.player.template.menu.offsetHeight>=V.height?(this.player.template.menu.style.bottom=V.height-R+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=R+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}hide(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}destroy(){this.player.container.removeEventListener("contextmenu",this.contextmenuHandler)}},du=class{constructor(b){ye(this,"player");ye(this,"container");ye(this,"template");ye(this,"video");ye(this,"beginTime",0);this.player=b,this.container=b.template.infoPanel,this.template=b.template,this.video=b.video,this.template.infoPanelClose.addEventListener("click",()=>{this.hide()})}show(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}hide(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}toggle(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}update(){var b;if(this.template.infoVersion.textContent="v1.31.3 b063e0f",this.template.infoType.textContent=this.player.type,this.template.infoUrl.textContent=this.player.options.video.url??"N/A",this.template.infoResolution.textContent=`${this.player.video.videoWidth} x ${this.player.video.videoHeight}`,this.template.infoDuration.textContent=`${this.player.video.duration}`,this.player.video.getVideoPlaybackQuality!=null){const R=this.player.video.getVideoPlaybackQuality();this.template.infoDroppedFrames.textContent=`${R.droppedVideoFrames} / ${R.totalVideoFrames}`}else if(this.player.video.webkitDecodedFrameCount!=null){const R=this.player.video.webkitDecodedFrameCount,V=this.player.video.webkitDroppedFrameCount;this.template.infoDroppedFrames.textContent=`${V} / ${R}`}else this.template.infoDroppedFrames.textContent="N/A";if(this.player.video.buffered.length>0){const R=this.player.video.buffered.length,V=this.player.video.buffered.end(R-1)-this.player.video.currentTime;this.template.infoBufferRemain.textContent=`${V.toFixed(3)} s`}else this.template.infoBufferRemain.textContent="N/A";if(this.player.type==="mpegts"||this.player.type==="flv"){const R=this.player.plugins.mpegts||this.player.plugins.flvjs;if(R){const V=R.mediaInfo,Y=R.statisticsInfo;this.template.infoMimeType.textContent=V.mimeType??"N/A",this.template.infoVideoFPS.textContent=`${((b=V.fps)==null?void 0:b.toFixed(3))??"N/A"}`,Y.speed!=null?this.template.infoDownloadSpeed.textContent=`${Y.speed.toFixed(3)} KB/s`:this.template.infoDownloadSpeed.textContent="N/A"}}else this.template.infoMimeType.textContent="N/A",this.template.infoVideoFPS.textContent="N/A",this.template.infoDownloadSpeed.textContent="N/A"}fps(b){this.template.infoPageFPS.textContent=`${b.toFixed(1)}`}};var hu=n(194),uu=n.n(hu);let so=0;const Rn=[],fu=class{constructor(b){ye(this,"bar");ye(this,"bezel");ye(this,"comment",null);ye(this,"contextmenu");ye(this,"controller");ye(this,"danmaku",null);ye(this,"events");ye(this,"fullScreen");ye(this,"hotkey");ye(this,"infoPanel");ye(this,"setting");ye(this,"subtitle",null);ye(this,"template");ye(this,"timer");ye(this,"user");ye(this,"container");ye(this,"containerClickFun");ye(this,"docClickFun");ye(this,"focus",!1);ye(this,"narrow",!1);ye(this,"noticeTime",null);ye(this,"options");ye(this,"paused",!1);ye(this,"plugins");ye(this,"prevVideoCurrentTime",0);ye(this,"prevVideo",null);ye(this,"quality",null);ye(this,"qualityIndex",null);ye(this,"switchingQuality",!1);ye(this,"resizeObserver");ye(this,"tran");ye(this,"type","auto");ye(this,"video");this.options=(R=>{const V={container:R.container||document.querySelector(".dplayer")||void 0,live:!1,liveSyncMinBufferSize:.8,syncWhenPlayingLive:!0,autoplay:!1,theme:"#b7daff",loop:!1,lang:navigator.language.toLowerCase(),screenshot:!1,pictureInPicture:!0,airplay:!0,hotkey:!0,preload:"metadata",crossOrigin:null,volume:1,playbackSpeed:[.25,.5,.75,1,1.25,1.5,1.75,2],apiBackend:th,video:{},contextmenu:[],mutex:!0,pluginOptions:{}};for(const Y in V)Object.prototype.hasOwnProperty.call(V,Y)&&!Object.prototype.hasOwnProperty.call(R,Y)&&(R[Y]=V[Y]);return R.video&&!R.video.type&&(R.video.type="auto"),typeof R.danmaku=="object"&&R.danmaku&&(!R.danmaku.user&&(R.danmaku.user="DPlayer"),!R.danmaku.speedRate&&(R.danmaku.speedRate=1),!R.danmaku.fontSize&&(R.danmaku.fontSize=35),R.danmaku.closeCommentFormAfterSend!==!1&&(R.danmaku.closeCommentFormAfterSend=!0)),R.subtitle&&(!R.subtitle.type&&(R.subtitle.type="webvtt"),!R.subtitle.fontSize&&(R.subtitle.fontSize="20px"),!R.subtitle.bottom&&(R.subtitle.bottom="40px"),!R.subtitle.color&&(R.subtitle.color="#fff")),R.video.quality&&(typeof R.video.defaultQuality=="string"&&(R.video.quality.forEach((Y,le)=>{R.video.defaultQuality===Y.name&&(R.video.defaultQuality=le)}),typeof R.video.defaultQuality=="string"&&(R.video.defaultQuality=0)),R.video.defaultQuality===void 0&&(R.video.defaultQuality=0),R.video.type=R.video.quality[R.video.defaultQuality].type,R.video.url=R.video.quality[R.video.defaultQuality].url),R.lang&&(R.lang=R.lang.toLowerCase()),R.contextmenu=R.contextmenu.concat([{text:"Video info",click:Y=>{Y.infoPanel.toggle()}},{text:"DPlayer v1.31.3",link:"https://github.com/tsukumijima/DPlayer"}]),{container:R.container,live:R.live,liveSyncMinBufferSize:R.liveSyncMinBufferSize,syncWhenPlayingLive:R.syncWhenPlayingLive,autoplay:R.autoplay,theme:R.theme,loop:R.loop,lang:R.lang,screenshot:R.screenshot,pictureInPicture:R.pictureInPicture,airplay:R.airplay,hotkey:R.hotkey,preload:R.preload,crossOrigin:R.crossOrigin,volume:R.volume,playbackSpeed:R.playbackSpeed,logo:R.logo,apiBackend:R.apiBackend,video:R.video,subtitle:R.subtitle,danmaku:R.danmaku,contextmenu:R.contextmenu,highlight:R.highlight,mutex:R.mutex,pluginOptions:R.pluginOptions}})({preload:b.video.type==="webtorrent"?"none":"metadata",...b}),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new ih(this.options.lang).tran,this.events=new Jh,this.user=new Zh(this),this.container=this.options.container,this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live?this.container.classList.add("dplayer-live"):this.container.classList.remove("dplayer-live"),T.isMobile&&this.container.classList.add("dplayer-mobile"),this.narrow=this.container.offsetWidth<=500,this.narrow&&this.container.classList.add("dplayer-narrow"),this.resizeObserver=new ResizeObserver(R=>{for(const V of R)V.target===this.container&&(this.narrow=this.container.offsetWidth<=500,this.narrow?this.container.classList.add("dplayer-narrow"):this.container.classList.remove("dplayer-narrow"))}),this.resizeObserver.observe(this.container),this.template=new Yh({container:this.container,options:this.options,index:so,tran:this.tran}),this.video=this.template.video,this.bar=new tu(this.template),this.bezel=new nu(this.template.bezel),this.fullScreen=new Qh(this),this.controller=new au(this),this.options.danmaku&&(this.danmaku=new Xh({player:this,container:this.template.danmaku,opacity:this.user.get("opacity"),callback:()=>{setTimeout(()=>{this.template.danmakuLoading.style.display="none",this.options.autoplay&&this.play()},0)},error:R=>{this.notice(R,void 0,void 0,"#FF6F6A")},apiBackend:this.options.apiBackend,borderColor:this.options.theme,fontSize:this.options.danmaku.fontSize,time:()=>this.video.currentTime,unlimited:this.user.get("unlimited"),speedRate:this.options.danmaku.speedRate,api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user},events:this.events,tran:R=>this.tran(R)}),this.comment=new ou(this)),this.plugins={},this.docClickFun=()=>{this.focus=!1},this.containerClickFun=()=>{this.focus=!0},document.addEventListener("click",this.docClickFun,!0),this.container.addEventListener("click",this.containerClickFun,!0),this.paused=!0,this.timer=new iu(this),this.hotkey=new lu(this),this.contextmenu=new cu(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.setting=new su(this),this.infoPanel=new du(this),!this.danmaku&&this.options.autoplay&&this.play(),so++,Rn.push(this)}seek(b){b=Math.max(b,0);const R=T.getVideoDuration(this.video,this.template);R&&(b=Math.min(b,R)),this.video.currentTime<b?this.notice(`${this.tran("FF")} ${(b-this.video.currentTime).toFixed(0)} ${this.tran("s")}`):this.video.currentTime>b&&this.notice(`${this.tran("REW")} ${(this.video.currentTime-b).toFixed(0)} ${this.tran("s")}`),isFinite(b)&&(this.video.currentTime=b),this.danmaku&&this.danmaku.seek(),this.bar.set("played",b/R,"width"),this.template.ptime.textContent=T.secondToTime(b)}sync(b=!1){if(this.options.live){const R=T.getVideoDuration(this.video,this.template)-this.options.liveSyncMinBufferSize;try{this.video.currentTime=R}catch{return}this.danmaku&&this.danmaku.seek(),this.template.ptime.textContent=T.secondToTime(R),b||this.notice(this.tran("Synchronized"))}}play(b=!1){if(this.paused=!1,this.video.paused&&!T.isMobile&&this.bezel.switch(zi.play),this.template.playButton.innerHTML=zi.pause,this.template.mobilePlayButton.innerHTML=zi.pause,this.options.live&&this.options.syncWhenPlayingLive&&this.sync(!0),!b){const R=this.type==="mpegts"&&this.plugins.mpegts&&this.plugins.mpegts.play.bind(this.plugins.mpegts)||this.video.play.bind(this.video);Promise.resolve(R()).catch(()=>{this.pause()}).then(()=>{})}if(this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(let R=0;R<Rn.length;R++)this!==Rn[R]&&Rn[R].pause()}pause(b=!1){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||T.isMobile||this.bezel.switch(zi.pause),this.template.playButton.innerHTML=zi.play,this.template.mobilePlayButton.innerHTML=zi.play,b||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}switchVolumeIcon(){this.volume()>=.95?this.template.volumeIcon.innerHTML=zi.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=zi.volumeDown:this.template.volumeIcon.innerHTML=zi.volumeOff}volume(b=NaN,R=!1,V=!1){if(typeof b=="string"&&(b=parseFloat(b)),!isNaN(b)){b=Math.max(b,0),b=Math.min(b,1),this.bar.set("volume",b,"width");const Y=`${(100*b).toFixed(0)}%`;this.template.volumeBarWrapWrap.ariaLabel=Y,R||this.user.set("volume",b),V||this.notice(`${this.tran("Volume")} ${(100*b).toFixed(0)}%`),this.video.volume=b,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}toggle(){this.video.paused?this.play():this.pause()}on(b,R,V=!1){this.events.on(b,R,V)}off(b,R){this.events.off(b,R)}switchVideo(b,R){this.pause(),this.video.poster=b.pic?b.pic:"",this.video.src=b.url,this.initMSE(this.video,b.type||"auto"),R&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.textContent="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:R.id,address:R.api,token:R.token,maximum:R.maximum,addition:R.addition,user:R.user}))}initMSE(b,R){if(this.type=R,this.options.video.customType&&this.options.video.customType[R])Object.prototype.toString.call(this.options.video.customType[R])==="[object Function]"?this.options.video.customType[R](this.video,this):console.error(`Illegal customType: ${R}`);else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(b.src)?this.type="hls":/.ts(#|\?|$)/i.exec(b.src)?this.type="mpegts":/.flv(#|\?|$)/i.exec(b.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(b.src)?this.type="dash":this.type="normal"),this.type!=="mpegts"&&this.container.classList.add("dplayer-no-audio-switching"),this.type){case"hls":if(window.Hls){const V=/Safari/i.test(navigator.userAgent)&&/iPad|Macintosh/i.test(navigator.userAgent)&&"ontouchend"in document&&(b.canPlayType("application/x-mpegURL")||b.canPlayType("application/vnd.apple.mpegURL"));if(window.Hls.isSupported()&&!V){this.plugins.hls&&(this.plugins.aribb24Caption&&(this.plugins.aribb24Caption.dispose(),delete this.plugins.aribb24Caption),this.plugins.aribb24Superimpose&&(this.plugins.aribb24Superimpose.dispose(),delete this.plugins.aribb24Superimpose),this.plugins.hls.destroy(),delete this.plugins.hls);const Y=this.options.pluginOptions.hls,le=new window.Hls(Y);if(this.plugins.hls=le,le.loadSource(b.src),le.attachMedia(b),this.events.on("destroy",()=>{this.plugins.aribb24Caption&&(this.plugins.aribb24Caption.dispose(),delete this.plugins.aribb24Caption),this.plugins.aribb24Superimpose&&(this.plugins.aribb24Superimpose.dispose(),delete this.plugins.aribb24Superimpose),le.destroy(),delete this.plugins.hls}),this.options.subtitle&&this.options.subtitle.type==="aribb24"){this.options.pluginOptions.aribb24===void 0&&(this.options.pluginOptions.aribb24={}),this.options.pluginOptions.aribb24.enableAutoInBandMetadataTextTrackDetection=!1;const pe=this.options.pluginOptions.aribb24,we=this.plugins.aribb24Caption=new O.CanvasRenderer({...pe,data_identifier:128});if(we.attachMedia(b),we.show(),this.options.pluginOptions.aribb24.disableSuperimposeRenderer!==!0){const Ke=this.plugins.aribb24Superimpose=new O.CanvasRenderer({...pe,data_identifier:129});Ke.attachMedia(b),Ke.show()}le.on(window.Hls.Events.FRAG_PARSING_METADATA,(Ke,lt)=>{for(const $e of lt.samples)this.plugins.aribb24Caption&&this.plugins.aribb24Caption.pushID3v2Data($e.pts,$e.data),this.plugins.aribb24Superimpose&&this.plugins.aribb24Superimpose.pushID3v2Data($e.pts,$e.data)})}}else if(b.canPlayType("application/x-mpegURL")||b.canPlayType("application/vnd.apple.mpegURL")){if(this.plugins.aribb24Caption&&(this.plugins.aribb24Caption.dispose(),delete this.plugins.aribb24Caption),this.plugins.aribb24Superimpose&&(this.plugins.aribb24Superimpose.dispose(),delete this.plugins.aribb24Superimpose),this.events.on("destroy",()=>{this.plugins.aribb24Caption&&(this.plugins.aribb24Caption.dispose(),delete this.plugins.aribb24Caption),this.plugins.aribb24Superimpose&&(this.plugins.aribb24Superimpose.dispose(),delete this.plugins.aribb24Superimpose)}),this.options.subtitle&&this.options.subtitle.type==="aribb24"){this.options.pluginOptions.aribb24===void 0&&(this.options.pluginOptions.aribb24={}),this.options.pluginOptions.aribb24.enableAutoInBandMetadataTextTrackDetection=!0;const Y=this.options.pluginOptions.aribb24,le=this.plugins.aribb24Caption=new O.CanvasRenderer({...Y,data_identifier:128});if(le.attachMedia(b),le.show(),this.options.pluginOptions.aribb24.disableSuperimposeRenderer!==!0){const pe=this.plugins.aribb24Superimpose=new O.CanvasRenderer({...Y,data_identifier:129});pe.attachMedia(b),pe.show()}}}else this.notice("Error: HLS is not supported.",void 0,void 0,"#FF6F6A")}else this.notice("Error: Can't find hls.js.",void 0,void 0,"#FF6F6A");break;case"mpegts":if(window.mpegts)if(window.mpegts.isSupported()){this.plugins.mpegts&&(this.plugins.aribb24Caption&&(this.plugins.aribb24Caption.dispose(),delete this.plugins.aribb24Caption),this.plugins.aribb24Superimpose&&(this.plugins.aribb24Superimpose.dispose(),delete this.plugins.aribb24Superimpose),this.plugins.mpegts.unload(),this.plugins.mpegts.detachMediaElement(),this.plugins.mpegts.destroy(),delete this.plugins.mpegts),this.options.pluginOptions.mpegts===void 0&&(this.options.pluginOptions.mpegts={});const V=window.mpegts.createPlayer(Object.assign(this.options.pluginOptions.mpegts.mediaDataSource||{},{type:"mpegts",isLive:this.options.live,url:b.src}),this.options.pluginOptions.mpegts.config);if(this.plugins.mpegts=V,V.attachMediaElement(b),V.load(),this.events.on("destroy",()=>{this.plugins.aribb24Caption&&(this.plugins.aribb24Caption.dispose(),delete this.plugins.aribb24Caption),this.plugins.aribb24Superimpose&&(this.plugins.aribb24Superimpose.dispose(),delete this.plugins.aribb24Superimpose),V.unload(),V.detachMediaElement(),V.destroy(),delete this.plugins.mpegts}),this.options.subtitle&&this.options.subtitle.type==="aribb24"){this.options.pluginOptions.aribb24===void 0&&(this.options.pluginOptions.aribb24={}),this.options.pluginOptions.aribb24.enableAutoInBandMetadataTextTrackDetection=!1;const Y=this.options.pluginOptions.aribb24,le=this.plugins.aribb24Caption=new O.CanvasRenderer({...Y,data_identifier:128});if(le.attachMedia(b),le.show(),this.options.pluginOptions.aribb24.disableSuperimposeRenderer!==!0){const pe=this.plugins.aribb24Superimpose=new O.CanvasRenderer({...Y,data_identifier:129});pe.attachMedia(b),pe.show()}V.on(window.mpegts.Events.TIMED_ID3_METADATA_ARRIVED,pe=>{this.plugins.aribb24Caption&&this.plugins.aribb24Caption.pushID3v2Data(pe.pts/1e3,pe.data),this.plugins.aribb24Superimpose&&this.plugins.aribb24Superimpose.pushID3v2Data(pe.pts/1e3,pe.data)})}}else this.notice("Error: mpegts.js is not supported.",void 0,void 0,"#FF6F6A");else this.notice("Error: Can't find mpegts.js.",void 0,void 0,"#FF6F6A");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){this.options.pluginOptions.flv===void 0&&(this.options.pluginOptions.flv={});const V=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:b.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=V,V.attachMediaElement(b),V.load(),this.events.on("destroy",()=>{V.unload(),V.detachMediaElement(),V.destroy(),delete this.plugins.flvjs})}else this.notice("Error: flv.js is not supported.",void 0,void 0,"#FF6F6A");else this.notice("Error: Can't find flv.js.",void 0,void 0,"#FF6F6A");break;case"dash":if(window.dashjs){const V=window.dashjs.MediaPlayer().create();V.initialize(b,b.src,!1);const Y=this.options.pluginOptions.dash;V.updateSettings(Y??{}),this.plugins.dash=V,this.events.on("destroy",()=>{V.reset(),delete this.plugins.dash})}else this.notice("Error: Can't find dash.js.",void 0,void 0,"#FF6F6A");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");const V=this.options.pluginOptions.webtorrent,Y=new window.WebTorrent(V);this.plugins.webtorrent=Y;const le=b.src;b.src="",b.preload="metadata",b.addEventListener("durationchange",()=>this.container.classList.remove("dplayer-loading"),{once:!0}),Y.add(le,pe=>{const we=pe.files.find(Ke=>Ke.name.endsWith(".mp4"));we&&we.renderTo(this.video,{autoplay:this.options.autoplay,controls:!1})}),this.events.on("destroy",()=>{Y.remove(le),Y.destroy(),delete this.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.",void 0,void 0,"#FF6F6A");else this.notice("Error: Can't find Webtorrent.",void 0,void 0,"#FF6F6A")}}initVideo(b,R){this.initMSE(b,R),this.on("durationchange",()=>{b.duration!==1&&b.duration!==1/0&&(this.template.dtime.textContent=T.secondToTime(b.duration))}),this.on("progress",()=>{const V=T.getVideoDuration(this.video,this.template),Y=b.buffered.length?b.buffered.end(b.buffered.length-1)/V:0;this.bar.set("loaded",Y,"width")}),this.on("error",()=>{this.video.error&&(this.switchingQuality&&(this.prevVideo!==null&&this.template.videoWrapAspect.removeChild(this.prevVideo),this.video.classList.add("dplayer-video-current"),this.prevVideo=null,this.switchingQuality=!1,this.events.trigger("quality_end")),this.tran&&this.notice&&this.type!=="webtorrent"&&this.notice(this.tran("Video load failed"),-1,void 0,"#FF6F6A"),this.container.classList.remove("dplayer-loading"))}),this.on("ended",()=>{this.bar.set("played",1,"width"),this.setting.loop?(this.seek(0),this.play()):this.pause(),this.danmaku&&(this.danmaku.danIndex=0)}),this.on("play",()=>{this.paused&&this.play(!0)}),this.on("pause",()=>{this.paused||this.pause(!0)}),this.on("timeupdate",()=>{const V=T.getVideoDuration(this.video,this.template);this.bar.set("played",this.video.currentTime/V,"width");const Y=T.secondToTime(this.video.currentTime);this.template.ptime.textContent!==Y&&(this.template.ptime.textContent=Y)});for(let V=0;V<this.events.videoEvents.length;V++)b.addEventListener(this.events.videoEvents[V],Y=>{this.events.trigger(this.events.videoEvents[V],Y)});this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new eu(this.template.subtitle,this.video,this.plugins,this.options.subtitle,this.events),this.user.get("subtitle")||this.subtitle.hide())}switchQuality(b){if(b=typeof b=="string"?parseInt(b):b,this.options.video.quality===void 0||this.qualityIndex===b||this.switchingQuality)return;this.qualityIndex=b,this.switchingQuality=!0,this.quality=this.options.video.quality[b];const R=this.video.paused;this.video.pause();const V=uu()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle,crossOrigin:this.options.crossOrigin}),Y=new DOMParser().parseFromString(V,"text/html").body.firstChild;this.template.videoWrapAspect.insertBefore(Y,this.template.videoWrapAspect.getElementsByTagName("div")[0]),this.prevVideoCurrentTime=this.video.currentTime,this.prevVideo=this.video,this.video=Y,this.initVideo(this.video,this.quality.type||this.options.video.type),this.options.live||this.seek(this.prevVideoCurrentTime),R||this.video.play(),this.options.lang==="ja"||this.options.lang==="ja-jp"?this.notice(`画質を ${this.quality.name} に切り替えています…`,-1):this.notice(`${this.tran("Switching to")} ${this.quality.name} ${this.tran("quality")}`,-1),this.container.classList.add("dplayer-loading"),this.events.trigger("quality_start",this.quality),this.template.qualityItem.forEach(le=>{le.classList.remove("dplayer-setting-quality-current"),parseInt(le.dataset.index)===b&&(le.classList.add("dplayer-setting-quality-current"),this.template.qualityValue.textContent=this.quality.name,this.template.settingBox.classList.remove("dplayer-setting-box-quality"))}),this.on("canplay",()=>{if(this.prevVideo!==null){if(!this.options.live&&this.video.currentTime!==this.prevVideoCurrentTime)return void this.seek(this.prevVideoCurrentTime);this.template.videoWrapAspect.removeChild(this.prevVideo),this.video.classList.add("dplayer-video-current"),R||this.video.play(),this.prevVideo=null,this.options.lang==="ja"||this.options.lang==="ja-jp"?this.notice(`画質を ${this.quality.name} に切り替えました。`,1e3):this.notice(`${this.tran("Switched to")} ${this.quality.name} ${this.tran("quality")}`),this.switchingQuality=!1;const le=parseFloat(this.template.settingBox.querySelector(".dplayer-setting-speed-current").dataset.speed);this.speed(le),this.template.settingBox.querySelector(".dplayer-setting-audio-current").dataset.audio==="secondary"&&(window.mpegts&&this.plugins.mpegts&&this.plugins.mpegts instanceof window.mpegts.MSEPlayer?this.plugins.mpegts.switchSecondaryAudio():this.plugins.liveLLHLSForKonomiTV&&this.plugins.liveLLHLSForKonomiTV.switchSecondaryAudio()),this.container.classList.remove("dplayer-loading"),this.events.trigger("quality_end")}})}notice(b,R=2e3,V=.8,Y){this.template.notice.textContent=b,this.template.notice.style.opacity=`${V}`,this.template.notice.style.color=Y&&Y!==""?Y:"",this.noticeTime&&window.clearTimeout(this.noticeTime),this.events.trigger("notice_show",b),R>0&&(this.noticeTime=window.setTimeout(()=>{this.hideNotice()},R))}hideNotice(){this.template.notice.style.opacity="0",this.events.trigger("notice_hide")}resize(){this.danmaku&&this.danmaku.resize(),this.plugins.aribb24Caption&&this.plugins.aribb24Caption.refresh(),this.plugins.aribb24Superimpose&&this.plugins.aribb24Superimpose.refresh(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}speed(b){this.video.playbackRate=b,this.template.speedItem.forEach(R=>{R.classList.remove("dplayer-setting-speed-current"),parseFloat(R.dataset.speed)===b&&(R.classList.add("dplayer-setting-speed-current"),parseFloat(R.dataset.speed)===1?this.template.speedValue.textContent=this.tran("Normal"):this.template.speedValue.textContent=`${b}`,this.template.settingBox.classList.remove("dplayer-setting-box-speed"))})}destroy(b=!1){Rn.splice(Rn.indexOf(this),1),this.pause(),document.removeEventListener("click",this.docClickFun,!0),this.container.removeEventListener("click",this.containerClickFun,!0),this.fullScreen.destroy(),this.hotkey.destroy(),this.contextmenu.destroy(),this.controller.destroy(),this.timer.destroy(),this.setting.destroy(),this.resizeObserver.disconnect(),this.video.src="",b||(this.container.innerHTML=""),this.events.trigger("destroy")}static get version(){return"1.31.3"}};console.log(`
 %c DPlayer v1.31.3 b063e0f %c http://dplayer.js.org 

`,"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");const pu=fu})(),o=o.default})())})($c);var zg=$c.exports;const qg=Rs(zg);function Kg(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Vc={exports:{}};(function(s,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(d,f,l){if(l=l||{},d=d.trim(),f=f.trim(),!f){if(!l.alwaysNormalize)return d;var h=c.parseURL(d);if(!h)throw new Error("Error trying to parse base URL.");return h.path=c.normalizePath(h.path),c.buildURLFromParts(h)}var r=c.parseURL(f);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return l.alwaysNormalize?(r.path=c.normalizePath(r.path),c.buildURLFromParts(r)):f;var u=c.parseURL(d);if(!u)throw new Error("Error trying to parse base URL.");if(!u.netLoc&&u.path&&u.path[0]!=="/"){var m=n.exec(u.path);u.netLoc=m[1],u.path=m[2]}u.netLoc&&!u.path&&(u.path="/");var p={scheme:u.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(p.netLoc=u.netLoc,r.path[0]!=="/"))if(!r.path)p.path=u.path,r.params||(p.params=u.params,r.query||(p.query=u.query));else{var _=u.path,A=_.substring(0,_.lastIndexOf("/")+1)+r.path;p.path=c.normalizePath(A)}return p.path===null&&(p.path=l.alwaysNormalize?c.normalizePath(r.path):r.path),c.buildURLFromParts(p)},parseURL:function(d){var f=i.exec(d);return f?{scheme:f[1]||"",netLoc:f[2]||"",path:f[3]||"",params:f[4]||"",query:f[5]||"",fragment:f[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(o,"");d.length!==(d=d.replace(a,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};s.exports=c})()})(Vc);var Gs=Vc.exports;function jo(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function wi(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?jo(Object(t),!0).forEach(function(i){Xg(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):jo(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function Wg(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Yg(s){var e=Wg(s,"string");return typeof e=="symbol"?e:String(e)}function Xg(s,e,t){return e=Yg(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Ei(){return Ei=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},Ei.apply(this,arguments)}const vt=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},Jg=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=Qg},Qg=Number.MAX_SAFE_INTEGER||9007199254740991;let W=function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s}({}),Lt=function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s}({}),Ve=function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.UNKNOWN="unknown",s}({});const En=function(){},ds={trace:En,debug:En,log:En,warn:En,info:En,error:En};let tr=ds;function Zg(s){const e=self.console[s];return e?e.bind(self.console,`[${s}] >`):En}function ey(s,...e){e.forEach(function(t){tr[t]=s[t]?s[t].bind(s):Zg(t)})}function ty(s,e){if(typeof console=="object"&&s===!0||typeof s=="object"){ey(s,"debug","log","info","warn","error");try{tr.log(`Debug logs enabled for "${e}" in hls.js version 1.5.1-patch.1`)}catch{tr=ds}}else tr=ds}const De=tr,iy=/^(\d+)x(\d+)$/,Ho=/(.+?)=(".*?"|.*?)(?:,|$)/g;class _i{constructor(e){typeof e=="string"&&(e=_i.parseAttrList(e)),Ei(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(n*2,n*2+2),16);return i}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=iy.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const i={},n='"';for(Ho.lastIndex=0;(t=Ho.exec(e))!==null;){let o=t[2];o.indexOf(n)===0&&o.lastIndexOf(n)===o.length-1&&(o=o.slice(1,-1));const a=t[1].trim();i[a]=o}return i}}function ny(s){return s!=="ID"&&s!=="CLASS"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function ry(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"}class jc{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const i=t.attr;for(const n in i)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==i[n]){De.warn(`DATERANGE tag attribute: "${n}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=n;break}e=Ei(new _i({}),i,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=new Date(this.attr["END-DATE"]);vt(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(vt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&vt(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class na{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Zt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Hc{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Zt.AUDIO]:null,[Zt.VIDEO]:null,[Zt.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const i=e.split("@",2);let n;i.length===1?n=(t==null?void 0:t.byteRangeEndOffset)||0:n=parseInt(i[1]),this._byteRange=[n,parseInt(i[0])+n]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Gs.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Oa extends Hc{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new na,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!vt(this.programDateTime))return null;const e=vt(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),i=t.length;if(i>1||i===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,n,o,a=!1){const{elementaryStreams:c}=this,d=c[e];if(!d){c[e]={startPTS:t,endPTS:i,startDTS:n,endDTS:o,partial:a};return}d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,i),d.startDTS=Math.min(d.startDTS,n),d.endDTS=Math.max(d.endDTS,o)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Zt.AUDIO]=null,e[Zt.VIDEO]=null,e[Zt.AUDIOVIDEO]=null}}class ay extends Hc{constructor(e,t,i,n,o){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new na,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=n;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const sy=10;class oy{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?vt(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||sy}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function $s(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function ly(s){const e=hs(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function cy(s){const e=function(i,n,o){const a=i[n];i[n]=i[o],i[o]=a};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function dy(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),n=i[i.length-1].split(",");if(n.length===2){const o=n[0]==="base64",a=n[1];o?(i.splice(-1,1),t=$s(a)):t=ly(a)}}return t}function hs(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}const Kn=typeof self<"u"?self:void 0;var mi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ui={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function zo(s){switch(s){case Ui.FAIRPLAY:return mi.FAIRPLAY;case Ui.PLAYREADY:return mi.PLAYREADY;case Ui.WIDEVINE:return mi.WIDEVINE;case Ui.CLEARKEY:return mi.CLEARKEY}}var zc={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function hy(s){if(s===zc.WIDEVINE)return mi.WIDEVINE}function qo(s){switch(s){case mi.FAIRPLAY:return Ui.FAIRPLAY;case mi.PLAYREADY:return Ui.PLAYREADY;case mi.WIDEVINE:return Ui.WIDEVINE;case mi.CLEARKEY:return Ui.CLEARKEY}}function Pa(s){const{drmSystems:e,widevineLicenseUrl:t}=s,i=e?[mi.FAIRPLAY,mi.WIDEVINE,mi.PLAYREADY,mi.CLEARKEY].filter(n=>!!e[n]):[];return!i[mi.WIDEVINE]&&t&&i.push(mi.WIDEVINE),i}const qc=function(s){return Kn!=null&&(s=Kn.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function uy(s,e,t,i){let n;switch(s){case mi.FAIRPLAY:n=["cenc","sinf"];break;case mi.WIDEVINE:case mi.PLAYREADY:n=["cenc"];break;case mi.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return fy(n,e,t,i)}function fy(s,e,t,i){return[{initDataTypes:s,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(o=>({contentType:`audio/mp4; codecs="${o}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(o=>({contentType:`video/mp4; codecs="${o}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function kn(s,e,t){return Uint8Array.prototype.slice?s.slice(e,t):new Uint8Array(Array.prototype.slice.call(s,e,t))}const Vs=(s,e)=>e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128,Kc=(s,e)=>e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128,rr=(s,e)=>{const t=e;let i=0;for(;Vs(s,e);){i+=10;const n=ra(s,e+6);i+=n,Kc(s,e+10)&&(i+=10),e+=i}if(i>0)return s.subarray(t,t+i)},ra=(s,e)=>{let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t},py=(s,e)=>Vs(s,e)&&ra(s,e+6)+10<=s.length-e,js=s=>{const e=Yc(s);for(let t=0;t<e.length;t++){const i=e[t];if(Wc(i))return Ay(i)}},Wc=s=>s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp",my=s=>{const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=ra(s,4),i=10;return{type:e,size:t,data:s.subarray(i,i+t)}},Yc=s=>{let e=0;const t=[];for(;Vs(s,e);){const i=ra(s,e+6);e+=10;const n=e+i;for(;e+8<n;){const o=my(s.subarray(e)),a=gy(o);a&&t.push(a),e+=o.size+10}Kc(s,e)&&(e+=10)}return t},gy=s=>s.type==="PRIV"?yy(s):s.type[0]==="W"?vy(s):_y(s),yy=s=>{if(s.size<2)return;const e=an(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}},_y=s=>{if(s.size<2)return;if(s.type==="TXXX"){let t=1;const i=an(s.data.subarray(t),!0);t+=i.length+1;const n=an(s.data.subarray(t));return{key:s.type,info:i,data:n}}const e=an(s.data.subarray(1));return{key:s.type,data:e}},vy=s=>{if(s.type==="WXXX"){if(s.size<2)return;let t=1;const i=an(s.data.subarray(t),!0);t+=i.length+1;const n=an(s.data.subarray(t));return{key:s.type,info:i,data:n}}const e=an(s.data);return{key:s.type,data:e}},Ay=s=>{if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}},an=(s,e=!1)=>{const t=by();if(t){const f=t.decode(s);if(e){const l=f.indexOf("\0");return l!==-1?f.substring(0,l):f}return f.replace(/\0/g,"")}const i=s.length;let n,o,a,c="",d=0;for(;d<i;){if(n=s[d++],n===0&&e)return c;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(n);break;case 12:case 13:o=s[d++],c+=String.fromCharCode((n&31)<<6|o&63);break;case 14:o=s[d++],a=s[d++],c+=String.fromCharCode((n&15)<<12|(o&63)<<6|(a&63)<<0);break}}return c};let Ba;function by(){if(!navigator.userAgent.includes("PlayStation 4"))return!Ba&&typeof self.TextDecoder<"u"&&(Ba=new self.TextDecoder("utf-8")),Ba}const en={hexDump:function(s){let e="";for(let t=0;t<s.length;t++){let i=s[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}},Fr=Math.pow(2,32)-1,Sy=[].push,Xc={video:1,audio:2,id3:3,text:4};function Ci(s){return String.fromCharCode.apply(null,s)}function Jc(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function Ot(s,e){const t=Qc(s,e);return t<0?4294967296+t:t}function Qc(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function Ma(s,e,t){s[e]=t>>24,s[e+1]=t>>16&255,s[e+2]=t>>8&255,s[e+3]=t&255}function Ey(s){const e=s.byteLength;for(let t=0;t<e;){const i=Ot(s,t);if(i>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=i>1?t+i:e}return!1}function Mt(s,e){const t=[];if(!e.length)return t;const i=s.byteLength;for(let n=0;n<i;){const o=Ot(s,n),a=Ci(s.subarray(n+4,n+8)),c=o>1?n+o:i;if(a===e[0])if(e.length===1)t.push(s.subarray(n+8,c));else{const d=Mt(s.subarray(n+8,c),e.slice(1));d.length&&Sy.apply(t,d)}n=c}return t}function xy(s){const e=[],t=s[0];let i=8;const n=Ot(s,i);i+=4;const o=0,a=0;t===0?i+=8:i+=16,i+=2;let c=s.length+a;const d=Jc(s,i);i+=2;for(let f=0;f<d;f++){let l=i;const h=Ot(s,l);l+=4;const r=h&2147483647;if((h&2147483648)>>>31===1)return De.warn("SIDX has hierarchical references (not supported)"),null;const m=Ot(s,l);l+=4,e.push({referenceSize:r,subsegmentDuration:m,info:{duration:m/n,start:c,end:c+r-1}}),c+=r,l+=4,i=l}return{earliestPresentationTime:o,timescale:n,version:t,referencesCount:d,references:e}}function Zc(s){const e=[],t=Mt(s,["moov","trak"]);for(let n=0;n<t.length;n++){const o=t[n],a=Mt(o,["tkhd"])[0];if(a){let c=a[0];const d=Ot(a,c===0?12:20),f=Mt(o,["mdia","mdhd"])[0];if(f){c=f[0];const l=Ot(f,c===0?12:20),h=Mt(o,["mdia","hdlr"])[0];if(h){const r=Ci(h.subarray(8,12)),u={soun:Zt.AUDIO,vide:Zt.VIDEO}[r];if(u){const m=Mt(o,["mdia","minf","stbl","stsd"])[0],p=Cy(m);e[d]={timescale:l,type:u},e[u]=wi({timescale:l,id:d},p)}}}}}return Mt(s,["moov","mvex","trex"]).forEach(n=>{const o=Ot(n,4),a=e[o];a&&(a.default={duration:Ot(n,12),flags:Ot(n,20)})}),e}function Cy(s){const e=s.subarray(8),t=e.subarray(86),i=Ci(e.subarray(4,8));let n=i;const o=i==="enca"||i==="encv";if(o){const c=Mt(e,[i])[0].subarray(i==="enca"?28:78);Mt(c,["sinf"]).forEach(f=>{const l=Mt(f,["schm"])[0];if(l){const h=Ci(l.subarray(4,8));if(h==="cbcs"||h==="cenc"){const r=Mt(f,["frma"])[0];r&&(n=Ci(r))}}})}switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const a=Mt(t,["avcC"])[0];n+="."+dr(a[1])+dr(a[2])+dr(a[3]);break}case"mp4a":{const a=Mt(e,[i])[0],c=Mt(a.subarray(28),["esds"])[0];if(c&&c.length>12){let d=4;if(c[d++]!==3)break;d=Fa(c,d),d+=2;const f=c[d++];if(f&128&&(d+=2),f&64&&(d+=c[d++]),c[d++]!==4)break;d=Fa(c,d);const l=c[d++];if(l===64)n+="."+dr(l);else break;if(d+=12,c[d++]!==5)break;d=Fa(c,d);const h=c[d++];let r=(h&248)>>3;r===31&&(r+=1+((h&7)<<3)+((c[d]&224)>>5)),n+="."+r}break}case"hvc1":case"hev1":{const a=Mt(t,["hvcC"])[0],c=a[1],d=["","A","B","C"][c>>6],f=c&31,l=Ot(a,2),h=(c&32)>>5?"H":"L",r=a[12],u=a.subarray(6,12);n+="."+d+f,n+="."+l.toString(16).toUpperCase(),n+="."+h+r;let m="";for(let p=u.length;p--;){const _=u[p];(_||m)&&(m="."+_.toString(16).toUpperCase()+m)}n+=m;break}case"dvh1":case"dvhe":{const a=Mt(t,["dvcC"])[0],c=a[2]>>1&127,d=a[2]<<5&32|a[3]>>3&31;n+="."+Zi(c)+"."+Zi(d);break}case"vp09":{const a=Mt(t,["vpcC"])[0],c=a[4],d=a[5],f=a[6]>>4&15;n+="."+Zi(c)+"."+Zi(d)+"."+Zi(f);break}case"av01":{const a=Mt(t,["av1C"])[0],c=a[1]>>>5,d=a[1]&31,f=a[2]>>>7?"H":"M",l=(a[2]&64)>>6,h=(a[2]&32)>>5,r=c===2&&l?h?12:10:l?10:8,u=(a[2]&16)>>4,m=(a[2]&8)>>3,p=(a[2]&4)>>2,_=a[2]&3;n+="."+c+"."+Zi(d)+f+"."+Zi(r)+"."+u+"."+m+p+_+"."+Zi(1)+"."+Zi(1)+"."+Zi(1)+"."+0;break}}return{codec:n,encrypted:o}}function Fa(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function dr(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function Zi(s){return(s<10?"0":"")+s}function wy(s,e){if(!s||!e)return s;const t=e.keyId;return t&&e.isCommonEncryption&&Mt(s,["moov","trak"]).forEach(n=>{const a=Mt(n,["mdia","minf","stbl","stsd"])[0].subarray(8);let c=Mt(a,["enca"]);const d=c.length>0;d||(c=Mt(a,["encv"])),c.forEach(f=>{const l=d?f.subarray(28):f.subarray(78);Mt(l,["sinf"]).forEach(r=>{const u=ed(r);if(u){const m=u.subarray(8,24);m.some(p=>p!==0)||(De.log(`[eme] Patching keyId in 'enc${d?"a":"v"}>sinf>>tenc' box: ${en.hexDump(m)} -> ${en.hexDump(t)}`),u.set(t,8))}})})}),s}function ed(s){const e=Mt(s,["schm"])[0];if(e){const t=Ci(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Mt(s,["schi","tenc"])[0]}return De.error("[eme] missing 'schm' box"),null}function Ty(s,e){return Mt(e,["moof","traf"]).reduce((t,i)=>{const n=Mt(i,["tfdt"])[0],o=n[0],a=Mt(i,["tfhd"]).reduce((c,d)=>{const f=Ot(d,4),l=s[f];if(l){let h=Ot(n,4);if(o===1){if(h===Fr)return De.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),c;h*=Fr+1,h+=Ot(n,8)}const r=l.timescale||9e4,u=h/r;if(vt(u)&&(c===null||u<c))return u}return c},null);return a!==null&&vt(a)&&(t===null||a<t)?a:t},null)}function ky(s,e){let t=0,i=0,n=0;const o=Mt(s,["moof","traf"]);for(let a=0;a<o.length;a++){const c=o[a],d=Mt(c,["tfhd"])[0],f=Ot(d,4),l=e[f];if(!l)continue;const h=l.default,r=Ot(d,0)|(h==null?void 0:h.flags);let u=h==null?void 0:h.duration;r&8&&(r&2?u=Ot(d,12):u=Ot(d,8));const m=l.timescale||9e4,p=Mt(c,["trun"]);for(let _=0;_<p.length;_++){if(t=Ry(p[_]),!t&&u){const A=Ot(p[_],4);t=u*A}l.type===Zt.VIDEO?i+=t/m:l.type===Zt.AUDIO&&(n+=t/m)}}if(i===0&&n===0){let a=0;const c=Mt(s,["sidx"]);for(let d=0;d<c.length;d++){const f=xy(c[d]);f!=null&&f.references&&(a+=f.references.reduce((l,h)=>l+h.info.duration||0,0))}return a}return i||n}function Ry(s){const e=Ot(s,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let i=0;const n=Ot(s,4);for(let o=0;o<n;o++){if(e&256){const a=Ot(s,t);i+=a,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return i}function Ly(s,e,t){Mt(e,["moof","traf"]).forEach(i=>{Mt(i,["tfhd"]).forEach(n=>{const o=Ot(n,4),a=s[o];if(!a)return;const c=a.timescale||9e4;Mt(i,["tfdt"]).forEach(d=>{const f=d[0],l=t*c;if(l){let h=Ot(d,4);if(f===0)h-=l,h=Math.max(h,0),Ma(d,4,h);else{h*=Math.pow(2,32),h+=Ot(d,8),h-=l,h=Math.max(h,0);const r=Math.floor(h/(Fr+1)),u=Math.floor(h%(Fr+1));Ma(d,4,r),Ma(d,8,u)}}})})})}function Iy(s){const e={valid:null,remainder:null},t=Mt(s,["moof"]);if(t.length<2)return e.remainder=s,e;const i=t[t.length-1];return e.valid=kn(s,0,i.byteOffset-8),e.remainder=kn(s,i.byteOffset-8),e}function ji(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function Ko(s,e){const t=[],i=e.samples,n=e.timescale,o=e.id;let a=!1;return Mt(i,["moof"]).map(d=>{const f=d.byteOffset-8;Mt(d,["traf"]).map(h=>{const r=Mt(h,["tfdt"]).map(u=>{const m=u[0];let p=Ot(u,4);return m===1&&(p*=Math.pow(2,32),p+=Ot(u,8)),p/n})[0];return r!==void 0&&(s=r),Mt(h,["tfhd"]).map(u=>{const m=Ot(u,4),p=Ot(u,0)&16777215,_=(p&1)!==0,A=(p&2)!==0,E=(p&8)!==0;let C=0;const k=(p&16)!==0;let O=0;const G=(p&32)!==0;let B=8;m===o&&(_&&(B+=8),A&&(B+=4),E&&(C=Ot(u,B),B+=4),k&&(O=Ot(u,B),B+=4),G&&(B+=4),e.type==="video"&&(a=Dy(e.codec)),Mt(h,["trun"]).map(T=>{const L=T[0],I=Ot(T,0)&16777215,M=(I&1)!==0;let K=0;const re=(I&4)!==0,ae=(I&256)!==0;let te=0;const ne=(I&512)!==0;let me=0;const Ae=(I&1024)!==0,F=(I&2048)!==0;let y=0;const v=Ot(T,4);let S=8;M&&(K=Ot(T,S),S+=4),re&&(S+=4);let w=K+f;for(let x=0;x<v;x++){if(ae?(te=Ot(T,S),S+=4):te=C,ne?(me=Ot(T,S),S+=4):me=O,Ae&&(S+=4),F&&(L===0?y=Ot(T,S):y=Qc(T,S),S+=4),e.type===Zt.VIDEO){let D=0;for(;D<me;){const U=Ot(i,w);if(w+=4,Oy(a,i[w])){const j=i.subarray(w,w+U);Hs(j,a?2:1,s+y/n,t)}w+=U,D+=U+4}}s+=te/n}}))})})}),t}function Dy(s){if(!s)return!1;const e=s.indexOf("."),t=e<0?s:s.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function Oy(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Hs(s,e,t,i){const n=td(s);let o=0;o+=e;let a=0,c=0,d=0;for(;o<n.length;){a=0;do{if(o>=n.length)break;d=n[o++],a+=d}while(d===255);c=0;do{if(o>=n.length)break;d=n[o++],c+=d}while(d===255);const f=n.length-o;let l=o;if(c<f)o+=c;else if(c>f){De.error(`Malformed SEI payload. ${c} is too small, only ${f} bytes left to parse.`);break}if(a===4){if(n[l++]===181){const r=Jc(n,l);if(l+=2,r===49){const u=Ot(n,l);if(l+=4,u===1195456820){const m=n[l++];if(m===3){const p=n[l++],_=31&p,A=64&p,E=A?2+_*3:0,C=new Uint8Array(E);if(A){C[0]=p;for(let k=1;k<E;k++)C[k]=n[l++]}i.push({type:m,payloadType:a,pts:t,bytes:C})}}}}}else if(a===5&&c>16){const h=[];for(let m=0;m<16;m++){const p=n[l++].toString(16);h.push(p.length==1?"0"+p:p),(m===3||m===5||m===7||m===9)&&h.push("-")}const r=c-16,u=new Uint8Array(r);for(let m=0;m<r;m++)u[m]=n[l++];i.push({payloadType:a,pts:t,uuid:h.join(""),userData:an(u),userDataBytes:u})}}}function td(s){const e=s.byteLength,t=[];let i=1;for(;i<e-2;)s[i]===0&&s[i+1]===0&&s[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return s;const n=e-t.length,o=new Uint8Array(n);let a=0;for(i=0;i<n;a++,i++)a===t[0]&&(a++,t.shift()),o[i]=s[a];return o}function Py(s){const e=s[0];let t="",i="",n=0,o=0,a=0,c=0,d=0,f=0;if(e===0){for(;Ci(s.subarray(f,f+1))!=="\0";)t+=Ci(s.subarray(f,f+1)),f+=1;for(t+=Ci(s.subarray(f,f+1)),f+=1;Ci(s.subarray(f,f+1))!=="\0";)i+=Ci(s.subarray(f,f+1)),f+=1;i+=Ci(s.subarray(f,f+1)),f+=1,n=Ot(s,12),o=Ot(s,16),c=Ot(s,20),d=Ot(s,24),f=28}else if(e===1){f+=4,n=Ot(s,f),f+=4;const h=Ot(s,f);f+=4;const r=Ot(s,f);for(f+=4,a=2**32*h+r,Jg(a)||(a=Number.MAX_SAFE_INTEGER,De.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),c=Ot(s,f),f+=4,d=Ot(s,f),f+=4;Ci(s.subarray(f,f+1))!=="\0";)t+=Ci(s.subarray(f,f+1)),f+=1;for(t+=Ci(s.subarray(f,f+1)),f+=1;Ci(s.subarray(f,f+1))!=="\0";)i+=Ci(s.subarray(f,f+1)),f+=1;i+=Ci(s.subarray(f,f+1)),f+=1}const l=s.subarray(f,s.byteLength);return{schemeIdUri:t,value:i,timeScale:n,presentationTime:a,presentationTimeDelta:o,eventDuration:c,id:d,payload:l}}function By(s,...e){const t=e.length;let i=8,n=t;for(;n--;)i+=e[n].byteLength;const o=new Uint8Array(i);for(o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=i&255,o.set(s,4),n=0,i=8;n<t;n++)o.set(e[n],i),i+=e[n].byteLength;return o}function My(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let i,n;i=0,n=new Uint8Array;let o;i>0?(o=new Uint8Array(4),e.length>0&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),By([112,115,115,104],new Uint8Array([i,0,0,0]),s,o,n,a,t||new Uint8Array)}function Fy(s){if(!(s instanceof ArrayBuffer)||s.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(s),i=t.getUint32(0);if(s.byteLength!==i&&i>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=en.hexDump(new Uint8Array(s,12,16));const o=t.getUint32(28);if(e.version===0){if(i-32<o)return null;e.data=new Uint8Array(s,32,o)}else if(e.version===1){e.kids=[];for(let a=0;a<o;a++)e.kids.push(new Uint8Array(s,32+a*16,16))}return e}let hr={};class ar{static clearKeyUriToKeyIdMap(){hr={}}constructor(e,t,i,n=[1],o=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=n,this.iv=o,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Ui.FAIRPLAY:case Ui.WIDEVINE:case Ui.PLAYREADY:case Ui.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&De.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const i=Ny(e);return new ar(this.method,this.uri,"identity",this.keyFormatVersions,i)}const t=dy(this.uri);if(t)switch(this.keyFormat){case Ui.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Ui.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=My(i,null,t);const n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),o=String.fromCharCode.apply(null,Array.from(n)),a=o.substring(o.indexOf("<"),o.length),f=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("KID")[0];if(f){const l=f.childNodes[0]?f.childNodes[0].nodeValue:f.getAttribute("VALUE");if(l){const h=$s(l).subarray(0,16);cy(h),this.keyId=h}}break}default:{let i=t.subarray(0,16);if(i.length!==16){const n=new Uint8Array(16);n.set(i,16-i.length),i=n}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i=hr[this.uri];if(!i){const n=Object.keys(hr).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,n),hr[this.uri]=i}this.keyId=i}return this}}function Ny(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const id=/\{\$([a-zA-Z0-9-_]+)\}/g;function Wo(s){return id.test(s)}function Fi(s,e,t){if(s.variableList!==null||s.hasVariableRefs)for(let i=t.length;i--;){const n=t[i],o=e[n];o&&(e[n]=us(s,o))}}function us(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(id,i=>{const n=i.substring(2,i.length-1),o=t==null?void 0:t[n];return o===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),i):o})}return e}function Yo(s,e,t){let i=s.variableList;i||(s.variableList=i={});let n,o;if("QUERYPARAM"in e){n=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(n))o=a.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${t}"`)}catch(a){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else n=e.NAME,o=e.VALUE;n in i?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):i[n]=o||""}function Uy(s,e,t){const i=e.IMPORT;if(t&&i in t){let n=s.variableList;n||(s.variableList=n={}),n[i]=t[i]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function Jn(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const Nr={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Gy(s,e){const t=Nr[e];return!!t&&!!t[s.slice(0,4)]}function Na(s,e,t=!0){return!s.split(",").some(i=>!nd(i,e,t))}function nd(s,e,t=!0){var i;const n=Jn(t);return(i=n==null?void 0:n.isTypeSupported(sr(s,e)))!=null?i:!1}function sr(s,e){return`${e}/mp4;codecs="${s}"`}function Xo(s){if(s){const e=s.substring(0,4);return Nr.video[e]}return 2}function Ur(s){return s.split(",").reduce((e,t)=>{const i=Nr.video[t];return i?(i*2+e)/(e?3:2):(Nr.audio[t]+e)/(e?2:1)},0)}const Ua={};function $y(s,e=!0){if(Ua[s])return Ua[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[s];for(let i=0;i<t.length;i++)if(nd(t[i],"audio",e))return Ua[s]=t[i],t[i];return s}const Vy=/flac|opus/i;function Gr(s,e=!0){return s.replace(Vy,t=>$y(t.toLowerCase(),e))}function Jo(s,e){return s&&s!=="mp4a"?s:e}function jy(s){const e=s.split(".");if(e.length>2){let t=e.shift()+".";return t+=parseInt(e.shift()).toString(16),t+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t}return s}const Qo=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Zo=/#EXT-X-MEDIA:(.*)/g,Hy=/^#EXT(?:INF|-X-TARGETDURATION):/m,el=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),zy=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class nn{static findGroup(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n.id===t)return n}}static resolve(e,t){return Gs.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Hy.test(e)}static parseMasterPlaylist(e,t){const i=Wo(e),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},o=[];Qo.lastIndex=0;let a;for(;(a=Qo.exec(e))!=null;)if(a[1]){var c;const f=new _i(a[1]);Fi(n,f,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const l=us(n,a[2]),h={attrs:f,bitrate:f.decimalInteger("BANDWIDTH")||f.decimalInteger("AVERAGE-BANDWIDTH"),name:f.NAME,url:nn.resolve(l,t)},r=f.decimalResolution("RESOLUTION");r&&(h.width=r.width,h.height=r.height),qy(f.CODECS,h),(c=h.unknownCodecs)!=null&&c.length||o.push(h),n.levels.push(h)}else if(a[3]){const f=a[3],l=a[4];switch(f){case"SESSION-DATA":{const h=new _i(l);Fi(n,h,["DATA-ID","LANGUAGE","VALUE","URI"]);const r=h["DATA-ID"];r&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[r]=h);break}case"SESSION-KEY":{const h=tl(l,t,n);h.encrypted&&h.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(h)):De.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${l}"`);break}case"DEFINE":{{const h=new _i(l);Fi(n,h,["NAME","VALUE","QUERYPARAM"]),Yo(n,h,t)}break}case"CONTENT-STEERING":{const h=new _i(l);Fi(n,h,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:nn.resolve(h["SERVER-URI"],t),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=il(l);break}}}const d=o.length>0&&o.length<n.levels.length;return n.levels=d?o:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,i){let n;const o={},a=i.levels,c={AUDIO:a.map(f=>({id:f.attrs.AUDIO,audioCodec:f.audioCodec})),SUBTITLES:a.map(f=>({id:f.attrs.SUBTITLES,textCodec:f.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(Zo.lastIndex=0;(n=Zo.exec(e))!==null;){const f=new _i(n[1]),l=f.TYPE;if(l){const h=c[l],r=o[l]||[];o[l]=r,Fi(i,f,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const u=f.LANGUAGE,m=f["ASSOC-LANGUAGE"],p=f.CHANNELS,_=f.CHARACTERISTICS,A=f["INSTREAM-ID"],E={attrs:f,bitrate:0,id:d++,groupId:f["GROUP-ID"]||"",name:f.NAME||u||"",type:l,default:f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:u,url:f.URI?nn.resolve(f.URI,t):""};if(m&&(E.assocLang=m),p&&(E.channels=p),_&&(E.characteristics=_),A&&(E.instreamId=A),h!=null&&h.length){const C=nn.findGroup(h,E.groupId)||h[0];nl(E,C,"audioCodec"),nl(E,C,"textCodec")}r.push(E)}}return o}static parseLevelPlaylist(e,t,i,n,o,a){const c=new oy(t),d=c.fragments;let f=null,l=0,h=0,r=0,u=0,m=null,p=new Oa(n,t),_,A,E,C=-1,k=!1,O=null;for(el.lastIndex=0,c.m3u8=e,c.hasVariableRefs=Wo(e);(_=el.exec(e))!==null;){k&&(k=!1,p=new Oa(n,t),p.start=r,p.sn=l,p.cc=u,p.level=i,f&&(p.initSegment=f,p.rawProgramDateTime=f.rawProgramDateTime,f.rawProgramDateTime=null,O&&(p.setByteRange(O),O=null)));const L=_[1];if(L){p.duration=parseFloat(L);const I=(" "+_[2]).slice(1);p.title=I||null,p.tagList.push(I?["INF",L,I]:["INF",L])}else if(_[3]){if(vt(p.duration)){p.start=r,E&&sl(p,E,c),p.sn=l,p.level=i,p.cc=u,d.push(p);const I=(" "+_[3]).slice(1);p.relurl=us(c,I),rl(p,m),m=p,r+=p.duration,l++,h=0,k=!0}}else if(_[4]){const I=(" "+_[4]).slice(1);m?p.setByteRange(I,m):p.setByteRange(I)}else if(_[5])p.rawProgramDateTime=(" "+_[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),C===-1&&(C=d.length);else{if(_=_[0].match(zy),!_){De.warn("No matches on slow regex match for level playlist!");continue}for(A=1;A<_.length&&!(typeof _[A]<"u");A++);const I=(" "+_[A]).slice(1),M=(" "+_[A+1]).slice(1),K=_[A+2]?(" "+_[A+2]).slice(1):"";switch(I){case"PLAYLIST-TYPE":c.type=M.toUpperCase();break;case"MEDIA-SEQUENCE":l=c.startSN=parseInt(M);break;case"SKIP":{const re=new _i(M);Fi(c,re,["RECENTLY-REMOVED-DATERANGES"]);const ae=re.decimalInteger("SKIPPED-SEGMENTS");if(vt(ae)){c.skippedSegments=ae;for(let ne=ae;ne--;)d.unshift(null);l+=ae}const te=re.enumeratedString("RECENTLY-REMOVED-DATERANGES");te&&(c.recentlyRemovedDateranges=te.split("	"));break}case"TARGETDURATION":c.targetduration=Math.max(parseInt(M),1);break;case"VERSION":c.version=parseInt(M);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(M||K)&&p.tagList.push(K?[M,K]:[M]);break;case"DISCONTINUITY":u++,p.tagList.push(["DIS"]);break;case"GAP":p.gap=!0,p.tagList.push([I]);break;case"BITRATE":p.tagList.push([I,M]);break;case"DATERANGE":{const re=new _i(M);Fi(c,re,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Fi(c,re,re.clientAttrs);const ae=new jc(re,c.dateRanges[re.ID]);ae.isValid||c.skippedSegments?c.dateRanges[ae.id]=ae:De.warn(`Ignoring invalid DATERANGE tag: "${M}"`),p.tagList.push(["EXT-X-DATERANGE",M]);break}case"DEFINE":{{const re=new _i(M);Fi(c,re,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in re?Uy(c,re,a):Yo(c,re,t)}break}case"DISCONTINUITY-SEQUENCE":u=parseInt(M);break;case"KEY":{const re=tl(M,t,c);if(re.isSupported()){if(re.method==="NONE"){E=void 0;break}E||(E={}),E[re.keyFormat]&&(E=Ei({},E)),E[re.keyFormat]=re}else De.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${M}"`);break}case"START":c.startTimeOffset=il(M);break;case"MAP":{const re=new _i(M);if(Fi(c,re,["BYTERANGE","URI"]),p.duration){const ae=new Oa(n,t);al(ae,re,i,E),f=ae,p.initSegment=f,f.rawProgramDateTime&&!p.rawProgramDateTime&&(p.rawProgramDateTime=f.rawProgramDateTime)}else{const ae=p.byteRangeEndOffset;if(ae){const te=p.byteRangeStartOffset;O=`${ae-te}@${te}`}else O=null;al(p,re,i,E),f=p,k=!0}break}case"SERVER-CONTROL":{const re=new _i(M);c.canBlockReload=re.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=re.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&re.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=re.optionalFloat("PART-HOLD-BACK",0),c.holdBack=re.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const re=new _i(M);c.partTarget=re.decimalFloatingPoint("PART-TARGET");break}case"PART":{let re=c.partList;re||(re=c.partList=[]);const ae=h>0?re[re.length-1]:void 0,te=h++,ne=new _i(M);Fi(c,ne,["BYTERANGE","URI"]);const me=new ay(ne,p,t,te,ae);re.push(me),p.duration+=me.duration;break}case"PRELOAD-HINT":{const re=new _i(M);Fi(c,re,["URI"]),c.preloadHint=re;break}case"RENDITION-REPORT":{const re=new _i(M);Fi(c,re,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push(re);break}default:De.warn(`line parsed but not handled: ${_}`);break}}}m&&!m.relurl?(d.pop(),r-=m.duration,c.partList&&(c.fragmentHint=m)):c.partList&&(rl(p,m),p.cc=u,c.fragmentHint=p,E&&sl(p,E,c));const G=d.length,B=d[0],T=d[G-1];if(r+=c.skippedSegments*c.targetduration,r>0&&G&&T){c.averagetargetduration=r/G;const L=T.sn;c.endSN=L!=="initSegment"?L:0,c.live||(T.endList=!0),B&&(c.startCC=B.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(r+=c.fragmentHint.duration),c.totalduration=r,c.endCC=u,C>0&&Ky(d,C),c}}function tl(s,e,t){var i,n;const o=new _i(s);Fi(t,o,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=(i=o.METHOD)!=null?i:"",c=o.URI,d=o.hexadecimalInteger("IV"),f=o.KEYFORMATVERSIONS,l=(n=o.KEYFORMAT)!=null?n:"identity";c&&o.IV&&!d&&De.error(`Invalid IV: ${o.IV}`);const h=c?nn.resolve(c,e):"",r=(f||"1").split("/").map(Number).filter(Number.isFinite);return new ar(a,h,l,r,d)}function il(s){const t=new _i(s).decimalFloatingPoint("TIME-OFFSET");return vt(t)?t:null}function qy(s,e){let t=(s||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const n=t.filter(o=>Gy(o,i));n.length&&(e[`${i}Codec`]=n.join(","),t=t.filter(o=>n.indexOf(o)===-1))}),e.unknownCodecs=t}function nl(s,e,t){const i=e[t];i&&(s[t]=i)}function Ky(s,e){let t=s[e];for(let i=e;i--;){const n=s[i];if(!n)return;n.programDateTime=t.programDateTime-n.duration*1e3,t=n}}function rl(s,e){s.rawProgramDateTime?s.programDateTime=Date.parse(s.rawProgramDateTime):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime),vt(s.programDateTime)||(s.programDateTime=null,s.rawProgramDateTime=null)}function al(s,e,t,i){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",i&&(s.levelkeys=i),s.initSegment=null}function sl(s,e,t){s.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(n=>e[n].isCommonEncryption)&&i.push(s)}var Kt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Rt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function ol(s){const{type:e}=s;switch(e){case Kt.AUDIO_TRACK:return Rt.AUDIO;case Kt.SUBTITLE_TRACK:return Rt.SUBTITLE;default:return Rt.MAIN}}function Ga(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Wy{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(W.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_LOADING,this.onLevelLoading,this),e.off(W.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(W.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,n=t.loader,o=i||n,a=new o(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Kt.MANIFEST,url:i,deliveryDirectives:null})}onLevelLoading(e,t){const{id:i,level:n,pathwayId:o,url:a,deliveryDirectives:c}=t;this.load({id:i,level:n,pathwayId:o,responseType:"text",type:Kt.LEVEL,url:a,deliveryDirectives:c})}onAudioTrackLoading(e,t){const{id:i,groupId:n,url:o,deliveryDirectives:a}=t;this.load({id:i,groupId:n,level:null,responseType:"text",type:Kt.AUDIO_TRACK,url:o,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){const{id:i,groupId:n,url:o,deliveryDirectives:a}=t;this.load({id:i,groupId:n,level:null,responseType:"text",type:Kt.SUBTITLE_TRACK,url:o,deliveryDirectives:a})}load(e){var t;const i=this.hls.config;let n=this.getInternalLoader(e);if(n){const f=n.context;if(f&&f.url===e.url&&f.level===e.level){De.trace("[playlist-loader]: playlist request ongoing");return}De.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}let o;if(e.type===Kt.MANIFEST?o=i.manifestLoadPolicy.default:o=Ei({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),vt((t=e.deliveryDirectives)==null?void 0:t.part)){let f;if(e.type===Kt.LEVEL&&e.level!==null?f=this.hls.levels[e.level].details:e.type===Kt.AUDIO_TRACK&&e.id!==null?f=this.hls.audioTracks[e.id].details:e.type===Kt.SUBTITLE_TRACK&&e.id!==null&&(f=this.hls.subtitleTracks[e.id].details),f){const l=f.partTarget,h=f.targetduration;if(l&&h){const r=Math.max(l*3,h*.8)*1e3;o=Ei({},o,{maxTimeToFirstByteMs:Math.min(r,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(r,o.maxTimeToFirstByteMs)})}}}const a=o.errorRetry||o.timeoutRetry||{},c={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},d={onSuccess:(f,l,h,r)=>{const u=this.getInternalLoader(h);this.resetInternalLoader(h.type);const m=f.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(f,h,new Error("no EXTM3U delimiter"),r||null,l);return}l.parsing.start=performance.now(),nn.isMediaPlaylist(m)?this.handleTrackOrLevelPlaylist(f,l,h,r||null,u):this.handleMasterPlaylist(f,l,h,r)},onError:(f,l,h,r)=>{this.handleNetworkError(l,h,!1,f,r)},onTimeout:(f,l,h)=>{this.handleNetworkError(l,h,!0,void 0,f)}};n.load(e,c,d)}handleMasterPlaylist(e,t,i,n){const o=this.hls,a=e.data,c=Ga(e,i),d=nn.parseMasterPlaylist(a,c);if(d.playlistParsingError){this.handleManifestParsingError(e,i,d.playlistParsingError,n,t);return}const{contentSteering:f,levels:l,sessionData:h,sessionKeys:r,startTimeOffset:u,variableList:m}=d;this.variableList=m;const{AUDIO:p=[],SUBTITLES:_,"CLOSED-CAPTIONS":A}=nn.parseMasterPlaylistMedia(a,c,d);p.length&&!p.some(C=>!C.url)&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(De.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new _i({}),bitrate:0,url:""})),o.trigger(W.MANIFEST_LOADED,{levels:l,audioTracks:p,subtitles:_,captions:A,contentSteering:f,url:c,stats:t,networkDetails:n,sessionData:h,sessionKeys:r,startTimeOffset:u,variableList:m})}handleTrackOrLevelPlaylist(e,t,i,n,o){const a=this.hls,{id:c,level:d,type:f}=i,l=Ga(e,i),h=0,r=vt(d)?d:vt(c)?c:0,u=ol(i),m=nn.parseLevelPlaylist(e.data,l,r,u,h,this.variableList);if(f===Kt.MANIFEST){const p={attrs:new _i({}),bitrate:0,details:m,name:"",url:l};a.trigger(W.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:l,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=m,this.handlePlaylistLoaded(m,e,t,i,n,o)}handleManifestParsingError(e,t,i,n,o){this.hls.trigger(W.ERROR,{type:Lt.NETWORK_ERROR,details:Ve.MANIFEST_PARSING_ERROR,fatal:t.type===Kt.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:n,stats:o})}handleNetworkError(e,t,i=!1,n,o){let a=`A network ${i?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===Kt.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===Kt.AUDIO_TRACK||e.type===Kt.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const c=new Error(a);De.warn(`[playlist-loader]: ${a}`);let d=Ve.UNKNOWN,f=!1;const l=this.getInternalLoader(e);switch(e.type){case Kt.MANIFEST:d=i?Ve.MANIFEST_LOAD_TIMEOUT:Ve.MANIFEST_LOAD_ERROR,f=!0;break;case Kt.LEVEL:d=i?Ve.LEVEL_LOAD_TIMEOUT:Ve.LEVEL_LOAD_ERROR,f=!1;break;case Kt.AUDIO_TRACK:d=i?Ve.AUDIO_TRACK_LOAD_TIMEOUT:Ve.AUDIO_TRACK_LOAD_ERROR,f=!1;break;case Kt.SUBTITLE_TRACK:d=i?Ve.SUBTITLE_TRACK_LOAD_TIMEOUT:Ve.SUBTITLE_LOAD_ERROR,f=!1;break}l&&this.resetInternalLoader(e.type);const h={type:Lt.NETWORK_ERROR,details:d,fatal:f,url:e.url,loader:l,context:e,error:c,networkDetails:t,stats:o};if(n){const r=(t==null?void 0:t.url)||e.url;h.response=wi({url:r,data:void 0},n)}this.hls.trigger(W.ERROR,h)}handlePlaylistLoaded(e,t,i,n,o,a){const c=this.hls,{type:d,level:f,id:l,groupId:h,deliveryDirectives:r}=n,u=Ga(t,n),m=ol(n),p=typeof n.level=="number"&&m===Rt.MAIN?f:void 0;if(!e.fragments.length){const A=new Error("No Segments found in Playlist");c.trigger(W.ERROR,{type:Lt.NETWORK_ERROR,details:Ve.LEVEL_EMPTY_ERROR,fatal:!1,url:u,error:A,reason:A.message,response:t,context:n,level:p,parent:m,networkDetails:o,stats:i});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const _=e.playlistParsingError;if(_){c.trigger(W.ERROR,{type:Lt.NETWORK_ERROR,details:Ve.LEVEL_PARSING_ERROR,fatal:!1,url:u,error:_,reason:_.message,response:t,context:n,level:p,parent:m,networkDetails:o,stats:i});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case Kt.MANIFEST:case Kt.LEVEL:c.trigger(W.LEVEL_LOADED,{details:e,level:p||0,id:l||0,stats:i,networkDetails:o,deliveryDirectives:r});break;case Kt.AUDIO_TRACK:c.trigger(W.AUDIO_TRACK_LOADED,{details:e,id:l||0,groupId:h||"",stats:i,networkDetails:o,deliveryDirectives:r});break;case Kt.SUBTITLE_TRACK:c.trigger(W.SUBTITLE_TRACK_LOADED,{details:e,id:l||0,groupId:h||"",stats:i,networkDetails:o,deliveryDirectives:r});break}}}function rd(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function ad(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){De.debug(`[texttrack-utils]: ${i}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,s.addCue(n)}catch(n){De.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}t==="disabled"&&(s.mode=t)}function Gn(s){const e=s.mode;if(e==="disabled"&&(s.mode="hidden"),s.cues)for(let t=s.cues.length;t--;)s.removeCue(s.cues[t]);e==="disabled"&&(s.mode=e)}function fs(s,e,t,i){const n=s.mode;if(n==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const o=Xy(s.cues,e,t);for(let a=0;a<o.length;a++)(!i||i(o[a]))&&s.removeCue(o[a])}n==="disabled"&&(s.mode=n)}function Yy(s,e){if(e<s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let i=0,n=t;for(;i<=n;){const o=Math.floor((n+i)/2);if(e<s[o].startTime)n=o-1;else if(e>s[o].startTime&&i<t)i=o+1;else return o}return s[i].startTime-e<e-s[n].startTime?i:n}function Xy(s,e,t){const i=[],n=Yy(s,e);if(n>-1)for(let o=n,a=s.length;o<a;o++){const c=s[o];if(c.startTime>=e&&c.endTime<=t)i.push(c);else if(c.startTime>t)return i}return i}function Cr(s){const e=[];for(let t=0;t<s.length;t++){const i=s[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(s[t])}return e}var Wi={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Jy=.25;function ps(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function ll(s,e,t,i,n){let o=new s(e,t,"");try{o.value=i,n&&(o.type=n)}catch{o=new s(e,t,JSON.stringify(n?wi({type:n},i):i))}return o}const ur=(()=>{const s=ps();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function $a(s,e){return s.getTime()/1e3-e}function Qy(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Zy{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Gn(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return rd(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:n}}}=this;if(!i&&!n)return;const{samples:o}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=ps();if(a)for(let c=0;c<o.length;c++){const d=o[c].type;if(d===Wi.emsg&&!i||!n)continue;const f=Yc(o[c].data);if(f){const l=o[c].pts;let h=l+o[c].duration;h>ur&&(h=ur),h-l<=0&&(h=l+Jy);for(let u=0;u<f.length;u++){const m=f[u];if(!Wc(m)){this.updateId3CueEnds(l,d);const p=ll(a,l,h,m,d);p&&this.id3Track.addCue(p)}}}}}updateId3CueEnds(e,t){var i;const n=(i=this.id3Track)==null?void 0:i.cues;if(n)for(let o=n.length;o--;){const a=n[o];a.type===t&&a.startTime<e&&a.endTime===ur&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:n}){const{id3Track:o,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:d}}=a;if(o&&(c||d)){let f;n==="audio"?f=l=>l.type===Wi.audioId3&&d:n==="video"?f=l=>l.type===Wi.emsg&&c:f=l=>l.type===Wi.audioId3&&d||l.type===Wi.emsg&&c,fs(o,t,i,f)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:n}=this,{dateRanges:o}=t,a=Object.keys(o);if(n){const l=Object.keys(i).filter(h=>!a.includes(h));for(let h=l.length;h--;){const r=l[h];Object.keys(i[r].cues).forEach(u=>{n.removeCue(i[r].cues[u])}),delete i[r]}}const c=t.fragments[t.fragments.length-1];if(a.length===0||!vt(c==null?void 0:c.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=c.programDateTime/1e3-c.start,f=ps();for(let l=0;l<a.length;l++){const h=a[l],r=o[h],u=$a(r.startDate,d),m=i[h],p=(m==null?void 0:m.cues)||{};let _=(m==null?void 0:m.durationKnown)||!1,A=ur;const E=r.endDate;if(E)A=$a(E,d),_=!0;else if(r.endOnNext&&!_){const k=a.reduce((O,G)=>{if(G!==r.id){const B=o[G];if(B.class===r.class&&B.startDate>r.startDate&&(!O||r.startDate<O.startDate))return B}return O},null);k&&(A=$a(k.startDate,d),_=!0)}const C=Object.keys(r.attr);for(let k=0;k<C.length;k++){const O=C[k];if(!ny(O))continue;const G=p[O];if(G)_&&!m.durationKnown&&(G.endTime=A);else if(f){let B=r.attr[O];ry(O)&&(B=Qy(B));const T=ll(f,u,A,{key:O,data:B},Wi.dateRange);T&&(T.id=h,this.id3Track.addCue(T),p[O]=T)}}i[h]={cues:p,dateRange:r,durationKnown:_}}}}class e_{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:i,targetduration:n}=e,{liveSyncDuration:o,liveSyncDurationCount:a,lowLatencyMode:c}=this.config,d=this.hls.userConfig;let f=c&&i||t;(d.liveSyncDuration||d.liveSyncDurationCount||f===0)&&(f=o!==void 0?o:a*n);const l=n;return f+Math.min(this.stallCount*1,l)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(e===null||t===null||i===null)return null;const n=i.edge,o=e-t-this.edgeStalled,a=n-i.totalduration,c=n-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,o),c)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(W.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(W.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(W.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(W.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var i;t.details===Ve.BUFFER_STALLED_ERROR&&(this.stallCount++,(i=this.levelDetails)!=null&&i.live&&De.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const i=this.computeLatency();if(i===null)return;this._latency=i;const{lowLatencyMode:n,maxLiveSyncPlaybackRate:o}=this.config;if(!n||o===1||!t.live)return;const a=this.targetLatency;if(a===null)return;const c=i-a,d=Math.min(this.maxLatency,a+t.targetduration);if(c<d&&c>.05&&this.forwardBufferLength>1){const l=Math.min(2,Math.max(1,o)),h=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;e.playbackRate=Math.min(l,Math.max(1,h))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const ms=["NONE","TYPE-0","TYPE-1",null];function t_(s){return ms.indexOf(s)>-1}const $r=["SDR","PQ","HLG"];function i_(s){return!!s&&$r.indexOf(s)>-1}var ir={No:"",Yes:"YES",v2:"v2"};function n_(s,e){const{canSkipUntil:t,canSkipDateRanges:i,endSN:n}=s,o=e!==void 0?e-n:0;return t&&o<t?i?ir.v2:ir.Yes:ir.No}class cl{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Wn{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return dl(this._audioGroups,e)}hasSubtitleGroup(e){return dl(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(t)===-1&&i.push(t)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(t)===-1&&i.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function dl(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function Va(s,e){const t=e.startPTS;if(vt(t)){let i=0,n;e.sn>s.sn?(i=t-s.start,n=s):(i=s.start-t,n=e),n.duration!==i&&(n.duration=i)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.start=s.start+(s.minEndPTS-s.start):e.start=s.start+s.duration:e.start=Math.max(s.start-e.duration,0)}function sd(s,e,t,i,n,o){i-t<=0&&(De.warn("Fragment should have a positive duration",e),i=t+e.duration,o=n+e.duration);let c=t,d=i;const f=e.startPTS,l=e.endPTS;if(vt(f)){const _=Math.abs(f-t);vt(e.deltaPTS)?e.deltaPTS=Math.max(_,e.deltaPTS):e.deltaPTS=_,c=Math.max(t,f),t=Math.min(t,f),n=Math.min(n,e.startDTS),d=Math.min(i,l),i=Math.max(i,l),o=Math.max(o,e.endDTS)}const h=t-e.start;e.start!==0&&(e.start=t),e.duration=i-e.start,e.startPTS=t,e.maxStartPTS=c,e.startDTS=n,e.endPTS=i,e.minEndPTS=d,e.endDTS=o;const r=e.sn;if(!s||r<s.startSN||r>s.endSN)return 0;let u;const m=r-s.startSN,p=s.fragments;for(p[m]=e,u=m;u>0;u--)Va(p[u],p[u-1]);for(u=m;u<p.length-1;u++)Va(p[u],p[u+1]);return s.fragmentHint&&Va(p[p.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,h}function r_(s,e){let t=null;const i=s.fragments;for(let d=i.length-1;d>=0;d--){const f=i[d].initSegment;if(f){t=f;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let n=0,o;if(o_(s,e,(d,f)=>{d.relurl&&(n=d.cc-f.cc),vt(d.startPTS)&&vt(d.endPTS)&&(f.start=f.startPTS=d.startPTS,f.startDTS=d.startDTS,f.maxStartPTS=d.maxStartPTS,f.endPTS=d.endPTS,f.endDTS=d.endDTS,f.minEndPTS=d.minEndPTS,f.duration=d.endPTS-d.startPTS,f.duration&&(o=f),e.PTSKnown=e.alignedSliding=!0),f.elementaryStreams=d.elementaryStreams,f.loader=d.loader,f.stats=d.stats,d.initSegment&&(f.initSegment=d.initSegment,t=d.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(f=>{var l;f&&(!f.initSegment||f.initSegment.relurl===((l=t)==null?void 0:l.relurl))&&(f.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(d=>!d),e.deltaUpdateFailed){De.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let d=e.skippedSegments;d--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=a_(s.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const a=e.fragments;if(n){De.warn("discontinuity sliding from playlist, take drift into account");for(let d=0;d<a.length;d++)a[d].cc+=n}e.skippedSegments&&(e.startCC=e.fragments[0].cc),s_(s.partList,e.partList,(d,f)=>{f.elementaryStreams=d.elementaryStreams,f.stats=d.stats}),o?sd(e,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS):od(s,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const d=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=d),e.driftEndTime=c,e.driftEnd=d}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime}function a_(s,e,t){const i=Ei({},s);return t&&t.forEach(n=>{delete i[n]}),Object.keys(e).forEach(n=>{const o=new jc(e[n].attr,i[n]);o.isValid?i[n]=o:De.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[n].attr)}"`)}),i}function s_(s,e,t){if(s&&e){let i=0;for(let n=0,o=s.length;n<=o;n++){const a=s[n],c=e[n+i];a&&c&&a.index===c.index&&a.fragment.sn===c.fragment.sn?t(a,c):i--}}}function o_(s,e,t){const i=e.skippedSegments,n=Math.max(s.startSN,e.startSN)-e.startSN,o=(s.fragmentHint?1:0)+(i?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,a=e.startSN-s.startSN,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let f=n;f<=o;f++){const l=d[a+f];let h=c[f];i&&!h&&f<i&&(h=e.fragments[f]=l),l&&h&&t(l,h)}}function od(s,e){const t=e.startSN+e.skippedSegments-s.startSN,i=s.fragments;t<0||t>=i.length||gs(e,i[t].start)}function gs(s,e){if(e){const t=s.fragments;for(let i=s.skippedSegments;i<t.length;i++)t[i].start+=e;s.fragmentHint&&(s.fragmentHint.start+=e)}}function l_(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const i=s.fragments;if(i.length&&t*4>e){const o=i[i.length-1].duration*1e3;o<t&&(t=o)}}else t/=2;return Math.round(t)}function c_(s,e,t){if(!(s!=null&&s.details))return null;const i=s.details;let n=i.fragments[e-i.startSN];return n||(n=i.fragmentHint,n&&n.sn===e)?n:e<i.startSN&&t&&t.sn===e?t:null}function hl(s,e,t){var i;return s!=null&&s.details?ld((i=s.details)==null?void 0:i.partList,e,t):null}function ld(s,e,t){if(s)for(let i=s.length;i--;){const n=s[i];if(n.index===t&&n.fragment.sn===e)return n}return null}function cd(s){s.forEach((e,t)=>{const{details:i}=e;i!=null&&i.fragments&&i.fragments.forEach(n=>{n.level=t})})}function Vr(s){switch(s.details){case Ve.FRAG_LOAD_TIMEOUT:case Ve.KEY_LOAD_TIMEOUT:case Ve.LEVEL_LOAD_TIMEOUT:case Ve.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ul(s,e){const t=Vr(e);return s.default[`${t?"timeout":"error"}Retry`]}function zs(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function fl(s){return wi(wi({},s),{errorRetry:null,timeoutRetry:null})}function jr(s,e,t,i){if(!s)return!1;const n=i==null?void 0:i.code,o=e<s.maxNumRetry&&(d_(n)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,i,o):o}function d_(s){return s===0&&navigator.onLine===!1||!!s&&(s<400||s>499)}const dd={search:function(s,e){let t=0,i=s.length-1,n=null,o=null;for(;t<=i;){n=(t+i)/2|0,o=s[n];const a=e(o);if(a>0)t=n+1;else if(a<0)i=n-1;else return o}return null}};function h_(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!vt(e))return null;const i=s[0].programDateTime;if(e<(i||0))return null;const n=s[s.length-1].endProgramDateTime;if(e>=(n||0))return null;t=t||0;for(let o=0;o<s.length;++o){const a=s[o];if(u_(e,t,a))return a}return null}function Hr(s,e,t=0,i=0){let n=null;if(s){n=e[s.sn-e[0].sn+1]||null;const a=s.endDTS-t;a>0&&a<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(n=e[0]);if(n&&(!s||s.level===n.level)&&ys(t,i,n)===0)return n;const o=dd.search(e,ys.bind(null,t,i));return o&&(o!==s||!n)?o:n}function ys(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=s?1:t.start-i>s&&t.start?-1:0}function u_(s,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>s}function f_(s,e){return dd.search(s,t=>t.cc<e?1:t.cc>e?-1:0)}var Ii={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},qi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class p_{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=De.log.bind(De,"[info]:"),this.warn=De.warn.bind(De,"[warning]:"),this.error=De.error.bind(De,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(W.ERROR,this.onError,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(W.ERROR,this.onError,this),e.off(W.ERROR,this.onErrorOut,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Rt.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i,n;if(t.fatal)return;const o=this.hls,a=t.context;switch(t.details){case Ve.FRAG_LOAD_ERROR:case Ve.FRAG_LOAD_TIMEOUT:case Ve.KEY_LOAD_ERROR:case Ve.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Ve.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction={action:Ii.DoNothing,flags:qi.None};return}case Ve.FRAG_GAP:case Ve.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ii.SendAlternateToPenaltyBox;return}case Ve.LEVEL_EMPTY_ERROR:case Ve.LEVEL_PARSING_ERROR:{var c,d;const f=t.parent===Rt.MAIN?t.level:o.loadLevel;t.details===Ve.LEVEL_EMPTY_ERROR&&((c=t.context)!=null&&(d=c.levelDetails)!=null&&d.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case Ve.LEVEL_LOAD_ERROR:case Ve.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case Ve.AUDIO_TRACK_LOAD_ERROR:case Ve.AUDIO_TRACK_LOAD_TIMEOUT:case Ve.SUBTITLE_LOAD_ERROR:case Ve.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const f=o.levels[o.loadLevel];if(f&&(a.type===Kt.AUDIO_TRACK&&f.hasAudioGroup(a.groupId)||a.type===Kt.SUBTITLE_TRACK&&f.hasSubtitleGroup(a.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.loadLevel),t.errorAction.action=Ii.SendAlternateToPenaltyBox,t.errorAction.flags=qi.MoveAllAlternatesMatchingHost;return}}return;case Ve.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const f=o.levels[o.loadLevel],l=f==null?void 0:f.attrs["HDCP-LEVEL"];l?t.errorAction={action:Ii.SendAlternateToPenaltyBox,flags:qi.MoveAllAlternatesMatchingHDCP,hdcpLevel:l}:this.keySystemError(t)}return;case Ve.BUFFER_ADD_CODEC_ERROR:case Ve.REMUX_ALLOC_ERROR:case Ve.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(n=t.level)!=null?n:o.loadLevel);return;case Ve.INTERNAL_EXCEPTION:case Ve.BUFFER_APPENDING_ERROR:case Ve.BUFFER_FULL_ERROR:case Ve.LEVEL_SWITCH_ERROR:case Ve.BUFFER_STALLED_ERROR:case Ve.BUFFER_SEEK_OVER_HOLE:case Ve.BUFFER_NUDGE_ON_STALL:t.errorAction={action:Ii.DoNothing,flags:qi.None};return}t.type===Lt.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const i=this.hls,n=ul(i.config.playlistLoadPolicy,e),o=this.playlistError++;if(jr(n,o,Vr(e),e.response))return{action:Ii.RetryRequest,flags:qi.None,retryConfig:n,retryCount:o};const c=this.getLevelSwitchAction(e,t);return n&&(c.retryConfig=n,c.retryCount=o),c}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),n=t.levels[i],{fragLoadPolicy:o,keyLoadPolicy:a}=t.config,c=ul(e.details.startsWith("key")?a:o,e),d=t.levels.reduce((l,h)=>l+h.fragmentError,0);if(n&&(e.details!==Ve.FRAG_GAP&&n.fragmentError++,jr(c,d,Vr(e),e.response)))return{action:Ii.RetryRequest,flags:qi.None,retryConfig:c,retryCount:d};const f=this.getLevelSwitchAction(e,i);return c&&(f.retryConfig=c,f.retryCount=d),f}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const n=this.hls.levels[t];if(n){var o,a;const f=e.details;n.loadError++,f===Ve.BUFFER_APPEND_ERROR&&n.fragmentError++;let l=-1;const{levels:h,loadLevel:r,minAutoLevel:u,maxAutoLevel:m}=i;i.autoLevelEnabled||(i.loadLevel=-1);const p=(o=e.frag)==null?void 0:o.type,A=(p===Rt.AUDIO&&f===Ve.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(f===Ve.BUFFER_ADD_CODEC_ERROR||f===Ve.BUFFER_APPEND_ERROR))&&h.some(({audioCodec:G})=>n.audioCodec!==G),C=e.sourceBufferName==="video"&&(f===Ve.BUFFER_ADD_CODEC_ERROR||f===Ve.BUFFER_APPEND_ERROR)&&h.some(({codecSet:G,audioCodec:B})=>n.codecSet!==G&&n.audioCodec===B),{type:k,groupId:O}=(a=e.context)!=null?a:{};for(let G=h.length;G--;){const B=(G+r)%h.length;if(B!==r&&B>=u&&B<=m&&h[B].loadError===0){var c,d;const T=h[B];if(f===Ve.FRAG_GAP&&e.frag){const L=h[B].details;if(L){const I=Hr(e.frag,L.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(k===Kt.AUDIO_TRACK&&T.hasAudioGroup(O)||k===Kt.SUBTITLE_TRACK&&T.hasSubtitleGroup(O))continue;if(p===Rt.AUDIO&&(c=n.audioGroups)!=null&&c.some(L=>T.hasAudioGroup(L))||p===Rt.SUBTITLE&&(d=n.subtitleGroups)!=null&&d.some(L=>T.hasSubtitleGroup(L))||A&&n.audioCodec===T.audioCodec||!A&&n.audioCodec!==T.audioCodec||C&&n.codecSet===T.codecSet)continue}l=B;break}}if(l>-1&&i.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:Ii.SendAlternateToPenaltyBox,flags:qi.None,nextAutoLevel:l}}return{action:Ii.SendAlternateToPenaltyBox,flags:qi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case Ii.DoNothing:break;case Ii.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Ve.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:n,hdcpLevel:o,nextAutoLevel:a}=i;switch(n){case qi.None:this.switchLevel(e,a);break;case qi.MoveAllAlternatesMatchingHDCP:o&&(t.maxHdcpLevel=ms[ms.indexOf(o)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}i.resolved||this.switchLevel(e,a)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class qs{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=De.log.bind(De,`${t}:`),this.warn=De.warn.bind(De,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const i=t==null?void 0:t.renditionReports;if(i){let n=-1;for(let o=0;o<i.length;o++){const a=i[o];let c;try{c=new self.URL(a.URI,t.url).href}catch(d){De.warn(`Could not construct new URL for Rendition Report: ${d}`),c=a.URI||""}if(c===e){n=o;break}else c===e.substring(0,c.length)&&(n=o)}if(n!==-1){const o=i[n],a=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let c=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}return new cl(a,c>=0?c:void 0,ir.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,i){const{details:n,stats:o}=t,a=self.performance.now(),c=o.loading.first?Math.max(0,a-o.loading.first):0;if(n.advancedDateTime=Date.now()-c,n.live||i!=null&&i.live){if(n.reloaded(i),i&&this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),i&&n.fragments.length>0&&r_(i,n),!this.canLoad||!n.live)return;let d,f,l;if(n.canBlockReload&&n.endSN&&n.advanced){const _=this.hls.config.lowLatencyMode,A=n.lastPartSn,E=n.endSN,C=n.lastPartIndex,k=C!==-1,O=A===E,G=_?0:C;k?(f=O?E+1:A,l=O?G:C+1):f=E+1;const B=n.age,T=B+n.ageHeader;let L=Math.min(T-n.partTarget,n.targetduration*1.5);if(L>0){if(i&&L>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${L} with playlist age: ${n.age}`),L=0;else{const I=Math.floor(L/n.targetduration);if(f+=I,l!==void 0){const M=Math.round(L%n.targetduration/n.partTarget);l+=M}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${B.toFixed(2)}s goal: ${L} skip sn ${I} to part ${l}`)}n.tuneInGoal=L}if(d=this.getDeliveryDirectives(n,t.deliveryDirectives,f,l),_||!O){this.loadPlaylist(d);return}}else(n.canBlockReload||n.canSkipUntil)&&(d=this.getDeliveryDirectives(n,t.deliveryDirectives,f,l));const h=this.hls.mainForwardBufferInfo,r=h?h.end-h.len:0,u=(n.edge-r)*1e3,m=l_(n,u);n.updated&&a>this.requestScheduled+m&&(this.requestScheduled=o.loading.start),f!==void 0&&n.canBlockReload?this.requestScheduled=o.loading.first+m-(n.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+m<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=m);let p=this.requestScheduled-a;p=Math.max(0,p),this.log(`reload live playlist ${e} in ${Math.round(p)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(d),p)}else this.clearTimer()}getDeliveryDirectives(e,t,i,n){let o=n_(e,i);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,n=t.part,o=ir.No),new cl(i,n,o)}checkRetry(e){const t=e.details,i=Vr(e),n=e.errorAction,{action:o,retryCount:a=0,retryConfig:c}=n||{},d=!!n&&!!c&&(o===Ii.RetryRequest||!n.resolved&&o===Ii.SendAlternateToPenaltyBox);if(d){var f;if(this.requestScheduled=-1,a>=c.maxNumRetry)return!1;if(i&&(f=e.context)!=null&&f.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${c.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const l=zs(c,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),l),this.warn(`Retrying playlist loading ${a+1}/${c.maxNumRetry} after "${t}" in ${l}ms`)}e.levelRetry=!0,n.resolved=!0}return d}}class Dn{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class m_{constructor(e,t,i,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Dn(e),this.fast_=new Dn(t),this.defaultTTFB_=n,this.ttfb_=new Dn(e)}update(e,t){const{slow_:i,fast_:n,ttfb_:o}=this;i.halfLife!==e&&(this.slow_=new Dn(e,i.getEstimate(),i.getTotalWeight())),n.halfLife!==t&&(this.fast_=new Dn(t,n.getEstimate(),n.getTotalWeight())),o.halfLife!==e&&(this.ttfb_=new Dn(e,o.getEstimate(),o.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,n=e/1e3,o=i/n;this.fast_.sample(n,o),this.slow_.sample(n,o)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const hd={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},pl={};function g_(s,e,t,i,n,o){const a=s.audioCodec?s.audioGroups:null,c=o==null?void 0:o.audioCodec,d=o==null?void 0:o.channels,f=d?parseInt(d):c?1/0:2;let l=null;if(a!=null&&a.length)try{a.length===1&&a[0]?l=e.groups[a[0]].channels:l=a.reduce((h,r)=>{if(r){const u=e.groups[r];if(!u)throw new Error(`Audio track group ${r} not found`);Object.keys(u.channels).forEach(m=>{h[m]=(h[m]||0)+u.channels[m]})}return h},{2:0})}catch{return!0}return s.videoCodec!==void 0&&(s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(i,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(n,8e6))||!!l&&vt(f)&&Object.keys(l).some(h=>parseInt(h)>f)}function y_(s,e,t){const i=s.videoCodec,n=s.audioCodec;if(!i||!n||!t)return Promise.resolve(hd);const o={width:s.width,height:s.height,bitrate:Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)),framerate:s.frameRate||30},a=s.videoRange;a!=="SDR"&&(o.transferFunction=a.toLowerCase());const c=i.split(",").map(d=>({type:"media-source",video:wi(wi({},o),{},{contentType:sr(d,"video")})}));return n&&s.audioGroups&&s.audioGroups.forEach(d=>{var f;d&&((f=e.groups[d])==null||f.tracks.forEach(l=>{if(l.groupId===d){const h=l.channels||"",r=parseFloat(h);vt(r)&&r>2&&c.push.apply(c,n.split(",").map(u=>({type:"media-source",audio:{contentType:sr(u,"audio"),channels:""+r}})))}}))}),Promise.all(c.map(d=>{const f=__(d);return pl[f]||(pl[f]=t.decodingInfo(d))})).then(d=>({supported:!d.some(f=>!f.supported),configurations:c,decodingInfoResults:d})).catch(d=>({supported:!1,configurations:c,decodingInfoResults:[],error:d}))}function __(s){const{audio:e,video:t}=s,i=t||e;if(i){const n=i.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${n}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${n}`}return""}function v_(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function A_(s,e){let t=!1,i=[];return s&&(t=s!=="SDR",i=[s]),e&&(i=e.allowedVideoRanges||$r.slice(0),t=e.preferHDR!==void 0?e.preferHDR:v_(),t?i=i.filter(n=>n!=="SDR"):i=["SDR"]),{preferHDR:t,allowedVideoRanges:i}}function b_(s,e,t,i,n){const o=Object.keys(s),a=i==null?void 0:i.channels,c=i==null?void 0:i.audioCodec,d=a&&parseInt(a)===2;let f=!0,l=!1,h=1/0,r=1/0,u=1/0,m=0,p=[];const{preferHDR:_,allowedVideoRanges:A}=A_(e,n);for(let O=o.length;O--;){const G=s[o[O]];f=G.channels[2]>0,h=Math.min(h,G.minHeight),r=Math.min(r,G.minFramerate),u=Math.min(u,G.minBitrate);const B=A.filter(T=>G.videoRanges[T]>0);B.length>0&&(l=!0,p=B)}h=vt(h)?h:0,r=vt(r)?r:0;const E=Math.max(1080,h),C=Math.max(30,r);return u=vt(u)?u:t,t=Math.max(u,t),l||(e=void 0,p=[]),{codecSet:o.reduce((O,G)=>{const B=s[G];if(G===O)return O;if(B.minBitrate>t)return hn(G,`min bitrate of ${B.minBitrate} > current estimate of ${t}`),O;if(!B.hasDefaultAudio)return hn(G,"no renditions with default or auto-select sound found"),O;if(c&&G.indexOf(c.substring(0,4))%5!==0)return hn(G,`audio codec preference "${c}" not found`),O;if(a&&!d){if(!B.channels[a])return hn(G,`no renditions with ${a} channel sound found (channels options: ${Object.keys(B.channels)})`),O}else if((!c||d)&&f&&B.channels[2]===0)return hn(G,"no renditions with stereo sound found"),O;return B.minHeight>E?(hn(G,`min resolution of ${B.minHeight} > maximum of ${E}`),O):B.minFramerate>C?(hn(G,`min framerate of ${B.minFramerate} > maximum of ${C}`),O):p.some(T=>B.videoRanges[T]>0)?B.maxScore<m?(hn(G,`max score of ${B.maxScore} < selected max of ${m}`),O):O&&(Ur(G)>=Ur(O)||B.fragmentError>s[O].fragmentError)?O:(m=B.maxScore,G):(hn(G,`no variants with VIDEO-RANGE of ${JSON.stringify(p)} found`),O)},void 0),videoRanges:p,preferHDR:_,minFramerate:r,minBitrate:u}}function hn(s,e){De.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function S_(s){return s.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const n=t.channels||"2";return i.channels[n]=(i.channels[n]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function E_(s,e,t,i){return s.slice(t,i+1).reduce((n,o)=>{if(!o.codecSet)return n;const a=o.audioGroups;let c=n[o.codecSet];c||(n[o.codecSet]=c={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),c.minBitrate=Math.min(c.minBitrate,o.bitrate);const d=Math.min(o.height,o.width);return c.minHeight=Math.min(c.minHeight,d),c.minFramerate=Math.min(c.minFramerate,o.frameRate),c.maxScore=Math.max(c.maxScore,o.score),c.fragmentError+=o.fragmentError,c.videoRanges[o.videoRange]=(c.videoRanges[o.videoRange]||0)+1,a&&a.forEach(f=>{if(!f)return;const l=e.groups[f];c.hasDefaultAudio=c.hasDefaultAudio||e.hasDefaultAudio?l.hasDefault:l.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(l.channels).forEach(h=>{c.channels[h]=(c.channels[h]||0)+l.channels[h]})}),n},{})}function rn(s,e,t){if("attrs"in s){const i=e.indexOf(s);if(i!==-1)return i}for(let i=0;i<e.length;i++){const n=e[i];if(jn(s,n,t))return i}return-1}function jn(s,e,t){const{groupId:i,name:n,lang:o,assocLang:a,characteristics:c,default:d}=s,f=s.forced;return(i===void 0||e.groupId===i)&&(n===void 0||e.name===n)&&(o===void 0||e.lang===o)&&(o===void 0||e.assocLang===a)&&(d===void 0||e.default===d)&&(f===void 0||e.forced===f)&&(c===void 0||x_(c,e.characteristics))&&(t===void 0||t(s,e))}function x_(s,e=""){const t=s.split(","),i=e.split(",");return t.length===i.length&&!t.some(n=>i.indexOf(n)===-1)}function On(s,e){const{audioCodec:t,channels:i}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function C_(s,e,t,i,n){const o=e[i],c=e.reduce((r,u,m)=>{const p=u.uri;return(r[p]||(r[p]=[])).push(m),r},{})[o.uri];c.length>1&&(i=Math.max.apply(Math,c));const d=o.videoRange,f=o.frameRate,l=o.codecSet.substring(0,4),h=ml(e,i,r=>{if(r.videoRange!==d||r.frameRate!==f||r.codecSet.substring(0,4)!==l)return!1;const u=r.audioGroups,m=t.filter(p=>!u||u.indexOf(p.groupId)!==-1);return rn(s,m,n)>-1});return h>-1?h:ml(e,i,r=>{const u=r.audioGroups,m=t.filter(p=>!u||u.indexOf(p.groupId)!==-1);return rn(s,m,n)>-1})}function ml(s,e,t){for(let i=e;i;i--)if(t(s[i]))return i;for(let i=e+1;i<s.length;i++)if(t(s[i]))return i;return-1}class w_{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:i,hls:n}=this,{autoLevelEnabled:o,media:a}=n;if(!t||!a)return;const c=performance.now(),d=i?i.stats:t.stats,f=i?i.duration:t.duration,l=c-d.loading.start,h=n.minAutoLevel;if(d.aborted||d.loaded&&d.loaded===d.total||t.level<=h){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o||a.paused||!a.playbackRate||!a.readyState)return;const r=n.mainForwardBufferInfo;if(r===null)return;const u=this.bwEstimator.getEstimateTTFB(),m=Math.abs(a.playbackRate);if(l<=Math.max(u,1e3*(f/(m*2))))return;const p=r.len/m,_=d.loading.first?d.loading.first-d.loading.start:-1,A=d.loaded&&_>-1,E=this.getBwEstimate(),C=n.levels,k=C[t.level],O=d.total||Math.max(d.loaded,Math.round(f*k.maxBitrate/8));let G=A?l-_:l;G<1&&A&&(G=Math.min(l,d.loaded*8/E));const B=A?d.loaded*1e3/G:0,T=B?(O-d.loaded)/B:O*8/E+u/1e3;if(T<=p)return;const L=B?B*8:E;let I=Number.POSITIVE_INFINITY,M;for(M=t.level-1;M>h;M--){const re=C[M].maxBitrate;if(I=this.getTimeToLoadFrag(u/1e3,L,f*re,!C[M].details),I<p)break}if(I>=T||I>f*10)return;n.nextLoadLevel=n.nextAutoLevel=M,A?this.bwEstimator.sample(l-Math.min(u,_),d.loaded):this.bwEstimator.sampleTTFB(l);const K=C[M].bitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>K&&this.resetEstimator(K),this.clearTimer(),De.warn(`[abr] Fragment ${t.sn}${i?" part "+i.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${p.toFixed(3)} s
      Estimated load time for current fragment: ${T.toFixed(3)} s
      Estimated load time for down switch fragment: ${I.toFixed(3)} s
      TTFB estimate: ${_|0} ms
      Current BW estimate: ${vt(E)?E|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${M} @ ${K|0} bps`),n.trigger(W.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:i,stats:d})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(De.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new m_(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.FRAG_LOADING,this.onFragLoading,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this),e.on(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(W.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.FRAG_LOADING,this.onFragLoading,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this),e.off(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(W.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(W.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var n;this.fragCurrent=i,this.partCurrent=(n=t.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Ve.BUFFER_ADD_CODEC_ERROR:case Ve.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Ve.FRAG_LOAD_TIMEOUT:{const i=t.frag,{fragCurrent:n,partCurrent:o}=this;if(i&&n&&i.sn===n.sn&&i.level===n.level){const a=performance.now(),c=o?o.stats:i.stats,d=a-c.loading.start,f=c.loading.first?c.loading.first-c.loading.start:-1;if(c.loaded&&f>-1){const h=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(h,f),c.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,t,i,n){const o=e+i/t,a=n?this.lastLevelLoadSec:0;return o+a}onLevelLoaded(e,t){const i=this.hls.config,{loading:n}=t.stats,o=n.end-n.start;vt(o)&&(this.lastLevelLoadSec=o/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:i}){const n=i?i.stats:t.stats;if(t.type===Rt.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=i?i.duration:t.duration,a=this.hls.levels[t.level],c=(a.loaded?a.loaded.bytes:0)+n.loaded,d=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:c,duration:d},a.realBitrate=Math.round(8*c/d)}if(t.bitrateTest){const o={stats:n,frag:t,part:i,id:t.type};this.onFragBuffered(W.FRAG_BUFFERED,o),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:n}=t,o=n!=null&&n.stats.loaded?n.stats:i.stats;if(o.aborted||this.ignoreFragment(i))return;const a=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,o.loaded),o.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Rt.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,o=this.findBestLevel(i,t,e,0,n,1,1);if(o>-1)return o;const a=this.hls.firstLevel,c=Math.min(Math.max(a,t),e);return De.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${c}`),c}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const o=i&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,o)&&a[e].loadError<=a[o].loadError)return e}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){var e;return`${this.getBwEstimate()}_${(e=this.hls.mainForwardBufferInfo)==null?void 0:e.len}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{maxAutoLevel:n,config:o,minAutoLevel:a,media:c}=i,d=t?t.duration:e?e.duration:0,f=c&&c.playbackRate!==0?Math.abs(c.playbackRate):1,l=this.getBwEstimate(),h=i.mainForwardBufferInfo,r=(h?h.len:0)/f;let u=o.abrBandWidthFactor,m=o.abrBandWidthUpFactor;if(r){const C=this.findBestLevel(l,a,n,r,0,u,m);if(C>=0)return C}let p=d?Math.min(d,o.maxStarvationDelay):o.maxStarvationDelay;if(!r){const C=this.bitrateTestDelay;C&&(p=(d?Math.min(d,o.maxLoadingDelay):o.maxLoadingDelay)-C,De.info(`[abr] bitrate test took ${Math.round(1e3*C)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),u=m=1)}const _=this.findBestLevel(l,a,n,r,p,u,m);if(De.info(`[abr] ${r?"rebuffering expected":"buffer is empty"}, optimal quality level ${_}`),_>-1)return _;const A=i.levels[a],E=i.levels[i.loadLevel];return(A==null?void 0:A.bitrate)<(E==null?void 0:E.bitrate)?a:i.loadLevel}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,n,o,a,c){var d;const f=n+o,l=this.lastLoadedFragLevel,h=l===-1?this.hls.firstLevel:l,{fragCurrent:r,partCurrent:u}=this,{levels:m,allAudioTracks:p,loadLevel:_,config:A}=this.hls;if(m.length===1)return 0;const E=m[h],C=!!(E!=null&&(d=E.details)!=null&&d.live),k=_===-1||l===-1;let O,G="SDR",B=(E==null?void 0:E.frameRate)||0;const{audioPreference:T,videoPreference:L}=A,I=this.audioTracksByGroup||(this.audioTracksByGroup=S_(p));if(k){if(this.firstSelection!==-1)return this.firstSelection;const ne=this.codecTiers||(this.codecTiers=E_(m,I,t,i)),me=b_(ne,G,e,T,L),{codecSet:Ae,videoRanges:F,minFramerate:y,minBitrate:v,preferHDR:S}=me;O=Ae,G=S?F[F.length-1]:F[0],B=y,e=Math.max(e,v),De.log(`[abr] picked start tier ${JSON.stringify(me)}`)}else O=E==null?void 0:E.codecSet,G=E==null?void 0:E.videoRange;const M=u?u.duration:r?r.duration:0,K=this.bwEstimator.getEstimateTTFB()/1e3,re=[];for(let ne=i;ne>=t;ne--){var ae,te;const me=m[ne],Ae=ne>h;if(!me)continue;if(A.useMediaCapabilities&&!me.supportedResult&&!me.supportedPromise){const D=navigator.mediaCapabilities;typeof(D==null?void 0:D.decodingInfo)=="function"&&g_(me,I,G,B,e,T)?(me.supportedPromise=y_(me,I,D),me.supportedPromise.then(U=>{me.supportedResult=U;const j=this.hls.levels,X=j.indexOf(me);U.error?De.warn(`[abr] MediaCapabilities decodingInfo error: "${U.error}" for level ${X} ${JSON.stringify(U)}`):U.supported||(De.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${X} ${JSON.stringify(U)}`),X>-1&&j.length>1&&(De.log(`[abr] Removing unsupported level ${X}`),this.hls.removeLevel(X)))})):me.supportedResult=hd}if(O&&me.codecSet!==O||G&&me.videoRange!==G||Ae&&B>me.frameRate||!Ae&&B>0&&B<me.frameRate||!((ae=me.supportedResult)!=null&&(te=ae.decodingInfoResults)!=null&&te[0].smooth)){re.push(ne);continue}const F=me.details,y=(u?F==null?void 0:F.partTarget:F==null?void 0:F.averagetargetduration)||M;let v;Ae?v=c*e:v=a*e;const S=M&&n>=M*2&&o===0?m[ne].averageBitrate:m[ne].maxBitrate,w=this.getTimeToLoadFrag(K,v,S*y,F===void 0);if(v>=S&&(ne===l||me.loadError===0&&me.fragmentError===0)&&(w<=K||!vt(w)||C&&!this.bitrateTestDelay||w<f)){const D=this.forcedAutoLevel;return ne!==_&&(D===-1||D!==_)&&(re.length&&De.trace(`[abr] Skipped level(s) ${re.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${m[re[0]].codecs}" ${m[re[0]].videoRange}; not compatible with "${E.codecs}" ${G}`),De.info(`[abr] switch candidate:${h}->${ne} adjustedbw(${Math.round(v)})-bitrate=${Math.round(v-S)} ttfb:${K.toFixed(1)} avgDuration:${y.toFixed(1)} maxFetchDuration:${f.toFixed(1)} fetchDuration:${w.toFixed(1)} firstSelection:${k} codecSet:${O} videoRange:${G} hls.loadLevel:${_}`)),k&&(this.firstSelection=ne),ne}}return-1}set nextAutoLevel(e){const t=Math.max(this.hls.minAutoLevel,e);this._nextAutoLevel!=t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}}class T_{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Li={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class k_{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(W.BUFFER_APPENDED,this.onBufferAppended,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.BUFFER_APPENDED,this.onBufferAppended,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let n=i.length;n--;){const o=i[n];if(!o)break;const a=o.end;if(o.start<=e&&a!==null&&e<=a)return o}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:i}=this,n=Object.keys(i);for(let o=n.length;o--;){const a=i[n[o]];if((a==null?void 0:a.body.type)===t&&a.buffered){const c=a.body;if(c.start<=e&&e<=c.end)return c}}return null}detectEvictedFragments(e,t,i,n){this.timeRanges&&(this.timeRanges[e]=t);const o=(n==null?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const c=this.fragments[a];if(!c||o>=c.body.sn)return;if(!c.buffered&&!c.loaded){c.body.type===i&&this.removeFragment(c.body);return}const d=c.range[e];d&&d.time.some(f=>{const l=!this.isTimeBuffered(f.startPTS,f.endPTS,t);return l&&this.removeFragment(c.body),l})})}detectPartialFragments(e){const t=this.timeRanges,{frag:i,part:n}=e;if(!t||i.sn==="initSegment")return;const o=Pn(i),a=this.fragments[o];if(!a||a.buffered&&i.gap)return;const c=!i.relurl;Object.keys(t).forEach(d=>{const f=i.elementaryStreams[d];if(!f)return;const l=t[d],h=c||f.partial===!0;a.range[d]=this.getBufferedTimes(i,n,h,l)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),fr(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=i.filter(n=>n.fragment.sn>=e))}fragBuffered(e,t){const i=Pn(e);let n=this.fragments[i];!n&&t&&(n=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(e,t,i,n){const o={time:[],partial:i},a=e.start,c=e.end,d=e.minEndPTS||c,f=e.maxStartPTS||a;for(let l=0;l<n.length;l++){const h=n.start(l)-this.bufferPadding,r=n.end(l)+this.bufferPadding;if(f>=h&&d<=r){o.time.push({startPTS:Math.max(a,n.start(l)),endPTS:Math.min(c,n.end(l))});break}else if(a<r&&c>h){const u=Math.max(a,n.start(l)),m=Math.min(c,n.end(l));m>u&&(o.partial=!0,o.time.push({startPTS:u,endPTS:m}))}else if(c<=h)break}return o}getPartialFragment(e){let t=null,i,n,o,a=0;const{bufferPadding:c,fragments:d}=this;return Object.keys(d).forEach(f=>{const l=d[f];l&&fr(l)&&(n=l.body.start-c,o=l.body.end+c,e>=n&&e<=o&&(i=Math.min(e-n,o-e),a<=i&&(t=l.body,a=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||fr(t))}getState(e){const t=Pn(e),i=this.fragments[t];return i?i.buffered?fr(i)?Li.PARTIAL:Li.OK:Li.APPENDING:Li.NOT_LOADED}isTimeBuffered(e,t,i){let n,o;for(let a=0;a<i.length;a++){if(n=i.start(a)-this.bufferPadding,o=i.end(a)+this.bufferPadding,e>=n&&t<=o)return!0;if(t<=n)return!1}return!1}onFragLoaded(e,t){const{frag:i,part:n}=t;if(i.sn==="initSegment"||i.bitrateTest)return;const o=n?null:t,a=Pn(i);this.fragments[a]={body:i,appendedPTS:null,loaded:o,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:n,timeRanges:o}=t;if(i.sn==="initSegment")return;const a=i.type;if(n){let c=this.activePartLists[a];c||(this.activePartLists[a]=c=[]),c.push(n)}this.timeRanges=o,Object.keys(o).forEach(c=>{const d=o[c];this.detectEvictedFragments(c,d,a,n)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Pn(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,n,o){n&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const c=this.fragments[a];if(!c)return;const d=c.body;d.type!==i||n&&!d.gap||d.start<t&&d.end>e&&(c.buffered||o)&&this.removeFragment(d)})}removeFragment(e){const t=Pn(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const n=e.sn;this.activePartLists[e.type]=i.filter(o=>o.fragment.sn!==n)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function fr(s){var e,t,i;return s.buffered&&(s.body.gap||((e=s.range.video)==null?void 0:e.partial)||((t=s.range.audio)==null?void 0:t.partial)||((i=s.range.audiovideo)==null?void 0:i.partial))}function Pn(s){return`${s.type}_${s.level}_${s.sn}`}const R_={length:0,start:()=>0,end:()=>0};class li{static isBuffered(e,t){try{if(e){const i=li.getBuffered(e);for(let n=0;n<i.length;n++)if(t>=i.start(n)&&t<=i.end(n))return!0}}catch{}return!1}static bufferInfo(e,t,i){try{if(e){const n=li.getBuffered(e),o=[];let a;for(a=0;a<n.length;a++)o.push({start:n.start(a),end:n.end(a)});return this.bufferedInfo(o,t,i)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.sort(function(f,l){const h=f.start-l.start;return h||l.end-f.end});let n=[];if(i)for(let f=0;f<e.length;f++){const l=n.length;if(l){const h=n[l-1].end;e[f].start-h<i?e[f].end>h&&(n[l-1].end=e[f].end):n.push(e[f])}else n.push(e[f])}else n=e;let o=0,a,c=t,d=t;for(let f=0;f<n.length;f++){const l=n[f].start,h=n[f].end;if(t+i>=l&&t<h)c=l,d=h,o=d-t;else if(t+i<l){a=l;break}}return{len:o,start:c||0,end:d||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(t){return De.log("failed to get media.buffered",t),R_}}}class Ks{constructor(e,t,i,n=0,o=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=pr(),this.buffering={audio:pr(),video:pr(),audiovideo:pr()},this.level=e,this.sn=t,this.id=i,this.size=n,this.part=o,this.partial=a}}function pr(){return{start:0,executeStart:0,executeEnd:0,end:0}}function wr(s,e){for(let i=0,n=s.length;i<n;i++){var t;if(((t=s[i])==null?void 0:t.cc)===e)return s[i]}return null}function L_(s,e,t){return!!(e&&(t.endCC>t.startCC||s&&s.cc<t.startCC))}function I_(s,e){const t=s.fragments,i=e.fragments;if(!i.length||!t.length){De.log("No fragments to align");return}const n=wr(t,i[0].cc);if(!n||n&&!n.startPTS){De.log("No frag in previous level to align on");return}return n}function gl(s,e){if(s){const t=s.start+e;s.start=s.startPTS=t,s.endPTS=t+s.duration}}function ud(s,e){const t=e.fragments;for(let i=0,n=t.length;i<n;i++)gl(t[i],s);e.fragmentHint&&gl(e.fragmentHint,s),e.alignedSliding=!0}function D_(s,e,t){e&&(O_(s,t,e),!t.alignedSliding&&e&&zr(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&od(e,t))}function O_(s,e,t){if(L_(s,t,e)){const i=I_(t,e);i&&vt(i.start)&&(De.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),ud(i.start,e))}}function zr(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,i=e.fragments;if(!t.length||!i.length)return;let n,o;const a=Math.min(e.endCC,s.endCC);e.startCC<a&&s.startCC<a&&(n=wr(i,a),o=wr(t,a)),(!n||!o)&&(n=i[Math.floor(i.length/2)],o=wr(t,n.cc)||t[Math.floor(t.length/2)]);const c=n.programDateTime,d=o.programDateTime;if(!c||!d)return;const f=(d-c)/1e3-(o.start-n.start);ud(f,s)}const yl=Math.pow(2,17);class P_{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new fn({type:Lt.NETWORK_ERROR,details:Ve.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,o=n.fLoader,a=n.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(u=>u[0]==="GAP")){d(vl(e));return}else e.gap=!1;const f=this.loader=e.loader=o?new o(n):new a(n),l=_l(e),h=fl(n.fragLoadPolicy.default),r={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:yl};e.stats=f.stats,f.load(l,r,{onSuccess:(u,m,p,_)=>{this.resetLoader(e,f);let A=u.data;p.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(A.slice(0,16)),A=A.slice(16)),c({frag:e,part:null,payload:A,networkDetails:_})},onError:(u,m,p,_)=>{this.resetLoader(e,f),d(new fn({type:Lt.NETWORK_ERROR,details:Ve.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:wi({url:i,data:void 0},u),error:new Error(`HTTP Error ${u.code} ${u.text}`),networkDetails:p,stats:_}))},onAbort:(u,m,p)=>{this.resetLoader(e,f),d(new fn({type:Lt.NETWORK_ERROR,details:Ve.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:p,stats:u}))},onTimeout:(u,m,p)=>{this.resetLoader(e,f),d(new fn({type:Lt.NETWORK_ERROR,details:Ve.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${r.timeout}ms`),networkDetails:p,stats:u}))},onProgress:(u,m,p,_)=>{t&&t({frag:e,part:null,payload:p,networkDetails:_})}})})}loadPart(e,t,i){this.abort();const n=this.config,o=n.fLoader,a=n.loader;return new Promise((c,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d(vl(e,t));return}const f=this.loader=e.loader=o?new o(n):new a(n),l=_l(e,t),h=fl(n.fragLoadPolicy.default),r={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:yl};t.stats=f.stats,f.load(l,r,{onSuccess:(u,m,p,_)=>{this.resetLoader(e,f),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:u.data,networkDetails:_};i(A),c(A)},onError:(u,m,p,_)=>{this.resetLoader(e,f),d(new fn({type:Lt.NETWORK_ERROR,details:Ve.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:wi({url:l.url,data:void 0},u),error:new Error(`HTTP Error ${u.code} ${u.text}`),networkDetails:p,stats:_}))},onAbort:(u,m,p)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,f),d(new fn({type:Lt.NETWORK_ERROR,details:Ve.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:p,stats:u}))},onTimeout:(u,m,p)=>{this.resetLoader(e,f),d(new fn({type:Lt.NETWORK_ERROR,details:Ve.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${r.timeout}ms`),networkDetails:p,stats:u}))}})})}updateStatsFromPart(e,t){const i=e.stats,n=t.stats,o=n.total;if(i.loaded+=n.loaded,o){const d=Math.round(e.duration/t.duration),f=Math.min(Math.round(i.loaded/o),d),h=(d-f)*Math.round(i.loaded/f);i.total=i.loaded+h}else i.total=Math.max(i.loaded,i.total);const a=i.loading,c=n.loading;a.start?a.first+=c.first-c.start:(a.start=c.start,a.first=c.first),a.end=c.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function _l(s,e=null){const t=e||s,i={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},n=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if(vt(n)&&vt(o)){var a;let c=n,d=o;if(s.sn==="initSegment"&&((a=s.decryptdata)==null?void 0:a.method)==="AES-128"){const f=o-n;f%16&&(d=o+(16-f%16)),n!==0&&(i.resetIV=!0,c=n-16)}i.rangeStart=c,i.rangeEnd=d}return i}function vl(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),i={type:Lt.MEDIA_ERROR,details:Ve.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(i.part=e),(e||s).stats.aborted=!0,new fn(i)}class fn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class B_{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class M_{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function F_(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?kn(s,0,e-t):s}class N_{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let n=0;n<4;n++)i[n]=t.getUint32(n*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,n=i[0],o=i[1],a=i[2],c=i[3],d=this.invSubMix,f=d[0],l=d[1],h=d[2],r=d[3],u=new Uint32Array(256);let m=0,p=0,_=0;for(_=0;_<256;_++)_<128?u[_]=_<<1:u[_]=_<<1^283;for(_=0;_<256;_++){let A=p^p<<1^p<<2^p<<3^p<<4;A=A>>>8^A&255^99,e[m]=A,t[A]=m;const E=u[m],C=u[E],k=u[C];let O=u[A]*257^A*16843008;n[m]=O<<24|O>>>8,o[m]=O<<16|O>>>16,a[m]=O<<8|O>>>24,c[m]=O,O=k*16843009^C*65537^E*257^m*16843008,f[A]=O<<24|O>>>8,l[A]=O<<16|O>>>16,h[A]=O<<8|O>>>24,r[A]=O,m?(m=E^u[u[u[k^E]]],p^=u[u[p]]):m=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,n=0;for(;n<t.length&&i;)i=t[n]===this.key[n],n++;if(i)return;this.key=t;const o=this.keySize=t.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const a=this.ksRows=(o+6+1)*4;let c,d;const f=this.keySchedule=new Uint32Array(a),l=this.invKeySchedule=new Uint32Array(a),h=this.sBox,r=this.rcon,u=this.invSubMix,m=u[0],p=u[1],_=u[2],A=u[3];let E,C;for(c=0;c<a;c++){if(c<o){E=f[c]=t[c];continue}C=E,c%o===0?(C=C<<8|C>>>24,C=h[C>>>24]<<24|h[C>>>16&255]<<16|h[C>>>8&255]<<8|h[C&255],C^=r[c/o|0]<<24):o>6&&c%o===4&&(C=h[C>>>24]<<24|h[C>>>16&255]<<16|h[C>>>8&255]<<8|h[C&255]),f[c]=E=(f[c-o]^C)>>>0}for(d=0;d<a;d++)c=a-d,d&3?C=f[c]:C=f[c-4],d<4||c<=4?l[d]=C:l[d]=m[h[C>>>24]]^p[h[C>>>16&255]]^_[h[C>>>8&255]]^A[h[C&255]],l[d]=l[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const n=this.keySize+6,o=this.invKeySchedule,a=this.invSBox,c=this.invSubMix,d=c[0],f=c[1],l=c[2],h=c[3],r=this.uint8ArrayToUint32Array_(i);let u=r[0],m=r[1],p=r[2],_=r[3];const A=new Int32Array(e),E=new Int32Array(A.length);let C,k,O,G,B,T,L,I,M,K,re,ae,te,ne;const me=this.networkToHostOrderSwap;for(;t<A.length;){for(M=me(A[t]),K=me(A[t+1]),re=me(A[t+2]),ae=me(A[t+3]),B=M^o[0],T=ae^o[1],L=re^o[2],I=K^o[3],te=4,ne=1;ne<n;ne++)C=d[B>>>24]^f[T>>16&255]^l[L>>8&255]^h[I&255]^o[te],k=d[T>>>24]^f[L>>16&255]^l[I>>8&255]^h[B&255]^o[te+1],O=d[L>>>24]^f[I>>16&255]^l[B>>8&255]^h[T&255]^o[te+2],G=d[I>>>24]^f[B>>16&255]^l[T>>8&255]^h[L&255]^o[te+3],B=C,T=k,L=O,I=G,te=te+4;C=a[B>>>24]<<24^a[T>>16&255]<<16^a[L>>8&255]<<8^a[I&255]^o[te],k=a[T>>>24]<<24^a[L>>16&255]<<16^a[I>>8&255]<<8^a[B&255]^o[te+1],O=a[L>>>24]<<24^a[I>>16&255]<<16^a[B>>8&255]<<8^a[T&255]^o[te+2],G=a[I>>>24]<<24^a[B>>16&255]<<16^a[T>>8&255]<<8^a[L&255]^o[te+3],E[t]=me(C^u),E[t+1]=me(G^m),E[t+2]=me(O^p),E[t+3]=me(k^_),u=M,m=K,p=re,_=ae,t=t+4}return E.buffer}}const U_=16;class Ws{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?F_(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i){return this.useSoftware?new Promise((n,o)=>{this.softwareDecrypt(new Uint8Array(e),t,i);const a=this.flush();a?n(a.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i)}softwareDecrypt(e,t,i){const{currentIV:n,currentResult:o,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=ji(a,e),this.remainderData=null);const c=this.getValidChunk(e);if(!c.length)return null;n&&(i=n);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new N_),d.expandKey(t);const f=o;return this.currentResult=d.decrypt(c.buffer,0,i),this.currentIV=kn(c,-16).buffer,f||null}webCryptoDecrypt(e,t,i){const n=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new M_(n,t)),this.fastAesKey.expandKey().then(o=>n?(this.logOnce("WebCrypto AES decrypt"),new B_(n,new Uint8Array(i)).decrypt(e.buffer,o)):Promise.reject(new Error("web crypto not initialized"))).catch(o=>(De.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${o.name}: ${o.message}`),this.onWebCryptoError(e,t,i)))}onWebCryptoError(e,t,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i);const n=this.flush();if(n)return n.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%U_;return i!==e.length&&(t=kn(e,0,i),this.remainderData=kn(e,i)),t}logOnce(e){this.logEnabled&&(De.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const G_={toString:function(s){let e="";const t=s.length;for(let i=0;i<t;i++)e+=`[${s.start(i).toFixed(3)}-${s.end(i).toFixed(3)}]`;return e}},Xe={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ys extends T_{constructor(e,t,i,n,o){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Xe.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=o,this.logPrefix=n,this.log=De.log.bind(De,`${n}:`),this.warn=De.warn.bind(De,`${n}:`),this.hls=e,this.fragmentLoader=new P_(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Ws(e.config),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Xe.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const i=t.partList;if(i!=null&&i.length){const o=i[i.length-1];return li.isBuffered(this.media,o.start+o.duration/2)}const n=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(n)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const n=this.config;this.levels&&n.autoStartLoad&&this.state===Xe.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:i,mediaBuffer:n,state:o}=this,a=i?i.currentTime:0,c=li.bufferInfo(n||i,a,e.maxBufferHole);if(this.log(`media seeking to ${vt(a)?a.toFixed(3):a}, state: ${o}`),this.state===Xe.ENDED)this.resetLoadingState();else if(t){const d=e.maxFragLookUpTolerance,f=t.start-d,l=t.start+t.duration+d;if(!c.len||l<c.start||f>c.end){const h=a>l;(a<f||h)&&(h&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!c.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Xe.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const n=o=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${o.part?" p: "+o.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(e,t,i,n).then(o=>{if(!o)return;const a=this.state;if(this.fragContextChanged(e)){(a===Xe.FRAG_LOADING||!this.fragCurrent&&a===Xe.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Xe.IDLE);return}"payload"in o&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(W.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===Xe.STOPPED||this.state===Xe.ERROR||(this.warn(o),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===Li.APPENDING){const o=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,o),c=Math.max(e.duration,a?a.len:this.config.maxBufferLength);this.reduceMaxBufferLength(c)&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===Li.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:i};this.hls.trigger(W.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{if(!i||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:n}=this,{payload:o}=i,a=e.decryptdata;if(o&&o.byteLength>0&&a!=null&&a.key&&a.iv&&a.method==="AES-128"){const c=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),a.key.buffer,a.iv.buffer).catch(d=>{throw n.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:e}),d}).then(d=>{const f=self.performance.now();return n.trigger(W.FRAG_DECRYPTED,{frag:e,payload:d,stats:{tstart:c,tdecrypt:f}}),i.payload=d,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===Xe.STOPPED||this.state===Xe.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state=Xe.IDLE,e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var i,n,o,a;const c=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Rt.MAIN?"level":"track"} ${e.level} (frag:[${((i=e.startPTS)!=null?i:NaN).toFixed(3)}-${((n=e.endPTS)!=null?n:NaN).toFixed(3)}] > buffer:${c?G_.toString(li.getBuffered(c)):"(detached)"})`),e.sn!=="initSegment"){var d;if(e.type!==Rt.SUBTITLE){const l=e.elementaryStreams;if(!Object.keys(l).some(h=>!!l[h])){this.state=Xe.IDLE;return}}const f=(d=this.levels)==null?void 0:d[e.level];f!=null&&f.fragmentError&&(this.log(`Resetting level fragment error count of ${f.fragmentError} on frag buffered`),f.fragmentError=0)}this.state=Xe.IDLE,c&&(!this.loadedmetadata&&e.type==Rt.MAIN&&c.buffered.length&&((o=this.fragCurrent)==null?void 0:o.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:n,partsLoaded:o}=e,a=!o||o.length===0||o.some(d=>!d),c=new Ks(i.level,i.sn,i.stats.chunkCount+1,0,n?n.index:-1,!a);t.flush(c)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,n){var o;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let c=null;if(e.encrypted&&!((o=e.decryptdata)!=null&&o.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=Xe.KEY_LOADING,this.fragCurrent=e,c=this.keyLoader.load(e).then(l=>{if(!this.fragContextChanged(l.frag))return this.hls.trigger(W.KEY_LOADED,l),this.state===Xe.KEY_LOADING&&(this.state=Xe.IDLE),l}),this.hls.trigger(W.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(c=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const l=a.partList;if(l&&n){i>e.end&&a.fragmentHint&&(e=a.fragmentHint);const h=this.getNextPart(l,e,i);if(h>-1){const r=l[h];this.log(`Loading part sn: ${e.sn} p: ${r.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${h}-${l.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=r.start+r.duration,this.state=Xe.FRAG_LOADING;let u;return c?u=c.then(m=>!m||this.fragContextChanged(m.frag)?null:this.doFragPartsLoad(e,r,t,n)).catch(m=>this.handleFragLoadError(m)):u=this.doFragPartsLoad(e,r,t,n).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(W.FRAG_LOADING,{frag:e,part:r,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}else if(!e.url||this.loadedEndOfParts(l,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),vt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Xe.FRAG_LOADING;const d=this.config.progressive;let f;return d&&c?f=c.then(l=>!l||this.fragContextChanged(l==null?void 0:l.frag)?null:this.fragmentLoader.load(e,n)).catch(l=>this.handleFragLoadError(l)):f=Promise.all([this.fragmentLoader.load(e,d?n:void 0),c]).then(([l])=>(!d&&l&&n&&n(l),l)).catch(l=>this.handleFragLoadError(l)),this.hls.trigger(W.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):f}doFragPartsLoad(e,t,i,n){return new Promise((o,a)=>{var c;const d=[],f=(c=i.details)==null?void 0:c.partList,l=h=>{this.fragmentLoader.loadPart(e,h,n).then(r=>{d[h.index]=r;const u=r.part;this.hls.trigger(W.FRAG_LOADED,r);const m=hl(i,e.sn,h.index+1)||ld(f,e.sn,h.index+1);if(m)l(m);else return o({frag:e,part:u,partsLoaded:d})}).catch(a)};l(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Ve.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(W.ERROR,t)}else this.hls.trigger(W.ERROR,{type:Lt.OTHER_ERROR,details:Ve.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Xe.PARSING){!this.fragCurrent&&this.state!==Xe.STOPPED&&this.state!==Xe.ERROR&&(this.state=Xe.IDLE);return}const{frag:i,part:n,level:o}=t,a=self.performance.now();i.stats.parsing.end=a,n&&(n.stats.parsing.end=a),this.updateLevelTiming(i,n,o,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:n,sn:o,part:a}=e;if(!(t!=null&&t[n]))return this.warn(`Levels object was unset while buffering fragment ${o} of level ${n}. The current chunk will not be buffered.`),null;const c=t[n],d=a>-1?hl(c,o,a):null,f=d?d.fragment:c_(c,o,i);return f?(i&&i!==f&&(f.stats=i.stats),{frag:f,part:d,level:c}):null}bufferFragmentData(e,t,i,n,o){var a;if(!e||this.state!==Xe.PARSING)return;const{data1:c,data2:d}=e;let f=c;if(c&&d&&(f=ji(c,d)),!((a=f)!=null&&a.length))return;const l={type:e.type,frag:t,part:i,chunkMeta:n,parent:t.type,data:f};if(this.hls.trigger(W.BUFFER_APPENDING,l),e.dropped&&e.independent&&!i){if(o)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!li.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,n=li.bufferInfo(t,i,0),o=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),c=Math.max(Math.min(e.start-a,n.end-a),i+a);e.start-c>a&&this.flushMainBuffer(c,e.start)}getFwdBufferInfo(e,t){const i=this.getLoadPosition();return vt(i)?this.getFwdBufferInfoAtPos(e,i,t):null}getFwdBufferInfoAtPos(e,t,i){const{config:{maxBufferHole:n}}=this,o=li.bufferInfo(e,t,n);if(o.len===0&&o.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,i);if(a&&o.nextStart<a.end)return li.bufferInfo(e,t,Math.max(o.nextStart,n))}return o}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,i=e||t.maxBufferLength;return t.maxMaxBufferLength>=i?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=Rt.MAIN){const i=this.fragmentTracker.getAppendedFrag(e,Rt.MAIN);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,n=i.length;if(!n)return null;const{config:o}=this,a=i[0].start;let c;if(t.live){const d=o.initialLiveManifestSize;if(n<d)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${d})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a)&&(c=this.getInitialLiveFragment(t,i),this.startPosition=this.nextLoadPosition=c?this.hls.liveSyncPosition||c.start:e)}else e<=a&&(c=i[0]);if(!c){const d=o.lowLatencyMode?t.partEnd:t.fragmentEnd;c=this.getFragmentAtPosition(e,d,t)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===Li.OK||i===Li.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,n,o){const a=e.gap,c=this.getNextFragment(this.nextLoadPosition,t);if(c===null)return c;if(e=c,a&&e&&!e.gap&&i.nextStart){const d=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,n);if(d!==null&&i.len+d.len>=o)return this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let n=-1,o=!1,a=!0;for(let c=0,d=e.length;c<d;c++){const f=e[c];if(a=a&&!f.independent,n>-1&&i<f.start)break;const l=f.loaded;l?n=-1:(o||f.independent||a)&&f.fragment===t&&(n=c),o=l}return n}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e,t){const i=this.fragPrevious;let n=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),n=h_(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const o=i.sn+1;if(o>=e.startSN&&o<=e.endSN){const a=t[o-e.startSN];i.cc===a.cc&&(n=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=f_(t,i.cc),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(n=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,i){const{config:n}=this;let{fragPrevious:o}=this,{fragments:a,endSN:c}=i;const{fragmentHint:d}=i,f=n.maxFragLookUpTolerance,l=i.partList,h=!!(n.lowLatencyMode&&l!=null&&l.length&&d);h&&d&&!this.bitrateTest&&(a=a.concat(d),c=d.sn);let r;if(e<t){const u=e>t-f?0:f;r=Hr(o,a,e,u)}else r=a[a.length-1];if(r){const u=r.sn-i.startSN,m=this.fragmentTracker.getState(r);if((m===Li.OK||m===Li.PARTIAL&&r.gap)&&(o=r),o&&r.sn===o.sn&&(!h||l[0].fragment.sn>r.sn)&&o&&r.level===o.level){const _=a[u+1];r.sn<c&&this.fragmentTracker.getState(_)!==Li.OK?r=_:r=null}}return r}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const n=this.hls.liveSyncPosition,o=i.currentTime,a=e.fragments[0].start,c=e.edge,d=o>=a-t.maxFragLookUpTolerance&&o<=c;if(n!==null&&i.duration>n&&(o<n||!d)){const f=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!d&&i.readyState<4||o<c-f)&&(this.loadedmetadata||(this.nextLoadPosition=n),i.readyState&&(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${c}, reset currentTime to : ${n.toFixed(3)}`),i.currentTime=n))}}alignPlaylists(e,t,i){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const o=e.fragments[0].start,a=!t,c=e.alignedSliding&&vt(o);if(a||!c&&!o){const{fragPrevious:d}=this;D_(d,i,e);const f=e.fragments[0].start;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${d?d.sn:"na"} fragments: ${n}`),f}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let i=this.startPosition;if(i<t&&(i=-1),i===-1||this.lastCurrentTime===-1){const n=this.startTimeOffset!==null,o=n?this.startTimeOffset:e.startTimeOffset;o!==null&&vt(o)?(i=t+o,o<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Start time offset ${o} found in ${n?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==Xe.FRAG_LOADING_WAITING_RETRY)&&(this.state=Xe.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const l=this.getCurrentContext(t.chunkMeta);l&&(t.frag=l.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;if(this.fragContextChanged(i)){var n;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(n=this.fragCurrent)==null?void 0:n.url}`);return}const o=t.details===Ve.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(i,!0);const a=t.errorAction,{action:c,retryCount:d=0,retryConfig:f}=a||{};if(a&&c===Ii.RetryRequest&&f){this.resetStartWhenNotLoaded(this.levelLastLoaded);const l=zs(f,d);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${d+1}/${f.maxNumRetry} in ${l}ms`),a.resolved=!0,this.retryDate=self.performance.now()+l,this.state=Xe.FRAG_LOADING_WAITING_RETRY}else if(f&&a)if(this.resetFragmentErrors(e),d<f.maxNumRetry)!o&&c!==Ii.RemoveAlternatePermanently&&(a.resolved=!0);else{De.warn(`${t.details} reached or exceeded max retry (${d})`);return}else(a==null?void 0:a.action)===Ii.SendAlternateToPenaltyBox?this.state=Xe.WAITING_LEVEL:this.state=Xe.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Xe.PARSING||this.state===Xe.PARSED){const t=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,t),n=i&&i.len>.5;n&&this.reduceMaxBufferLength(i.len);const o=!n;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Rt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Xe.STOPPED&&(this.state=Xe.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const n=li.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,i),this.state===Xe.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Xe.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,n){var o;const a=i.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((d,f)=>{const l=e.elementaryStreams[f];if(l){const h=l.endPTS-l.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${e.sn} ${f} duration reliably (${h})`),d||!1;const r=n?0:sd(a,e,l.startPTS,l.endPTS,l.startDTS,l.endDTS);return this.hls.trigger(W.LEVEL_PTS_UPDATED,{details:a,level:i,drift:r,type:f,frag:e,start:l.startPTS,end:l.endPTS}),!0}return d},!1)&&((o=this.transmuxer)==null?void 0:o.error)===null){const d=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(i.fragmentError===0&&(i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(d.message),this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Xe.PARSED,this.hls.trigger(W.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class fd{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=$_(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function $_(s,e){const t=new Uint8Array(e);let i=0;for(let n=0;n<s.length;n++){const o=s[n];t.set(o,i),i+=o.length}return t}function V_(){return typeof __HLS_WORKER_BUNDLE__=="function"}function j_(){const s=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(s);return{worker:new self.Worker(e),objectURL:e}}function H_(s){const e=new self.URL(s,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function tn(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Xs{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=ji(this.cachedData,e),this.cachedData=null);let i=rr(e,0),n=i?i.length:0,o;const a=this._audioTrack,c=this._id3Track,d=i?js(i):void 0,f=e.length;for((this.basePTS===null||this.frameIndex===0&&vt(d))&&(this.basePTS=z_(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Wi.audioId3,duration:Number.POSITIVE_INFINITY});n<f;){if(this.canParse(e,n)){const l=this.appendFrame(a,e,n);l?(this.frameIndex++,this.lastPTS=l.sample.pts,n+=l.length,o=n):n=f}else py(e,n)?(i=rr(e,n),c.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Wi.audioId3,duration:Number.POSITIVE_INFINITY}),n+=i.length,o=n):n++;if(n===f&&o!==f){const l=kn(e,o);this.cachedData?this.cachedData=ji(this.cachedData,l):this.cachedData=l}}return{audioTrack:a,videoTrack:tn(),id3Track:c,textTrack:tn()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:tn(),id3Track:this._id3Track,textTrack:tn()}}destroy(){}}const z_=(s,e,t)=>{if(vt(s))return s*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};function q_(s,e,t,i){let n,o,a,c;const d=navigator.userAgent.toLowerCase(),f=i,l=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n=((e[t+2]&192)>>>6)+1;const h=(e[t+2]&60)>>>2;if(h>l.length-1){const r=new Error(`invalid ADTS sampling index:${h}`);s.emit(W.ERROR,W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_PARSING_ERROR,fatal:!0,error:r,reason:r.message});return}return a=(e[t+2]&1)<<2,a|=(e[t+3]&192)>>>6,De.log(`manifest codec:${i}, ADTS type:${n}, samplingIndex:${h}`),/firefox/i.test(d)?h>=6?(n=5,c=new Array(4),o=h-3):(n=2,c=new Array(2),o=h):d.indexOf("android")!==-1?(n=2,c=new Array(2),o=h):(n=5,c=new Array(4),i&&(i.indexOf("mp4a.40.29")!==-1||i.indexOf("mp4a.40.5")!==-1)||!i&&h>=6?o=h-3:((i&&i.indexOf("mp4a.40.2")!==-1&&(h>=6&&a===1||/vivaldi/i.test(d))||!i&&a===1)&&(n=2,c=new Array(2)),o=h)),c[0]=n<<3,c[0]|=(h&14)>>1,c[1]|=(h&1)<<7,c[1]|=a<<3,n===5&&(c[1]|=(o&14)>>1,c[2]=(o&1)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:l[h],channelCount:a,codec:"mp4a.40."+n,manifestCodec:f}}function pd(s,e){return s[e]===255&&(s[e+1]&246)===240}function md(s,e){return s[e+1]&1?7:9}function Js(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function K_(s,e){return e+5<s.length}function qr(s,e){return e+1<s.length&&pd(s,e)}function W_(s,e){return K_(s,e)&&pd(s,e)&&Js(s,e)<=s.length-e}function Y_(s,e){if(qr(s,e)){const t=md(s,e);if(e+t>=s.length)return!1;const i=Js(s,e);if(i<=t)return!1;const n=e+i;return n===s.length||qr(s,n)}return!1}function gd(s,e,t,i,n){if(!s.samplerate){const o=q_(e,t,i,n);if(!o)return;s.config=o.config,s.samplerate=o.samplerate,s.channelCount=o.channelCount,s.codec=o.codec,s.manifestCodec=o.manifestCodec,De.log(`parsed codec:${s.codec}, rate:${o.samplerate}, channels:${o.channelCount}`)}}function yd(s){return 1024*9e4/s}function X_(s,e){const t=md(s,e);if(e+t<=s.length){const i=Js(s,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function _d(s,e,t,i,n){const o=yd(s.samplerate),a=i+n*o,c=X_(e,t);let d;if(c){const{frameLength:h,headerLength:r}=c,u=r+h,m=Math.max(0,t+u-e.length);m?(d=new Uint8Array(u-r),d.set(e.subarray(t+r,e.length),0)):d=e.subarray(t+r,t+u);const p={unit:d,pts:a};return m||s.samples.push(p),{sample:p,length:u,missing:m}}const f=e.length-t;return d=new Uint8Array(f),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:a},length:f,missing:-1}}let mr=null;const J_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Q_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Z_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ev=[0,1,1,4];function vd(s,e,t,i,n){if(t+24>e.length)return;const o=Ad(e,t);if(o&&t+o.frameLength<=e.length){const a=o.samplesPerFrame*9e4/o.sampleRate,c=i+n*a,d={unit:e.subarray(t,t+o.frameLength),pts:c,dts:c};return s.config=[],s.channelCount=o.channelCount,s.samplerate=o.sampleRate,s.samples.push(d),{sample:d,length:o.frameLength,missing:0}}}function Ad(s,e){const t=s[e+1]>>3&3,i=s[e+1]>>1&3,n=s[e+2]>>4&15,o=s[e+2]>>2&3;if(t!==1&&n!==0&&n!==15&&o!==3){const a=s[e+2]>>1&1,c=s[e+3]>>6,d=t===3?3-i:i===3?3:4,f=J_[d*14+n-1]*1e3,h=Q_[(t===3?0:t===2?1:2)*3+o],r=c===3?1:2,u=Z_[t][i],m=ev[i],p=u*8*m,_=Math.floor(u*f/h+a)*m;if(mr===null){const C=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);mr=C?parseInt(C[1]):0}return!!mr&&mr<=87&&i===2&&f>=224e3&&c===0&&(s[e+3]=s[e+3]|128),{sampleRate:h,channelCount:r,frameLength:_,samplesPerFrame:p}}}function Qs(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function bd(s,e){return e+1<s.length&&Qs(s,e)}function tv(s,e){return Qs(s,e)&&4<=s.length-e}function Sd(s,e){if(e+1<s.length&&Qs(s,e)){const i=Ad(s,e);let n=4;i!=null&&i.frameLength&&(n=i.frameLength);const o=e+n;return o===s.length||bd(s,o)}return!1}class iv extends Xs{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,n){super.resetInitSegment(e,t,i,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=rr(e,0);let i=(t==null?void 0:t.length)||0;if(Sd(e,i))return!1;for(let n=e.length;i<n;i++)if(Y_(e,i))return De.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return W_(e,t)}appendFrame(e,t,i){gd(e,this.observer,t,i,e.manifestCodec);const n=_d(e,t,i,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const nv=/\/emsg[-/]ID3/i;class rv{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,n){const o=this.videoTrack=tn("video",1),a=this.audioTrack=tn("audio",1),c=this.txtTrack=tn("text",1);if(this.id3Track=tn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=Zc(e);if(d.video){const{id:f,timescale:l,codec:h}=d.video;o.id=f,o.timescale=c.timescale=l,o.codec=h}if(d.audio){const{id:f,timescale:l,codec:h}=d.audio;a.id=f,a.timescale=l,a.codec=h}c.id=Xc.text,o.sampleDuration=0,o.duration=a.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return Ey(e)}demux(e,t){this.timeOffset=t;let i=e;const n=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=ji(this.remainderData,e));const c=Iy(i);this.remainderData=c.remainder,n.samples=c.valid||new Uint8Array}else n.samples=i;const a=this.extractID3Track(n,t);return o.samples=Ko(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return i.samples=Ko(e,t),{videoTrack:t,audioTrack:tn(),id3Track:n,textTrack:tn()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const n=Mt(e.samples,["emsg"]);n&&n.forEach(o=>{const a=Py(o);if(nv.test(a.schemeIdUri)){const c=vt(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale;let d=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const f=a.payload;i.samples.push({data:f,len:f.byteLength,dts:c,pts:c,type:Wi.emsg,duration:d})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const Ed=(s,e)=>{let t=0,i=5;e+=i;const n=new Uint32Array(1),o=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=s[e];const c=Math.min(i,8),d=8-c;o[0]=4278190080>>>24+d<<d,n[0]=(a[0]&o[0])>>d,t=t?t<<c|n[0]:n[0],e+=1,i-=c}return t};class av extends Xs{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,n){super.resetInitSegment(e,t,i,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const n=xd(e,t,i,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const t=rr(e,0);if(!t)return!1;const i=t.length;return e[i]===11&&e[i+1]===119&&js(t)!==void 0&&Ed(e,i)<16}}function xd(s,e,t,i,n){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const o=e[t+4]>>6;if(o>=3)return-1;const c=[48e3,44100,32e3][o],d=e[t+4]&63,l=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+o]*2;if(t+l>e.length)return-1;const h=e[t+6]>>5;let r=0;h===2?r+=2:(h&1&&h!==1&&(r+=2),h&4&&(r+=2));const u=(e[t+6]<<8|e[t+7])>>12-r&1,p=[2,1,2,3,3,4,4,5][h]+u,_=e[t+5]>>3,A=e[t+5]&7,E=new Uint8Array([o<<6|_<<1|A>>2,(A&3)<<6|h<<3|u<<2|d>>4,d<<4&224]),C=1536/c*9e4,k=i+n*C,O=e.subarray(t,t+l);return s.config=E,s.channelCount=p,s.samplerate=c,s.samples.push({unit:O,pts:k}),l}class Cd{constructor(){this.VideoSample=null}createVideoSample(e,t,i,n){return{key:e,frame:!1,pts:t,dts:i,units:[],debug:n,length:0}}getLastNalUnit(e){var t;let i=this.VideoSample,n;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const o=i.units;n=o[o.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const i=t.samples,n=i.length;if(n){const o=i[n-1];e.pts=o.pts,e.dts=o.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&De.log(e.pts+"/"+e.dts+":"+e.debug)}parseNALu(e,t){const i=t.byteLength;let n=e.naluState||0;const o=n,a=[];let c=0,d,f,l,h=-1,r=0;for(n===-1&&(h=0,r=this.getNALuType(t,0),n=0,c=1);c<i;){if(d=t[c++],!n){n=d?0:1;continue}if(n===1){n=d?0:2;continue}if(!d)n=3;else if(d===1){if(f=c-n-1,h>=0){const u={data:t.subarray(h,f),type:r};a.push(u)}else{const u=this.getLastNalUnit(e.samples);u&&(o&&c<=4-o&&u.state&&(u.data=u.data.subarray(0,u.data.byteLength-o)),f>0&&(u.data=ji(u.data,t.subarray(0,f)),u.state=0))}c<i?(l=this.getNALuType(t,c),h=c,r=l,n=0):n=-1}else n=0}if(h>=0&&n>=0){const u={data:t.subarray(h,i),type:r,state:n};a.push(u)}if(a.length===0){const u=this.getLastNalUnit(e.samples);u&&(u.data=ji(u.data,t))}return e.naluState=n,a}}class nr{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),o=Math.min(4,t);if(o===0)throw new Error("no bytes available");n.set(e.subarray(i,i+o)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&De.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Al extends Cd{parsePES(e,t,i,n,o){const a=this.parseNALu(e,i.data);let c=this.VideoSample,d,f=!1;i.data=null,c&&a.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"")),a.forEach(l=>{var h;switch(l.type){case 1:{let p=!1;d=!0;const _=l.data;if(f&&_.length>4){const A=this.readSliceType(_);(A===2||A===4||A===7||A===9)&&(p=!0)}if(p){var r;(r=c)!=null&&r.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),c.frame=!0,c.key=p;break}case 5:d=!0,(h=c)!=null&&h.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),c.key=!0,c.frame=!0;break;case 6:{d=!0,Hs(l.data,1,i.pts,t.samples);break}case 7:{var u,m;d=!0,f=!0;const p=l.data,_=this.readSPS(p);if(!e.sps||e.width!==_.width||e.height!==_.height||((u=e.pixelRatio)==null?void 0:u[0])!==_.pixelRatio[0]||((m=e.pixelRatio)==null?void 0:m[1])!==_.pixelRatio[1]){e.width=_.width,e.height=_.height,e.pixelRatio=_.pixelRatio,e.sps=[p],e.duration=o;const A=p.subarray(1,4);let E="avc1.";for(let C=0;C<3;C++){let k=A[C].toString(16);k.length<2&&(k="0"+k),E+=k}e.codec=E}break}case 8:d=!0,e.pps=[l.data];break;case 9:d=!0,e.audFound=!0,c&&this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"");break;case 12:d=!0;break;default:d=!1,c&&(c.debug+="unknown NAL "+l.type+" ");break}c&&d&&c.units.push(l)}),n&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new nr(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let i=8,n=8,o;for(let a=0;a<e;a++)n!==0&&(o=t.readEG(),n=(i+o+256)%256),i=n===0?i:n}readSPS(e){const t=new nr(e);let i=0,n=0,o=0,a=0,c,d,f;const l=t.readUByte.bind(t),h=t.readBits.bind(t),r=t.readUEG.bind(t),u=t.readBoolean.bind(t),m=t.skipBits.bind(t),p=t.skipEG.bind(t),_=t.skipUEG.bind(t),A=this.skipScalingList.bind(this);l();const E=l();if(h(5),m(3),l(),_(),E===100||E===110||E===122||E===244||E===44||E===83||E===86||E===118||E===128){const T=r();if(T===3&&m(1),_(),_(),m(1),u())for(d=T!==3?8:12,f=0;f<d;f++)u()&&(f<6?A(16,t):A(64,t))}_();const C=r();if(C===0)r();else if(C===1)for(m(1),p(),p(),c=r(),f=0;f<c;f++)p();_(),m(1);const k=r(),O=r(),G=h(1);G===0&&m(1),m(1),u()&&(i=r(),n=r(),o=r(),a=r());let B=[1,1];if(u()&&u())switch(l()){case 1:B=[1,1];break;case 2:B=[12,11];break;case 3:B=[10,11];break;case 4:B=[16,11];break;case 5:B=[40,33];break;case 6:B=[24,11];break;case 7:B=[20,11];break;case 8:B=[32,11];break;case 9:B=[80,33];break;case 10:B=[18,11];break;case 11:B=[15,11];break;case 12:B=[64,33];break;case 13:B=[160,99];break;case 14:B=[4,3];break;case 15:B=[3,2];break;case 16:B=[2,1];break;case 255:{B=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((k+1)*16-i*2-n*2),height:(2-G)*(O+1)*16-(G?2:4)*(o+a),pixelRatio:B}}}class bl extends Cd{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,i,n,o){const a=this.parseNALu(e,i.data);let c=this.VideoSample,d,f=!1;i.data=null,c&&a.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"")),a.forEach(l=>{var h;switch(l.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:c||(c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"")),c.frame=!0,d=!0;break;case 16:case 17:case 18:case 21:if(d=!0,f){var r;(r=c)!=null&&r.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),c.key=!0,c.frame=!0;break;case 19:case 20:d=!0,(h=c)!=null&&h.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),c.key=!0,c.frame=!0;break;case 39:d=!0,Hs(l.data,2,i.pts,t.samples);break;case 32:if(d=!0,!e.vps){const u=this.readVPS(l.data);e.params=wi({},u),this.initVPS=l.data}e.vps=[l.data];break;case 33:if(d=!0,f=!0,typeof e.params=="object"){if(e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],l.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const u=this.readSPS(l.data);e.width=u.width,e.height=u.height,e.pixelRatio=u.pixelRatio,e.duration=o,e.codec=u.codecString,e.sps=[];for(const m in u.params)e.params[m]=u.params[m]}e.vps!==void 0&&e.vps[0]===this.initVPS&&e.sps.push(l.data)}c||(c=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),c.key=!0;break;case 34:if(d=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const u=this.readPPS(l.data);for(const m in u)e.params[m]=u[m]}(this.initVPS!==null||e.pps.length===0)&&e.pps.push(l.data)}break;case 35:d=!0,e.audFound=!0,c&&this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"");break;default:d=!1,c&&(c.debug+="unknown or irrelevant NAL "+l.type+" ");break}c&&d&&c.units.push(l)}),n&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let i=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(t[i]=e[n],i++);return new Uint8Array(t.buffer,0,i)}readVPS(e){const t=new nr(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const i=t.readBits(3),n=t.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:n}}readSPS(e){const t=new nr(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const i=t.readBits(3);t.readBoolean();const n=t.readBits(2),o=t.readBoolean(),a=t.readBits(5),c=t.readUByte(),d=t.readUByte(),f=t.readUByte(),l=t.readUByte(),h=t.readUByte(),r=t.readUByte(),u=t.readUByte(),m=t.readUByte(),p=t.readUByte(),_=t.readUByte(),A=t.readUByte(),E=[],C=[];for(let Le=0;Le<i;Le++)E.push(t.readBoolean()),C.push(t.readBoolean());if(i>0)for(let Le=i;Le<8;Le++)t.readBits(2);for(let Le=0;Le<i;Le++)E[Le]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),C[Le]&&t.readUByte();t.readUEG();const k=t.readUEG();k==3&&t.skipBits(1);const O=t.readUEG(),G=t.readUEG(),B=t.readBoolean();let T=0,L=0,I=0,M=0;B&&(T+=t.readUEG(),L+=t.readUEG(),I+=t.readUEG(),M+=t.readUEG());const K=t.readUEG(),re=t.readUEG(),ae=t.readUEG(),te=t.readBoolean();for(let Le=te?0:i;Le<=i;Le++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let rt=0;rt<4;rt++)for(let tt=0;tt<(rt===3?2:6);tt++)if(!t.readBoolean())t.readUEG();else{const ft=Math.min(64,1<<4+(rt<<1));rt>1&&t.readEG();for(let pt=0;pt<ft;pt++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const Ae=t.readUEG();let F=0;for(let Le=0;Le<Ae;Le++){let rt=!1;if(Le!==0&&(rt=t.readBoolean()),rt){Le===Ae&&t.readUEG(),t.readBoolean(),t.readUEG();let tt=0;for(let Ee=0;Ee<=F;Ee++){const ft=t.readBoolean();let pt=!1;ft||(pt=t.readBoolean()),(ft||pt)&&tt++}F=tt}else{const tt=t.readUEG(),Ee=t.readUEG();F=tt+Ee;for(let ft=0;ft<tt;ft++)t.readUEG(),t.readBoolean();for(let ft=0;ft<Ee;ft++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Le=t.readUEG();for(let rt=0;rt<Le;rt++){for(let tt=0;tt<ae+4;tt++)t.readBits(1);t.readBits(1)}}let v=0,S=1,w=1,x=!0,D=1,U=0;t.readBoolean(),t.readBoolean();let j=!1;if(t.readBoolean()){if(t.readBoolean()){const Ze=t.readUByte(),je=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],he=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Ze>0&&Ze<16?(S=je[Ze-1],w=he[Ze-1]):Ze===255&&(S=t.readBits(16),w=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),j=t.readBoolean(),j&&(T+=t.readUEG(),L+=t.readUEG(),I+=t.readUEG(),M+=t.readUEG()),t.readBoolean()&&(D=t.readBits(32),U=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const he=t.readBoolean(),_e=t.readBoolean();let Ne=!1;(he||_e)&&(Ne=t.readBoolean(),Ne&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Ne&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let fe=0;fe<=i;fe++){x=t.readBoolean();const Je=x||t.readBoolean();let ot=!1;Je?t.readEG():ot=t.readBoolean();const nt=ot?1:t.readUEG()+1;if(he)for(let q=0;q<nt;q++)t.readUEG(),t.readUEG(),Ne&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(_e)for(let q=0;q<nt;q++)t.readUEG(),t.readUEG(),Ne&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),v=t.readUEG())}let ee=O,ie=G;if(B||j){let Le=1,rt=1;k===1?Le=rt=2:k==2&&(Le=2),ee=O-Le*L-Le*T,ie=G-rt*M-rt*I}const be=n?["A","B","C"][n]:"",Te=c<<24|d<<16|f<<8|l;let Oe=0;for(let Le=0;Le<32;Le++)Oe=(Oe|(Te>>Le&1)<<31-Le)>>>0;let He=Oe.toString(16);return a===1&&He==="2"&&(He="6"),{codecString:`hvc1.${be}${a}.${He}.${o?"H":"L"}${A}.B0`,params:{general_tier_flag:o,general_profile_idc:a,general_profile_space:n,general_profile_compatibility_flags:[c,d,f,l],general_constraint_indicator_flags:[h,r,u,m,p,_],general_level_idc:A,bit_depth:K+8,bit_depth_luma_minus8:K,bit_depth_chroma_minus8:re,min_spatial_segmentation_idc:v,chroma_format_idc:k,frame_rate:{fixed:x,fps:U/D}},width:ee,height:ie,pixelRatio:[S,w]}}readPPS(e){const t=new nr(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),o=t.readBoolean();let a=1;return o&&n?a=0:o?a=3:n&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}class sv{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Ws(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,i){const n=e[t].unit;if(n.length<=16)return;const o=n.subarray(16,n.length-n.length%16),a=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(a).then(c=>{const d=new Uint8Array(c);n.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let n=0;for(let o=32;o<e.length-16;o+=160,n+=16)i.set(e.subarray(o,o+16),n);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let n=0;for(let o=32;o<e.length-16;o+=160,n+=16)e.set(i.subarray(n,n+16),o);return e}decryptAvcSample(e,t,i,n,o){const a=td(o.data),c=this.getAvcEncryptedData(a);this.decryptBuffer(c.buffer).then(d=>{o.data=this.getAvcDecryptedUnit(a,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,n)})}decryptAvcSamples(e,t,i,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){n();return}const o=e[t].units;for(;!(i>=o.length);i++){const a=o[i];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,i,n,a),!this.decrypter.isSync()))return}}}}const ki=188;class gn{constructor(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.videoParser=null}static probe(e){const t=gn.syncOffset(e);return t>0&&De.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let i=Math.min(ki*5,t-ki)+1,n=0;for(;n<i;){let o=!1,a=-1,c=0;for(let d=n;d<t;d+=ki)if(e[d]===71&&(t-d===ki||e[d+ki]===71)){if(c++,a===-1&&(a=d,a!==0&&(i=Math.min(a+ki*99,e.length-ki)+1)),o||(o=_s(e,d)===0),o&&c>1&&(a===0&&c>2||d+ki>i))return a}else{if(c)return-1;break}n++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Xc[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=gn.createTrack("video"),this._audioTrack=gn.createTrack("audio",n),this._id3Track=gn.createTrack("id3"),this._txtTrack=gn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i,this._duration=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,n=!1){i||(this.sampleAes=null);let o;const a=this._videoTrack,c=this._audioTrack,d=this._id3Track,f=this._txtTrack;let l=a.pid,h=a.pesData,r=c.pid,u=d.pid,m=c.pesData,p=d.pesData,_=null,A=this.pmtParsed,E=this._pmtId,C=e.length;if(this.remainderData&&(e=ji(this.remainderData,e),C=e.length,this.remainderData=null),C<ki&&!n)return this.remainderData=e,{audioTrack:c,videoTrack:a,id3Track:d,textTrack:f};const k=Math.max(0,gn.syncOffset(e));C-=(C-k)%ki,C<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,C,e.buffer.byteLength-C));let O=0;for(let B=k;B<C;B+=ki)if(e[B]===71){const T=!!(e[B+1]&64),L=_s(e,B),I=(e[B+3]&48)>>4;let M;if(I>1){if(M=B+5+e[B+4],M===B+ki)continue}else M=B+4;switch(L){case l:if(T){if(h&&(o=Bn(h))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new Al;break;case"hevc":this.videoParser=new bl;break}this.videoParser!==null&&this.videoParser.parsePES(a,f,o,!1,this._duration)}h={data:[],size:0}}h&&(h.data.push(e.subarray(M,B+ki)),h.size+=B+ki-M);break;case r:if(T){if(m&&(o=Bn(m)))switch(c.segmentCodec){case"aac":this.parseAACPES(c,o);break;case"mp3":this.parseMPEGPES(c,o);break;case"ac3":this.parseAC3PES(c,o);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(M,B+ki)),m.size+=B+ki-M);break;case u:T&&(p&&(o=Bn(p))&&this.parseID3PES(d,o),p={data:[],size:0}),p&&(p.data.push(e.subarray(M,B+ki)),p.size+=B+ki-M);break;case 0:T&&(M+=e[M]+1),E=this._pmtId=ov(e,M);break;case E:{T&&(M+=e[M]+1);const K=lv(e,M,this.typeSupported,i);l=K.videoPid,l>0&&(a.pid=l,a.segmentCodec=K.segmentVideoCodec),r=K.audioPid,r>0&&(c.pid=r,c.segmentCodec=K.segmentAudioCodec),u=K.id3Pid,u>0&&(d.pid=u),_!==null&&!A&&(De.warn(`MPEG-TS PMT found at ${B} after unknown PID '${_}'. Backtracking to sync byte @${k} to parse all TS packets.`),_=null,B=k-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:_=L;break}}else O++;if(O>0){const B=new Error(`Found ${O} TS packet/s that do not start with 0x47`);this.observer.emit(W.ERROR,W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_PARSING_ERROR,fatal:!1,error:B,reason:B.message})}a.pesData=h,c.pesData=m,d.pesData=p;const G={audioTrack:c,videoTrack:a,id3Track:d,textTrack:f};return n&&this.extractRemainingSamples(G),G}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:n,textTrack:o}=e,a=i.pesData,c=t.pesData,d=n.pesData;let f;if(a&&(f=Bn(a))){if(this.videoParser===null)switch(i.segmentCodec){case"avc":this.videoParser=new Al;break;case"hevc":this.videoParser=new bl;break}this.videoParser!==null&&(this.videoParser.parsePES(i,o,f,!0,this._duration),i.pesData=null)}else i.pesData=a;if(c&&(f=Bn(c))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,f);break;case"mp3":this.parseMPEGPES(t,f);break;case"ac3":this.parseAC3PES(t,f);break}t.pesData=null}else c!=null&&c.size&&De.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=c;d&&(f=Bn(d))?(this.parseID3PES(n,f),n.pesData=null):n.pesData=d}demuxSampleAes(e,t,i){const n=this.demux(e,i,!0,!this.config.progressive),o=this.sampleAes=new sv(this.observer,this.config,t);return this.decrypt(n,o)}decrypt(e,t){return new Promise(i=>{const{audioTrack:n,videoTrack:o}=e;n.samples&&n.segmentCodec==="aac"?t.decryptAacSamples(n.samples,0,()=>{o.samples?t.decryptAvcSamples(o.samples,0,0,()=>{i(e)}):i(e)}):o.samples&&t.decryptAvcSamples(o.samples,0,0,()=>{i(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let i=0;const n=this.aacOverFlow;let o=t.data;if(n){this.aacOverFlow=null;const h=n.missing,r=n.sample.unit.byteLength;if(h===-1)o=ji(n.sample.unit,o);else{const u=r-h;n.sample.unit.set(o.subarray(0,h),u),e.samples.push(n.sample),i=n.missing}}let a,c;for(a=i,c=o.length;a<c-1&&!qr(o,a);a++);if(a!==i){let h;const r=a<c-1;r?h=`AAC PES did not start with ADTS header,offset:${a}`:h="No ADTS header found in AAC PES";const u=new Error(h);if(De.warn(`parsing error: ${h}`),this.observer.emit(W.ERROR,W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:u,reason:h}),!r)return}gd(e,this.observer,o,a,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(n){const h=yd(e.samplerate);d=n.sample.pts+h}else{De.warn("[tsdemuxer]: AAC PES unknown PTS");return}let f=0,l;for(;a<c;)if(l=_d(e,o,a,d,f),a+=l.length,l.missing){this.aacOverFlow=l;break}else for(f++;a<c-1&&!qr(o,a);a++);}parseMPEGPES(e,t){const i=t.data,n=i.length;let o=0,a=0;const c=t.pts;if(c===void 0){De.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<n;)if(bd(i,a)){const d=vd(e,i,a,c,o);if(d)a+=d.length,o++;else break}else a++}parseAC3PES(e,t){{const i=t.data,n=t.pts;if(n===void 0){De.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=i.length;let a=0,c=0,d;for(;c<o&&(d=xd(e,i,c,n,a++))>0;)c+=d}}parseID3PES(e,t){if(t.pts===void 0){De.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Ei({},t,{type:this._videoTrack?Wi.emsg:Wi.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function _s(s,e){return((s[e+1]&31)<<8)+s[e+2]}function ov(s,e){return(s[e+10]&31)<<8|s[e+11]}function lv(s,e,t,i){const n={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(s[e+1]&15)<<8|s[e+2],a=e+3+o-4,c=(s[e+10]&15)<<8|s[e+11];for(e+=12+c;e<a;){const d=_s(s,e),f=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!i){ja("ADTS AAC");break}case 15:n.audioPid===-1&&(n.audioPid=d);break;case 21:n.id3Pid===-1&&(n.id3Pid=d);break;case 219:if(!i){ja("H.264");break}case 27:n.videoPid===-1&&(n.videoPid=d,n.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?De.log("MPEG audio found, not supported in this browser"):n.audioPid===-1&&(n.audioPid=d,n.segmentAudioCodec="mp3");break;case 193:if(!i){ja("AC-3");break}case 129:t.ac3?n.audioPid===-1&&(n.audioPid=d,n.segmentAudioCodec="ac3"):De.log("AC-3 audio found, not supported in this browser");break;case 6:if(n.audioPid===-1&&f>0){let l=e+5,h=f;for(;h>2;){switch(s[l]){case 106:t.ac3!==!0?De.log("AC-3 audio found, not supported in this browser for now"):(n.audioPid=d,n.segmentAudioCodec="ac3");break}const u=s[l+1]+2;l+=u,h-=u}}break;case 194:case 135:De.warn("Unsupported EC-3 in M2TS found");break;case 36:n.videoPid===-1&&(n.videoPid=d,n.segmentVideoCodec="hevc",De.log("HEVC in M2TS found"));break}e+=f+5}return n}function ja(s){De.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function Bn(s){let e=0,t,i,n,o,a;const c=s.data;if(!s||s.size===0)return null;for(;c[0].length<19&&c.length>1;)c[0]=ji(c[0],c[1]),c.splice(1,1);if(t=c[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(i=(t[4]<<8)+t[5],i&&i>s.size-6)return null;const f=t[7];f&192&&(o=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,f&64?(a=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,o-a>60*9e4&&(De.warn(`${Math.round((o-a)/9e4)}s delta between PTS and DTS, align them`),o=a)):a=o),n=t[8];let l=n+9;if(s.size<=l)return null;s.size-=l;const h=new Uint8Array(s.size);for(let r=0,u=c.length;r<u;r++){t=c[r];let m=t.byteLength;if(l)if(l>m){l-=m;continue}else t=t.subarray(l),m-=l,l=0;h.set(t,e),e+=m}return i&&(i-=n+3),{data:h,pts:o,dts:a,len:i}}return null}class cv extends Xs{resetInitSegment(e,t,i,n){super.resetInitSegment(e,t,i,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=rr(e,0);let i=(t==null?void 0:t.length)||0;if(t&&e[i]===11&&e[i+1]===119&&js(t)!==void 0&&Ed(e,i)<=16)return!1;for(let n=e.length;i<n;i++)if(Sd(e,i))return De.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return tv(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return vd(e,t,i,this.basePTS,this.frameIndex)}}class Sl{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const mn=Math.pow(2,32)-1;class Ie{static init(){Ie.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Ie.types)Ie.types.hasOwnProperty(e)&&(Ie.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ie.HDLR_TYPES={video:t,audio:i};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);Ie.STTS=Ie.STSC=Ie.STCO=o,Ie.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ie.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ie.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ie.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);Ie.FTYP=Ie.box(Ie.types.ftyp,a,d,a,c),Ie.DINF=Ie.box(Ie.types.dinf,Ie.box(Ie.types.dref,n))}static box(e,...t){let i=8,n=t.length;const o=n;for(;n--;)i+=t[n].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(e,4),n=0,i=8;n<o;n++)a.set(t[n],i),i+=t[n].byteLength;return a}static hdlr(e){return Ie.box(Ie.types.hdlr,Ie.HDLR_TYPES[e])}static mdat(e){return Ie.box(Ie.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(mn+1)),n=Math.floor(t%(mn+1));return Ie.box(Ie.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return Ie.box(Ie.types.mdia,Ie.mdhd(e.timescale,e.duration),Ie.hdlr(e.type),Ie.minf(e))}static mfhd(e){return Ie.box(Ie.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Ie.box(Ie.types.minf,Ie.box(Ie.types.smhd,Ie.SMHD),Ie.DINF,Ie.stbl(e)):Ie.box(Ie.types.minf,Ie.box(Ie.types.vmhd,Ie.VMHD),Ie.DINF,Ie.stbl(e))}static moof(e,t,i){return Ie.box(Ie.types.moof,Ie.mfhd(e),Ie.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=Ie.trak(e[t]);return Ie.box.apply(null,[Ie.types.moov,Ie.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(Ie.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=Ie.trex(e[t]);return Ie.box.apply(null,[Ie.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(mn+1)),n=Math.floor(t%(mn+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ie.box(Ie.types.mvhd,o)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let n,o;for(n=0;n<t.length;n++)o=t[n].flags,i[n+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return Ie.box(Ie.types.sdtp,i)}static stbl(e){return Ie.box(Ie.types.stbl,Ie.stsd(e),Ie.box(Ie.types.stts,Ie.STTS),Ie.box(Ie.types.stsc,Ie.STSC),Ie.box(Ie.types.stsz,Ie.STSZ),Ie.box(Ie.types.stco,Ie.STCO))}static avc1(e){let t=[],i=[],n,o,a;for(n=0;n<e.sps.length;n++)o=e.sps[n],a=o.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(o));for(n=0;n<e.pps.length;n++)o=e.pps[n],a=o.byteLength,i.push(a>>>8&255),i.push(a&255),i=i.concat(Array.prototype.slice.call(o));const c=Ie.box(Ie.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),d=e.width,f=e.height,l=e.pixelRatio[0],h=e.pixelRatio[1];return Ie.box(Ie.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,Ie.box(Ie.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ie.box(Ie.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,l&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Ie.box(Ie.types.mp4a,Ie.audioStsd(e),Ie.box(Ie.types.esds,Ie.esds(e)))}static mp3(e){return Ie.box(Ie.types[".mp3"],Ie.audioStsd(e))}static ac3(e){return Ie.box(Ie.types["ac-3"],Ie.audioStsd(e),Ie.box(Ie.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?Ie.box(Ie.types.stsd,Ie.STSD,Ie.mp3(e)):e.segmentCodec==="ac3"?Ie.box(Ie.types.stsd,Ie.STSD,Ie.ac3(e)):Ie.box(Ie.types.stsd,Ie.STSD,Ie.mp4a(e)):e.segmentCodec==="avc"?Ie.box(Ie.types.stsd,Ie.STSD,Ie.avc1(e)):Ie.box(Ie.types.stsd,Ie.STSD,Ie.hvc1(e))}static tkhd(e){const t=e.id,i=e.duration*e.timescale,n=e.width,o=e.height,a=Math.floor(i/(mn+1)),c=Math.floor(i%(mn+1));return Ie.box(Ie.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,o>>8&255,o&255,0,0]))}static traf(e,t){const i=Ie.sdtp(e),n=e.id,o=Math.floor(t/(mn+1)),a=Math.floor(t%(mn+1));return Ie.box(Ie.types.traf,Ie.box(Ie.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),Ie.box(Ie.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255])),Ie.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,Ie.box(Ie.types.trak,Ie.tkhd(e),Ie.mdia(e))}static trex(e){const t=e.id;return Ie.box(Ie.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],n=i.length,o=12+16*n,a=new Uint8Array(o);let c,d,f,l,h,r;for(t+=8+o,a.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),c=0;c<n;c++)d=i[c],f=d.duration,l=d.size,h=d.flags,r=d.cts,a.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,l>>>24&255,l>>>16&255,l>>>8&255,l&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&61440,h.degradPrio&15,r>>>24&255,r>>>16&255,r>>>8&255,r&255],12+16*c);return Ie.box(Ie.types.trun,a)}static initSegment(e){Ie.types||Ie.init();const t=Ie.moov(e);return ji(Ie.FTYP,t)}static hvc1(e){const t=e.params,i=[e.vps,e.sps,e.pps],n=4,o=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),n-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),i.length]);let a=o.length;for(let m=0;m<i.length;m+=1){a+=3;for(let p=0;p<i[m].length;p+=1)a+=2+i[m][p].length}const c=new Uint8Array(a);c.set(o,0),a=o.length;const d=i.length-1;for(let m=0;m<i.length;m+=1){c.set(new Uint8Array([32+m|(m===d?128:0),0,i[m].length]),a),a+=3;for(let p=0;p<i[m].length;p+=1)c.set(new Uint8Array([i[m][p].length>>8,i[m][p].length&255]),a),a+=2,c.set(i[m][p],a),a+=i[m][p].length}const f=Ie.box(Ie.types.hvcC,c),l=e.width,h=e.height,r=e.pixelRatio[0],u=e.pixelRatio[1];return Ie.box(Ie.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,Ie.box(Ie.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ie.box(Ie.types.pasp,new Uint8Array([r>>24,r>>16&255,r>>8&255,r&255,u>>24,u>>16&255,u>>8&255,u&255])))}}Ie.types=void 0;Ie.HDLR_TYPES=void 0;Ie.STTS=void 0;Ie.STSC=void 0;Ie.STCO=void 0;Ie.STSZ=void 0;Ie.VMHD=void 0;Ie.SMHD=void 0;Ie.STSD=void 0;Ie.FTYP=void 0;Ie.DINF=void 0;const wd=9e4;function Zs(s,e,t=1,i=!1){const n=s*e*t;return i?Math.round(n):n}function dv(s,e,t=1,i=!1){return Zs(s,e,1/t,i)}function er(s,e=!1){return Zs(s,1e3,1/wd,e)}function hv(s,e=1){return Zs(s,wd,1/e)}const uv=10*1e3,El=1024,fv=1152,pv=1536;let Mn=null,Ha=null;class Tr{constructor(e,t,i,n=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,Mn===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Mn=a?parseInt(a[1]):0}if(Ha===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);Ha=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){De.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){De.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){De.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e.reduce((n,o)=>{const a=o.pts-n;return a<-4294967296?(t=!0,$i(n,o.pts)):a>0?n:o.pts},e[0].pts);return t&&De.debug("PTS rollover detected"),i}remux(e,t,i,n,o,a,c,d){let f,l,h,r,u,m,p=o,_=o;const A=e.pid>-1,E=t.pid>-1,C=t.samples.length,k=e.samples.length>0,O=c&&C>0||C>1;if((!A||k)&&(!E||O)||this.ISGenerated||c){if(this.ISGenerated){var B,T,L,I;const ae=this.videoTrackConfig;ae&&(t.width!==ae.width||t.height!==ae.height||((B=t.pixelRatio)==null?void 0:B[0])!==((T=ae.pixelRatio)==null?void 0:T[0])||((L=t.pixelRatio)==null?void 0:L[1])!==((I=ae.pixelRatio)==null?void 0:I[1]))&&this.resetInitSegment()}else h=this.generateIS(e,t,o,a);const M=this.isVideoContiguous;let K=-1,re;if(O&&(K=mv(t.samples),!M&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,K>0){De.warn(`[mp4-remuxer]: Dropped ${K} out of ${C} video samples due to a missing keyframe`);const ae=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(K),t.dropped+=K,_+=(t.samples[0].pts-ae)/t.inputTimeScale,re=_}else K===-1&&(De.warn(`[mp4-remuxer]: No keyframe found out of ${C} video samples`),m=!1);if(this.ISGenerated){if(k&&O){const ae=this.getVideoStartPts(t.samples),ne=($i(e.samples[0].pts,ae)-ae)/t.inputTimeScale;p+=Math.max(0,ne),_+=Math.max(0,-ne)}if(k){if(e.samplerate||(De.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(e,t,o,a)),l=this.remuxAudio(e,p,this.isAudioContiguous,a,E||O||d===Rt.AUDIO?_:void 0),O){const ae=l?l.endPTS-l.startPTS:0;t.inputTimeScale||(De.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(e,t,o,a)),f=this.remuxVideo(t,_,M,ae)}}else O&&(f=this.remuxVideo(t,_,M,0));f&&(f.firstKeyFrame=K,f.independent=K!==-1,f.firstKeyFramePTS=re)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(u=Td(i,o,this._initPTS,this._initDTS)),n.samples.length&&(r=kd(n,o,this._initPTS))),{audio:l,video:f,initSegment:h,independent:m,text:r,id3:u}}generateIS(e,t,i,n){const o=e.samples,a=t.samples,c=this.typeSupported,d={},f=this._initPTS;let l=!f||n,h="audio/mp4",r,u,m;if(l&&(r=u=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":c.mpeg?(h="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:h,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&c.mpeg?new Uint8Array(0):Ie.initSegment([e]),metadata:{channelCount:e.channelCount}},l&&(m=e.inputTimeScale,!f||m!==f.timescale?r=u=o[0].pts-Math.round(m*i):l=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Ie.initSegment([t]),metadata:{width:t.width,height:t.height}},l)if(m=t.inputTimeScale,!f||m!==f.timescale){const p=this.getVideoStartPts(a),_=Math.round(m*i);u=Math.min(u,$i(a[0].dts,p)-_),r=Math.min(r,p-_)}else l=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,l?(this._initPTS={baseTime:r,timescale:m},this._initDTS={baseTime:u,timescale:m}):r=m=void 0,{tracks:d,initPTS:r,timescale:m}}remuxVideo(e,t,i,n){const o=e.inputTimeScale,a=e.samples,c=[],d=a.length,f=this._initPTS;let l=this.nextAvcDts,h=8,r=this.videoSampleDuration,u,m,p=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,A=!1;if(!i||l===null){const F=t*o,y=a[0].pts-$i(a[0].dts,a[0].pts);Mn&&l!==null&&Math.abs(F-y-l)<15e3?i=!0:l=F-y}const E=f.baseTime*o/f.timescale;for(let F=0;F<d;F++){const y=a[F];y.pts=$i(y.pts-E,l),y.dts=$i(y.dts-E,l),y.dts<a[F>0?F-1:F].dts&&(A=!0)}A&&a.sort(function(F,y){const v=F.dts-y.dts,S=F.pts-y.pts;return v||S}),u=a[0].dts,m=a[a.length-1].dts;const C=m-u,k=C?Math.round(C/(d-1)):r||e.inputTimeScale/30;if(i){const F=u-l,y=F>k,v=F<-1;if((y||v)&&(y?De.warn(`${(e.segmentCodec||"").toUpperCase()}: ${er(F,!0)} ms (${F}dts) hole between fragments detected at ${t.toFixed(3)}`):De.warn(`${(e.segmentCodec||"").toUpperCase()}: ${er(-F,!0)} ms (${F}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!v||l>=a[0].pts||Mn)){u=l;const S=a[0].pts-F;if(y)a[0].dts=u,a[0].pts=S;else for(let w=0;w<a.length&&!(a[w].dts>S);w++)a[w].dts-=F,a[w].pts-=F;De.log(`Video: Initial PTS/DTS adjusted: ${er(S,!0)}/${er(u,!0)}, delta: ${er(F,!0)} ms`)}}u=Math.max(0,u);let O=0,G=0,B=u;for(let F=0;F<d;F++){const y=a[F],v=y.units,S=v.length;let w=0;for(let x=0;x<S;x++)w+=v[x].data.length;G+=w,O+=S,y.length=w,y.dts<B?(y.dts=B,B+=k/4|0||1):B=y.dts,p=Math.min(y.pts,p),_=Math.max(y.pts,_)}m=a[d-1].dts;const T=G+4*O+8;let L;try{L=new Uint8Array(T)}catch(F){this.observer.emit(W.ERROR,W.ERROR,{type:Lt.MUX_ERROR,details:Ve.REMUX_ALLOC_ERROR,fatal:!1,error:F,bytes:T,reason:`fail allocating video mdat ${T}`});return}const I=new DataView(L.buffer);I.setUint32(0,T),L.set(Ie.types.mdat,4);let M=!1,K=Number.POSITIVE_INFINITY,re=Number.POSITIVE_INFINITY,ae=Number.NEGATIVE_INFINITY,te=Number.NEGATIVE_INFINITY;for(let F=0;F<d;F++){const y=a[F],v=y.units;let S=0;for(let D=0,U=v.length;D<U;D++){const j=v[D],X=j.data,ee=j.data.byteLength;I.setUint32(h,ee),h+=4,L.set(X,h),h+=ee,S+=4+ee}let w;if(F<d-1)r=a[F+1].dts-y.dts,w=a[F+1].pts-y.pts;else{const D=this.config,U=F>0?y.dts-a[F-1].dts:k;if(w=F>0?y.pts-a[F-1].pts:k,D.stretchShortVideoTrack&&this.nextAudioPts!==null){const j=Math.floor(D.maxBufferHole*o),X=(n?p+n*o:this.nextAudioPts)-y.pts;X>j?(r=X-U,r<0?r=U:M=!0,De.log(`[mp4-remuxer]: It is approximately ${X/90} ms to the next segment; using duration ${r/90} ms for the last video frame.`)):r=U}else r=U}const x=Math.round(y.pts-y.dts);K=Math.min(K,r),ae=Math.max(ae,r),re=Math.min(re,w),te=Math.max(te,w),c.push(new xl(y.key,r,S,x))}if(c.length){if(Mn){if(Mn<70){const F=c[0].flags;F.dependsOn=2,F.isNonSync=0}}else if(Ha&&te-re<ae-K&&k/ae<.025&&c[0].cts===0){De.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let F=u;for(let y=0,v=c.length;y<v;y++){const S=F+c[y].duration,w=F+c[y].cts;if(y<v-1){const x=S+c[y+1].cts;c[y].duration=x-w}else c[y].duration=y?c[y-1].duration:k;c[y].cts=0,F=S}}}r=M||!r?k:r,this.nextAvcDts=l=m+r,this.videoSampleDuration=r,this.isVideoContiguous=!0;const Ae={data1:Ie.moof(e.sequenceNumber++,u,Ei({},e,{samples:c})),data2:L,startPTS:p/o,endPTS:(_+r)/o,startDTS:u/o,endDTS:l/o,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Ae}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return fv;case"ac3":return pv;default:return El}}remuxAudio(e,t,i,n,o){const a=e.inputTimeScale,c=e.samplerate?e.samplerate:a,d=a/c,f=this.getSamplesPerFrame(e),l=f*d,h=this._initPTS,r=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,u=[],m=o!==void 0;let p=e.samples,_=r?0:8,A=this.nextAudioPts||-1;const E=t*a,C=h.baseTime*a/h.timescale;if(this.isAudioContiguous=i=i||p.length&&A>0&&(n&&Math.abs(E-A)<9e3||Math.abs($i(p[0].pts-C,E)-A)<20*l),p.forEach(function(ne){ne.pts=$i(ne.pts-C,E)}),!i||A<0){if(p=p.filter(ne=>ne.pts>=0),!p.length)return;o===0?A=0:n&&!m?A=Math.max(0,E):A=p[0].pts}if(e.segmentCodec==="aac"){const ne=this.config.maxAudioFramesDrift;for(let me=0,Ae=A;me<p.length;me++){const F=p[me],y=F.pts,v=y-Ae,S=Math.abs(1e3*v/a);if(v<=-ne*l&&m)me===0&&(De.warn(`Audio frame @ ${(y/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*v/a)} ms.`),this.nextAudioPts=A=Ae=y);else if(v>=ne*l&&S<uv&&m){let w=Math.round(v/l);Ae=y-w*l,Ae<0&&(w--,Ae+=l),me===0&&(this.nextAudioPts=A=Ae),De.warn(`[mp4-remuxer]: Injecting ${w} audio frame @ ${(Ae/a).toFixed(3)}s due to ${Math.round(1e3*v/a)} ms gap.`);for(let x=0;x<w;x++){const D=Math.max(Ae,0);let U=Sl.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);U||(De.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),U=F.unit.subarray()),p.splice(me,0,{unit:U,pts:D}),Ae+=l,me++}}F.pts=Ae,Ae+=l}}let k=null,O=null,G,B=0,T=p.length;for(;T--;)B+=p[T].unit.byteLength;for(let ne=0,me=p.length;ne<me;ne++){const Ae=p[ne],F=Ae.unit;let y=Ae.pts;if(O!==null){const S=u[ne-1];S.duration=Math.round((y-O)/d)}else if(i&&e.segmentCodec==="aac"&&(y=A),k=y,B>0){B+=_;try{G=new Uint8Array(B)}catch(S){this.observer.emit(W.ERROR,W.ERROR,{type:Lt.MUX_ERROR,details:Ve.REMUX_ALLOC_ERROR,fatal:!1,error:S,bytes:B,reason:`fail allocating audio mdat ${B}`});return}r||(new DataView(G.buffer).setUint32(0,B),G.set(Ie.types.mdat,4))}else return;G.set(F,_);const v=F.byteLength;_+=v,u.push(new xl(!0,f,v,0)),O=y}const L=u.length;if(!L)return;const I=u[u.length-1];this.nextAudioPts=A=O+d*I.duration;const M=r?new Uint8Array(0):Ie.moof(e.sequenceNumber++,k/d,Ei({},e,{samples:u}));e.samples=[];const K=k/a,re=A/a,te={data1:M,data2:G,startPTS:K,endPTS:re,startDTS:K,endDTS:re,type:"audio",hasAudio:!0,hasVideo:!1,nb:L};return this.isAudioContiguous=!0,te}remuxEmptyAudio(e,t,i,n){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,c=o/a,d=this.nextAudioPts,f=this._initDTS,l=f.baseTime*9e4/f.timescale,h=(d!==null?d:n.startDTS*o)+l,r=n.endDTS*o+l,u=c*El,m=Math.ceil((r-h)/u),p=Sl.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(De.warn("[mp4-remuxer]: remux empty Audio"),!p){De.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const _=[];for(let A=0;A<m;A++){const E=h+A*u;_.push({unit:p,pts:E,dts:E})}return e.samples=_,this.remuxAudio(e,t,i,!1)}}function $i(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function mv(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function Td(s,e,t,i){const n=s.samples.length;if(!n)return;const o=s.inputTimeScale;for(let c=0;c<n;c++){const d=s.samples[c];d.pts=$i(d.pts-t.baseTime*o/t.timescale,e*o)/o,d.dts=$i(d.dts-i.baseTime*o/i.timescale,e*o)/o}const a=s.samples;return s.samples=[],{samples:a}}function kd(s,e,t){const i=s.samples.length;if(!i)return;const n=s.inputTimeScale;for(let a=0;a<i;a++){const c=s.samples[a];c.pts=$i(c.pts-t.baseTime*n/t.timescale,e*n)/n}s.samples.sort((a,c)=>a.pts-c.pts);const o=s.samples;return s.samples=[],{samples:o}}class xl{constructor(e,t,i,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=n,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class gv{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,i,n){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(wy(e,n)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const n=this.initData=Zc(e);n.audio&&(t=Cl(n.audio,Zt.AUDIO)),n.video&&(i=Cl(n.video,Zt.VIDEO));const o={};n.audio&&n.video?o.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:n.audio?o.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?o.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:De.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=o}remux(e,t,i,n,o,a){var c,d;let{initPTS:f,lastEndTime:l}=this;const h={audio:void 0,video:void 0,text:n,id3:i,initSegment:void 0};vt(l)||(l=this.lastEndTime=o||0);const r=t.samples;if(!(r!=null&&r.length))return h;const u={initPTS:void 0,timescale:1};let m=this.initData;if((c=m)!=null&&c.length||(this.generateInitSegment(r),m=this.initData),!((d=m)!=null&&d.length))return De.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(u.tracks=this.initTracks,this.emitInitSegment=!1);const p=ky(r,m),_=Ty(m,r),A=_===null?o:_;(yv(f,A,o,p)||u.timescale!==f.timescale&&a)&&(u.initPTS=A-o,f&&f.timescale===1&&De.warn(`Adjusting initPTS by ${u.initPTS-f.baseTime}`),this.initPTS=f={baseTime:u.initPTS,timescale:1});const E=e?A-f.baseTime/f.timescale:l,C=E+p;Ly(m,r,f.baseTime/f.timescale),p>0?this.lastEndTime=C:(De.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!m.audio,O=!!m.video;let G="";k&&(G+="audio"),O&&(G+="video");const B={data1:r,startPTS:E,startDTS:E,endPTS:C,endDTS:C,type:G,hasAudio:k,hasVideo:O,nb:1,dropped:0};return h.audio=B.type==="audio"?B:void 0,h.video=B.type!=="audio"?B:void 0,h.initSegment=u,h.id3=Td(i,o,f,f),n.samples.length&&(h.text=kd(n,o,f)),h}}function yv(s,e,t,i){if(s===null)return!0;const n=Math.max(i,1),o=e-s.baseTime/s.timescale;return Math.abs(o-t)>n}function Cl(s,e){const t=s==null?void 0:s.codec;if(t&&t.length>4)return t;if(e===Zt.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return Gr(t,!1);const i="mp4a.40.5";return De.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${i}"`),i}return De.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let pn;try{pn=self.performance.now.bind(self.performance)}catch{De.debug("Unable to use Performance API on this environment"),pn=Kn==null?void 0:Kn.Date.now}const kr=[{demux:rv,remux:gv},{demux:gn,remux:Tr},{demux:iv,remux:Tr},{demux:cv,remux:Tr}];kr.splice(2,0,{demux:av,remux:Tr});class wl{constructor(e,t,i,n,o){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=n,this.id=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,n){const o=i.transmuxing;o.executeStart=pn();let a=new Uint8Array(e);const{currentTransmuxState:c,transmuxConfig:d}=this;n&&(this.currentTransmuxState=n);const{contiguous:f,discontinuity:l,trackSwitch:h,accurateTimeOffset:r,timeOffset:u,initSegmentChange:m}=n||c,{audioCodec:p,videoCodec:_,defaultInitPts:A,duration:E,initSegmentData:C}=d,k=_v(a,t);if(k&&k.method==="AES-128"){const T=this.getDecrypter();if(T.isSync()){let L=T.softwareDecrypt(a,k.key.buffer,k.iv.buffer);if(i.part>-1&&(L=T.flush()),!L)return o.executeEnd=pn(),za(i);a=new Uint8Array(L)}else return this.decryptionPromise=T.webCryptoDecrypt(a,k.key.buffer,k.iv.buffer).then(L=>{const I=this.push(L,null,i);return this.decryptionPromise=null,I}),this.decryptionPromise}const O=this.needsProbing(l,h);if(O){const T=this.configureTransmuxer(a);if(T)return De.warn(`[transmuxer] ${T.message}`),this.observer.emit(W.ERROR,W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_PARSING_ERROR,fatal:!1,error:T,reason:T.message}),o.executeEnd=pn(),za(i)}(l||h||m||O)&&this.resetInitSegment(C,p,_,E,t),(l||m||O)&&this.resetInitialTimestamp(A),f||this.resetContiguity();const G=this.transmux(a,k,u,r,i),B=this.currentTransmuxState;return B.contiguous=!0,B.discontinuity=!1,B.trackSwitch=!1,o.executeEnd=pn(),G}flush(e){const t=e.transmuxing;t.executeStart=pn();const{decrypter:i,currentTransmuxState:n,decryptionPromise:o}=this;if(o)return o.then(()=>this.flush(e));const a=[],{timeOffset:c}=n;if(i){const h=i.flush();h&&a.push(this.push(h,null,e))}const{demuxer:d,remuxer:f}=this;if(!d||!f)return t.executeEnd=pn(),[za(e)];const l=d.flush(c);return Rr(l)?l.then(h=>(this.flushRemux(a,h,e),a)):(this.flushRemux(a,l,e),a)}flushRemux(e,t,i){const{audioTrack:n,videoTrack:o,id3Track:a,textTrack:c}=t,{accurateTimeOffset:d,timeOffset:f}=this.currentTransmuxState;De.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const l=this.remuxer.remux(n,o,a,c,f,d,!0,this.id);e.push({remuxResult:l,chunkMeta:i}),i.transmuxing.executeEnd=pn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,n,o){const{demuxer:a,remuxer:c}=this;!a||!c||(a.resetInitSegment(e,t,i,n),c.resetInitSegment(e,t,i,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,n,o){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,i,n,o):a=this.transmuxUnencrypted(e,i,n,o),a}transmuxUnencrypted(e,t,i,n){const{audioTrack:o,videoTrack:a,id3Track:c,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,a,c,d,t,i,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,i,n,o){return this.demuxer.demuxSampleAes(e,t,i).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,i,n,!1,this.id),chunkMeta:o}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:n,vendor:o}=this;let a;for(let r=0,u=kr.length;r<u;r++){var c;if((c=kr[r].demux)!=null&&c.probe(e)){a=kr[r];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const d=this.demuxer,f=this.remuxer,l=a.remux,h=a.demux;(!f||!(f instanceof l))&&(this.remuxer=new l(i,t,n,o)),(!d||!(d instanceof h))&&(this.demuxer=new h(i,t,n),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Ws(this.config)),e}}function _v(s,e){let t=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const za=s=>({remuxResult:{},chunkMeta:s});function Rr(s){return"then"in s&&s.then instanceof Function}class vv{constructor(e,t,i,n,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=n,this.defaultInitPts=o||null}}class Av{constructor(e,t,i,n,o,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=n,this.timeOffset=o,this.initSegmentChange=a}}var Rd={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(d,f,l){this.fn=d,this.context=f,this.once=l||!1}function o(d,f,l,h,r){if(typeof l!="function")throw new TypeError("The listener must be a function");var u=new n(l,h||d,r),m=t?t+f:f;return d._events[m]?d._events[m].fn?d._events[m]=[d._events[m],u]:d._events[m].push(u):(d._events[m]=u,d._eventsCount++),d}function a(d,f){--d._eventsCount===0?d._events=new i:delete d._events[f]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],l,h;if(this._eventsCount===0)return f;for(h in l=this._events)e.call(l,h)&&f.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(l)):f},c.prototype.listeners=function(f){var l=t?t+f:f,h=this._events[l];if(!h)return[];if(h.fn)return[h.fn];for(var r=0,u=h.length,m=new Array(u);r<u;r++)m[r]=h[r].fn;return m},c.prototype.listenerCount=function(f){var l=t?t+f:f,h=this._events[l];return h?h.fn?1:h.length:0},c.prototype.emit=function(f,l,h,r,u,m){var p=t?t+f:f;if(!this._events[p])return!1;var _=this._events[p],A=arguments.length,E,C;if(_.fn){switch(_.once&&this.removeListener(f,_.fn,void 0,!0),A){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,l),!0;case 3:return _.fn.call(_.context,l,h),!0;case 4:return _.fn.call(_.context,l,h,r),!0;case 5:return _.fn.call(_.context,l,h,r,u),!0;case 6:return _.fn.call(_.context,l,h,r,u,m),!0}for(C=1,E=new Array(A-1);C<A;C++)E[C-1]=arguments[C];_.fn.apply(_.context,E)}else{var k=_.length,O;for(C=0;C<k;C++)switch(_[C].once&&this.removeListener(f,_[C].fn,void 0,!0),A){case 1:_[C].fn.call(_[C].context);break;case 2:_[C].fn.call(_[C].context,l);break;case 3:_[C].fn.call(_[C].context,l,h);break;case 4:_[C].fn.call(_[C].context,l,h,r);break;default:if(!E)for(O=1,E=new Array(A-1);O<A;O++)E[O-1]=arguments[O];_[C].fn.apply(_[C].context,E)}}return!0},c.prototype.on=function(f,l,h){return o(this,f,l,h,!1)},c.prototype.once=function(f,l,h){return o(this,f,l,h,!0)},c.prototype.removeListener=function(f,l,h,r){var u=t?t+f:f;if(!this._events[u])return this;if(!l)return a(this,u),this;var m=this._events[u];if(m.fn)m.fn===l&&(!r||m.once)&&(!h||m.context===h)&&a(this,u);else{for(var p=0,_=[],A=m.length;p<A;p++)(m[p].fn!==l||r&&!m[p].once||h&&m[p].context!==h)&&_.push(m[p]);_.length?this._events[u]=_.length===1?_[0]:_:a(this,u)}return this},c.prototype.removeAllListeners=function(f){var l;return f?(l=t?t+f:f,this._events[l]&&a(this,l)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,s.exports=c})(Rd);var bv=Rd.exports,eo=Kg(bv);class Ld{constructor(e,t,i,n){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const o=e.config;this.hls=e,this.id=t,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=i,this.onFlush=n;const a=(l,h)=>{h=h||{},h.frag=this.frag,h.id=this.id,l===W.ERROR&&(this.error=h.error),this.hls.trigger(l,h)};this.observer=new eo,this.observer.on(W.FRAG_DECRYPTED,a),this.observer.on(W.ERROR,a);const c=Jn(o.preferManagedMediaSource)||{isTypeSupported:()=>!1},d={mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:c.isTypeSupported('audio/mp4; codecs="ac-3"')},f=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(o.workerPath||V_())){try{o.workerPath?(De.log(`loading Web Worker ${o.workerPath} for "${t}"`),this.workerContext=H_(o.workerPath)):(De.log(`injecting Web Worker for "${t}"`),this.workerContext=j_()),this.onwmsg=r=>this.onWorkerMessage(r);const{worker:h}=this.workerContext;h.addEventListener("message",this.onwmsg),h.onerror=r=>{const u=new Error(`${r.message}  (${r.filename}:${r.lineno})`);o.enableWorker=!1,De.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(W.ERROR,{type:Lt.OTHER_ERROR,details:Ve.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})},h.postMessage({cmd:"init",typeSupported:d,vendor:f,id:t,config:JSON.stringify(o)})}catch(h){De.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.resetWorker(),this.error=null,this.transmuxer=new wl(this.observer,d,o,f,t)}return}this.transmuxer=new wl(this.observer,d,o,f,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,i,n,o,a,c,d,f,l){var h,r;f.transmuxing.start=self.performance.now();const{transmuxer:u}=this,m=a?a.start:o.start,p=o.decryptdata,_=this.frag,A=!(_&&o.cc===_.cc),E=!(_&&f.level===_.level),C=_?f.sn-_.sn:-1,k=this.part?f.part-this.part.index:-1,O=C===0&&f.id>1&&f.id===(_==null?void 0:_.stats.chunkCount),G=!E&&(C===1||C===0&&(k===1||O&&k<=0)),B=self.performance.now();(E||C||o.stats.parsing.start===0)&&(o.stats.parsing.start=B),a&&(k||!G)&&(a.stats.parsing.start=B);const T=!(_&&((h=o.initSegment)==null?void 0:h.url)===((r=_.initSegment)==null?void 0:r.url)),L=new Av(A,G,d,E,m,T);if(!G||A||T){De.log(`[transmuxer-interface, ${o.type}]: Starting new transmux session for sn: ${f.sn} p: ${f.part} level: ${f.level} id: ${f.id}
        discontinuity: ${A}
        trackSwitch: ${E}
        contiguous: ${G}
        accurateTimeOffset: ${d}
        timeOffset: ${m}
        initSegmentChange: ${T}`);const I=new vv(i,n,t,c,l);this.configureTransmuxer(I)}if(this.frag=o,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:f,state:L},e instanceof ArrayBuffer?[e]:[]);else if(u){const I=u.push(e,p,f,L);Rr(I)?(u.async=!0,I.then(M=>{this.handleTransmuxComplete(M)}).catch(M=>{this.transmuxerError(M,f,"transmuxer-interface push error")})):(u.async=!1,this.handleTransmuxComplete(I))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let i=t.flush(e);Rr(i)||t.async?(Rr(i)||(i=Promise.resolve(i)),i.then(o=>{this.handleFlushResult(o,e)}).catch(o=>{this.transmuxerError(o,e,"transmuxer-interface flush error")})):this.handleFlushResult(i,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,i=this.hls;switch(t.event){case"init":{var n;const o=(n=this.workerContext)==null?void 0:n.objectURL;o&&self.URL.revokeObjectURL(o);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":De[t.data.logType]&&De[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function Id(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!Yn(s[t].attrs,e[t].attrs))return!1;return!0}function Yn(s,e,t){const i=s["STABLE-RENDITION-ID"];return i&&!t?i===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>s[n]!==e[n])}function vs(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}const Tl=100;class Sv extends Ys{constructor(e,t,i){super(e,t,i,"[audio-stream-controller]",Rt.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(W.ERROR,this.onError,this),e.on(W.BUFFER_RESET,this.onBufferReset,this),e.on(W.BUFFER_CREATED,this.onBufferCreated,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(W.ERROR,this.onError,this),e.off(W.BUFFER_RESET,this.onBufferReset,this),e.off(W.BUFFER_CREATED,this.onBufferCreated,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:i,initPTS:n,timescale:o}){if(i==="main"){const a=t.cc;this.initPTS[t.cc]={baseTime:n,timescale:o},this.log(`InitPTS for cc: ${a} found from main: ${n}`),this.videoTrackCC=a,this.state===Xe.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=Xe.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(Tl),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=Xe.IDLE):(this.loadedmetadata=!1,this.state=Xe.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Xe.IDLE:this.doTickIdle();break;case Xe.WAITING_TRACK:{var e;const{levels:i,trackId:n}=this,o=i==null||(e=i[n])==null?void 0:e.details;if(o){if(this.waitForCdnTuneIn(o))break;this.state=Xe.WAITING_INIT_PTS}break}case Xe.FRAG_LOADING_WAITING_RETRY:{var t;const i=performance.now(),n=this.retryDate;if(!n||i>=n||(t=this.media)!=null&&t.seeking){const{levels:o,trackId:a}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((o==null?void 0:o[a])||null),this.state=Xe.IDLE}break}case Xe.WAITING_INIT_PTS:{const i=this.waitingData;if(i){const{frag:n,part:o,cache:a,complete:c}=i;if(this.initPTS[n.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Xe.FRAG_LOADING;const d=a.flush(),f={frag:n,part:o,payload:d,networkDetails:null};this._handleFragmentLoadProgress(f),c&&super._handleFragmentLoadComplete(f)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${n.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const d=this.getLoadPosition(),f=li.bufferInfo(this.mediaBuffer,d,this.config.maxBufferHole);ys(f.end,this.config.maxFragLookUpTolerance,n)<0&&(this.log(`Waiting fragment cc (${n.cc}) @ ${n.start} cancelled because another fragment at ${f.end} is needed`),this.clearWaitingFragment())}}else this.state=Xe.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Xe.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:i,trackId:n}=this,o=e.config;if(!i&&(this.startFragRequested||!o.startFragPrefetch)||!(t!=null&&t[n]))return;const a=t[n],c=a.details;if(!c||c.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(c)){this.state=Xe.WAITING_TRACK;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,Zt.AUDIO,Rt.AUDIO));const f=this.getFwdBufferInfo(d,Rt.AUDIO);if(f===null)return;const{bufferedTrack:l,switchingTrack:h}=this;if(!h&&this._streamEnded(f,c)){e.trigger(W.BUFFER_EOS,{type:"audio"}),this.state=Xe.ENDED;return}const r=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Rt.MAIN),u=f.len,m=this.getMaxBufferLength(r==null?void 0:r.len),p=c.fragments,_=p[0].start;let A=this.flushing?this.getLoadPosition():f.end;if(h&&i){const O=this.getLoadPosition();l&&!Yn(h.attrs,l.attrs)&&(A=O),c.PTSKnown&&O<_&&(f.end>_||f.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=_+.05)}if(u>=m&&!h&&A<p[p.length-1].start)return;let E=this.getNextFragment(A,c),C=!1;if(E&&this.isLoopLoading(E,A)&&(C=!!E.gap,E=this.getNextFragmentLoopLoading(E,c,f,Rt.MAIN,m)),!E){this.bufferFlushed=!0;return}const k=r&&E.start>r.end+c.targetduration;if(k||!(r!=null&&r.len)&&f.len){const O=this.getAppendedFrag(E.start,Rt.MAIN);if(O===null||(C||(C=!!O.gap||!!k&&r.len===0),k&&!C||C&&f.nextStart&&f.nextStart<O.end))return}this.loadFragment(E,a,A)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new Wn(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),i?this.setInterval(Tl):this.resetTransmuxer(),i?(this.switchingTrack=t,this.state=Xe.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Xe.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(W.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var i;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:n}=this,{details:o,id:a}=t;if(!n){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Audio track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const c=n[a];let d=0;if(o.live||(i=c.details)!=null&&i.live){this.checkLiveUpdate(o);const l=this.mainDetails;if(o.deltaUpdateFailed||!l)return;if(!c.details&&o.hasProgramDateTime&&l.hasProgramDateTime)zr(o,l),d=o.fragments[0].start;else{var f;d=this.alignPlaylists(o,c.details,(f=this.levelLastLoaded)==null?void 0:f.details)}}c.details=o,this.levelLastLoaded=c,!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(c.details,d),this.state===Xe.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=Xe.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:n,payload:o}=e,{config:a,trackId:c,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const f=d[c];if(!f){this.warn("Audio track is undefined on fragment load progress");return}const l=f.details;if(!l){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const h=a.defaultAudioCodec||f.audioCodec||"mp4a.40.2";let r=this.transmuxer;r||(r=this.transmuxer=new Ld(this.hls,Rt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const u=this.initPTS[i.cc],m=(t=i.initSegment)==null?void 0:t.data;if(u!==void 0){const _=n?n.index:-1,A=_!==-1,E=new Ks(i.level,i.sn,i.stats.chunkCount,o.byteLength,_,A);r.push(o,m,h,"",i,n,l.totalduration,!1,E,u)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${l.startSN} ,${l.endSN}],track ${c}`);const{cache:p}=this.waitingData=this.waitingData||{frag:i,part:n,cache:new fd,complete:!1};p.push(new Uint8Array(o)),this.waitingVideoCC=this.videoTrackCC,this.state=Xe.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:i,part:n}=t;if(i.type!==Rt.AUDIO){if(!this.loadedmetadata&&i.type===Rt.MAIN){const o=this.videoBuffer||this.media;o&&li.getBuffered(o).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(i.sn!=="initSegment"){this.fragPrevious=i;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(W.AUDIO_TRACK_SWITCHED,wi({},o)))}this.fragBufferedComplete(i,n)}onError(e,t){var i;if(t.fatal){this.state=Xe.ERROR;return}switch(t.details){case Ve.FRAG_GAP:case Ve.FRAG_PARSING_ERROR:case Ve.FRAG_DECRYPT_ERROR:case Ve.FRAG_LOAD_ERROR:case Ve.FRAG_LOAD_TIMEOUT:case Ve.KEY_LOAD_ERROR:case Ve.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Rt.AUDIO,t);break;case Ve.AUDIO_TRACK_LOAD_ERROR:case Ve.AUDIO_TRACK_LOAD_TIMEOUT:case Ve.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Xe.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===Kt.AUDIO_TRACK&&(this.state=Xe.IDLE);break;case Ve.BUFFER_APPEND_ERROR:case Ve.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===Ve.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Ve.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Zt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Zt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Xe.ENDED&&(this.state=Xe.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,t,Rt.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:n}=this,{remuxResult:o,chunkMeta:a}=e,c=this.getCurrentContext(a);if(!c){this.resetWhenMissingContext(a);return}const{frag:d,part:f,level:l}=c,{details:h}=l,{audio:r,text:u,id3:m,initSegment:p}=o;if(this.fragContextChanged(d)||!h){this.fragmentTracker.removeFragment(d);return}if(this.state=Xe.PARSING,this.switchingTrack&&r&&this.completeAudioSwitch(this.switchingTrack),p!=null&&p.tracks){const _=d.initSegment||d;this._bufferInitSegment(l,p.tracks,_,a),n.trigger(W.FRAG_PARSING_INIT_SEGMENT,{frag:_,id:i,tracks:p.tracks})}if(r){const{startPTS:_,endPTS:A,startDTS:E,endDTS:C}=r;f&&(f.elementaryStreams[Zt.AUDIO]={startPTS:_,endPTS:A,startDTS:E,endDTS:C}),d.setElementaryStreamInfo(Zt.AUDIO,_,A,E,C),this.bufferFragmentData(r,d,f,a)}if(m!=null&&(t=m.samples)!=null&&t.length){const _=Ei({id:i,frag:d,details:h},m);n.trigger(W.FRAG_PARSING_METADATA,_)}if(u){const _=Ei({id:i,frag:d,details:h},u);n.trigger(W.FRAG_PARSING_USERDATA,_)}}_bufferInitSegment(e,t,i,n){if(this.state!==Xe.PARSING)return;t.video&&delete t.video;const o=t.audio;if(!o)return;o.id="audio";const a=e.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${a}/${o.codec}]`),a&&a.split(",").length===1&&(o.levelCodec=a),this.hls.trigger(W.BUFFER_CODECS,t);const c=o.initSegment;if(c!=null&&c.byteLength){const d={type:"audio",frag:i,part:null,chunkMeta:n,parent:i.type,data:c};this.hls.trigger(W.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,t,i){const n=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||n===Li.NOT_LOADED||n===Li.PARTIAL){var o;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((o=t.details)!=null&&o.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Xe.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragments[0].start!==t.details.fragments[0].start&&zr(t.details,a)}else this.startFragRequested=!0,super.loadFragment(e,t,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:i}=this,n=i==null?void 0:i.attrs,o=e.attrs;t&&n&&(n.CHANNELS!==o.CHANNELS||i.name!==e.name||i.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(W.AUDIO_TRACK_SWITCHED,wi({},e))}}class Ev extends qs{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVEL_LOADING,this.onLevelLoading,this),e.off(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(W.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:n,details:o}=t,a=this.tracksInGroup[i];if(!a||a.groupId!==n){this.warn(`Audio track with id:${i} and group:${n} not found in active group ${a==null?void 0:a.groupId}`);return}const c=a.details;a.details=t.details,this.log(`Audio track ${i} "${a.name}" lang:${a.lang} group:${n} loaded [${o.startSN}-${o.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,n=this.groupIds;let o=this.currentTrack;if(!i||(n==null?void 0:n.length)!==(i==null?void 0:i.length)||i!=null&&i.some(c=>(n==null?void 0:n.indexOf(c))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(r=>!i||i.indexOf(r.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(r=>r.default)&&(this.selectDefaultTrack=!1),c.forEach((r,u)=>{r.id=u});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const d=this.hls.config.audioPreference;if(!o&&d){const r=rn(d,c,On);if(r>-1)o=c[r];else{const u=rn(d,this.tracks);o=this.tracks[u]}}let f=this.findTrackId(o);f===-1&&o&&(f=this.findTrackId(null));const l={audioTracks:c};this.log(`Updating audio tracks, ${c.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(W.AUDIO_TRACKS_UPDATED,l);const h=this.trackId;if(f!==-1&&h===-1)this.setAudioTrack(f);else if(c.length&&h===-1){var a;const r=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${c.length}`);this.warn(r.message),this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:r})}}else this.shouldReloadPlaylist(o)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Kt.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const n=this.currentTrack;if(n&&jn(e,n,On))return n;const o=rn(e,this.tracksInGroup,On);if(o>-1){const a=this.tracksInGroup[o];return this.setAudioTrack(o),a}else if(n){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const c=C_(e,t.levels,i,a,On);if(c===-1)return null;t.nextLoadLevel=c}if(e.channels||e.audioCodec){const a=rn(e,i);if(a>-1)return i[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const i=this.currentTrack,n=t[e],o=n.details&&!n.details.live;if(e===this.trackId&&n===i&&o||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(W.AUDIO_TRACK_SWITCHING,wi({},n)),o))return;const a=this.switchParams(n.url,i==null?void 0:i.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const n=t[i];if(!(this.selectDefaultTrack&&!n.default)&&(!e||jn(e,n,On)))return i}if(e){const{name:i,lang:n,assocLang:o,characteristics:a,audioCodec:c,channels:d}=e;for(let f=0;f<t.length;f++){const l=t[f];if(jn({name:i,lang:n,assocLang:o,characteristics:a,audioCodec:c,channels:d},l,On))return f}for(let f=0;f<t.length;f++){const l=t[f];if(Yn(e.attrs,l.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(let f=0;f<t.length;f++){const l=t[f];if(Yn(e.attrs,l.attrs,["LANGUAGE"]))return f}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const i=t.id,n=t.groupId;let o=t.url;if(e)try{o=e.addDirectives(o)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${n}`),this.clearTimer(),this.hls.trigger(W.AUDIO_TRACK_LOADING,{url:o,id:i,groupId:n,deliveryDirectives:e||null})}}}const kl=500;class xv extends Ys{constructor(e,t,i){super(e,t,i,"[subtitle-stream-controller]",Rt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.ERROR,this.onError,this),e.on(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(W.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(W.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.ERROR,this.onError,this),e.off(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(W.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(W.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Xe.IDLE,this.setInterval(kl),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:n}=t;if(this.fragPrevious=i,this.state=Xe.IDLE,!n)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let a;const c=i.start;for(let f=0;f<o.length;f++)if(c>=o[f].start&&c<=o[f].end){a=o[f];break}const d=i.start+i.duration;a?a.end=d:(a={start:c,end:d},o.push(a)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null)}onBufferFlushing(e,t){const{startOffset:i,endOffset:n}=t;if(i===0&&n!==Number.POSITIVE_INFINITY){const o=n-1;if(o<=0)return;t.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(a=>{for(let c=0;c<a.length;){if(a[c].end<=o){a.shift();continue}else if(a[c].start<o)a[c].start=o;else break;c++}}),this.fragmentTracker.removeFragmentsInRange(i,o,Rt.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Rt.MAIN){var i;(i=this.media)!=null&&i.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const i=t.frag;(i==null?void 0:i.type)===Rt.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Xe.STOPPED&&(this.state=Xe.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(!this.levels||Id(this.levels,t)){this.levels=t.map(i=>new Wn(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const n=new Wn(i);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Rt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(kl)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:n,levels:o}=this,{details:a,id:c}=t;if(!o){this.warn(`Subtitle tracks were reset while loading level ${c}`);return}const d=o[n];if(c>=o.length||c!==n||!d)return;this.log(`Subtitle track ${c} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let f=0;if(a.live||(i=d.details)!=null&&i.live){const h=this.mainDetails;if(a.deltaUpdateFailed||!h)return;const r=h.fragments[0];if(!d.details)a.hasProgramDateTime&&h.hasProgramDateTime?(zr(a,h),f=a.fragments[0].start):r&&(f=r.start,gs(a,f));else{var l;f=this.alignPlaylists(a,d.details,(l=this.levelLastLoaded)==null?void 0:l.details),f===0&&r&&(f=r.start,gs(a,f))}}d.details=a,this.levelLastLoaded=d,!this.startFragRequested&&(this.mainDetails||!a.live)&&this.setStartPosition(d.details,f),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===Xe.IDLE&&(Hr(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,n=t.decryptdata,o=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&n!=null&&n.key&&n.iv&&n.method==="AES-128"){const a=performance.now();this.decrypter.decrypt(new Uint8Array(i),n.key.buffer,n.iv.buffer).catch(c=>{throw o.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:t}),c}).then(c=>{const d=performance.now();o.trigger(W.FRAG_DECRYPTED,{frag:t,payload:c,stats:{tstart:a,tdecrypt:d}})}).catch(c=>{this.warn(`${c.name}: ${c.message}`),this.state=Xe.IDLE})}}doTick(){if(!this.media){this.state=Xe.IDLE;return}if(this.state===Xe.IDLE){const{currentTrackId:e,levels:t}=this,i=t==null?void 0:t[e];if(!i||!t.length||!i.details)return;const{config:n}=this,o=this.getLoadPosition(),a=li.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,n.maxBufferHole),{end:c,len:d}=a,f=this.getFwdBufferInfo(this.media,Rt.MAIN),l=i.details,h=this.getMaxBufferLength(f==null?void 0:f.len)+l.levelTargetDuration;if(d>h)return;const r=l.fragments,u=r.length,m=l.edge;let p=null;const _=this.fragPrevious;if(c<m){const A=n.maxFragLookUpTolerance,E=c>m-A?0:A;p=Hr(_,r,Math.max(r[0].start,c),E),!p&&_&&_.start<r[0].start&&(p=r[0])}else p=r[u-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),p.sn!=="initSegment"){const A=p.sn-l.startSN,E=r[A-1];E&&E.cc===p.cc&&this.fragmentTracker.getState(E)===Li.NOT_LOADED&&(p=E)}this.fragmentTracker.getState(p)===Li.NOT_LOADED&&this.loadFragment(p,i,c)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,i){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,i))}get mediaBufferTimeRanges(){return new Cv(this.tracksBuffered[this.currentTrackId]||[])}}class Cv{constructor(e){this.buffered=void 0;const t=(i,n,o)=>{if(n=n>>>0,n>o-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${o})`);return e[n][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}class wv extends qs{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const i=Cr(this.media.textTracks);for(let o=0;o<i.length;o++)if(i[o].mode==="hidden")t=i[o];else if(i[o].mode==="showing"){t=i[o];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVEL_LOADING,this.onLevelLoading,this),e.off(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(W.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Cr(this.media.textTracks).forEach(t=>{Gn(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:n,details:o}=t,a=this.tracksInGroup[i];if(!a||a.groupId!==n){this.warn(`Subtitle track with id:${i} and group:${n} not found in active group ${a==null?void 0:a.groupId}`);return}const c=a.details;a.details=t.details,this.log(`Subtitle track ${i} "${a.name}" lang:${a.lang} group:${n} loaded [${o.startSN}-${o.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,c)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,n=this.groupIds;let o=this.currentTrack;if(!i||(n==null?void 0:n.length)!==(i==null?void 0:i.length)||i!=null&&i.some(a=>(n==null?void 0:n.indexOf(a))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(l=>!i||i.indexOf(l.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(l=>l.default)&&(this.selectDefaultTrack=!1),a.forEach((l,h)=>{l.id=h});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const c=this.hls.config.subtitlePreference;if(!o&&c){this.selectDefaultTrack=!1;const l=rn(c,a);if(l>-1)o=a[l];else{const h=rn(c,this.tracks);o=this.tracks[h]}}let d=this.findTrackId(o);d===-1&&o&&(d=this.findTrackId(null));const f={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(W.SUBTITLE_TRACKS_UPDATED,f),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}else this.shouldReloadPlaylist(o)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let n=0;n<t.length;n++){const o=t[n];if(!(i&&!o.default||!i&&!e)&&(!e||jn(o,e)))return n}if(e){for(let n=0;n<t.length;n++){const o=t[n];if(Yn(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const o=t[n];if(Yn(e.attrs,o.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const n=t[i];if(vs(n,e))return i}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Kt.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&jn(e,i))return i;const n=rn(e,this.tracksInGroup);if(n>-1){const o=this.tracksInGroup[n];return this.setSubtitleTrack(n),o}else{if(i)return null;{const o=rn(e,t);if(o>-1)return t[o]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const i=t.id,n=t.groupId;let o=t.url;if(e)try{o=e.addDirectives(o)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(W.SUBTITLE_TRACK_LOADING,{url:o,id:i,groupId:n,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Cr(e.textTracks),i=this.currentTrack;let n;if(i&&(n=t.filter(o=>vs(i,o))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(o=>{o.mode!=="disabled"&&o!==n&&(o.mode="disabled")}),n){const o=this.subtitleDisplay?"showing":"hidden";n.mode!==o&&(n.mode=o)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!vt(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const i=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(W.SUBTITLE_TRACK_SWITCH,{id:e});return}const o=!!n.details&&!n.details.live;if(e===this.trackId&&n===i&&o)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:a,groupId:c="",name:d,type:f,url:l}=n;this.hls.trigger(W.SUBTITLE_TRACK_SWITCH,{id:a,groupId:c,name:d,type:f,url:l});const h=this.switchParams(n.url,i==null?void 0:i.details);this.loadPlaylist(h)}}class Tv{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,i){const n=this.queues[t];n.push(e),n.length===1&&!i&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const i=new Promise(o=>{t=o}),n={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(n,e),i}executeNext(e){const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(n){De.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${n}`),i.onError(n);const o=this.buffers[e];o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Rl=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class kv{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=i=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:i,mediaSource:n}=this;this.log("Media source opened"),i&&(i.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(W.MEDIA_ATTACHED,{media:i,mediaSource:n})),n&&n.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:n}=this;i!==n&&De.error(`Media element src was set while attaching MediaSource (${n} > ${i})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=e.config.preferManagedMediaSource,this.log=De.log.bind(De,t),this.warn=De.warn.bind(De,t),this.error=De.error.bind(De,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.BUFFER_RESET,this.onBufferReset,this),e.on(W.BUFFER_APPENDING,this.onBufferAppending,this),e.on(W.BUFFER_CODECS,this.onBufferCodecs,this),e.on(W.BUFFER_EOS,this.onBufferEos,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(W.FRAG_PARSED,this.onFragParsed,this),e.on(W.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.BUFFER_RESET,this.onBufferReset,this),e.off(W.BUFFER_APPENDING,this.onBufferAppending,this),e.off(W.BUFFER_CODECS,this.onBufferCodecs,this),e.off(W.BUFFER_EOS,this.onBufferEos,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(W.FRAG_PARSED,this.onFragParsed,this),e.off(W.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Tv(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const i=this.media=t.media,n=Jn(this.appendSource);if(i&&n){var o;const a=this.mediaSource=new n;this.log(`created media source: ${(o=a.constructor)==null?void 0:o.name}`),a.addEventListener("sourceopen",this._onMediaSourceOpen),a.addEventListener("sourceended",this._onMediaSourceEnded),a.addEventListener("sourceclose",this._onMediaSourceClose),a.addEventListener("startstreaming",this._onStartStreaming),a.addEventListener("endstreaming",this._onEndStreaming);const c=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{i.removeAttribute("src");const d=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||d&&a instanceof d,Ll(i),Rv(i,c),i.load()}catch{i.src=c}else i.src=c;i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:i}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(n){this.warn(`onMediaDetaching: ${n.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming),e&&(e.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),this.mediaSrc===i?(e.removeAttribute("src"),this.appendSource&&Ll(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(W.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var i;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(i=this.mediaSource)!=null&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(n){this.warn(`onBufferReset ${e}`,n)}}onBufferCodecs(e,t){const i=this.getSourceBufferTypes().length,n=Object.keys(t);if(n.forEach(a=>{if(i){const d=this.tracks[a];if(d&&typeof d.buffer.changeType=="function"){var c;const{id:f,codec:l,levelCodec:h,container:r,metadata:u}=t[a],m=Jo(d.codec,d.levelCodec),p=m==null?void 0:m.replace(Rl,"$1");let _=Jo(l,h);const A=(c=_)==null?void 0:c.replace(Rl,"$1");if(_&&p!==A){a.slice(0,5)==="audio"&&(_=Gr(_,this.hls.config.preferManagedMediaSource));const E=`${r};codecs=${_}`;this.appendChangeType(a,E),this.log(`switching codec ${m} to ${_}`),this.tracks[a]={buffer:d.buffer,codec:l,container:r,levelCodec:h,metadata:u,id:f}}}}else this.pendingTracks[a]=t[a]}),i)return;const o=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==o&&(this.log(`${o} bufferCodec event(s) expected ${n.join(",")}`),this.bufferCodecEventsExpected=o),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:i}=this,n={execute:()=>{const o=this.sourceBuffer[e];o&&(this.log(`changing ${e} sourceBuffer type to ${t}`),o.changeType(t)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};i.append(n,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:i,operationQueue:n,tracks:o}=this,{data:a,type:c,frag:d,part:f,chunkMeta:l}=t,h=l.buffering[c],r=self.performance.now();h.start=r;const u=d.stats.buffering,m=f?f.stats.buffering:null;u.start===0&&(u.start=r),m&&m.start===0&&(m.start=r);const p=o.audio;let _=!1;c==="audio"&&(p==null?void 0:p.container)==="audio/mpeg"&&(_=!this.lastMpegAudioChunk||l.id===1||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);const A=d.start,E={execute:()=>{if(h.executeStart=self.performance.now(),_){const C=this.sourceBuffer[c];if(C){const k=A-C.timestampOffset;Math.abs(k)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${A} (delta: ${k}) sn: ${d.sn})`),C.timestampOffset=A)}}this.appendExecutor(a,c)},onStart:()=>{},onComplete:()=>{const C=self.performance.now();h.executeEnd=h.end=C,u.first===0&&(u.first=C),m&&m.first===0&&(m.first=C);const{sourceBuffer:k}=this,O={};for(const G in k)O[G]=li.getBuffered(k[G]);this.appendErrors[c]=0,c==="audio"||c==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(W.BUFFER_APPENDED,{type:c,frag:d,part:f,chunkMeta:l,parent:d.type,timeRanges:O})},onError:C=>{const k={type:Lt.MEDIA_ERROR,parent:d.type,details:Ve.BUFFER_APPEND_ERROR,sourceBufferName:c,frag:d,part:f,chunkMeta:l,error:C,err:C,fatal:!1};if(C.code===DOMException.QUOTA_EXCEEDED_ERR)k.details=Ve.BUFFER_FULL_ERROR;else{const O=++this.appendErrors[c];k.details=Ve.BUFFER_APPEND_ERROR,this.warn(`Failed ${O}/${i.config.appendErrorMaxRetry} times to append segment in "${c}" sourceBuffer`),O>=i.config.appendErrorMaxRetry&&(k.fatal=!0)}i.trigger(W.ERROR,k)}};n.append(E,c,!!this.pendingTracks[c])}onBufferFlushing(e,t){const{operationQueue:i}=this,n=o=>({execute:this.removeExecutor.bind(this,o,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(W.BUFFER_FLUSHED,{type:o})},onError:a=>{this.warn(`Failed to remove from ${o} SourceBuffer`,a)}});t.type?i.append(n(t.type),t.type):this.getSourceBufferTypes().forEach(o=>{i.append(n(o),o)})}onFragParsed(e,t){const{frag:i,part:n}=t,o=[],a=n?n.elementaryStreams:i.elementaryStreams;a[Zt.AUDIOVIDEO]?o.push("audiovideo"):(a[Zt.AUDIO]&&o.push("audio"),a[Zt.VIDEO]&&o.push("video"));const c=()=>{const d=self.performance.now();i.stats.buffering.end=d,n&&(n.stats.buffering.end=d);const f=n?n.stats:i.stats;this.hls.trigger(W.FRAG_BUFFERED,{frag:i,part:n,stats:f,id:i.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(c,o)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((n,o)=>{const a=this.sourceBuffer[o];return a&&(!t.type||t.type===o)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${o} sourceBuffer now EOS`))),n&&!!(!a||a.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(o=>{const a=this.sourceBuffer[o];a&&(a.ending=!1)});const{mediaSource:n}=this;if(!n||n.readyState!=="open"){n&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${n.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),n.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||t===null||!this.getSourceBufferTypes().length)return;const o=e.config,a=i.currentTime,c=t.levelTargetDuration,d=t.live&&o.liveBackBufferLength!==null?o.liveBackBufferLength:o.backBufferLength;if(vt(d)&&d>0){const f=Math.max(d,c),l=Math.floor(a/c)*c-f;this.flushBackBuffer(a,c,l)}if(vt(o.frontBufferFlushThreshold)&&o.frontBufferFlushThreshold>0){const f=Math.max(o.maxBufferLength,o.frontBufferFlushThreshold),l=Math.max(f,c),h=Math.floor(a/c)*c+l;this.flushFrontBuffer(a,c,h)}}flushBackBuffer(e,t,i){const{details:n,sourceBuffer:o}=this;this.getSourceBufferTypes().forEach(c=>{const d=o[c];if(d){const f=li.getBuffered(d);if(f.length>0&&i>f.start(0)){if(this.hls.trigger(W.BACK_BUFFER_REACHED,{bufferEnd:i}),n!=null&&n.live)this.hls.trigger(W.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(d.ended&&f.end(f.length-1)-e<t*2){this.log(`Cannot flush ${c} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(W.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:c})}}})}flushFrontBuffer(e,t,i){const{sourceBuffer:n}=this;this.getSourceBufferTypes().forEach(a=>{const c=n[a];if(c){const d=li.getBuffered(c),f=d.length;if(f<2)return;const l=d.start(f-1),h=d.end(f-1);if(i>l||e>=l&&e<=h)return;if(c.ended&&e-h<2*t){this.log(`Cannot flush ${a} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(W.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:a})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:i,mediaSource:n}=this,o=e.fragments[0].start+e.totalduration,a=i.duration,c=vt(n.duration)?n.duration:0;e.live&&t.config.liveDurationInfinity?(n.duration=1/0,this.updateSeekableRange(e)):(o>c&&o>a||!vt(a))&&(this.log(`Updating Media Source duration to ${o.toFixed(3)}`),n.duration=o)}updateSeekableRange(e){const t=this.mediaSource,i=e.fragments;if(i.length&&e.live&&t!=null&&t.setLiveSeekableRange){const o=Math.max(0,i[0].start),a=Math.max(o,o+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${o}-${a}.`),t.setLiveSeekableRange(o,a)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:i}=this,n=Object.keys(i).length;if(n&&(!e||n===2||"audiovideo"in i)){this.createSourceBuffers(i),this.pendingTracks={};const o=this.getSourceBufferTypes();if(o.length)this.hls.trigger(W.BUFFER_CREATED,{tracks:this.tracks}),o.forEach(a=>{t.executeNext(a)});else{const a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(const n in e)if(!t[n]){const o=e[n];if(!o)throw Error(`source buffer exists for track ${n}, however track does not`);let a=o.levelCodec||o.codec;a&&n.slice(0,5)==="audio"&&(a=Gr(a,this.hls.config.preferManagedMediaSource));const c=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${c})`);try{const d=t[n]=i.addSourceBuffer(c),f=n;this.addBufferListener(f,"updatestart",this._onSBUpdateStart),this.addBufferListener(f,"updateend",this._onSBUpdateEnd),this.addBufferListener(f,"error",this._onSBUpdateError),this.addBufferListener(f,"bufferedchange",(l,h)=>{const r=h.removedRanges;r!=null&&r.length&&this.hls.trigger(W.BUFFER_FLUSHED,{type:n})}),this.tracks[n]={buffer:d,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(d){this.error(`error while trying to add sourceBuffer: ${d.message}`),this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,sourceBufferName:n,mimeType:c})}}}get mediaSrc(){var e;const t=((e=this.media)==null?void 0:e.firstChild)||this.media;return t==null?void 0:t.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:i}=this;i.current(e).onComplete(),i.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var i;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${n}`,t),this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const o=this.operationQueue.current(e);o&&o.onError(n)}removeExecutor(e,t,i){const{media:n,mediaSource:o,operationQueue:a,sourceBuffer:c}=this,d=c[e];if(!n||!o||!d){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}const f=vt(n.duration)?n.duration:1/0,l=vt(o.duration)?o.duration:1/0,h=Math.max(0,t),r=Math.min(i,f,l);r>h&&(!d.ending||d.ended)?(d.ended=!1,this.log(`Removing [${h},${r}] from the ${e} SourceBuffer`),d.remove(h,r)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.sourceBuffer[t];if(!i){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}i.ended=!1,i.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:i}=this,n=t.map(o=>i.appendBlocker(o));Promise.all(n).then(()=>{e(),t.forEach(o=>{const a=this.sourceBuffer[o];a!=null&&a.updating||i.shiftAndExecuteNext(o)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,i){const n=this.sourceBuffer[e];if(!n)return;const o=i.bind(this,e);this.listeners[e].push({event:t,listener:o}),n.addEventListener(t,o)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(i=>{t.removeEventListener(i.event,i.listener)})}}function Ll(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function Rv(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}const Il={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Dd=function(e){let t=e;return Il.hasOwnProperty(e)&&(t=Il[e]),String.fromCharCode(t)},Ki=15,un=100,Lv={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Iv={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Dv={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Ov={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Pv=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Bv{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;De.log(`${this.time} [${e}] ${i}`)}}}const Sn=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class Od{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Mv{constructor(){this.uchar=" ",this.penState=new Od}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Fv{constructor(e){this.chars=[],this.pos=0,this.currPenState=new Od,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<un;t++)this.chars.push(new Mv);this.logger=e}equals(e){for(let t=0;t<un;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<un;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<un;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>un&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=un)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Dd(e);if(this.pos>=un){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<un;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<un;i++){const n=this.chars[i].uchar;n!==" "&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class qa{constructor(e){this.rows=[],this.currRow=Ki-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Ki;t++)this.rows.push(new Fv(e));this.logger=e}reset(){for(let e=0;e<Ki;e++)this.rows[e].clear();this.currRow=Ki-1}equals(e){let t=!0;for(let i=0;i<Ki;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<Ki;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Ki;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let c=0;c<Ki;c++)this.rows[c].clear();const o=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const c=a.rows[o].cueStartTime,d=this.logger.time;if(c!==null&&d!==null&&c<d)for(let f=0;f<this.nrRollUpRows;f++)this.rows[t-this.nrRollUpRows+f+1].copy(a.rows[o+f])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const o=e.indent,a=Math.max(o-1,0);i.setCursor(e.indent),e.color=i.chars[a].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",n=-1;for(let o=0;o<Ki;o++){const a=this.rows[o].getTextString();a&&(n=o+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class Dl{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new qa(i),this.nonDisplayedMemory=new qa(i),this.lastOutputScreen=new qa(i),this.currRollUpRow=this.displayedMemory.rows[Ki-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Ki-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[i]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Ol{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Bl(),this.logger=void 0;const n=this.logger=new Bv;this.channels=[null,new Dl(e,t,n),new Dl(e+1,i,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let i,n,o,a=!1;this.logger.time=e;for(let c=0;c<t.length;c+=2)if(n=t[c]&127,o=t[c+1]&127,!(n===0&&o===0)){if(this.logger.log(3,"["+Sn([t[c],t[c+1]])+"] -> ("+Sn([n,o])+")"),i=this.parseCmd(n,o),i||(i=this.parseMidrow(n,o)),i||(i=this.parsePAC(n,o)),i||(i=this.parseBackgroundAttributes(n,o)),!i&&(a=this.parseChars(n,o),a)){const d=this.currentChannel;d&&d>0?this.channels[d].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!i&&!a&&this.logger.log(2,"Couldn't parse cleaned data "+Sn([n,o])+" orig: "+Sn([t[c],t[c+1]]))}}parseCmd(e,t){const{cmdHistory:i}=this,n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,o=(e===23||e===31)&&t>=33&&t<=35;if(!(n||o))return!1;if(Pl(e,t,i))return Fn(null,null,i),this.logger.log(3,"Repeated command ("+Sn([e,t])+") is dropped"),!0;const a=e===20||e===21||e===23?1:2,c=this.channels[a];return e===20||e===21||e===28||e===29?t===32?c.ccRCL():t===33?c.ccBS():t===34?c.ccAOF():t===35?c.ccAON():t===36?c.ccDER():t===37?c.ccRU(2):t===38?c.ccRU(3):t===39?c.ccRU(4):t===40?c.ccFON():t===41?c.ccRDC():t===42?c.ccTR():t===43?c.ccRTD():t===44?c.ccEDM():t===45?c.ccCR():t===46?c.ccENM():t===47&&c.ccEOC():c.ccTO(t-32),Fn(e,t,i),this.currentChannel=a,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[i];return n?(n.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Sn([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const n=this.cmdHistory,o=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(o||a))return!1;if(Pl(e,t,n))return Fn(null,null,n),!0;const c=e<=23?1:2;t>=64&&t<=95?i=c===1?Lv[e]:Dv[e]:i=c===1?Iv[e]:Ov[e];const d=this.channels[c];return d?(d.setPAC(this.interpretPAC(i,t)),Fn(e,t,n),this.currentChannel=c,!0):!1}interpretPAC(e,t){let i;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,n.underline=(i&1)===1,i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((i-16)/2)*4,n}parseChars(e,t){let i,n=null,o=null;if(e>=25?(i=2,o=e-8):(i=1,o=e),o>=17&&o<=19){let a;o===17?a=t+80:o===18?a=t+112:a=t+144,this.logger.log(2,"Special char '"+Dd(a)+"' in channel "+i),n=[a]}else e>=32&&e<=127&&(n=t===0?[e]:[e,t]);if(n){const a=Sn(n);this.logger.log(3,"Char codes =  "+a.join(",")),Fn(e,t,this.cmdHistory)}return n}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=45&&t<=47;if(!(i||n))return!1;let o;const a={};e===16||e===24?(o=Math.floor((t-32)/2),a.background=Pv[o],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const c=e<=23?1:2;return this.channels[c].setBkgData(a),Fn(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=Bl()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function Fn(s,e,t){t.a=s,t.b=e}function Pl(s,e,t){return t.a===s&&t.b===e}function Bl(){return{a:null,b:null}}class gr{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var to=function(){if(Kn!=null&&Kn.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(c,d){if(typeof d!="string"||!Array.isArray(c))return!1;const f=d.toLowerCase();return~c.indexOf(f)?f:!1}function i(c){return t(s,c)}function n(c){return t(e,c)}function o(c,...d){let f=1;for(;f<arguments.length;f++){const l=arguments[f];for(const h in l)c[h]=l[h]}return c}function a(c,d,f){const l=this,h={enumerable:!0};l.hasBeenReset=!1;let r="",u=!1,m=c,p=d,_=f,A=null,E="",C=!0,k="auto",O="start",G=50,B="middle",T=50,L="middle";Object.defineProperty(l,"id",o({},h,{get:function(){return r},set:function(I){r=""+I}})),Object.defineProperty(l,"pauseOnExit",o({},h,{get:function(){return u},set:function(I){u=!!I}})),Object.defineProperty(l,"startTime",o({},h,{get:function(){return m},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");m=I,this.hasBeenReset=!0}})),Object.defineProperty(l,"endTime",o({},h,{get:function(){return p},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(l,"text",o({},h,{get:function(){return _},set:function(I){_=""+I,this.hasBeenReset=!0}})),Object.defineProperty(l,"region",o({},h,{get:function(){return A},set:function(I){A=I,this.hasBeenReset=!0}})),Object.defineProperty(l,"vertical",o({},h,{get:function(){return E},set:function(I){const M=i(I);if(M===!1)throw new SyntaxError("An invalid or illegal string was specified.");E=M,this.hasBeenReset=!0}})),Object.defineProperty(l,"snapToLines",o({},h,{get:function(){return C},set:function(I){C=!!I,this.hasBeenReset=!0}})),Object.defineProperty(l,"line",o({},h,{get:function(){return k},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");k=I,this.hasBeenReset=!0}})),Object.defineProperty(l,"lineAlign",o({},h,{get:function(){return O},set:function(I){const M=n(I);if(!M)throw new SyntaxError("An invalid or illegal string was specified.");O=M,this.hasBeenReset=!0}})),Object.defineProperty(l,"position",o({},h,{get:function(){return G},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");G=I,this.hasBeenReset=!0}})),Object.defineProperty(l,"positionAlign",o({},h,{get:function(){return B},set:function(I){const M=n(I);if(!M)throw new SyntaxError("An invalid or illegal string was specified.");B=M,this.hasBeenReset=!0}})),Object.defineProperty(l,"size",o({},h,{get:function(){return T},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");T=I,this.hasBeenReset=!0}})),Object.defineProperty(l,"align",o({},h,{get:function(){return L},set:function(I){const M=n(I);if(!M)throw new SyntaxError("An invalid or illegal string was specified.");L=M,this.hasBeenReset=!0}})),l.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class Nv{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Pd(s){function e(i,n,o,a){return(i|0)*3600+(n|0)*60+(o|0)+parseFloat(a||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Uv{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function Bd(s,e,t,i){const n=i?s.split(i):[s];for(const o in n){if(typeof n[o]!="string")continue;const a=n[o].split(t);if(a.length!==2)continue;const c=a[0],d=a[1];e(c,d)}}const As=new to(0,0,""),yr=As.align==="middle"?"middle":"center";function Gv(s,e,t){const i=s;function n(){const c=Pd(s);if(c===null)throw new Error("Malformed timestamp: "+i);return s=s.replace(/^[^\sa-zA-Z-]+/,""),c}function o(c,d){const f=new Uv;Bd(c,function(r,u){let m;switch(r){case"region":for(let p=t.length-1;p>=0;p--)if(t[p].id===u){f.set(r,t[p].region);break}break;case"vertical":f.alt(r,u,["rl","lr"]);break;case"line":m=u.split(","),f.integer(r,m[0]),f.percent(r,m[0])&&f.set("snapToLines",!1),f.alt(r,m[0],["auto"]),m.length===2&&f.alt("lineAlign",m[1],["start",yr,"end"]);break;case"position":m=u.split(","),f.percent(r,m[0]),m.length===2&&f.alt("positionAlign",m[1],["start",yr,"end","line-left","line-right","auto"]);break;case"size":f.percent(r,u);break;case"align":f.alt(r,u,["start",yr,"end","left","right"]);break}},/:/,/\s/),d.region=f.get("region",null),d.vertical=f.get("vertical","");let l=f.get("line","auto");l==="auto"&&As.line===-1&&(l=-1),d.line=l,d.lineAlign=f.get("lineAlign","start"),d.snapToLines=f.get("snapToLines",!0),d.size=f.get("size",100),d.align=f.get("align",yr);let h=f.get("position","auto");h==="auto"&&As.position===50&&(h=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=h}function a(){s=s.replace(/^\s+/,"")}if(a(),e.startTime=n(),a(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);s=s.slice(3),a(),e.endTime=n(),a(),o(s,e)}function Md(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class $v{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Nv,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let o=t.buffer,a=0;for(o=Md(o);a<o.length&&o[a]!=="\r"&&o[a]!==`
`;)++a;const c=o.slice(0,a);return o[a]==="\r"&&++a,o[a]===`
`&&++a,t.buffer=o.slice(a),c}function n(o){Bd(o,function(a,c){},/:/)}try{let o="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;o=i();const c=o.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(c!=null&&c[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:o=i(),t.state){case"HEADER":/:/.test(o)?n(o):o||(t.state="ID");continue;case"NOTE":o||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){t.state="NOTE";break}if(!o)continue;if(t.cue=new to(0,0,""),t.state="CUE",o.indexOf("-->")===-1){t.cue.id=o;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Gv(o,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const c=o.indexOf("-->")!==-1;if(!o||c&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=o}continue;case"BADCUE":o||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Vv=/\r\n|\n\r|\n|\r/g,Ka=function(e,t,i=0){return e.slice(i,i+t.length)===t},jv=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),o=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!vt(t)||!vt(i)||!vt(n)||!vt(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*n,t+=60*60*1e3*o,t},Wa=function(e){let t=5381,i=e.length;for(;i;)t=t*33^e.charCodeAt(--i);return(t>>>0).toString()};function io(s,e,t){return Wa(s.toString())+Wa(e.toString())+Wa(t)}const Hv=function(e,t,i){let n=e[t],o=e[n.prevCC];if(!o||!o.new&&n.new){e.ccOffset=e.presentationOffset=n.start,n.new=!1;return}for(;(a=o)!=null&&a.new;){var a;e.ccOffset+=n.start-o.start,n.new=!1,n=o,o=e[n.prevCC]}e.presentationOffset=i};function zv(s,e,t,i,n,o,a){const c=new $v,d=an(new Uint8Array(s)).trim().replace(Vv,`
`).split(`
`),f=[],l=e?hv(e.baseTime,e.timescale):0;let h="00:00.000",r=0,u=0,m,p=!0;c.oncue=function(_){const A=t[i];let E=t.ccOffset;const C=(r-l)/9e4;if(A!=null&&A.new&&(u!==void 0?E=t.ccOffset=A.start:Hv(t,i,C)),C){if(!e){m=new Error("Missing initPTS for VTT MPEGTS");return}E=C-t.presentationOffset}const k=_.endTime-_.startTime,O=$i((_.startTime+E-u)*9e4,n*9e4)/9e4;_.startTime=Math.max(O,0),_.endTime=Math.max(O+k,0);const G=_.text.trim();_.text=decodeURIComponent(encodeURIComponent(G)),_.id||(_.id=io(_.startTime,_.endTime,G)),_.endTime>0&&f.push(_)},c.onparsingerror=function(_){m=_},c.onflush=function(){if(m){a(m);return}o(f)},d.forEach(_=>{if(p)if(Ka(_,"X-TIMESTAMP-MAP=")){p=!1,_.slice(16).split(",").forEach(A=>{Ka(A,"LOCAL:")?h=A.slice(6):Ka(A,"MPEGTS:")&&(r=parseInt(A.slice(7)))});try{u=jv(h)/1e3}catch(A){m=A}return}else _===""&&(p=!1);c.parse(_+`
`)}),c.flush()}const Ya="stpp.ttml.im1t",Fd=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Nd=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,qv={left:"start",center:"center",right:"end",start:"start",end:"end"};function Ml(s,e,t,i){const n=Mt(new Uint8Array(s),["mdat"]);if(n.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const o=n.map(c=>an(c)),a=dv(e.baseTime,1,e.timescale);try{o.forEach(c=>t(Kv(c,a)))}catch(c){i(c)}}function Kv(s,e){const n=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(o).reduce((h,r)=>(h[r]=n.getAttribute(`ttp:${r}`)||o[r],h),{}),c=n.getAttribute("xml:space")!=="preserve",d=Fl(Xa(n,"styling","style")),f=Fl(Xa(n,"layout","region")),l=Xa(n,"body","[begin]");return[].map.call(l,h=>{const r=Ud(h,c);if(!r||!h.hasAttribute("begin"))return null;const u=Qa(h.getAttribute("begin"),a),m=Qa(h.getAttribute("dur"),a);let p=Qa(h.getAttribute("end"),a);if(u===null)throw Nl(h);if(p===null){if(m===null)throw Nl(h);p=u+m}const _=new to(u-e,p-e,r);_.id=io(_.startTime,_.endTime,_.text);const A=f[h.getAttribute("region")],E=d[h.getAttribute("style")],C=Wv(A,E,d),{textAlign:k}=C;if(k){const O=qv[k];O&&(_.lineAlign=O),_.align=k}return Ei(_,C),_}).filter(h=>h!==null)}function Xa(s,e,t){const i=s.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function Fl(s){return s.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function Ud(s,e){return[].slice.call(s.childNodes).reduce((t,i,n)=>{var o;return i.nodeName==="br"&&n?t+`
`:(o=i.childNodes)!=null&&o.length?Ud(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function Wv(s,e,t){const i="http://www.w3.org/ns/ttml#styling";let n=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(n=t[a]),o.reduce((c,d)=>{const f=Ja(e,i,d)||Ja(s,i,d)||Ja(n,i,d);return f&&(c[d]=f),c},{})}function Ja(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function Nl(s){return new Error(`Could not parse ttml timestamp ${s}`)}function Qa(s,e){if(!s)return null;let t=Pd(s);return t===null&&(Fd.test(s)?t=Yv(s,e):Nd.test(s)&&(t=Xv(s,e))),t}function Yv(s,e){const t=Fd.exec(s),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function Xv(s,e){const t=Nd.exec(s),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class Jv{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Gl(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(W.FRAG_LOADING,this.onFragLoading,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this),e.on(W.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(W.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(W.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(W.FRAG_LOADING,this.onFragLoading,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this),e.off(W.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(W.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(W.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new gr(this,"textTrack1"),t=new gr(this,"textTrack2"),i=new gr(this,"textTrack3"),n=new gr(this,"textTrack4");this.cea608Parser1=new Ol(1,e,t),this.cea608Parser2=new Ol(3,i,n)}}addCues(e,t,i,n,o){let a=!1;for(let c=o.length;c--;){const d=o[c],f=Qv(d[0],d[1],t,i);if(f>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],i),a=!0,f/(i-t)>.5))return}if(a||o.push([t,i]),this.config.renderTextTracksNatively){const c=this.captionsTracks[e];this.Cues.newCue(c,t,i,n)}else{const c=this.Cues.newCue(null,t,i,n);this.hls.trigger(W.CUES_PARSED,{type:"captions",cues:c,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:n,timescale:o}){const{unparsedVttFrags:a}=this;i==="main"&&(this.initPTS[t.cc]={baseTime:n,timescale:o}),a.length&&(this.unparsedVttFrags=[],a.forEach(c=>{this.onFragLoaded(W.FRAG_LOADED,c)}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let n=0;n<i.textTracks.length;n++){const o=i.textTracks[n];if(Ul(o,{name:e,lang:t,attrs:{}}))return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:n}=this,{label:o,languageCode:a}=t[e],c=this.getExistingTrack(o,a);if(c)i[e]=c,Gn(i[e]),rd(i[e],n);else{const d=this.createTextTrack("captions",o,a);d&&(d[e]=!0,i[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,n={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(W.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,i){const n=this.media;if(n)return n.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Gn(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Gl(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)Gn(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],n=i.some(o=>o.textCodec===Ya);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(Id(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const a=this.media,c=a?Cr(a.textTracks):null;if(this.tracks.forEach((d,f)=>{let l;if(c){let h=null;for(let r=0;r<c.length;r++)if(c[r]&&Ul(c[r],d)){h=c[r],c[r]=null;break}h&&(l=h)}if(l)Gn(l);else{const h=Gd(d);l=this.createTextTrack(h,d.name,d.lang),l&&(l.mode="disabled")}l&&this.textTracks.push(l)}),c!=null&&c.length){const d=c.filter(f=>f!==null).map(f=>f.label);d.length&&De.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(W.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const n=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!n)return;const o=`textTrack${n[1]}`,a=this.captionsProperties[o];a&&(a.label=i.name,i.lang&&(a.languageCode=i.lang),a.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){this.initCea608Parsers();const{cea608Parser1:i,cea608Parser2:n,lastCc:o,lastSn:a,lastPartIndex:c}=this;if(!(!this.enabled||!i||!n)&&t.frag.type===Rt.MAIN){var d,f;const{cc:l,sn:h}=t.frag,r=(d=t==null||(f=t.part)==null?void 0:f.index)!=null?d:-1;h===a+1||h===a&&r===c+1||l===o||(i.reset(),n.reset()),this.lastCc=l,this.lastSn=h,this.lastPartIndex=r}}onFragLoaded(e,t){const{frag:i,payload:n}=t;if(i.type===Rt.SUBTITLE)if(n.byteLength){const o=i.decryptdata,a="stats"in t;if(o==null||!o.encrypted||a){const c=this.tracks[i.level],d=this.vttCCs;d[i.cc]||(d[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),c&&c.textCodec===Ya?this._parseIMSC1(i,n):this._parseVTTs(t)}}else this.hls.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;Ml(t,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),i.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{De.log(`Failed to parse IMSC1: ${n}`),i.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var t;const{frag:i,payload:n}=e,{initPTS:o,unparsedVttFrags:a}=this,c=o.length-1;if(!o[i.cc]&&c===-1){a.push(e);return}const d=this.hls,f=(t=i.initSegment)!=null&&t.data?ji(i.initSegment.data,new Uint8Array(n)):n;zv(f,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,l=>{this._appendCues(l,i.level),d.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},l=>{const h=l.message==="Missing initPTS for VTT MPEGTS";h?a.push(e):this._fallbackToIMSC1(i,n),De.log(`Failed to parse VTT cue: ${l}`),!(h&&c>i.cc)&&d.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:l})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||Ml(t,this.initPTS[e.cc],()=>{i.textCodec=Ya,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||n.mode==="disabled")return;e.forEach(o=>ad(n,o))}else{const n=this.tracks[t];if(!n)return;const o=n.default?"default":"subtitles"+t;i.trigger(W.CUES_PARSED,{type:"subtitles",cues:e,track:o})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===Rt.SUBTITLE&&this.onFragLoaded(W.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:i,cea608Parser2:n}=this;if(!this.enabled||!i||!n)return;const{frag:o,samples:a}=t;if(!(o.type===Rt.MAIN&&this.closedCaptionsForLevel(o)==="NONE"))for(let c=0;c<a.length;c++){const d=a[c].bytes;if(d){const f=this.extractCea608Data(d);i.addData(a[c].pts,f[0]),n.addData(a[c].pts,f[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:n,type:o}){const{media:a}=this;if(!(!a||a.currentTime<i)){if(!o||o==="video"){const{captionsTracks:c}=this;Object.keys(c).forEach(d=>fs(c[d],t,i))}if(this.config.renderTextTracksNatively&&t===0&&n!==void 0){const{textTracks:c}=this;Object.keys(c).forEach(d=>fs(c[d],t,n))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let n=2;for(let o=0;o<i;o++){const a=e[n++],c=127&e[n++],d=127&e[n++];if(c===0&&d===0)continue;if((4&a)!==0){const l=3&a;(l===0||l===1)&&(t[l].push(c),t[l].push(d))}}return t}}function Gd(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function Ul(s,e){return!!s&&s.kind===Gd(e)&&vs(e,s)}function Qv(s,e,t,i){return Math.min(e,i)-Math.max(s,t)}function Gl(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class no{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(W.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(W.BUFFER_CODECS,this.onBufferCodecs,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(W.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(W.BUFFER_CODECS,this.onBufferCodecs,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&vt(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&De.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((n,o)=>this.isLevelAllowed(n)&&o<=e);return this.clientRect=null,no.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const n=(c,d)=>d?c.width!==d.width||c.height!==d.height:!0;let o=e.length-1;const a=Math.max(t,i);for(let c=0;c<e.length;c+=1){const d=e[c];if((d.width>=a||d.height>=a)&&n(d,e[c+1])){o=c;break}}return o}}class Zv{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,i){const n=performance.now();if(t){if(this.lastTime){const o=n-this.lastTime,a=i-this.lastDroppedFrames,c=t-this.lastDecodedFrames,d=1e3*a/o,f=this.hls;if(f.trigger(W.FPS_DROP,{currentDropped:a,currentDecoded:c,totalDroppedFrames:i}),d>0&&a>f.config.fpsDroppedMonitoringThreshold*c){let l=f.currentLevel;De.warn("drop FPS ratio greater than max allowed value for currentLevel: "+l),l>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=l)&&(l=l-1,f.trigger(W.FPS_DROP_LEVEL_CAPPING,{level:l,droppedLevel:f.currentLevel}),f.autoLevelCapping=l,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const _r="[eme]";class Hn{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Hn.CDMCleanupPromise?[Hn.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=De.debug.bind(De,_r),this.log=De.log.bind(De,_r),this.warn=De.warn.bind(De,_r),this.error=De.error.bind(De,_r),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(W.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(W.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(W.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(W.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,n=t[e];if(n)return n.licenseUrl;if(e===mi.WIDEVINE&&i)return i;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(a,c,d)=>!!a&&d.indexOf(a)===c,n=t.map(a=>a.audioCodec).filter(i),o=t.map(a=>a.videoCodec).filter(i);return n.length+o.length===0&&o.push("avc1.42e01e"),new Promise((a,c)=>{const d=f=>{const l=f.shift();this.getMediaKeysPromise(l,n,o).then(h=>a({keySystem:l,mediaKeys:h})).catch(h=>{f.length?d(f):h instanceof Gi?c(h):c(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${i}`;return qc===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return i(e,t)}getMediaKeysPromise(e,t,i){const n=uy(e,t,i,this.config.drmSystemOptions),o=this.keySystemAccessPromises[e];let a=o==null?void 0:o.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(n)}`),a=this.requestMediaKeySystemAccess(e,n);const c=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),a.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const f=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),c.mediaKeys=d.createMediaKeys().then(l=>(this.log(`Media-keys created for "${e}"`),f.then(h=>h?this.setMediaKeysServerCertificate(l,e,h):l))),c.mediaKeys.catch(l=>{this.error(`Failed to create media-keys for "${e}"}: ${l}`)}),c.mediaKeys})}return a.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${en.hexDump(e.keyId||[])}`);const n=i.createSession(),o={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),o="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(i,o,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return en.hexDump(e.keyId)}updateKeySession(e,t){var i;const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${en.hexDump(((i=e.decryptdata)==null?void 0:i.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),n.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,i)=>{const n=Pa(this.config),o=e.map(zo).filter(a=>!!a&&n.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(o).then(({keySystem:a})=>{const c=qo(a);c?t(c):i(new Error(`Unable to find format for key-system "${a}"`))}).catch(i)})}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),n=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${n}`);let o=this.keyIdToKeySessionPromise[i];return o||(o=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(t).then(({keySystem:a,mediaKeys:c})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${n}`),this.attemptSetMediaKeys(a,c).then(()=>{this.throwIfDestroyed();const d=this.createMediaKeySessionContext({keySystem:a,mediaKeys:c,decryptdata:t});return this.generateRequestWithPreferredKeySession(d,"cenc",t.pssh,"playlist-key")}))),o.catch(a=>this.handleError(a))),o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Gi?this.hls.trigger(W.ERROR,e.data):this.hls.trigger(W.ERROR,{type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const n=zo(e.keyFormat),o=n?[n]:Pa(this.config);return this.attemptKeySystemAccess(o)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=Pa(this.config)),e.length===0)throw new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:i}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),i===null)return;let n,o;if(t==="sinf"&&this.config.drmSystems[mi.FAIRPLAY]){const l=Ci(new Uint8Array(i));try{const h=$s(JSON.parse(l).sinf),r=ed(new Uint8Array(h));if(!r)return;n=r.subarray(8,24),o=mi.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const l=Fy(i);if(l===null)return;l.version===0&&l.systemId===zc.WIDEVINE&&l.data&&(n=l.data.subarray(8,24)),o=hy(l.systemId)}if(!o||!n)return;const a=en.hexDump(n),{keyIdToKeySessionPromise:c,mediaKeySessions:d}=this;let f=c[a];for(let l=0;l<d.length;l++){const h=d[l],r=h.decryptdata;if(r.pssh||!r.keyId)continue;const u=en.hexDump(r.keyId);if(a===u||r.uri.replace(/-/g,"").indexOf(a)!==-1){f=c[u],delete c[u],r.pssh=new Uint8Array(i),r.keyId=n,f=c[a]=f.then(()=>this.generateRequestWithPreferredKeySession(h,t,i,"encrypted-event-key-match"));break}}f||(f=c[a]=this.getKeySystemSelectionPromise([o]).then(({keySystem:l,mediaKeys:h})=>{var r;this.throwIfDestroyed();const u=new ar("ISO-23001-7",a,(r=qo(l))!=null?r:"");return u.pssh=new Uint8Array(i),u.keyId=n,this.attemptSetMediaKeys(l,h).then(()=>{this.throwIfDestroyed();const m=this.createMediaKeySessionContext({decryptdata:u,keySystem:l,mediaKeys:h});return this.generateRequestWithPreferredKeySession(m,t,i,"encrypted-event-no-match")})})),f.catch(l=>this.handleError(l))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(i).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>i.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(e,t,i,n){var o,a;const c=(o=this.config.drmSystems)==null||(a=o[e.keySystem])==null?void 0:a.generateRequest;if(c)try{const m=c.call(this.hls,t,i,e);if(!m)throw new Error("Invalid response from configured generateRequest filter");t=m.initDataType,i=e.decryptdata.pssh=m.initData?new Uint8Array(m.initData):null}catch(m){var d;if(this.warn(m.message),(d=this.hls)!=null&&d.config.debug)throw m}if(i===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const f=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${n}": ${f} (init data type: ${t} length: ${i?i.byteLength:null})`);const l=new eo,h=e._onmessage=m=>{const p=e.mediaKeysSession;if(!p){l.emit("error",new Error("invalid state"));return}const{messageType:_,message:A}=m;this.log(`"${_}" message event for session "${p.sessionId}" message size: ${A.byteLength}`),_==="license-request"||_==="license-renewal"?this.renewLicense(e,A).catch(E=>{this.handleError(E),l.emit("error",E)}):_==="license-release"?e.keySystem===mi.FAIRPLAY&&(this.updateKeySession(e,hs("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${_}"`)},r=e._onkeystatuseschange=m=>{if(!e.mediaKeysSession){l.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const _=e.keyStatus;l.emit("keyStatus",_),_==="expired"&&(this.warn(`${e.keySystem} expired for key ${f}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",h),e.mediaKeysSession.addEventListener("keystatuseschange",r);const u=new Promise((m,p)=>{l.on("error",p),l.on("keyStatus",_=>{_.startsWith("usable")?m():_==="output-restricted"?p(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):_==="internal-error"?p(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${_}"`)):_==="expired"?p(new Error("key expired while generating request")):this.warn(`unhandled key status change "${_}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var m;this.log(`Request generated for key-session "${(m=e.mediaKeysSession)==null?void 0:m.sessionId}" keyId: ${f}`)}).catch(m=>{throw new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_NO_SESSION,error:m,fatal:!1},`Error generating key-session request: ${m}`)}).then(()=>u).catch(m=>{throw l.removeAllListeners(),this.removeSession(e),m}).then(()=>(l.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${en.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${en.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,i=t.loader,n=new i(t),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,c)=>{const d={responseType:"arraybuffer",url:o},f=t.certLoadPolicy.default,l={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(r,u,m,p)=>{a(r.data)},onError:(r,u,m,p)=>{c(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:wi({url:d.url,data:void 0},r)},`"${e}" certificate request failed (${o}). Status: ${r.code} (${r.text})`))},onTimeout:(r,u,m)=>{c(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(r,u,m)=>{c(new Error("aborted"))}};n.load(d,l,h)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((n,o)=>{e.setServerCertificate(i).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${i==null?void 0:i.byteLength}) on "${t}"`),n(e)}).catch(a=>{o(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(n=>{throw new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:n,fatal:!0},n.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const n=new DOMParser().parseFromString(i,"application/xml"),o=n.querySelectorAll("HttpHeader");if(o.length>0){let l;for(let h=0,r=o.length;h<r;h++){var a,c;l=o[h];const u=(a=l.querySelector("name"))==null?void 0:a.textContent,m=(c=l.querySelector("value"))==null?void 0:c.textContent;u&&m&&e.setRequestHeader(u,m)}}const d=n.querySelector("Challenge"),f=d==null?void 0:d.textContent;if(!f)throw new Error("Cannot find <Challenge> in key message");return hs(atob(f))}setupLicenseXHR(e,t,i,n){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,t,i,n)}).catch(a=>{if(!i.decryptdata)throw a;return e.open("POST",t,!0),o.call(this.hls,e,t,i,n)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||n})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((n,o)=>{const a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);const c=new XMLHttpRequest;c.responseType="arraybuffer",c.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(c.readyState===4)if(c.status===200){this._requestLicenseFailureCount=0;let d=c.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const f=this.config.licenseResponseCallback;if(f)try{d=f.call(this.hls,c,a,e)}catch(l){this.error(l)}n(d)}else{const d=i.errorRetry,f=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f||c.status>=400&&c.status<500)o(new Gi({type:Lt.KEY_SYSTEM_ERROR,details:Ve.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:c,response:{url:a,data:void 0,code:c.status,text:c.statusText}},`License Request XHR failed (${a}). Status: ${c.status} (${c.statusText})`));else{const l=f-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${l} attempts left`),this.requestLicense(e,t).then(n,o)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=c,this.setupLicenseXHR(c,a,e,t).then(({xhr:d,licenseChallenge:f})=>{e.keySystem==mi.PLAYREADY&&(f=this.unpackPlayReadyKeyMessage(d,f)),d.send(f)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},ar.clearKeyUriToKeyIdMap();const i=t.length;Hn.CDMCleanupPromise=Promise.all(t.map(n=>this.removeSession(n)).concat(e==null?void 0:e.setMediaKeys(null).catch(n=>{this.log(`Could not clear media keys: ${n}`)}))).then(()=>{i&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(n=>{this.log(`Could not close sessions and clear media keys: ${n}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((n,o)=>(n.indexOf(o.keyFormat)===-1&&n.push(o.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(e);return n>-1&&this.mediaKeySessions.splice(n,1),t.remove().catch(o=>{this.log(`Could not remove session: ${o}`)}).then(()=>t.close()).catch(o=>{this.log(`Could not close session: ${o}`)})}}}Hn.CDMCleanupPromise=void 0;class Gi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Oi;(function(s){s.MANIFEST="m",s.AUDIO="a",s.VIDEO="v",s.MUXED="av",s.INIT="i",s.CAPTION="c",s.TIMED_TEXT="tt",s.KEY="k",s.OTHER="o"})(Oi||(Oi={}));var bs;(function(s){s.DASH="d",s.HLS="h",s.SMOOTH="s",s.OTHER="o"})(bs||(bs={}));var xn;(function(s){s.OBJECT="CMCD-Object",s.REQUEST="CMCD-Request",s.SESSION="CMCD-Session",s.STATUS="CMCD-Status"})(xn||(xn={}));const eA={[xn.OBJECT]:["br","d","ot","tb"],[xn.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[xn.SESSION]:["cid","pr","sf","sid","st","v"],[xn.STATUS]:["bs","rtp"]};class Xn{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(i=>i instanceof Xn?i:new Xn(i))),this.value=e,this.params=t}}class $d{constructor(e){this.description=void 0,this.description=e}}const tA="Dict";function iA(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function nA(s,e,t,i){return new Error(`failed to ${s} "${iA(e)}" as ${t}`,{cause:i})}const $l="Bare Item",rA="Boolean",aA="Byte Sequence",sA="Decimal",oA="Integer";function lA(s){return s<-999999999999999||999999999999999<s}const cA=/[\x00-\x1f\x7f]+/,dA="Token",hA="Key";function on(s,e,t){return nA("serialize",s,e,t)}function uA(s){if(typeof s!="boolean")throw on(s,rA);return s?"?1":"?0"}function fA(s){return btoa(String.fromCharCode(...s))}function pA(s){if(ArrayBuffer.isView(s)===!1)throw on(s,aA);return`:${fA(s)}:`}function Vd(s){if(lA(s))throw on(s,oA);return s.toString()}function mA(s){return`@${Vd(s.getTime()/1e3)}`}function jd(s,e){if(s<0)return-jd(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const n=Math.floor(s*t);return(n%2===0?n:n+1)/t}else return Math.round(s*t)/t}function gA(s){const e=jd(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw on(s,sA);const t=e.toString();return t.includes(".")?t:`${t}.0`}const yA="String";function _A(s){if(cA.test(s))throw on(s,yA);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function vA(s){return s.description||s.toString().slice(7,-1)}function Vl(s){const e=vA(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw on(e,dA);return e}function Ss(s){switch(typeof s){case"number":if(!vt(s))throw on(s,$l);return Number.isInteger(s)?Vd(s):gA(s);case"string":return _A(s);case"symbol":return Vl(s);case"boolean":return uA(s);case"object":if(s instanceof Date)return mA(s);if(s instanceof Uint8Array)return pA(s);if(s instanceof $d)return Vl(s);default:throw on(s,$l)}}function Es(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw on(s,hA);return s}function ro(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${Es(e)}`:`;${Es(e)}=${Ss(t)}`).join("")}function Hd(s){return s instanceof Xn?`${Ss(s.value)}${ro(s.params)}`:Ss(s)}function AA(s){return`(${s.value.map(Hd).join(" ")})${ro(s.params)}`}function bA(s,e={whitespace:!0}){if(typeof s!="object")throw on(s,tA);const t=s instanceof Map?s.entries():Object.entries(s),i=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([n,o])=>{o instanceof Xn||(o=new Xn(o));let a=Es(n);return o.value===!0?a+=ro(o.params):(a+="=",Array.isArray(o.value)?a+=AA(o):a+=Hd(o)),a}).join(`,${i}`)}function SA(s,e){return bA(s,e)}const EA=s=>s==="ot"||s==="sf"||s==="st",xA=s=>typeof s=="number"?vt(s):s!=null&&s!==""&&s!==!1;function CA(s,e){const t=new URL(s),i=new URL(e);if(t.origin!==i.origin)return s;const n=t.pathname.split("/").slice(1),o=i.pathname.split("/").slice(1,-1);for(;n[0]===o[0];)n.shift(),o.shift();for(;o.length;)o.shift(),n.unshift("..");return n.join("/")}function wA(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?o:o&3|8).toString(16)})}}}const Lr=s=>Math.round(s),TA=(s,e)=>(e!=null&&e.baseUrl&&(s=CA(s,e.baseUrl)),encodeURIComponent(s)),vr=s=>Lr(s/100)*100,kA={br:Lr,d:Lr,bl:vr,dl:vr,mtp:vr,nor:TA,rtp:vr,tb:Lr};function RA(s,e){const t={};if(s==null||typeof s!="object")return t;const i=Object.keys(s).sort(),n=Ei({},kA,e==null?void 0:e.formatters),o=e==null?void 0:e.filter;return i.forEach(a=>{if(o!=null&&o(a))return;let c=s[a];const d=n[a];d&&(c=d(c,e)),!(a==="v"&&c===1)&&(a=="pr"&&c===1||xA(c)&&(EA(a)&&typeof c=="string"&&(c=new $d(c)),t[a]=c))}),t}function zd(s,e={}){return s?SA(RA(s,e),Ei({whitespace:!1},e)):""}function LA(s,e={}){if(!s)return{};const t=Object.entries(s),i=Object.entries(eA).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),n=t.reduce((o,a)=>{var c,d;const[f,l]=a,h=((c=i.find(r=>r[1].includes(f)))==null?void 0:c[0])||xn.REQUEST;return(d=o[h])!=null||(o[h]={}),o[h][f]=l,o},{});return Object.entries(n).reduce((o,[a,c])=>(o[a]=zd(c,e),o),{})}function IA(s,e,t){return Ei(s,LA(e,t))}const DA="CMCD";function OA(s,e={}){if(!s)return"";const t=zd(s,e);return`${DA}=${encodeURIComponent(t)}`}const jl=/CMCD=[^&#]+/;function PA(s,e,t){const i=OA(e,t);if(!i)return s;if(jl.test(s))return s.replace(jl,i);const n=s.includes("?")?"&":"?";return`${s}${n}${i}`}class BA{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:Oi.MANIFEST,su:!this.initialized})}catch(o){De.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=n=>{try{const o=n.frag,a=this.hls.levels[o.level],c=this.getObjectType(o),d={d:o.duration*1e3,ot:c};(c===Oi.VIDEO||c===Oi.AUDIO||c==Oi.MUXED)&&(d.br=a.bitrate/1e3,d.tb=this.getTopBandwidth(c)/1e3,d.bl=this.getBufferLength(c)),this.apply(n,d)}catch(o){De.warn("Could not generate segment CMCD data.",o)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||wA(),this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHED,this.onMediaDetached,this),e.on(W.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHED,this.onMediaDetached,this),e.off(W.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,n;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(n=t.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:bs.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ei(t,this.createData());const i=t.ot===Oi.INIT||t.ot===Oi.VIDEO||t.ot===Oi.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:n}=this;n&&(t=Object.keys(t).reduce((o,a)=>(n.includes(a)&&(o[a]=t[a]),o),{})),this.useHeaders?(e.headers||(e.headers={}),IA(e.headers,t)):e.url=PA(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Oi.TIMED_TEXT;if(e.sn==="initSegment")return Oi.INIT;if(t==="audio")return Oi.AUDIO;if(t==="main")return this.hls.audioTracks.length?Oi.VIDEO:Oi.MUXED}getTopBandwidth(e){let t=0,i;const n=this.hls;if(e===Oi.AUDIO)i=n.audioTracks;else{const o=n.maxAutoLevel,a=o>-1?o+1:n.levels.length;i=n.levels.slice(0,a)}for(const o of i)o.bitrate>t&&(t=o.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,i=e===Oi.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:li.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new i(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,a,c){t(o),this.loader.load(o,a,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new i(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,a,c){t(o),this.loader.load(o,a,c)}}}}const MA=3e5;class FA{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=De.log.bind(De,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((i==null?void 0:i.action)===Ii.SendAlternateToPenaltyBox&&i.flags===qi.MoveAllAlternatesMatchingHost){const n=this.levels;let o=this.pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:c,pathwayId:d,type:f}=t.context;c&&n?a=this.getPathwayForGroupId(c,f,a):d&&(a=d)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!o&&n&&(o=n.reduce((c,d)=>(c.indexOf(d.pathwayId)===-1&&c.push(d.pathwayId),c),[])),o&&o.length>1&&(this.updatePathwayPriority(o),i.resolved=this.pathwayId!==a),i.resolved||De.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${n&&n.length} priorities: ${JSON.stringify(o)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const i=this.penalizedPathways,n=performance.now();Object.keys(i).forEach(o=>{n-i[o]>MA&&delete i[o]});for(let o=0;o<e.length;o++){const a=e[o];if(a in i)continue;if(a===this.pathwayId)return;const c=this.hls.nextLoadLevel,d=this.hls.levels[c];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,cd(t),this.hls.trigger(W.LEVELS_UPDATED,{levels:t});const f=this.hls.levels[c];d&&f&&this.levels&&(f.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&f.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${f.bitrate}`),this.hls.nextLoadLevel=c);break}}}getPathwayForGroupId(e,t,i){const n=this.getLevelsForPathway(i).concat(this.levels||[]);for(let o=0;o<n.length;o++)if(t===Kt.AUDIO_TRACK&&n[o].hasAudioGroup(e)||t===Kt.SUBTITLE_TRACK&&n[o].hasSubtitleGroup(e))return n[o].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},n={};e.forEach(o=>{const{ID:a,"BASE-ID":c,"URI-REPLACEMENT":d}=o;if(t.some(l=>l.pathwayId===a))return;const f=this.getLevelsForPathway(c).map(l=>{const h=new _i(l.attrs);h["PATHWAY-ID"]=a;const r=h.AUDIO&&`${h.AUDIO}_clone_${a}`,u=h.SUBTITLES&&`${h.SUBTITLES}_clone_${a}`;r&&(i[h.AUDIO]=r,h.AUDIO=r),u&&(n[h.SUBTITLES]=u,h.SUBTITLES=u);const m=qd(l.uri,h["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),p=new Wn({attrs:h,audioCodec:l.audioCodec,bitrate:l.bitrate,height:l.height,name:l.name,url:m,videoCodec:l.videoCodec,width:l.width});if(l.audioGroups)for(let _=1;_<l.audioGroups.length;_++)p.addGroupId("audio",`${l.audioGroups[_]}_clone_${a}`);if(l.subtitleGroups)for(let _=1;_<l.subtitleGroups.length;_++)p.addGroupId("text",`${l.subtitleGroups[_]}_clone_${a}`);return p});t.push(...f),Hl(this.audioTracks,i,d,a),Hl(this.subtitleTracks,n,d,a)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const l=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+l)}const o={responseType:"json",url:n.href},a=t.steeringManifestLoadPolicy.default,c=a.errorRetry||a.timeoutRetry||{},d={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},f={onSuccess:(l,h,r,u)=>{this.log(`Loaded steering manifest: "${n}"`);const m=l.data;if(m.VERSION!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":p,"PATHWAY-CLONES":_,"PATHWAY-PRIORITY":A}=m;if(p)try{this.uri=new self.URL(p,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${p}`);return}this.scheduleRefresh(this.uri||r.url),_&&this.clonePathways(_);const E={steeringManifest:m,url:n.toString()};this.hls.trigger(W.STEERING_MANIFEST_LOADED,E),A&&this.updatePathwayPriority(A)},onError:(l,h,r,u)=>{if(this.log(`Error loading steering manifest: ${l.code} ${l.text} (${h.url})`),this.stopLoad(),l.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let m=this.timeToLoad*1e3;if(l.code===429){const p=this.loader;if(typeof(p==null?void 0:p.getResponseHeader)=="function"){const _=p.getResponseHeader("Retry-After");_&&(m=parseFloat(_)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,m)},onTimeout:(l,h,r)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(o,d,f)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const n=(i=this.hls)==null?void 0:i.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Hl(s,e,t,i){s&&Object.keys(e).forEach(n=>{const o=s.filter(a=>a.groupId===n).map(a=>{const c=Ei({},a);return c.details=void 0,c.attrs=new _i(c.attrs),c.url=c.attrs.URI=qd(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),c.groupId=c.attrs["GROUP-ID"]=e[n],c.attrs["PATHWAY-ID"]=i,c});s.push(...o)})}function qd(s,e,t,i){const{HOST:n,PARAMS:o,[t]:a}=i;let c;e&&(c=a==null?void 0:a[e],c&&(s=c));const d=new self.URL(s);return n&&!c&&(d.host=n),o&&Object.keys(o).sort().forEach(f=>{f&&d.searchParams.set(f,o[f])}),d.href}const NA=/^age:\s*[\d.]+\s*$/im;class Kd{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new na,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null,this.stats=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!this.stats.aborted)return o(i,t.url)}).catch(a=>(i.open("GET",t.url,!0),o(i,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(a=>{this.callbacks.onError({code:i.status,text:a.message},t,i,n)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const n=t.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:a}=i.loadPolicy;if(n)for(const c in n)e.setRequestHeader(c,n[c]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=o&&vt(o)?o:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const n=t.readyState,o=this.config;if(!i.aborted&&n>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const a=t.status,c=t.responseType!=="text";if(a>=200&&a<300&&(c&&t.response||t.responseText!==null)){i.loading.end=Math.max(self.performance.now(),i.loading.first);const d=c?t.response:t.responseText,f=t.responseType==="arraybuffer"?d.byteLength:d.length;if(i.loaded=i.total=f,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first),!this.callbacks)return;const l=this.callbacks.onProgress;if(l&&l(i,e,d,t),!this.callbacks)return;const h={url:t.responseURL,data:d,code:a};this.callbacks.onSuccess(h,i,e,t)}else{const d=o.loadPolicy.errorRetry,f=i.retry,l={url:e.url,data:void 0,code:a};jr(d,f,!1,l)?this.retry(d):(De.error(`${a} while loading ${e.url}`),this.callbacks.onError({code:a,text:t.statusText},e,t,i))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,i=this.stats.retry;if(jr(t,i,!0))this.retry(t);else{var n;De.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const o=this.callbacks;o&&(this.abortInternal(),o.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=zs(e,i.retry),i.retry++,De.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&NA.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function UA(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const GA=/(\d+)-(\d+)\/(\d+)/;class zl{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||HA,this.controller=new self.AbortController,this.stats=new na}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const o=$A(e,this.controller.signal),a=i.onProgress,c=e.responseType==="arraybuffer",d=c?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),t.timeout=f&&vt(f)?f:l,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(n,e,this.response)},t.timeout),self.fetch(this.request).then(h=>{this.response=this.loader=h;const r=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(n,e,this.response)},l-(r-n.loading.start)),!h.ok){const{status:u,statusText:m}=h;throw new zA(m||"fetch, bad network response",u,h)}return n.loading.first=r,n.total=jA(h.headers)||n.total,a&&vt(t.highWaterMark)?this.loadProgressively(h,n,e,t.highWaterMark,a):c?h.arrayBuffer():e.responseType==="json"?h.json():h.text()}).then(h=>{const r=this.response;if(!r)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const u=h[d];u&&(n.loaded=n.total=u);const m={url:r.url,data:h,code:r.status};a&&!vt(t.highWaterMark)&&a(n,e,h,r),i.onSuccess(m,n,e,r)}).catch(h=>{if(self.clearTimeout(this.requestTimeout),n.aborted)return;const r=h&&h.code||0,u=h?h.message:null;i.onError({code:r,text:u},e,h?h.details:null,n)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,n=0,o){const a=new fd,c=e.body.getReader(),d=()=>c.read().then(f=>{if(f.done)return a.dataLength&&o(t,i,a.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=f.value,h=l.length;return t.loaded+=h,h<n||a.dataLength?(a.push(l),a.dataLength>=n&&o(t,i,a.flush(),e)):o(t,i,l,e),d()}).catch(()=>Promise.reject());return d()}}function $A(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ei({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function VA(s){const e=GA.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function jA(s){const e=s.get("Content-Range");if(e){const i=VA(e);if(vt(i))return i}const t=s.get("Content-Length");if(t)return parseInt(t)}function HA(s,e){return new self.Request(s.url,e)}class zA extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const qA=/\s/,KA={newCue(s,e,t,i){const n=[];let o,a,c,d,f;const l=self.VTTCue||self.TextTrackCue;for(let r=0;r<i.rows.length;r++)if(o=i.rows[r],c=!0,d=0,f="",!o.isEmpty()){var h;for(let p=0;p<o.chars.length;p++)qA.test(o.chars[p].uchar)&&c?d++:(f+=o.chars[p].uchar,c=!1);o.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const u=Md(f.trim()),m=io(e,t,u);s!=null&&(h=s.cues)!=null&&h.getCueById(m)||(a=new l(e,t,u),a.id=m,a.line=r+1,a.align="left",a.position=10+Math.min(80,Math.floor(d*8/32)*10),n.push(a))}return s&&n.length&&(n.sort((r,u)=>r.line==="auto"||u.line==="auto"?0:r.line>8&&u.line>8?u.line-r.line:r.line-u.line),n.forEach(r=>ad(s,r))),n}},WA={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},Wd=wi(wi({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Kd,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:w_,bufferController:kv,capLevelController:no,errorController:p_,fpsController:Zv,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:qc,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:WA},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},YA()),{},{subtitleStreamController:xv,subtitleTrackController:wv,timelineController:Jv,audioStreamController:Sv,audioTrackController:Ev,emeController:Hn,cmcdController:BA,contentSteeringController:FA});function YA(){return{cueHandler:KA,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function XA(s,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=xs(s),i=["manifest","level","frag"],n=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(o=>{const a=`${o==="level"?"playlist":o}LoadPolicy`,c=e[a]===void 0,d=[];n.forEach(f=>{const l=`${o}Loading${f}`,h=e[l];if(h!==void 0&&c){d.push(l);const r=t[a].default;switch(e[a]={default:r},f){case"TimeOut":r.maxLoadTimeMs=h,r.maxTimeToFirstByteMs=h;break;case"MaxRetry":r.errorRetry.maxNumRetry=h,r.timeoutRetry.maxNumRetry=h;break;case"RetryDelay":r.errorRetry.retryDelayMs=h,r.timeoutRetry.retryDelayMs=h;break;case"MaxRetryTimeout":r.errorRetry.maxRetryDelayMs=h,r.timeoutRetry.maxRetryDelayMs=h;break}}}),d.length&&De.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${a}": ${JSON.stringify(e[a])}`)}),wi(wi({},t),e)}function xs(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(xs):Object.keys(s).reduce((e,t)=>(e[t]=xs(s[t]),e),{}):s}function JA(s){const e=s.loader;e!==zl&&e!==Kd?(De.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):UA()&&(s.loader=zl,s.progressive=!0,s.enableSoftwareAES=!0,De.log("[config]: Progressive streaming enabled, using FetchLoader"))}let Za;class QA extends qs{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this),e.on(W.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this),e.off(W.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,n=[],o={},a={};let c=!1,d=!1,f=!1;t.levels.forEach(l=>{var h,r;const u=l.attrs;let{audioCodec:m,videoCodec:p}=l;((h=m)==null?void 0:h.indexOf("mp4a.40.34"))!==-1&&(Za||(Za=/chrome|firefox/i.test(navigator.userAgent)),Za&&(l.audioCodec=m=void 0)),m&&(l.audioCodec=m=Gr(m,i)),((r=p)==null?void 0:r.indexOf("avc1"))===0&&(p=l.videoCodec=jy(p));const{width:_,height:A,unknownCodecs:E}=l;if(c||(c=!!(_&&A)),d||(d=!!p),f||(f=!!m),E!=null&&E.length||m&&!Na(m,"audio",i)||p&&!Na(p,"video",i))return;const{CODECS:C,"FRAME-RATE":k,"HDCP-LEVEL":O,"PATHWAY-ID":G,RESOLUTION:B,"VIDEO-RANGE":T}=u,I=`${`${G||"."}-`}${l.bitrate}-${B}-${k}-${C}-${T}-${O}`;if(o[I])if(o[I].uri!==l.url&&!l.attrs["PATHWAY-ID"]){const M=a[I]+=1;l.attrs["PATHWAY-ID"]=new Array(M+1).join(".");const K=new Wn(l);o[I]=K,n.push(K)}else o[I].addGroupId("audio",u.AUDIO),o[I].addGroupId("text",u.SUBTITLES);else{const M=new Wn(l);o[I]=M,a[I]=1,n.push(M)}}),this.filterAndSortMediaOptions(n,t,c,d,f)}filterAndSortMediaOptions(e,t,i,n,o){let a=[],c=[],d=e;if((i||n)&&o&&(d=d.filter(({videoCodec:m,videoRange:p,width:_,height:A})=>(!!m||!!(_&&A))&&i_(p))),d.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const m=new Error("no level with compatible codecs found in manifest");this.hls.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:m,reason:m.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:m}=this.hls.config;a=t.audioTracks.filter(p=>!p.audioCodec||Na(p.audioCodec,"audio",m)),ql(a)}t.subtitles&&(c=t.subtitles,ql(c));const f=d.slice(0);d.sort((m,p)=>{if(m.attrs["HDCP-LEVEL"]!==p.attrs["HDCP-LEVEL"])return(m.attrs["HDCP-LEVEL"]||"")>(p.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&m.height!==p.height)return m.height-p.height;if(m.frameRate!==p.frameRate)return m.frameRate-p.frameRate;if(m.videoRange!==p.videoRange)return $r.indexOf(m.videoRange)-$r.indexOf(p.videoRange);if(m.videoCodec!==p.videoCodec){const _=Xo(m.videoCodec),A=Xo(p.videoCodec);if(_!==A)return A-_}if(m.uri===p.uri&&m.codecSet!==p.codecSet){const _=Ur(m.codecSet),A=Ur(p.codecSet);if(_!==A)return A-_}return m.bitrate!==p.bitrate?m.bitrate-p.bitrate:0});let l=f[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==f.length)){for(let m=0;m<f.length;m++)if(f[m].pathwayId===d[0].pathwayId){l=f[m];break}}this._levels=d;for(let m=0;m<d.length;m++)if(d[m]===l){var h;this._firstLevel=m;const p=l.bitrate,_=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${p}`),((h=this.hls.userConfig)==null?void 0:h.abrEwmaDefaultEstimate)===void 0){const A=Math.min(p,this.hls.config.abrEwmaDefaultEstimateMax);A>_&&_===Wd.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=A)}break}const r=o&&!n,u={levels:d,audioTracks:a,subtitleTracks:c,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:n,altAudio:!r&&a.some(m=>!!m.url)};this.hls.trigger(W.MANIFEST_PARSED,u),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const l=new Error("invalid level idx"),h=e<0;if(this.hls.trigger(W.ERROR,{type:Lt.OTHER_ERROR,details:Ve.LEVEL_SWITCH_ERROR,level:e,fatal:h,error:l,reason:l.message}),h)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,n=this.currentLevel,o=n?n.attrs["PATHWAY-ID"]:void 0,a=t[e],c=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,i===e&&a.details&&n&&o===c)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${c?" with Pathway "+c:""} from level ${i}${o?" with Pathway "+o:""}`);const d={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(W.LEVEL_SWITCHING,d);const f=a.details;if(!f||f.live){const l=this.switchParams(a.uri,n==null?void 0:n.details);this.loadPlaylist(l)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Kt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Rt.MAIN){const i=t.elementaryStreams;if(!Object.keys(i).some(o=>!!i[o]))return;const n=this._levels[t.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,t){var i;const{level:n,details:o}=t,a=this._levels[n];if(!a){var c;this.warn(`Invalid level index ${n}`),(c=t.deliveryDirectives)!=null&&c.skip&&(o.deltaUpdateFailed=!0);return}n===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(n,t,a.details)):(i=t.deliveryDirectives)!=null&&i.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){let n=i.uri;if(e)try{n=e.addDirectives(n)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}const o=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} ${n}`),this.clearTimer(),this.hls.trigger(W.LEVEL_LOADING,{url:n,level:t,pathwayId:i.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const i=this._levels.filter((n,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(n),n===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,n.details&&n.details.fragments.forEach(a=>a.level=-1)),!1));cd(i),this._levels=i,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(W.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(W.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function ql(s){const e={};s.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}class ZA{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[i].loader;if(n){var t;if(e&&e!==((t=n.context)==null?void 0:t.frag.type))return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Ve.KEY_LOAD_ERROR,i,n,o){return new fn({type:Lt.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:o,error:i,networkDetails:n})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:n}=e;for(let o=0;o<t.length;o++){const a=t[o];if(n<=a.cc&&(i==="initSegment"||a.sn==="initSegment"||i<a.sn)){this.emeController.selectKeySystemFormat(a).then(c=>{a.setKeyFormat(c)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,n;t&&e.setKeyFormat(t);const o=e.decryptdata;if(!o){const f=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Ve.KEY_LOAD_ERROR,f))}const a=o.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,Ve.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let c=this.keyUriToKeyInfo[a];if((i=c)!=null&&i.decryptdata.key)return o.key=c.decryptdata.key,Promise.resolve({frag:e,keyInfo:c});if((n=c)!=null&&n.keyLoadPromise){var d;switch((d=c.mediaKeySessionContext)==null?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return c.keyLoadPromise.then(f=>(o.key=f.keyInfo.decryptdata.key,{frag:e,keyInfo:c}))}}switch(c=this.keyUriToKeyInfo[a]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(c,e):this.loadKeyEME(c,e);case"AES-128":return this.loadKeyHTTP(c,e);default:return Promise.reject(this.createKeyLoadError(e,Ve.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const n=this.emeController.loadKey(i);if(n)return(e.keyLoadPromise=n.then(o=>(e.mediaKeySessionContext=o,i))).catch(o=>{throw e.keyLoadPromise=null,o})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,n=i.loader,o=new n(i);return t.keyLoader=e.loader=o,e.keyLoadPromise=new Promise((a,c)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},f=i.keyLoadPolicy.default,l={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(r,u,m,p)=>{const{frag:_,keyInfo:A,url:E}=m;if(!_.decryptdata||A!==this.keyUriToKeyInfo[E])return c(this.createKeyLoadError(_,Ve.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),p));A.decryptdata.key=_.decryptdata.key=new Uint8Array(r.data),_.keyLoader=null,A.loader=null,a({frag:_,keyInfo:A})},onError:(r,u,m,p)=>{this.resetLoader(u),c(this.createKeyLoadError(t,Ve.KEY_LOAD_ERROR,new Error(`HTTP Error ${r.code} loading key ${r.text}`),m,wi({url:d.url,data:void 0},r)))},onTimeout:(r,u,m)=>{this.resetLoader(u),c(this.createKeyLoadError(t,Ve.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(r,u,m)=>{this.resetLoader(u),c(this.createKeyLoadError(t,Ve.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};o.load(d,l,h)})}resetLoader(e){const{frag:t,keyInfo:i,url:n}=e,o=i.loader;t.keyLoader===o&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[n],o&&o.destroy()}}function Yd(){return self.SourceBuffer||self.WebKitSourceBuffer}function Xd(){if(!Jn())return!1;const e=Yd();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function eb(){if(!Xd())return!1;const s=Jn();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(sr(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(sr(e,"audio"))))}function tb(){var s;const e=Yd();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const ib=250,Ir=2,nb=.1,rb=.05;class ab{constructor(e,t,i,n){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=n}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:i,media:n,stalled:o}=this;if(n===null)return;const{currentTime:a,seeking:c}=n,d=this.seeking&&!c,f=!this.seeking&&c;if(this.seeking=c,a!==e){if(this.moved=!0,c||(this.nudgeRetry=0),o!==null){if(this.stallReported){const _=self.performance.now()-o;De.warn(`playback not stuck anymore @${a}, after ${Math.round(_)}ms`),this.stallReported=!1}this.stalled=null}return}if(f||d){this.stalled=null;return}if(n.paused&&!c||n.ended||n.playbackRate===0||!li.getBuffered(n).length){this.nudgeRetry=0;return}const l=li.bufferInfo(n,a,0),h=l.nextStart||0;if(c){const _=l.len>Ir,A=!h||t&&t.start<=a||h-a>Ir&&!this.fragmentTracker.getPartialFragment(a);if(_||A)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var r;if(!(l.len>0)&&!h)return;const A=Math.max(h,l.start||0)-a,E=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=(E==null||(r=E.details)==null?void 0:r.live)?E.details.targetduration*2:Ir,O=this.fragmentTracker.getPartialFragment(a);if(A>0&&(A<=k||O)){n.paused||this._trySkipBufferHole(O);return}}const u=self.performance.now();if(o===null){this.stalled=u;return}const m=u-o;if(!c&&m>=ib&&(this._reportStall(l),!this.media))return;const p=li.bufferInfo(n,a,i.maxBufferHole);this._tryFixBufferStall(p,m)}_tryFixBufferStall(e,t){const{config:i,fragmentTracker:n,media:o}=this;if(o===null)return;const a=o.currentTime,c=n.getPartialFragment(a);c&&(this._trySkipBufferHole(c)||!this.media)||(e.len>i.maxBufferHole||e.nextStart&&e.nextStart-a<i.maxBufferHole)&&t>i.highBufferWatchdogPeriod*1e3&&(De.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:i,stallReported:n}=this;if(!n&&i){this.stallReported=!0;const o=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(e)})`);De.warn(o.message),t.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:i,media:n}=this;if(n===null)return 0;const o=n.currentTime,a=li.bufferInfo(n,o,0),c=o<a.start?a.start:a.nextStart;if(c){const d=a.len<=t.maxBufferHole,f=a.len>0&&a.len<1&&n.readyState<3,l=c-o;if(l>0&&(d||f)){if(l>t.maxBufferHole){const{fragmentTracker:r}=this;let u=!1;if(o===0){const m=r.getAppendedFrag(0,Rt.MAIN);m&&c<m.end&&(u=!0)}if(!u){const m=e||r.getAppendedFrag(o,Rt.MAIN);if(m){let p=!1,_=m.end;for(;_<c;){const A=r.getPartialFragment(_);if(A)_+=A.duration;else{p=!0;break}}if(p)return 0}}}const h=Math.max(c+rb,o+nb);if(De.warn(`skipping hole, adjusting currentTime from ${o} to ${h}`),this.moved=!0,this.stalled=null,n.currentTime=h,e&&!e.gap){const r=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${h}`);i.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:r,reason:r.message,frag:e})}return h}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:i,nudgeRetry:n}=this;if(i===null)return;const o=i.currentTime;if(this.nudgeRetry++,n<e.nudgeMaxRetry){const a=o+(n+1)*e.nudgeOffset,c=new Error(`Nudging 'currentTime' from ${o} to ${a}`);De.warn(c.message),i.currentTime=a,t.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_NUDGE_ON_STALL,error:c,fatal:!1})}else{const a=new Error(`Playhead still not moving while enough data buffered @${o} after ${e.nudgeMaxRetry} nudges`);De.error(a.message),t.trigger(W.ERROR,{type:Lt.MEDIA_ERROR,details:Ve.BUFFER_STALLED_ERROR,error:a,fatal:!0})}}}const sb=100;class ob extends Ys{constructor(e,t,i){super(e,t,i,"[stream-controller]",Rt.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(W.ERROR,this.onError,this),e.on(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(W.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(W.BUFFER_CREATED,this.onBufferCreated,this),e.on(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(W.ERROR,this.onError,this),e.off(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(W.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(W.BUFFER_CREATED,this.onBufferCreated,this),e.off(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:i}=this;if(this.stopLoad(),this.setInterval(sb),this.level=-1,!this.startFragRequested){let n=i.startLevel;n===-1&&(i.config.testBandwidth&&this.levels.length>1?(n=0,this.bitrateTest=!0):n=i.firstAutoLevel),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=Xe.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Xe.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Xe.WAITING_LEVEL:{const{levels:t,level:i}=this,n=t==null?void 0:t[i],o=n==null?void 0:n.details;if(o&&(!o.live||this.levelLastLoaded===n)){if(this.waitForCdnTuneIn(o))break;this.state=Xe.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=Xe.IDLE;break}break}case Xe.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),i=this.retryDate;if(!i||t>=i||(e=this.media)!=null&&e.seeking){const{levels:n,level:o}=this,a=n==null?void 0:n[o];this.resetStartWhenNotLoaded(a||null),this.state=Xe.IDLE}}break}this.state===Xe.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:n}=this,{config:o,nextLoadLevel:a}=e;if(t===null||!n&&(this.startFragRequested||!o.startFragPrefetch)||this.altAudio&&this.audioOnly||!(i!=null&&i[a]))return;const c=i[a],d=this.getMainFwdBufferInfo();if(d===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(d,f)){const _={};this.altAudio&&(_.type="video"),this.hls.trigger(W.BUFFER_EOS,_),this.state=Xe.ENDED;return}e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const l=c.details;if(!l||this.state===Xe.WAITING_LEVEL||l.live&&this.levelLastLoaded!==c){this.level=a,this.state=Xe.WAITING_LEVEL;return}const h=d.len,r=this.getMaxBufferLength(c.maxBitrate);if(h>=r)return;this.backtrackFragment&&this.backtrackFragment.start>d.end&&(this.backtrackFragment=null);const u=this.backtrackFragment?this.backtrackFragment.start:d.end;let m=this.getNextFragment(u,l);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==Li.OK){var p;const A=((p=this.backtrackFragment)!=null?p:m).sn-l.startSN,E=l.fragments[A-1];E&&m.cc===E.cc&&(m=E,this.fragmentTracker.removeFragment(E))}else this.backtrackFragment&&d.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,u)){if(!m.gap){const A=this.audioOnly&&!this.altAudio?Zt.AUDIO:Zt.VIDEO,E=(A===Zt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;E&&this.afterBufferFlushed(E,A,Rt.MAIN)}m=this.getNextFragmentLoopLoading(m,l,d,Rt.MAIN,r)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,c,u))}loadFragment(e,t,i){const n=this.fragmentTracker.getState(e);this.fragCurrent=e,n===Li.NOT_LOADED||n===Li.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Rt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const c=this.getMainFwdBufferInfo();if(!c||c.len<o.targetduration*2)return}if(!t.paused&&e){const c=this.hls.nextLoadLevel,d=e[c],f=this.fragLastKbps;f&&this.fragCurrent?i=this.fragCurrent.duration*d.maxBitrate/(1e3*f)+1:i=0}else i=0;const a=this.getBufferedFrag(t.currentTime+i);if(a){const c=this.followingBufferedFrag(a);if(c){this.abortCurrentFrag();const d=c.maxStartPTS?c.maxStartPTS:c.start,f=c.duration,l=Math.max(a.end,d+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(l,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Xe.KEY_LOADING:case Xe.FRAG_LOADING:case Xe.FRAG_LOADING_WAITING_RETRY:case Xe.PARSING:case Xe.PARSED:this.state=Xe.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new ab(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;vt(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const i=this.getMainFwdBufferInfo();if(i===null||i.len===0){this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(W.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let i=!1,n=!1;t.levels.forEach(o=>{const a=o.audioCodec;a&&(i=i||a.indexOf("mp4a.40.2")!==-1,n=n||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=i&&n&&!tb(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==Xe.IDLE)return;const n=i[t.level];(!n.details||n.details.live&&this.levelLastLoaded!==n||this.waitForCdnTuneIn(n.details))&&(this.state=Xe.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:n}=this,o=t.level,a=t.details,c=a.totalduration;if(!n){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${c}`);const d=n[o],f=this.fragCurrent;f&&(this.state===Xe.FRAG_LOADING||this.state===Xe.FRAG_LOADING_WAITING_RETRY)&&f.level!==t.level&&f.loader&&this.abortCurrentFrag();let l=0;if(a.live||(i=d.details)!=null&&i.live){var h;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;l=this.alignPlaylists(a,d.details,(h=this.levelLastLoaded)==null?void 0:h.details)}if(d.details=a,this.levelLastLoaded=d,this.hls.trigger(W.LEVEL_UPDATED,{details:a,level:o}),this.state===Xe.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=Xe.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,l),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:n,payload:o}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const c=a[i.level],d=c.details;if(!d){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const f=c.videoCodec,l=d.PTSKnown||!d.live,h=(t=i.initSegment)==null?void 0:t.data,r=this._getAudioCodec(c),u=this.transmuxer=this.transmuxer||new Ld(this.hls,Rt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=n?n.index:-1,p=m!==-1,_=new Ks(i.level,i.sn,i.stats.chunkCount,o.byteLength,m,p),A=this.initPTS[i.cc];u.push(o,h,r,f,i,n,d.totalduration,l,_,A)}onAudioTrackSwitching(e,t){const i=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const o=this.hls;i&&(o.trigger(W.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),o.trigger(W.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=t.id,n=!!this.hls.audioTracks[i].url;if(n){const o=this.videoBuffer;o&&this.mediaBuffer!==o&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=o)}this.altAudio=n,this.tick()}onBufferCreated(e,t){const i=t.tracks;let n,o,a=!1;for(const c in i){const d=i[c];if(d.id==="main"){if(o=c,n=d,c==="video"){const f=i[c];f&&(this.videoBuffer=f.buffer)}}else a=!0}a&&n?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:n}=t;if(i&&i.type!==Rt.MAIN)return;if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Xe.PARSED&&(this.state=Xe.IDLE);return}const o=n?n.stats:i.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),i.sn!=="initSegment"&&(this.fragPrevious=i),this.fragBufferedComplete(i,n)}onError(e,t){var i;if(t.fatal){this.state=Xe.ERROR;return}switch(t.details){case Ve.FRAG_GAP:case Ve.FRAG_PARSING_ERROR:case Ve.FRAG_DECRYPT_ERROR:case Ve.FRAG_LOAD_ERROR:case Ve.FRAG_LOAD_TIMEOUT:case Ve.KEY_LOAD_ERROR:case Ve.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Rt.MAIN,t);break;case Ve.LEVEL_LOAD_ERROR:case Ve.LEVEL_LOAD_TIMEOUT:case Ve.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Xe.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===Kt.LEVEL&&(this.state=Xe.IDLE);break;case Ve.BUFFER_APPEND_ERROR:case Ve.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===Ve.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Ve.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!li.getBuffered(e).length){const i=this.state!==Xe.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,i)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Xe.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Zt.AUDIO||this.audioOnly&&!this.altAudio){const i=(t===Zt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(i,t,Rt.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const n=li.getBuffered(e),a=(n.length?n.start(0):0)-i;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),i+=a,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${t}`),e.currentTime=i}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:n}=this;if(!i||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Xe.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=e.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),n.trigger(W.FRAG_LOADED,i),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i="main",{hls:n}=this,{remuxResult:o,chunkMeta:a}=e,c=this.getCurrentContext(a);if(!c){this.resetWhenMissingContext(a);return}const{frag:d,part:f,level:l}=c,{video:h,text:r,id3:u,initSegment:m}=o,{details:p}=l,_=this.altAudio?void 0:o.audio;if(this.fragContextChanged(d)){this.fragmentTracker.removeFragment(d);return}if(this.state=Xe.PARSING,m){if(m!=null&&m.tracks){const C=d.initSegment||d;this._bufferInitSegment(l,m.tracks,C,a),n.trigger(W.FRAG_PARSING_INIT_SEGMENT,{frag:C,id:i,tracks:m.tracks})}const A=m.initPTS,E=m.timescale;vt(A)&&(this.initPTS[d.cc]={baseTime:A,timescale:E},n.trigger(W.INIT_PTS_FOUND,{frag:d,id:i,initPTS:A,timescale:E}))}if(h&&p&&d.sn!=="initSegment"){const A=p.fragments[d.sn-1-p.startSN],E=d.sn===p.startSN,C=!A||d.cc>A.cc;if(o.independent!==!1){const{startPTS:k,endPTS:O,startDTS:G,endDTS:B}=h;if(f)f.elementaryStreams[h.type]={startPTS:k,endPTS:O,startDTS:G,endDTS:B};else if(h.firstKeyFrame&&h.independent&&a.id===1&&!C&&(this.couldBacktrack=!0),h.dropped&&h.independent){const T=this.getMainFwdBufferInfo(),L=(T?T.end:this.getLoadPosition())+this.config.maxBufferHole,I=h.firstKeyFramePTS?h.firstKeyFramePTS:k;if(!E&&L<I-this.config.maxBufferHole&&!C){this.backtrack(d);return}else C&&(d.gap=!0);d.setElementaryStreamInfo(h.type,d.start,O,d.start,B,!0)}else E&&k>Ir&&(d.gap=!0);d.setElementaryStreamInfo(h.type,k,O,G,B),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(h,d,f,a,E||C)}else if(E||C)d.gap=!0;else{this.backtrack(d);return}}if(_){const{startPTS:A,endPTS:E,startDTS:C,endDTS:k}=_;f&&(f.elementaryStreams[Zt.AUDIO]={startPTS:A,endPTS:E,startDTS:C,endDTS:k}),d.setElementaryStreamInfo(Zt.AUDIO,A,E,C,k),this.bufferFragmentData(_,d,f,a)}if(p&&u!=null&&(t=u.samples)!=null&&t.length){const A={id:i,frag:d,details:p,samples:u.samples};n.trigger(W.FRAG_PARSING_METADATA,A)}if(p&&r){const A={id:i,frag:d,details:p,samples:r.samples};n.trigger(W.FRAG_PARSING_USERDATA,A)}}_bufferInitSegment(e,t,i,n){if(this.state!==Xe.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:o,video:a,audiovideo:c}=t;if(o){let d=e.audioCodec;const f=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(d&&(d.indexOf("mp4a.40.5")!==-1?d="mp4a.40.2":d="mp4a.40.5"),o.metadata.channelCount!==1&&f.indexOf("firefox")===-1&&(d="mp4a.40.5")),d&&d.indexOf("mp4a.40.5")!==-1&&f.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(d="mp4a.40.2",this.log(`Android: force audio codec to ${d}`)),e.audioCodec&&e.audioCodec!==d&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${d}"`),o.levelCodec=d,o.id="main",this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${d||""}/${e.audioCodec||""}/${o.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),c&&this.log(`Init audiovideo buffer, container:${c.container}, codecs[level/parsed]=[${e.codecs}/${c.codec}]`),this.hls.trigger(W.BUFFER_CODECS,t),Object.keys(t).forEach(d=>{const l=t[d].initSegment;l!=null&&l.byteLength&&this.hls.trigger(W.BUFFER_APPENDING,{type:d,data:l,frag:i,part:null,chunkMeta:n,parent:i.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Rt.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Xe.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(li.isBuffered(e,i)?t=this.getAppendedFrag(i):li.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const n=this.fragPlaying,o=t.level;(!n||t.sn!==n.sn||n.level!==o)&&(this.fragPlaying=t,this.hls.trigger(W.FRAG_CHANGED,{frag:t}),(!n||n.level!==o)&&this.hls.trigger(W.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,i=this.currentFrag;if(i&&vt(t)&&vt(i.programDateTime)){const n=i.programDateTime+(t-i.start)*1e3;return new Date(n)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class yn{static get version(){return"1.5.1-patch.1"}static isMSESupported(){return Xd()}static isSupported(){return eb()}static getMediaSource(){return Jn()}static get Events(){return W}static get ErrorTypes(){return Lt}static get ErrorDetails(){return Ve}static get DefaultConfig(){return yn.defaultConfig?yn.defaultConfig:Wd}static set DefaultConfig(e){yn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new eo,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,ty(e.debug||!1,"Hls instance");const t=this.config=XA(yn.DefaultConfig,e);this.userConfig=e,t.progressive&&JA(t);const{abrController:i,bufferController:n,capLevelController:o,errorController:a,fpsController:c}=t,d=new a(this),f=this.abrController=new i(this),l=this.bufferController=new n(this),h=this.capLevelController=new o(this),r=new c(this),u=new Wy(this),m=new Zy(this),p=t.contentSteeringController,_=p?new p(this):null,A=this.levelController=new QA(this,_),E=new k_(this),C=new ZA(this.config),k=this.streamController=new ob(this,E,C);h.setStreamController(k),r.setStreamController(k);const O=[u,A,k];_&&O.splice(1,0,_),this.networkControllers=O;const G=[f,l,h,r,m,E];this.audioTrackController=this.createController(t.audioTrackController,O);const B=t.audioStreamController;B&&O.push(new B(this,E,C)),this.subtitleTrackController=this.createController(t.subtitleTrackController,O);const T=t.subtitleStreamController;T&&O.push(new T(this,E,C)),this.createController(t.timelineController,G),C.emeController=this.emeController=this.createController(t.emeController,G),this.cmcdController=this.createController(t.cmcdController,G),this.latencyController=this.createController(e_,G),this.coreComponents=G,O.push(d);const L=d.onErrorOut;typeof L=="function"&&this.on(W.ERROR,L,d)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,n){this._emitter.off(e,t,i,n)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(De.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const n=e===W.ERROR;this.trigger(W.ERROR,{type:Lt.OTHER_ERROR,details:Ve.INTERNAL_EXCEPTION,fatal:n,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){De.log("destroy"),this.trigger(W.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){De.log("attachMedia"),this._media=e,this.trigger(W.MEDIA_ATTACHING,{media:e})}detachMedia(){De.log("detachMedia"),this.trigger(W.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,i=this.url,n=this.url=Gs.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,De.log(`loadSource:${n}`),t&&i&&(i!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(W.MANIFEST_LOADING,{url:e})}startLoad(e=-1){De.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){De.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){De.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){De.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){De.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){De.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){De.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){De.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){De.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(De.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){t_(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let n=0;n<i;n++)if(e[n].maxBitrate>=t)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let n;if(t===-1&&e!=null&&e.length?n=e.length-1:n=t,i)for(let o=n;o--;){const a=e[o].attrs["HDCP-LEVEL"];if(a&&a<=i)return o}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}yn.defaultConfig=void 0;var Jd={exports:{}};(function(s,e){(function(t,i){s.exports=i()})(window,function(){return function(t){var i={};function n(o){if(i[o])return i[o].exports;var a=i[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=i,n.d=function(o,a,c){n.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:c})},n.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.t=function(o,a){if(1&a&&(o=n(o)),8&a||4&a&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),2&a&&typeof o!="string")for(var d in o)n.d(c,d,(function(f){return o[f]}).bind(null,d));return c},n.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(a,"a",a),a},n.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},n.p="",n(n.s=24)}([function(t,i,n){var o=n(10),a=n.n(o),c=function(){function d(){}return d.e=function(f,l){f&&!d.FORCE_GLOBAL_TAG||(f=d.GLOBAL_TAG);var h="[".concat(f,"] > ").concat(l);d.ENABLE_CALLBACK&&d.emitter.emit("log","error",h),d.ENABLE_ERROR&&(console.error?console.error(h):console.warn?console.warn(h):console.log(h))},d.i=function(f,l){f&&!d.FORCE_GLOBAL_TAG||(f=d.GLOBAL_TAG);var h="[".concat(f,"] > ").concat(l);d.ENABLE_CALLBACK&&d.emitter.emit("log","info",h),d.ENABLE_INFO&&(console.info?console.info(h):console.log(h))},d.w=function(f,l){f&&!d.FORCE_GLOBAL_TAG||(f=d.GLOBAL_TAG);var h="[".concat(f,"] > ").concat(l);d.ENABLE_CALLBACK&&d.emitter.emit("log","warn",h),d.ENABLE_WARN&&(console.warn?console.warn(h):console.log(h))},d.d=function(f,l){f&&!d.FORCE_GLOBAL_TAG||(f=d.GLOBAL_TAG);var h="[".concat(f,"] > ").concat(l);d.ENABLE_CALLBACK&&d.emitter.emit("log","debug",h),d.ENABLE_DEBUG&&(console.debug?console.debug(h):console.log(h))},d.v=function(f,l){f&&!d.FORCE_GLOBAL_TAG||(f=d.GLOBAL_TAG);var h="[".concat(f,"] > ").concat(l);d.ENABLE_CALLBACK&&d.emitter.emit("log","verbose",h),d.ENABLE_VERBOSE&&console.log(h)},d}();c.GLOBAL_TAG="mpegts.js",c.FORCE_GLOBAL_TAG=!1,c.ENABLE_ERROR=!0,c.ENABLE_INFO=!0,c.ENABLE_WARN=!0,c.ENABLE_DEBUG=!0,c.ENABLE_VERBOSE=!0,c.ENABLE_CALLBACK=!1,c.emitter=new a.a,i.a=c},function(t,i,n){var o;(function(a){a.IO_ERROR="io_error",a.DEMUX_ERROR="demux_error",a.INIT_SEGMENT="init_segment",a.MEDIA_SEGMENT="media_segment",a.LOADING_COMPLETE="loading_complete",a.RECOVERED_EARLY_EOF="recovered_early_eof",a.MEDIA_INFO="media_info",a.METADATA_ARRIVED="metadata_arrived",a.SCRIPTDATA_ARRIVED="scriptdata_arrived",a.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",a.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",a.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",a.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",a.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",a.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",a.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",a.STATISTICS_INFO="statistics_info",a.RECOMMEND_SEEKPOINT="recommend_seekpoint"})(o||(o={})),i.a=o},function(t,i,n){n.d(i,"c",function(){return a}),n.d(i,"b",function(){return c}),n.d(i,"a",function(){return d});var o=n(3),a={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},c={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},d=function(){function f(l){this._type=l||"undefined",this._status=a.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return f.prototype.destroy=function(){this._status=a.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},f.prototype.isWorking=function(){return this._status===a.kConnecting||this._status===a.kBuffering},Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(l){this._onContentLengthKnown=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(l){this._onURLRedirect=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(l){this._onDataArrival=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onError",{get:function(){return this._onError},set:function(l){this._onError=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onComplete",{get:function(){return this._onComplete},set:function(l){this._onComplete=l},enumerable:!1,configurable:!0}),f.prototype.open=function(l,h){throw new o.c("Unimplemented abstract function!")},f.prototype.abort=function(){throw new o.c("Unimplemented abstract function!")},f}()},function(t,i,n){n.d(i,"d",function(){return c}),n.d(i,"a",function(){return d}),n.d(i,"b",function(){return f}),n.d(i,"c",function(){return l});var o,a=(o=function(h,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,m){u.__proto__=m}||function(u,m){for(var p in m)Object.prototype.hasOwnProperty.call(m,p)&&(u[p]=m[p])})(h,r)},function(h,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function u(){this.constructor=h}o(h,r),h.prototype=r===null?Object.create(r):(u.prototype=r.prototype,new u)}),c=function(){function h(r){this._message=r}return Object.defineProperty(h.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),h.prototype.toString=function(){return this.name+": "+this.message},h}(),d=function(h){function r(u){return h.call(this,u)||this}return a(r,h),Object.defineProperty(r.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),r}(c),f=function(h){function r(u){return h.call(this,u)||this}return a(r,h),Object.defineProperty(r.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),r}(c),l=function(h){function r(u){return h.call(this,u)||this}return a(r,h),Object.defineProperty(r.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),r}(c)},function(t,i,n){var o;(function(a){a.ERROR="error",a.LOADING_COMPLETE="loading_complete",a.RECOVERED_EARLY_EOF="recovered_early_eof",a.MEDIA_INFO="media_info",a.METADATA_ARRIVED="metadata_arrived",a.SCRIPTDATA_ARRIVED="scriptdata_arrived",a.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",a.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",a.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",a.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",a.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",a.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",a.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",a.STATISTICS_INFO="statistics_info",a.DESTROYING="destroying"})(o||(o={})),i.a=o},function(t,i,n){var o={};(function(){var a=self.navigator.userAgent.toLowerCase(),c=/(edge)\/([\w.]+)/.exec(a)||/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(iemobile)[\/]([\w.]+)/.exec(a)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(a)||[],d=/(ipad)/.exec(a)||/(ipod)/.exec(a)||/(windows phone)/.exec(a)||/(iphone)/.exec(a)||/(kindle)/.exec(a)||/(android)/.exec(a)||/(windows)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/.exec(a)||[],f={browser:c[5]||c[3]||c[1]||"",version:c[2]||c[4]||"0",majorVersion:c[4]||c[2]||"0",platform:d[0]||""},l={};if(f.browser){l[f.browser]=!0;var h=f.majorVersion.split(".");l.version={major:parseInt(f.majorVersion,10),string:f.version},h.length>1&&(l.version.minor=parseInt(h[1],10)),h.length>2&&(l.version.build=parseInt(h[2],10))}f.platform&&(l[f.platform]=!0),(l.chrome||l.opr||l.safari)&&(l.webkit=!0),(l.rv||l.iemobile)&&(l.rv&&delete l.rv,f.browser="msie",l.msie=!0),l.edge&&(delete l.edge,f.browser="msedge",l.msedge=!0),l.opr&&(f.browser="opera",l.opera=!0),l.safari&&l.android&&(f.browser="android",l.android=!0);for(var r in l.name=f.browser,l.platform=f.platform,o)o.hasOwnProperty(r)&&delete o[r];Object.assign(o,l)})(),i.a=o},function(t,i,n){i.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(t,i,n){var o;(function(a){a.ERROR="error",a.SOURCE_OPEN="source_open",a.UPDATE_END="update_end",a.BUFFER_FULL="buffer_full",a.START_STREAMING="start_streaming",a.END_STREAMING="end_streaming"})(o||(o={})),i.a=o},function(t,i,n){var o=n(3),a=function(){function c(d){this.TAG="ExpGolomb",this._buffer=d,this._buffer_index=0,this._total_bytes=d.byteLength,this._total_bits=8*d.byteLength,this._current_word=0,this._current_word_bits_left=0}return c.prototype.destroy=function(){this._buffer=null},c.prototype._fillCurrentWord=function(){var d=this._total_bytes-this._buffer_index;if(d<=0)throw new o.a("ExpGolomb: _fillCurrentWord() but no bytes available");var f=Math.min(4,d),l=new Uint8Array(4);l.set(this._buffer.subarray(this._buffer_index,this._buffer_index+f)),this._current_word=new DataView(l.buffer).getUint32(0,!1),this._buffer_index+=f,this._current_word_bits_left=8*f},c.prototype.readBits=function(d){if(d>32)throw new o.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(d<=this._current_word_bits_left){var f=this._current_word>>>32-d;return this._current_word<<=d,this._current_word_bits_left-=d,f}var l=this._current_word_bits_left?this._current_word:0;l>>>=32-this._current_word_bits_left;var h=d-this._current_word_bits_left;this._fillCurrentWord();var r=Math.min(h,this._current_word_bits_left),u=this._current_word>>>32-r;return this._current_word<<=r,this._current_word_bits_left-=r,l=l<<r|u},c.prototype.readBool=function(){return this.readBits(1)===1},c.prototype.readByte=function(){return this.readBits(8)},c.prototype._skipLeadingZero=function(){var d;for(d=0;d<this._current_word_bits_left;d++)if(this._current_word&2147483648>>>d)return this._current_word<<=d,this._current_word_bits_left-=d,d;return this._fillCurrentWord(),d+this._skipLeadingZero()},c.prototype.readUEG=function(){var d=this._skipLeadingZero();return this.readBits(d+1)-1},c.prototype.readSEG=function(){var d=this.readUEG();return 1&d?d+1>>>1:-1*(d>>>1)},c}();i.a=a},function(t,i,n){var o=n(10),a=n.n(o),c=n(0),d=function(){function f(){}return Object.defineProperty(f,"forceGlobalTag",{get:function(){return c.a.FORCE_GLOBAL_TAG},set:function(l){c.a.FORCE_GLOBAL_TAG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"globalTag",{get:function(){return c.a.GLOBAL_TAG},set:function(l){c.a.GLOBAL_TAG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableAll",{get:function(){return c.a.ENABLE_VERBOSE&&c.a.ENABLE_DEBUG&&c.a.ENABLE_INFO&&c.a.ENABLE_WARN&&c.a.ENABLE_ERROR},set:function(l){c.a.ENABLE_VERBOSE=l,c.a.ENABLE_DEBUG=l,c.a.ENABLE_INFO=l,c.a.ENABLE_WARN=l,c.a.ENABLE_ERROR=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableDebug",{get:function(){return c.a.ENABLE_DEBUG},set:function(l){c.a.ENABLE_DEBUG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableVerbose",{get:function(){return c.a.ENABLE_VERBOSE},set:function(l){c.a.ENABLE_VERBOSE=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableInfo",{get:function(){return c.a.ENABLE_INFO},set:function(l){c.a.ENABLE_INFO=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableWarn",{get:function(){return c.a.ENABLE_WARN},set:function(l){c.a.ENABLE_WARN=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableError",{get:function(){return c.a.ENABLE_ERROR},set:function(l){c.a.ENABLE_ERROR=l,f._notifyChange()},enumerable:!1,configurable:!0}),f.getConfig=function(){return{globalTag:c.a.GLOBAL_TAG,forceGlobalTag:c.a.FORCE_GLOBAL_TAG,enableVerbose:c.a.ENABLE_VERBOSE,enableDebug:c.a.ENABLE_DEBUG,enableInfo:c.a.ENABLE_INFO,enableWarn:c.a.ENABLE_WARN,enableError:c.a.ENABLE_ERROR,enableCallback:c.a.ENABLE_CALLBACK}},f.applyConfig=function(l){c.a.GLOBAL_TAG=l.globalTag,c.a.FORCE_GLOBAL_TAG=l.forceGlobalTag,c.a.ENABLE_VERBOSE=l.enableVerbose,c.a.ENABLE_DEBUG=l.enableDebug,c.a.ENABLE_INFO=l.enableInfo,c.a.ENABLE_WARN=l.enableWarn,c.a.ENABLE_ERROR=l.enableError,c.a.ENABLE_CALLBACK=l.enableCallback},f._notifyChange=function(){var l=f.emitter;if(l.listenerCount("change")>0){var h=f.getConfig();l.emit("change",h)}},f.registerListener=function(l){f.emitter.addListener("change",l)},f.removeListener=function(l){f.emitter.removeListener("change",l)},f.addLogListener=function(l){c.a.emitter.addListener("log",l),c.a.emitter.listenerCount("log")>0&&(c.a.ENABLE_CALLBACK=!0,f._notifyChange())},f.removeLogListener=function(l){c.a.emitter.removeListener("log",l),c.a.emitter.listenerCount("log")===0&&(c.a.ENABLE_CALLBACK=!1,f._notifyChange())},f}();d.emitter=new a.a,i.a=d},function(t,i,n){var o,a=typeof Reflect=="object"?Reflect:null,c=a&&typeof a.apply=="function"?a.apply:function(k,O,G){return Function.prototype.apply.call(k,O,G)};o=a&&typeof a.ownKeys=="function"?a.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var d=Number.isNaN||function(k){return k!=k};function f(){f.init.call(this)}t.exports=f,t.exports.once=function(k,O){return new Promise(function(G,B){function T(I){k.removeListener(O,L),B(I)}function L(){typeof k.removeListener=="function"&&k.removeListener("error",T),G([].slice.call(arguments))}C(k,O,L,{once:!0}),O!=="error"&&function(I,M,K){typeof I.on=="function"&&C(I,"error",M,K)}(k,T,{once:!0})})},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var l=10;function h(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}function r(k){return k._maxListeners===void 0?f.defaultMaxListeners:k._maxListeners}function u(k,O,G,B){var T,L,I,M;if(h(G),(L=k._events)===void 0?(L=k._events=Object.create(null),k._eventsCount=0):(L.newListener!==void 0&&(k.emit("newListener",O,G.listener?G.listener:G),L=k._events),I=L[O]),I===void 0)I=L[O]=G,++k._eventsCount;else if(typeof I=="function"?I=L[O]=B?[G,I]:[I,G]:B?I.unshift(G):I.push(G),(T=r(k))>0&&I.length>T&&!I.warned){I.warned=!0;var K=new Error("Possible EventEmitter memory leak detected. "+I.length+" "+String(O)+" listeners added. Use emitter.setMaxListeners() to increase limit");K.name="MaxListenersExceededWarning",K.emitter=k,K.type=O,K.count=I.length,M=K,console&&console.warn&&console.warn(M)}return k}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(k,O,G){var B={fired:!1,wrapFn:void 0,target:k,type:O,listener:G},T=m.bind(B);return T.listener=G,B.wrapFn=T,T}function _(k,O,G){var B=k._events;if(B===void 0)return[];var T=B[O];return T===void 0?[]:typeof T=="function"?G?[T.listener||T]:[T]:G?function(L){for(var I=new Array(L.length),M=0;M<I.length;++M)I[M]=L[M].listener||L[M];return I}(T):E(T,T.length)}function A(k){var O=this._events;if(O!==void 0){var G=O[k];if(typeof G=="function")return 1;if(G!==void 0)return G.length}return 0}function E(k,O){for(var G=new Array(O),B=0;B<O;++B)G[B]=k[B];return G}function C(k,O,G,B){if(typeof k.on=="function")B.once?k.once(O,G):k.on(O,G);else{if(typeof k.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k);k.addEventListener(O,function T(L){B.once&&k.removeEventListener(O,T),G(L)})}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(k){if(typeof k!="number"||k<0||d(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");l=k}}),f.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||d(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},f.prototype.getMaxListeners=function(){return r(this)},f.prototype.emit=function(k){for(var O=[],G=1;G<arguments.length;G++)O.push(arguments[G]);var B=k==="error",T=this._events;if(T!==void 0)B=B&&T.error===void 0;else if(!B)return!1;if(B){var L;if(O.length>0&&(L=O[0]),L instanceof Error)throw L;var I=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw I.context=L,I}var M=T[k];if(M===void 0)return!1;if(typeof M=="function")c(M,this,O);else{var K=M.length,re=E(M,K);for(G=0;G<K;++G)c(re[G],this,O)}return!0},f.prototype.addListener=function(k,O){return u(this,k,O,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(k,O){return u(this,k,O,!0)},f.prototype.once=function(k,O){return h(O),this.on(k,p(this,k,O)),this},f.prototype.prependOnceListener=function(k,O){return h(O),this.prependListener(k,p(this,k,O)),this},f.prototype.removeListener=function(k,O){var G,B,T,L,I;if(h(O),(B=this._events)===void 0)return this;if((G=B[k])===void 0)return this;if(G===O||G.listener===O)--this._eventsCount==0?this._events=Object.create(null):(delete B[k],B.removeListener&&this.emit("removeListener",k,G.listener||O));else if(typeof G!="function"){for(T=-1,L=G.length-1;L>=0;L--)if(G[L]===O||G[L].listener===O){I=G[L].listener,T=L;break}if(T<0)return this;T===0?G.shift():function(M,K){for(;K+1<M.length;K++)M[K]=M[K+1];M.pop()}(G,T),G.length===1&&(B[k]=G[0]),B.removeListener!==void 0&&this.emit("removeListener",k,I||O)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(k){var O,G,B;if((G=this._events)===void 0)return this;if(G.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):G[k]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete G[k]),this;if(arguments.length===0){var T,L=Object.keys(G);for(B=0;B<L.length;++B)(T=L[B])!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(O=G[k])=="function")this.removeListener(k,O);else if(O!==void 0)for(B=O.length-1;B>=0;B--)this.removeListener(k,O[B]);return this},f.prototype.listeners=function(k){return _(this,k,!0)},f.prototype.rawListeners=function(k){return _(this,k,!1)},f.listenerCount=function(k,O){return typeof k.listenerCount=="function"?k.listenerCount(O):A.call(k,O)},f.prototype.listenerCount=A,f.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]}},function(t,i,n){n.d(i,"b",function(){return c}),n.d(i,"a",function(){return d});var o=n(2),a=n(6),c={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},d={NETWORK_EXCEPTION:o.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:o.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:o.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:o.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:a.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:a.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:a.a.CODEC_UNSUPPORTED}},function(t,i,n){n.d(i,"d",function(){return o}),n.d(i,"b",function(){return a}),n.d(i,"a",function(){return c}),n.d(i,"c",function(){return d});var o=function(f,l,h,r,u){this.dts=f,this.pts=l,this.duration=h,this.originalDts=r,this.isSyncPoint=u,this.fileposition=null},a=function(){function f(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return f.prototype.appendSyncPoint=function(l){l.isSyncPoint=!0,this.syncPoints.push(l)},f}(),c=function(){function f(){this._list=[]}return f.prototype.clear=function(){this._list=[]},f.prototype.appendArray=function(l){var h=this._list;l.length!==0&&(h.length>0&&l[0].originalDts<h[h.length-1].originalDts&&this.clear(),Array.prototype.push.apply(h,l))},f.prototype.getLastSyncPointBeforeDts=function(l){if(this._list.length==0)return null;var h=this._list,r=0,u=h.length-1,m=0,p=0,_=u;for(l<h[0].dts&&(r=0,p=_+1);p<=_;){if((m=p+Math.floor((_-p)/2))===u||l>=h[m].dts&&l<h[m+1].dts){r=m;break}h[m].dts<l?p=m+1:_=m-1}return this._list[r]},f}(),d=function(){function f(l){this._type=l,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),f.prototype.isEmpty=function(){return this._list.length===0},f.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},f.prototype._searchNearestSegmentBefore=function(l){var h=this._list;if(h.length===0)return-2;var r=h.length-1,u=0,m=0,p=r,_=0;if(l<h[0].originalBeginDts)return _=-1;for(;m<=p;){if((u=m+Math.floor((p-m)/2))===r||l>h[u].lastSample.originalDts&&l<h[u+1].originalBeginDts){_=u;break}h[u].originalBeginDts<l?m=u+1:p=u-1}return _},f.prototype._searchNearestSegmentAfter=function(l){return this._searchNearestSegmentBefore(l)+1},f.prototype.append=function(l){var h=this._list,r=l,u=this._lastAppendLocation,m=0;u!==-1&&u<h.length&&r.originalBeginDts>=h[u].lastSample.originalDts&&(u===h.length-1||u<h.length-1&&r.originalBeginDts<h[u+1].originalBeginDts)?m=u+1:h.length>0&&(m=this._searchNearestSegmentBefore(r.originalBeginDts)+1),this._lastAppendLocation=m,this._list.splice(m,0,r)},f.prototype.getLastSegmentBefore=function(l){var h=this._searchNearestSegmentBefore(l);return h>=0?this._list[h]:null},f.prototype.getLastSampleBefore=function(l){var h=this.getLastSegmentBefore(l);return h!=null?h.lastSample:null},f.prototype.getLastSyncPointBefore=function(l){for(var h=this._searchNearestSegmentBefore(l),r=this._list[h].syncPoints;r.length===0&&h>0;)h--,r=this._list[h].syncPoints;return r.length>0?r[r.length-1]:null},f}()},function(t,i,n){var o=function(){function a(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return a.prototype.isComplete=function(){var c=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,d=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&c&&d},a.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},a.prototype.getNearestKeyframe=function(c){if(this.keyframesIndex==null)return null;var d=this.keyframesIndex,f=this._search(d.times,c);return{index:f,milliseconds:d.times[f],fileposition:d.filepositions[f]}},a.prototype._search=function(c,d){var f=0,l=c.length-1,h=0,r=0,u=l;for(d<c[0]&&(f=0,r=u+1);r<=u;){if((h=r+Math.floor((u-r)/2))===l||d>=c[h]&&d<c[h+1]){f=h;break}c[h]<d?r=h+1:u=h-1}return f},a}();i.a=o},function(t,i,n){var o,a=n(0),c=n(13),d=n(3),f=function(){function q(){}return q.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},q}(),l=function(){this.program_pmt_pid={}};(function(q){q[q.kMPEG1Audio=3]="kMPEG1Audio",q[q.kMPEG2Audio=4]="kMPEG2Audio",q[q.kPESPrivateData=6]="kPESPrivateData",q[q.kADTSAAC=15]="kADTSAAC",q[q.kLOASAAC=17]="kLOASAAC",q[q.kAC3=129]="kAC3",q[q.kEAC3=135]="kEAC3",q[q.kMetadata=21]="kMetadata",q[q.kSCTE35=134]="kSCTE35",q[q.kH264=27]="kH264",q[q.kH265=36]="kH265"})(o||(o={}));var h,r=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},u=function(){},m=function(){},p=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(q){q[q.kUnspecified=0]="kUnspecified",q[q.kSliceNonIDR=1]="kSliceNonIDR",q[q.kSliceDPA=2]="kSliceDPA",q[q.kSliceDPB=3]="kSliceDPB",q[q.kSliceDPC=4]="kSliceDPC",q[q.kSliceIDR=5]="kSliceIDR",q[q.kSliceSEI=6]="kSliceSEI",q[q.kSliceSPS=7]="kSliceSPS",q[q.kSlicePPS=8]="kSlicePPS",q[q.kSliceAUD=9]="kSliceAUD",q[q.kEndOfSequence=10]="kEndOfSequence",q[q.kEndOfStream=11]="kEndOfStream",q[q.kFiller=12]="kFiller",q[q.kSPSExt=13]="kSPSExt",q[q.kReserved0=14]="kReserved0"})(h||(h={}));var _,A,E=function(){},C=function(q){var Z=q.data.byteLength;this.type=q.type,this.data=new Uint8Array(4+Z),new DataView(this.data.buffer).setUint32(0,Z),this.data.set(q.data,4)},k=function(){function q(Z){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=Z,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return q.prototype.findNextStartCodeOffset=function(Z){for(var z=Z,$=this.data_;;){if(z+3>=$.byteLength)return this.eof_flag_=!0,$.byteLength;var ce=$[z+0]<<24|$[z+1]<<16|$[z+2]<<8|$[z+3],Se=$[z+0]<<16|$[z+1]<<8|$[z+2];if(ce===1||Se===1)return z;z++}},q.prototype.readNextNaluPayload=function(){for(var Z=this.data_,z=null;z==null&&!this.eof_flag_;){var $=this.current_startcode_offset_,ce=31&Z[$+=(Z[$]<<24|Z[$+1]<<16|Z[$+2]<<8|Z[$+3])===1?4:3],Se=(128&Z[$])>>>7,se=this.findNextStartCodeOffset($);if(this.current_startcode_offset_=se,!(ce>=h.kReserved0)&&Se===0){var ve=Z.subarray($,se);(z=new E).type=ce,z.data=ve}}return z},q}(),O=function(){function q(Z,z,$){var ce=8+Z.byteLength+1+2+z.byteLength,Se=!1;Z[3]!==66&&Z[3]!==77&&Z[3]!==88&&(Se=!0,ce+=4);var se=this.data=new Uint8Array(ce);se[0]=1,se[1]=Z[1],se[2]=Z[2],se[3]=Z[3],se[4]=255,se[5]=225;var ve=Z.byteLength;se[6]=ve>>>8,se[7]=255&ve;var Pe=8;se.set(Z,8),se[Pe+=ve]=1;var ke=z.byteLength;se[Pe+1]=ke>>>8,se[Pe+2]=255&ke,se.set(z,Pe+3),Pe+=3+ke,Se&&(se[Pe]=252|$.chroma_format_idc,se[Pe+1]=248|$.bit_depth_luma-8,se[Pe+2]=248|$.bit_depth_chroma-8,se[Pe+3]=0,Pe+=4)}return q.prototype.getData=function(){return this.data},q}(),G=n(22),B=n(8);(function(q){q[q.kNull=0]="kNull",q[q.kAACMain=1]="kAACMain",q[q.kAAC_LC=2]="kAAC_LC",q[q.kAAC_SSR=3]="kAAC_SSR",q[q.kAAC_LTP=4]="kAAC_LTP",q[q.kAAC_SBR=5]="kAAC_SBR",q[q.kAAC_Scalable=6]="kAAC_Scalable",q[q.kLayer1=32]="kLayer1",q[q.kLayer2=33]="kLayer2",q[q.kLayer3=34]="kLayer3"})(_||(_={})),function(q){q[q.k96000Hz=0]="k96000Hz",q[q.k88200Hz=1]="k88200Hz",q[q.k64000Hz=2]="k64000Hz",q[q.k48000Hz=3]="k48000Hz",q[q.k44100Hz=4]="k44100Hz",q[q.k32000Hz=5]="k32000Hz",q[q.k24000Hz=6]="k24000Hz",q[q.k22050Hz=7]="k22050Hz",q[q.k16000Hz=8]="k16000Hz",q[q.k12000Hz=9]="k12000Hz",q[q.k11025Hz=10]="k11025Hz",q[q.k8000Hz=11]="k8000Hz",q[q.k7350Hz=12]="k7350Hz"}(A||(A={}));var T,L,I=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],M=(T=function(q,Z){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,$){z.__proto__=$}||function(z,$){for(var ce in $)Object.prototype.hasOwnProperty.call($,ce)&&(z[ce]=$[ce])})(q,Z)},function(q,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function z(){this.constructor=q}T(q,Z),q.prototype=Z===null?Object.create(Z):(z.prototype=Z.prototype,new z)}),K=function(){},re=function(q){function Z(){return q!==null&&q.apply(this,arguments)||this}return M(Z,q),Z}(K),ae=function(){function q(Z){this.TAG="AACADTSParser",this.data_=Z,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return q.prototype.findNextSyncwordOffset=function(Z){for(var z=Z,$=this.data_;;){if(z+7>=$.byteLength)return this.eof_flag_=!0,$.byteLength;if(($[z+0]<<8|$[z+1])>>>4===4095)return z;z++}},q.prototype.readNextAACFrame=function(){for(var Z=this.data_,z=null;z==null&&!this.eof_flag_;){var $=this.current_syncword_offset_,ce=(8&Z[$+1])>>>3,Se=(6&Z[$+1])>>>1,se=1&Z[$+1],ve=(192&Z[$+2])>>>6,Pe=(60&Z[$+2])>>>2,ke=(1&Z[$+2])<<2|(192&Z[$+3])>>>6,xe=(3&Z[$+3])<<11|Z[$+4]<<3|(224&Z[$+5])>>>5;if(Z[$+6],$+xe>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var Re=se===1?7:9,Be=xe-Re;$+=Re;var Ue=this.findNextSyncwordOffset($+Be);if(this.current_syncword_offset_=Ue,(ce===0||ce===1)&&Se===0){var at=Z.subarray($,$+Be);(z=new K).audio_object_type=ve+1,z.sampling_freq_index=Pe,z.sampling_frequency=I[Pe],z.channel_config=ke,z.data=at}}return z},q.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},q.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},q}(),te=function(){function q(Z){this.TAG="AACLOASParser",this.data_=Z,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return q.prototype.findNextSyncwordOffset=function(Z){for(var z=Z,$=this.data_;;){if(z+1>=$.byteLength)return this.eof_flag_=!0,$.byteLength;if(($[z+0]<<3|$[z+1]>>>5)===695)return z;z++}},q.prototype.getLATMValue=function(Z){for(var z=Z.readBits(2),$=0,ce=0;ce<=z;ce++)$<<=8,$|=Z.readByte();return $},q.prototype.readNextAACFrame=function(Z){for(var z=this.data_,$=null;$==null&&!this.eof_flag_;){var ce=this.current_syncword_offset_,Se=(31&z[ce+1])<<8|z[ce+2];if(ce+3+Se>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var se=new B.a(z.subarray(ce+3,ce+3+Se)),ve=null;if(se.readBool()){if(Z==null){a.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(ce+3+Se),se.destroy();continue}ve=Z}else{var Pe=se.readBool();if(Pe&&se.readBool()){a.a.e(this.TAG,"audioMuxVersionA is Not Supported"),se.destroy();break}if(Pe&&this.getLATMValue(se),!se.readBool()){a.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),se.destroy();break}if(se.readBits(6)!==0){a.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),se.destroy();break}if(se.readBits(4)!==0){a.a.e(this.TAG,"more than 2 numProgram Not Supported"),se.destroy();break}if(se.readBits(3)!==0){a.a.e(this.TAG,"more than 2 numLayer Not Supported"),se.destroy();break}var ke=Pe?this.getLATMValue(se):0,xe=se.readBits(5);ke-=5;var Re=se.readBits(4);ke-=4;var Be=se.readBits(4);ke-=4,se.readBits(3),(ke-=3)>0&&se.readBits(ke);var Ue=se.readBits(3);if(Ue!==0){a.a.e(this.TAG,"frameLengthType = ".concat(Ue,". Only frameLengthType = 0 Supported")),se.destroy();break}se.readByte();var at=se.readBool();if(at)if(Pe)this.getLATMValue(se);else{for(var gt=0;;){gt<<=8;var Yt=se.readBool();if(gt+=se.readByte(),!Yt)break}console.log(gt)}se.readBool()&&se.readByte(),(ve=new re).audio_object_type=xe,ve.sampling_freq_index=Re,ve.sampling_frequency=I[ve.sampling_freq_index],ve.channel_config=Be,ve.other_data_present=at}for(var Ht=0;;){var zt=se.readByte();if(Ht+=zt,zt!==255)break}for(var oe=new Uint8Array(Ht),ge=0;ge<Ht;ge++)oe[ge]=se.readByte();($=new re).audio_object_type=ve.audio_object_type,$.sampling_freq_index=ve.sampling_freq_index,$.sampling_frequency=I[ve.sampling_freq_index],$.channel_config=ve.channel_config,$.other_data_present=ve.other_data_present,$.data=oe,this.current_syncword_offset_=this.findNextSyncwordOffset(ce+3+Se)}return $},q.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},q.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},q}(),ne=function(q){var Z=null,z=q.audio_object_type,$=q.audio_object_type,ce=q.sampling_freq_index,Se=q.channel_config,se=0,ve=navigator.userAgent.toLowerCase();ve.indexOf("firefox")!==-1?ce>=6?($=5,Z=new Array(4),se=ce-3):($=2,Z=new Array(2),se=ce):ve.indexOf("android")!==-1?($=2,Z=new Array(2),se=ce):($=5,se=ce,Z=new Array(4),ce>=6?se=ce-3:Se===1&&($=2,Z=new Array(2),se=ce)),Z[0]=$<<3,Z[0]|=(15&ce)>>>1,Z[1]=(15&ce)<<7,Z[1]|=(15&Se)<<3,$===5&&(Z[1]|=(15&se)>>>1,Z[2]=(1&se)<<7,Z[2]|=8,Z[3]=0),this.config=Z,this.sampling_rate=I[ce],this.channel_count=Se,this.codec_mimetype="mp4a.40."+$,this.original_codec_mimetype="mp4a.40."+z},me=function(){},Ae=function(){};(function(q){q[q.kSpliceNull=0]="kSpliceNull",q[q.kSpliceSchedule=4]="kSpliceSchedule",q[q.kSpliceInsert=5]="kSpliceInsert",q[q.kTimeSignal=6]="kTimeSignal",q[q.kBandwidthReservation=7]="kBandwidthReservation",q[q.kPrivateCommand=255]="kPrivateCommand"})(L||(L={}));var F,y=function(q){var Z=q.readBool();return Z?(q.readBits(6),{time_specified_flag:Z,pts_time:4*q.readBits(31)+q.readBits(2)}):(q.readBits(7),{time_specified_flag:Z})},v=function(q){var Z=q.readBool();return q.readBits(6),{auto_return:Z,duration:4*q.readBits(31)+q.readBits(2)}},S=function(q,Z){var z=Z.readBits(8);return q?{component_tag:z}:{component_tag:z,splice_time:y(Z)}},w=function(q){return{component_tag:q.readBits(8),utc_splice_time:q.readBits(32)}},x=function(q){var Z=q.readBits(32),z=q.readBool();q.readBits(7);var $={splice_event_id:Z,splice_event_cancel_indicator:z};if(z)return $;if($.out_of_network_indicator=q.readBool(),$.program_splice_flag=q.readBool(),$.duration_flag=q.readBool(),q.readBits(5),$.program_splice_flag)$.utc_splice_time=q.readBits(32);else{$.component_count=q.readBits(8),$.components=[];for(var ce=0;ce<$.component_count;ce++)$.components.push(w(q))}return $.duration_flag&&($.break_duration=v(q)),$.unique_program_id=q.readBits(16),$.avail_num=q.readBits(8),$.avails_expected=q.readBits(8),$},D=function(q,Z,z,$){return{descriptor_tag:q,descriptor_length:Z,identifier:z,provider_avail_id:$.readBits(32)}},U=function(q,Z,z,$){var ce=$.readBits(8),Se=$.readBits(3);$.readBits(5);for(var se="",ve=0;ve<Se;ve++)se+=String.fromCharCode($.readBits(8));return{descriptor_tag:q,descriptor_length:Z,identifier:z,preroll:ce,dtmf_count:Se,DTMF_char:se}},j=function(q){var Z=q.readBits(8);return q.readBits(7),{component_tag:Z,pts_offset:4*q.readBits(31)+q.readBits(2)}},X=function(q,Z,z,$){var ce=$.readBits(32),Se=$.readBool();$.readBits(7);var se={descriptor_tag:q,descriptor_length:Z,identifier:z,segmentation_event_id:ce,segmentation_event_cancel_indicator:Se};if(Se)return se;if(se.program_segmentation_flag=$.readBool(),se.segmentation_duration_flag=$.readBool(),se.delivery_not_restricted_flag=$.readBool(),se.delivery_not_restricted_flag?$.readBits(5):(se.web_delivery_allowed_flag=$.readBool(),se.no_regional_blackout_flag=$.readBool(),se.archive_allowed_flag=$.readBool(),se.device_restrictions=$.readBits(2)),!se.program_segmentation_flag){se.component_count=$.readBits(8),se.components=[];for(var ve=0;ve<se.component_count;ve++)se.components.push(j($))}se.segmentation_duration_flag&&(se.segmentation_duration=$.readBits(40)),se.segmentation_upid_type=$.readBits(8),se.segmentation_upid_length=$.readBits(8);var Pe=new Uint8Array(se.segmentation_upid_length);for(ve=0;ve<se.segmentation_upid_length;ve++)Pe[ve]=$.readBits(8);return se.segmentation_upid=Pe.buffer,se.segmentation_type_id=$.readBits(8),se.segment_num=$.readBits(8),se.segments_expected=$.readBits(8),se.segmentation_type_id!==52&&se.segmentation_type_id!==54&&se.segmentation_type_id!==56&&se.segmentation_type_id!==58||(se.sub_segment_num=$.readBits(8),se.sub_segments_expected=$.readBits(8)),se},ee=function(q,Z,z,$){return{descriptor_tag:q,descriptor_length:Z,identifier:z,TAI_seconds:$.readBits(48),TAI_ns:$.readBits(32),UTC_offset:$.readBits(16)}},ie=function(q){return{component_tag:q.readBits(8),ISO_code:String.fromCharCode(q.readBits(8),q.readBits(8),q.readBits(8)),Bit_Stream_Mode:q.readBits(3),Num_Channels:q.readBits(4),Full_Srvc_Audio:q.readBool()}},be=function(q,Z,z,$){for(var ce=$.readBits(4),Se=[],se=0;se<ce;se++)Se.push(ie($));return{descriptor_tag:q,descriptor_length:Z,identifier:z,audio_count:ce,components:Se}},Te=function(q){var Z=new B.a(q),z=Z.readBits(8),$=Z.readBool(),ce=Z.readBool();Z.readBits(2);var Se=Z.readBits(12),se=Z.readBits(8),ve=Z.readBool(),Pe=Z.readBits(6),ke=4*Z.readBits(31)+Z.readBits(2),xe=Z.readBits(8),Re=Z.readBits(12),Be=Z.readBits(12),Ue=Z.readBits(8),at=null;Ue===L.kSpliceNull?at={}:Ue===L.kSpliceSchedule?at=function(J){for(var ue=J.readBits(8),de=[],Ce=0;Ce<ue;Ce++)de.push(x(J));return{splice_count:ue,events:de}}(Z):Ue===L.kSpliceInsert?at=function(J){var ue=J.readBits(32),de=J.readBool();J.readBits(7);var Ce={splice_event_id:ue,splice_event_cancel_indicator:de};if(de)return Ce;if(Ce.out_of_network_indicator=J.readBool(),Ce.program_splice_flag=J.readBool(),Ce.duration_flag=J.readBool(),Ce.splice_immediate_flag=J.readBool(),J.readBits(4),Ce.program_splice_flag&&!Ce.splice_immediate_flag&&(Ce.splice_time=y(J)),!Ce.program_splice_flag){Ce.component_count=J.readBits(8),Ce.components=[];for(var Me=0;Me<Ce.component_count;Me++)Ce.components.push(S(Ce.splice_immediate_flag,J))}return Ce.duration_flag&&(Ce.break_duration=v(J)),Ce.unique_program_id=J.readBits(16),Ce.avail_num=J.readBits(8),Ce.avails_expected=J.readBits(8),Ce}(Z):Ue===L.kTimeSignal?at=function(J){return{splice_time:y(J)}}(Z):Ue===L.kBandwidthReservation?at={}:Ue===L.kPrivateCommand?at=function(J,ue){for(var de=String.fromCharCode(ue.readBits(8),ue.readBits(8),ue.readBits(8),ue.readBits(8)),Ce=new Uint8Array(J-4),Me=0;Me<J-4;Me++)Ce[Me]=ue.readBits(8);return{identifier:de,private_data:Ce.buffer}}(Be,Z):Z.readBits(8*Be);for(var gt=[],Yt=Z.readBits(16),Ht=0;Ht<Yt;){var zt=Z.readBits(8),oe=Z.readBits(8),ge=String.fromCharCode(Z.readBits(8),Z.readBits(8),Z.readBits(8),Z.readBits(8));zt===0?gt.push(D(zt,oe,ge,Z)):zt===1?gt.push(U(zt,oe,ge,Z)):zt===2?gt.push(X(zt,oe,ge,Z)):zt===3?gt.push(ee(zt,oe,ge,Z)):zt===4?gt.push(be(zt,oe,ge,Z)):Z.readBits(8*(oe-4)),Ht+=2+oe}var H={table_id:z,section_syntax_indicator:$,private_indicator:ce,section_length:Se,protocol_version:se,encrypted_packet:ve,encryption_algorithm:Pe,pts_adjustment:ke,cw_index:xe,tier:Re,splice_command_length:Be,splice_command_type:Ue,splice_command:at,descriptor_loop_length:Yt,splice_descriptors:gt,E_CRC32:ve?Z.readBits(32):void 0,CRC32:Z.readBits(32)};if(Ue===L.kSpliceInsert){var P=at;if(P.splice_event_cancel_indicator)return{splice_command_type:Ue,detail:H,data:q};if(P.program_splice_flag&&!P.splice_immediate_flag){var g=P.duration_flag?P.break_duration.auto_return:void 0,N=P.duration_flag?P.break_duration.duration/90:void 0;return P.splice_time.time_specified_flag?{splice_command_type:Ue,pts:(ke+P.splice_time.pts_time)%Math.pow(2,33),auto_return:g,duraiton:N,detail:H,data:q}:{splice_command_type:Ue,auto_return:g,duraiton:N,detail:H,data:q}}return{splice_command_type:Ue,auto_return:g=P.duration_flag?P.break_duration.auto_return:void 0,duraiton:N=P.duration_flag?P.break_duration.duration/90:void 0,detail:H,data:q}}if(Ue===L.kTimeSignal){var Q=at;return Q.splice_time.time_specified_flag?{splice_command_type:Ue,pts:(ke+Q.splice_time.pts_time)%Math.pow(2,33),detail:H,data:q}:{splice_command_type:Ue,detail:H,data:q}}return{splice_command_type:Ue,detail:H,data:q}};(function(q){q[q.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",q[q.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",q[q.kSliceCRA_NUT=21]="kSliceCRA_NUT",q[q.kSliceVPS=32]="kSliceVPS",q[q.kSliceSPS=33]="kSliceSPS",q[q.kSlicePPS=34]="kSlicePPS",q[q.kSliceAUD=35]="kSliceAUD"})(F||(F={}));var Oe=function(){},He=function(q){var Z=q.data.byteLength;this.type=q.type,this.data=new Uint8Array(4+Z),new DataView(this.data.buffer).setUint32(0,Z),this.data.set(q.data,4)},st=function(){function q(Z){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=Z,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return q.prototype.findNextStartCodeOffset=function(Z){for(var z=Z,$=this.data_;;){if(z+3>=$.byteLength)return this.eof_flag_=!0,$.byteLength;var ce=$[z+0]<<24|$[z+1]<<16|$[z+2]<<8|$[z+3],Se=$[z+0]<<16|$[z+1]<<8|$[z+2];if(ce===1||Se===1)return z;z++}},q.prototype.readNextNaluPayload=function(){for(var Z=this.data_,z=null;z==null&&!this.eof_flag_;){var $=this.current_startcode_offset_,ce=Z[$+=(Z[$]<<24|Z[$+1]<<16|Z[$+2]<<8|Z[$+3])===1?4:3]>>1&63,Se=(128&Z[$])>>>7,se=this.findNextStartCodeOffset($);if(this.current_startcode_offset_=se,Se===0){var ve=Z.subarray($,se);(z=new Oe).type=ce,z.data=ve}}return z},q}(),Le=function(){function q(Z,z,$,ce){var Se=23+(5+Z.byteLength)+(5+z.byteLength)+(5+$.byteLength),se=this.data=new Uint8Array(Se);se[0]=1,se[1]=(3&ce.general_profile_space)<<6|(ce.general_tier_flag?1:0)<<5|31&ce.general_profile_idc,se[2]=ce.general_profile_compatibility_flags_1,se[3]=ce.general_profile_compatibility_flags_2,se[4]=ce.general_profile_compatibility_flags_3,se[5]=ce.general_profile_compatibility_flags_4,se[6]=ce.general_constraint_indicator_flags_1,se[7]=ce.general_constraint_indicator_flags_2,se[8]=ce.general_constraint_indicator_flags_3,se[9]=ce.general_constraint_indicator_flags_4,se[10]=ce.general_constraint_indicator_flags_5,se[11]=ce.general_constraint_indicator_flags_6,se[12]=ce.general_level_idc,se[13]=240|(3840&ce.min_spatial_segmentation_idc)>>8,se[14]=255&ce.min_spatial_segmentation_idc,se[15]=252|3&ce.parallelismType,se[16]=252|3&ce.chroma_format_idc,se[17]=248|7&ce.bit_depth_luma_minus8,se[18]=248|7&ce.bit_depth_chroma_minus8,se[19]=0,se[20]=0,se[21]=(3&ce.constant_frame_rate)<<6|(7&ce.num_temporal_layers)<<3|(ce.temporal_id_nested?1:0)<<2|3,se[22]=3,se[23]=128|F.kSliceVPS,se[24]=0,se[25]=1,se[26]=(65280&Z.byteLength)>>8,se[27]=(255&Z.byteLength)>>0,se.set(Z,28),se[23+(5+Z.byteLength)+0]=128|F.kSliceSPS,se[23+(5+Z.byteLength)+1]=0,se[23+(5+Z.byteLength)+2]=1,se[23+(5+Z.byteLength)+3]=(65280&z.byteLength)>>8,se[23+(5+Z.byteLength)+4]=(255&z.byteLength)>>0,se.set(z,23+(5+Z.byteLength)+5),se[23+(5+Z.byteLength+5+z.byteLength)+0]=128|F.kSlicePPS,se[23+(5+Z.byteLength+5+z.byteLength)+1]=0,se[23+(5+Z.byteLength+5+z.byteLength)+2]=1,se[23+(5+Z.byteLength+5+z.byteLength)+3]=(65280&$.byteLength)>>8,se[23+(5+Z.byteLength+5+z.byteLength)+4]=(255&$.byteLength)>>0,se.set($,23+(5+Z.byteLength+5+z.byteLength)+5)}return q.prototype.getData=function(){return this.data},q}(),rt=n(15),tt=function(){},Ee=function(){},ft=function(){},pt=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],Ze=function(){function q(Z){this.TAG="AC3Parser",this.data_=Z,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return q.prototype.findNextSyncwordOffset=function(Z){for(var z=Z,$=this.data_;;){if(z+7>=$.byteLength)return this.eof_flag_=!0,$.byteLength;if(($[z+0]<<8|$[z+1]<<0)===2935)return z;z++}},q.prototype.readNextAC3Frame=function(){for(var Z=this.data_,z=null;z==null&&!this.eof_flag_;){var $=this.current_syncword_offset_,ce=Z[$+4]>>6,Se=[48e3,44200,33e3][ce],se=63&Z[$+4],ve=2*pt[ce][se];if(isNaN(ve)||$+ve>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var Pe=this.findNextSyncwordOffset($+ve);this.current_syncword_offset_=Pe;var ke=Z[$+5]>>3,xe=7&Z[$+5],Re=Z[$+6]>>5,Be=0;1&Re&&Re!==1&&(Be+=2),4&Re&&(Be+=2),Re===2&&(Be+=2);var Ue=(Z[$+6]<<8|Z[$+7]<<0)>>12-Be&1,at=[2,1,2,3,3,4,4,5][Re]+Ue;(z=new ft).sampling_frequency=Se,z.channel_count=at,z.channel_mode=Re,z.bit_stream_identification=ke,z.low_frequency_effects_channel_on=Ue,z.bit_stream_mode=xe,z.frame_size_code=se,z.data=Z.subarray($,$+ve)}return z},q.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},q.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},q}(),je=function(q){var Z;Z=[q.sampling_rate_code<<6|q.bit_stream_identification<<1|q.bit_stream_mode>>2,(3&q.bit_stream_mode)<<6|q.channel_mode<<3|q.low_frequency_effects_channel_on<<2|q.frame_size_code>>4,q.frame_size_code<<4&224],this.config=Z,this.sampling_rate=q.sampling_frequency,this.bit_stream_identification=q.bit_stream_identification,this.bit_stream_mode=q.bit_stream_mode,this.low_frequency_effects_channel_on=q.low_frequency_effects_channel_on,this.channel_count=q.channel_count,this.channel_mode=q.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},he=function(){},_e=function(){function q(Z){this.TAG="EAC3Parser",this.data_=Z,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return q.prototype.findNextSyncwordOffset=function(Z){for(var z=Z,$=this.data_;;){if(z+7>=$.byteLength)return this.eof_flag_=!0,$.byteLength;if(($[z+0]<<8|$[z+1]<<0)===2935)return z;z++}},q.prototype.readNextEAC3Frame=function(){for(var Z=this.data_,z=null;z==null&&!this.eof_flag_;){var $=this.current_syncword_offset_,ce=new B.a(Z.subarray($+2)),Se=(ce.readBits(2),ce.readBits(3),ce.readBits(11)+1<<1),se=ce.readBits(2),ve=null,Pe=null;se===3?(ve=[24e3,22060,16e3][se=ce.readBits(2)],Pe=3):(ve=[48e3,44100,32e3][se],Pe=ce.readBits(2));var ke=ce.readBits(3),xe=ce.readBits(1),Re=ce.readBits(5);if($+Se>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var Be=this.findNextSyncwordOffset($+Se);this.current_syncword_offset_=Be;var Ue=[2,1,2,3,3,4,4,5][ke]+xe;ce.destroy(),(z=new he).sampling_frequency=ve,z.channel_count=Ue,z.channel_mode=ke,z.bit_stream_identification=Re,z.low_frequency_effects_channel_on=xe,z.frame_size=Se,z.num_blks=[1,2,3,6][Pe],z.data=Z.subarray($,$+Se)}return z},q.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},q.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},q}(),Ne=function(q){var Z,z=Math.floor(q.frame_size*q.sampling_frequency/(16*q.num_blks));Z=[255&z,248&z,q.sampling_rate_code<<6|q.bit_stream_identification<<1|0,0|q.channel_mode<<1|q.low_frequency_effects_channel_on<<0,0],this.config=Z,this.sampling_rate=q.sampling_frequency,this.bit_stream_identification=q.bit_stream_identification,this.num_blks=q.num_blks,this.low_frequency_effects_channel_on=q.low_frequency_effects_channel_on,this.channel_count=q.channel_count,this.channel_mode=q.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},fe=function(){},Je=function(){var q=function(Z,z){return(q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,ce){$.__proto__=ce}||function($,ce){for(var Se in ce)Object.prototype.hasOwnProperty.call(ce,Se)&&($[Se]=ce[Se])})(Z,z)};return function(Z,z){if(typeof z!="function"&&z!==null)throw new TypeError("Class extends value "+String(z)+" is not a constructor or null");function $(){this.constructor=Z}q(Z,z),Z.prototype=z===null?Object.create(z):($.prototype=z.prototype,new $)}}(),ot=function(){return(ot=Object.assign||function(q){for(var Z,z=1,$=arguments.length;z<$;z++)for(var ce in Z=arguments[z])Object.prototype.hasOwnProperty.call(Z,ce)&&(q[ce]=Z[ce]);return q}).apply(this,arguments)},nt=function(q){function Z(z,$){var ce=q.call(this)||this;return ce.TAG="TSDemuxer",ce.first_parse_=!0,ce.media_info_=new c.a,ce.timescale_=90,ce.duration_=0,ce.current_pmt_pid_=-1,ce.program_pmt_map_={},ce.pes_slice_queues_={},ce.section_slice_queues_={},ce.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},ce.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},ce.last_pcr_base_=NaN,ce.timestamp_offset_=0,ce.audio_last_sample_pts_=void 0,ce.aac_last_incomplete_data_=null,ce.has_video_=!1,ce.has_audio_=!1,ce.video_init_segment_dispatched_=!1,ce.audio_init_segment_dispatched_=!1,ce.video_metadata_changed_=!1,ce.audio_metadata_changed_=!1,ce.loas_previous_frame=null,ce.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},ce.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},ce.preferred_secondary_audio=!1,ce.ts_packet_size_=z.ts_packet_size,ce.sync_offset_=z.sync_offset,ce.config_=$,ce}return Je(Z,q),Z.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,q.prototype.destroy.call(this)},Z.probe=function(z){var $=new Uint8Array(z),ce=-1,Se=188;if($.byteLength<=3*Se)return{needMoreData:!0};for(;ce===-1;){for(var se=Math.min(1e3,$.byteLength-3*Se),ve=0;ve<se;){if($[ve]===71&&$[ve+Se]===71&&$[ve+2*Se]===71){ce=ve;break}ve++}if(ce===-1)if(Se===188)Se=192;else{if(Se!==192)break;Se=204}}return ce===-1?{match:!1}:(Se===192&&ce>=4?(a.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),ce-=4):Se===204&&a.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:Se,sync_offset:ce})},Z.prototype.bindDataSource=function(z){return z.onDataArrival=this.parseChunks.bind(this),this},Z.prototype.resetMediaInfo=function(){this.media_info_=new c.a},Z.prototype.parseChunks=function(z,$){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new d.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var ce=0;for(this.first_parse_&&(this.first_parse_=!1,ce=this.sync_offset_);ce+this.ts_packet_size_<=z.byteLength;){var Se=$+ce;this.ts_packet_size_===192&&(ce+=4);var se=new Uint8Array(z,ce,188),ve=se[0];if(ve!==71){a.a.e(this.TAG,"sync_byte = ".concat(ve,", not 0x47"));break}var Pe=(64&se[1])>>>6,ke=(se[1],(31&se[1])<<8|se[2]),xe=(48&se[3])>>>4,Re=15&se[3],Be=!(!this.pmt_||this.pmt_.pcr_pid!==ke),Ue={},at=4;if(xe==2||xe==3){var gt=se[4];if(gt>0&&(Be||xe==3)&&(Ue.discontinuity_indicator=(128&se[5])>>>7,Ue.random_access_indicator=(64&se[5])>>>6,Ue.elementary_stream_priority_indicator=(32&se[5])>>>5,(16&se[5])>>>4)){var Yt=300*this.getPcrBase(se)+((1&se[10])<<8|se[11]);this.last_pcr_=Yt}if(xe==2||5+gt===188){ce+=188,this.ts_packet_size_===204&&(ce+=16);continue}at=5+gt}if(xe==1||xe==3){if(ke===0||ke===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[ke]===o.kSCTE35){var Ht=188-at;this.handleSectionSlice(z,ce+at,Ht,{pid:ke,file_position:Se,payload_unit_start_indicator:Pe,continuity_conunter:Re,random_access_indicator:Ue.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[ke]!=null){Ht=188-at;var zt=this.pmt_.pid_stream_type[ke];ke!==this.pmt_.common_pids.h264&&ke!==this.pmt_.common_pids.h265&&ke!==this.pmt_.common_pids.adts_aac&&ke!==this.pmt_.common_pids.loas_aac&&ke!==this.pmt_.common_pids.ac3&&ke!==this.pmt_.common_pids.eac3&&ke!==this.pmt_.common_pids.opus&&ke!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[ke]!==!0&&this.pmt_.timed_id3_pids[ke]!==!0&&this.pmt_.synchronous_klv_pids[ke]!==!0&&this.pmt_.asynchronous_klv_pids[ke]!==!0||this.handlePESSlice(z,ce+at,Ht,{pid:ke,stream_type:zt,file_position:Se,payload_unit_start_indicator:Pe,continuity_conunter:Re,random_access_indicator:Ue.random_access_indicator})}}ce+=188,this.ts_packet_size_===204&&(ce+=16)}return this.dispatchAudioVideoMediaSegment(),ce},Z.prototype.handleSectionSlice=function(z,$,ce,Se){var se=new Uint8Array(z,$,ce),ve=this.section_slice_queues_[Se.pid];if(Se.payload_unit_start_indicator){var Pe=se[0];if(ve!=null&&ve.total_length!==0){var ke=new Uint8Array(z,$+1,Math.min(ce,Pe));ve.slices.push(ke),ve.total_length+=ke.byteLength,ve.total_length===ve.expected_length?this.emitSectionSlices(ve,Se):this.clearSlices(ve,Se)}for(var xe=1+Pe;xe<se.byteLength&&se[xe+0]!==255;){var Re=(15&se[xe+1])<<8|se[xe+2];this.section_slice_queues_[Se.pid]=new p,(ve=this.section_slice_queues_[Se.pid]).expected_length=Re+3,ve.file_position=Se.file_position,ve.random_access_indicator=Se.random_access_indicator,ke=new Uint8Array(z,$+xe,Math.min(ce-xe,ve.expected_length-ve.total_length)),ve.slices.push(ke),ve.total_length+=ke.byteLength,ve.total_length===ve.expected_length?this.emitSectionSlices(ve,Se):ve.total_length>=ve.expected_length&&this.clearSlices(ve,Se),xe+=ke.byteLength}}else ve!=null&&ve.total_length!==0&&(ke=new Uint8Array(z,$,Math.min(ce,ve.expected_length-ve.total_length)),ve.slices.push(ke),ve.total_length+=ke.byteLength,ve.total_length===ve.expected_length?this.emitSectionSlices(ve,Se):ve.total_length>=ve.expected_length&&this.clearSlices(ve,Se))},Z.prototype.handlePESSlice=function(z,$,ce,Se){var se=new Uint8Array(z,$,ce),ve=se[0]<<16|se[1]<<8|se[2],Pe=(se[3],se[4]<<8|se[5]);if(Se.payload_unit_start_indicator){if(ve!==1)return void a.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(ve));var ke=this.pes_slice_queues_[Se.pid];ke&&(ke.expected_length===0||ke.expected_length===ke.total_length?this.emitPESSlices(ke,Se):this.clearSlices(ke,Se)),this.pes_slice_queues_[Se.pid]=new p,this.pes_slice_queues_[Se.pid].file_position=Se.file_position,this.pes_slice_queues_[Se.pid].random_access_indicator=Se.random_access_indicator}if(this.pes_slice_queues_[Se.pid]!=null){var xe=this.pes_slice_queues_[Se.pid];xe.slices.push(se),Se.payload_unit_start_indicator&&(xe.expected_length=Pe===0?0:Pe+6),xe.total_length+=se.byteLength,xe.expected_length>0&&xe.expected_length===xe.total_length?this.emitPESSlices(xe,Se):xe.expected_length>0&&xe.expected_length<xe.total_length&&this.clearSlices(xe,Se)}},Z.prototype.emitSectionSlices=function(z,$){for(var ce=new Uint8Array(z.total_length),Se=0,se=0;Se<z.slices.length;Se++){var ve=z.slices[Se];ce.set(ve,se),se+=ve.byteLength}z.slices=[],z.expected_length=-1,z.total_length=0;var Pe=new m;Pe.pid=$.pid,Pe.data=ce,Pe.file_position=z.file_position,Pe.random_access_indicator=z.random_access_indicator,this.parseSection(Pe)},Z.prototype.emitPESSlices=function(z,$){for(var ce=new Uint8Array(z.total_length),Se=0,se=0;Se<z.slices.length;Se++){var ve=z.slices[Se];ce.set(ve,se),se+=ve.byteLength}z.slices=[],z.expected_length=-1,z.total_length=0;var Pe=new u;Pe.pid=$.pid,Pe.data=ce,Pe.stream_type=$.stream_type,Pe.file_position=z.file_position,Pe.random_access_indicator=z.random_access_indicator,this.parsePES(Pe)},Z.prototype.clearSlices=function(z,$){z.slices=[],z.expected_length=-1,z.total_length=0},Z.prototype.parseSection=function(z){var $=z.data,ce=z.pid;ce===0?this.parsePAT($):ce===this.current_pmt_pid_?this.parsePMT($):this.pmt_!=null&&this.pmt_.scte_35_pids[ce]&&this.parseSCTE35($)},Z.prototype.parsePES=function(z){var $=z.data,ce=$[0]<<16|$[1]<<8|$[2],Se=$[3],se=$[4]<<8|$[5];if(ce===1)if(Se!==188&&Se!==190&&Se!==191&&Se!==240&&Se!==241&&Se!==255&&Se!==242&&Se!==248){$[6];var ve=(192&$[7])>>>6,Pe=$[8],ke=void 0,xe=void 0;ve!==2&&ve!==3||(ke=this.getTimestamp($,9),xe=ve===3?this.getTimestamp($,14):ke);var Re=9+Pe,Be=void 0;if(se!==0){if(se<3+Pe)return void a.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");Be=se-3-Pe}else Be=$.byteLength-Re;var Ue=$.subarray(Re,Re+Be);switch(z.stream_type){case o.kMPEG1Audio:case o.kMPEG2Audio:this.parseMP3Payload(Ue,ke);break;case o.kPESPrivateData:this.pmt_.common_pids.opus===z.pid?this.parseOpusPayload(Ue,ke):this.pmt_.common_pids.ac3===z.pid?this.parseAC3Payload(Ue,ke):this.pmt_.common_pids.eac3===z.pid?this.parseEAC3Payload(Ue,ke):this.pmt_.asynchronous_klv_pids[z.pid]?this.parseAsynchronousKLVMetadataPayload(Ue,z.pid,Se):this.pmt_.smpte2038_pids[z.pid]?this.parseSMPTE2038MetadataPayload(Ue,ke,xe,z.pid,Se):this.parsePESPrivateDataPayload(Ue,ke,xe,z.pid,Se);break;case o.kADTSAAC:this.parseADTSAACPayload(Ue,ke);break;case o.kLOASAAC:this.parseLOASAACPayload(Ue,ke);break;case o.kAC3:this.parseAC3Payload(Ue,ke);break;case o.kEAC3:this.parseEAC3Payload(Ue,ke);break;case o.kMetadata:this.pmt_.timed_id3_pids[z.pid]?this.parseTimedID3MetadataPayload(Ue,ke,xe,z.pid,Se):this.pmt_.synchronous_klv_pids[z.pid]&&this.parseSynchronousKLVMetadataPayload(Ue,ke,xe,z.pid,Se);break;case o.kH264:this.parseH264Payload(Ue,ke,xe,z.file_position,z.random_access_indicator);break;case o.kH265:this.parseH265Payload(Ue,ke,xe,z.file_position,z.random_access_indicator)}}else(Se===188||Se===191||Se===240||Se===241||Se===255||Se===242||Se===248)&&z.stream_type===o.kPESPrivateData&&(Re=6,Be=void 0,Be=se!==0?se:$.byteLength-Re,Ue=$.subarray(Re,Re+Be),this.parsePESPrivateDataPayload(Ue,void 0,void 0,z.pid,Se));else a.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(ce))},Z.prototype.parsePAT=function(z){var $=z[0];if($===0){var ce=(15&z[1])<<8|z[2],Se=(z[3],z[4],(62&z[5])>>>1),se=1&z[5],ve=z[6],Pe=(z[7],null);if(se===1&&ve===0)(Pe=new l).version_number=Se;else if((Pe=this.pat_)==null)return;for(var ke=ce-5-4,xe=-1,Re=-1,Be=8;Be<8+ke;Be+=4){var Ue=z[Be]<<8|z[Be+1],at=(31&z[Be+2])<<8|z[Be+3];Ue===0?Pe.network_pid=at:(Pe.program_pmt_pid[Ue]=at,xe===-1&&(xe=Ue),Re===-1&&(Re=at))}se===1&&ve===0&&(this.pat_==null&&a.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(Pe))),this.pat_=Pe,this.current_program_=xe,this.current_pmt_pid_=Re)}else a.a.e(this.TAG,"parsePAT: table_id ".concat($," is not corresponded to PAT!"))},Z.prototype.parsePMT=function(z){var $=z[0];if($===2){var ce=(15&z[1])<<8|z[2],Se=z[3]<<8|z[4],se=(62&z[5])>>>1,ve=1&z[5],Pe=z[6],ke=(z[7],null);if(ve===1&&Pe===0)(ke=new r).program_number=Se,ke.version_number=se,this.program_pmt_map_[Se]=ke;else if((ke=this.program_pmt_map_[Se])==null)return;ke.pcr_pid=(31&z[8])<<8|z[9];for(var xe=(15&z[10])<<8|z[11],Re=12+xe,Be=ce-9-xe-4,Ue=Re;Ue<Re+Be;){var at=z[Ue],gt=(31&z[Ue+1])<<8|z[Ue+2],Yt=(15&z[Ue+3])<<8|z[Ue+4];ke.pid_stream_type[gt]=at;var Ht=ke.common_pids.h264||ke.common_pids.h265,zt=ke.common_pids.adts_aac||ke.common_pids.loas_aac||ke.common_pids.ac3||ke.common_pids.eac3||ke.common_pids.opus||ke.common_pids.mp3;if(at!==o.kH264||Ht)if(at!==o.kH265||Ht)if(at!==o.kADTSAAC||zt&&!this.preferred_secondary_audio)if(at!==o.kLOASAAC||zt&&!this.preferred_secondary_audio)if(at!==o.kAC3||zt&&!this.preferred_secondary_audio)if(at!==o.kEAC3||zt&&!this.preferred_secondary_audio)if(at!==o.kMPEG1Audio&&at!==o.kMPEG2Audio||zt&&!this.preferred_secondary_audio)if(at===o.kPESPrivateData){if(ke.pes_private_data_pids[gt]=!0,Yt>0){for(var oe=Ue+5;oe<Ue+5+Yt;){var ge=z[oe+0],H=z[oe+1];if(ge===5){var P=String.fromCharCode.apply(String,Array.from(z.subarray(oe+2,oe+2+H)));P==="VANC"?ke.smpte2038_pids[gt]=!0:P==="Opus"?ke.common_pids.opus=gt:P==="KLVA"&&(ke.asynchronous_klv_pids[gt]=!0)}else if(ge===127&&gt===ke.common_pids.opus){var g=null;if(z[oe+2]===128&&(g=z[oe+3]),g==null){a.a.e(this.TAG,"Not Supported Opus channel count.");continue}var N={codec:"opus",channel_count:15&g?15&g:2,channel_config_code:g,sample_rate:48e3},Q={codec:"opus",meta:N};this.audio_init_segment_dispatched_==0?(this.audio_metadata_=N,this.dispatchAudioInitSegment(Q)):this.detectAudioMetadataChange(Q)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Q))}oe+=2+H}var J=z.subarray(Ue+5,Ue+5+Yt);this.dispatchPESPrivateDataDescriptor(gt,at,J)}}else if(at===o.kMetadata){if(Yt>0)for(oe=Ue+5;oe<Ue+5+Yt;){ge=z[oe+0];var ue=z[oe+1];if(ge===38){var de=z[oe+2]<<8|z[oe+3]<<0,Ce=null;de===65535&&(Ce=String.fromCharCode.apply(String,Array.from(z.subarray(oe+4,oe+4+4))));var Me=null;if(z[oe+4+(de===65535?4:0)]===255){var Ge=4+(de===65535?4:0)+1;Me=String.fromCharCode.apply(String,Array.from(z.subarray(oe+Ge,oe+Ge+4)))}Ce==="ID3 "&&Me==="ID3 "?ke.timed_id3_pids[gt]=!0:Me==="KLVA"&&(ke.synchronous_klv_pids[gt]=!0)}oe+=2+ue}}else at===o.kSCTE35&&(ke.scte_35_pids[gt]=!0);else ke.common_pids.mp3=gt;else ke.common_pids.eac3=gt;else ke.common_pids.ac3=gt;else ke.common_pids.loas_aac=gt;else ke.common_pids.adts_aac=gt;else ke.common_pids.h265=gt;else ke.common_pids.h264=gt;Ue+=5+Yt}Se===this.current_program_&&(this.pmt_==null&&a.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(ke))),this.pmt_=ke,(ke.common_pids.h264||ke.common_pids.h265)&&(this.has_video_=!0),(ke.common_pids.adts_aac||ke.common_pids.loas_aac||ke.common_pids.ac3||ke.common_pids.opus||ke.common_pids.mp3)&&(this.has_audio_=!0))}else a.a.e(this.TAG,"parsePMT: table_id ".concat($," is not corresponded to PMT!"))},Z.prototype.parseSCTE35=function(z){var $=Te(z);if($.pts!=null){var ce=Math.floor($.pts/this.timescale_);$.pts=ce}else $.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata($)},Z.prototype.parseH264Payload=function(z,$,ce,Se,se){for(var ve=new k(z),Pe=null,ke=[],xe=0,Re=!1;(Pe=ve.readNextNaluPayload())!=null;){var Be=new C(Pe);if(Be.type===h.kSliceSPS){var Ue=G.a.parseSPS(Pe.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(Be,Ue)===!0&&(a.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:Be,pps:void 0,details:Ue}):(this.video_metadata_.sps=Be,this.video_metadata_.details=Ue)}else Be.type===h.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=Be,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(Be.type===h.kSliceIDR||Be.type===h.kSliceNonIDR&&se===1)&&(Re=!0);this.video_init_segment_dispatched_&&(ke.push(Be),xe+=Be.data.byteLength)}var at=Math.floor($/this.timescale_),gt=Math.floor(ce/this.timescale_);if(ke.length){var Yt=this.video_track_,Ht={units:ke,length:xe,isKeyframe:Re,dts:gt,pts:at,cts:at-gt,file_position:Se};Yt.samples.push(Ht),Yt.length+=xe}},Z.prototype.parseH265Payload=function(z,$,ce,Se,se){for(var ve=new st(z),Pe=null,ke=[],xe=0,Re=!1;(Pe=ve.readNextNaluPayload())!=null;){var Be=new He(Pe);if(Be.type===F.kSliceVPS){if(!this.video_init_segment_dispatched_){var Ue=rt.a.parseVPS(Pe.data);this.video_metadata_.vps=Be,this.video_metadata_.details=ot(ot({},this.video_metadata_.details),Ue)}}else Be.type===F.kSliceSPS?(Ue=rt.a.parseSPS(Pe.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(Be,Ue)===!0&&(a.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:Be,pps:void 0,details:Ue}):(this.video_metadata_.sps=Be,this.video_metadata_.details=ot(ot({},this.video_metadata_.details),Ue))):Be.type===F.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&(Ue=rt.a.parsePPS(Pe.data),this.video_metadata_.pps=Be,this.video_metadata_.details=ot(ot({},this.video_metadata_.details),Ue),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):Be.type!==F.kSliceIDR_W_RADL&&Be.type!==F.kSliceIDR_N_LP&&Be.type!==F.kSliceCRA_NUT||(Re=!0);this.video_init_segment_dispatched_&&(ke.push(Be),xe+=Be.data.byteLength)}var at=Math.floor($/this.timescale_),gt=Math.floor(ce/this.timescale_);if(ke.length){var Yt=this.video_track_,Ht={units:ke,length:xe,isKeyframe:Re,dts:gt,pts:at,cts:at-gt,file_position:Se};Yt.samples.push(Ht),Yt.length+=xe}},Z.prototype.detectVideoMetadataChange=function(z,$){if($.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return a.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat($.codec_mimetype)),!0;if($.codec_size.width!==this.video_metadata_.details.codec_size.width||$.codec_size.height!==this.video_metadata_.details.codec_size.height){var ce=this.video_metadata_.details.codec_size,Se=$.codec_size;return a.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(ce.width,"x").concat(ce.height," to ").concat(Se.width,"x").concat(Se.height)),!0}return $.present_size.width!==this.video_metadata_.details.present_size.width&&(a.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat($.present_size.width)),!0)},Z.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},Z.prototype.dispatchVideoInitSegment=function(){var z=this.video_metadata_.details,$={type:"video"};$.id=this.video_track_.id,$.timescale=1e3,$.duration=this.duration_,$.codecWidth=z.codec_size.width,$.codecHeight=z.codec_size.height,$.presentWidth=z.present_size.width,$.presentHeight=z.present_size.height,$.profile=z.profile_string,$.level=z.level_string,$.bitDepth=z.bit_depth,$.chromaFormat=z.chroma_format,$.sarRatio=z.sar_ratio,$.frameRate=z.frame_rate;var ce=$.frameRate.fps_den,Se=$.frameRate.fps_num;if($.refSampleDuration=ce/Se*1e3,$.codec=z.codec_mimetype,this.video_metadata_.vps){var se=this.video_metadata_.vps.data.subarray(4),ve=this.video_metadata_.sps.data.subarray(4),Pe=this.video_metadata_.pps.data.subarray(4),ke=new Le(se,ve,Pe,z);$.hvcc=ke.getData(),this.video_init_segment_dispatched_==0&&a.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat($.codec))}else{ve=this.video_metadata_.sps.data.subarray(4),Pe=this.video_metadata_.pps.data.subarray(4);var xe=new O(ve,Pe,z);$.avcc=xe.getData(),this.video_init_segment_dispatched_==0&&a.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat($.codec))}this.onTrackMetadata("video",$),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var Re=this.media_info_;Re.hasVideo=!0,Re.width=$.codecWidth,Re.height=$.codecHeight,Re.fps=$.frameRate.fps,Re.profile=$.profile,Re.level=$.level,Re.refFrames=z.ref_frames,Re.chromaFormat=z.chroma_format_string,Re.sarNum=$.sarRatio.width,Re.sarDen=$.sarRatio.height,Re.videoCodec=$.codec,Re.hasAudio&&Re.audioCodec?Re.mimeType='video/mp2t; codecs="'.concat(Re.videoCodec,",").concat(Re.audioCodec,'"'):Re.mimeType='video/mp2t; codecs="'.concat(Re.videoCodec,'"'),Re.isComplete()&&this.onMediaInfo(Re)},Z.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},Z.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},Z.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},Z.prototype.parseADTSAACPayload=function(z,$){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var ce=new Uint8Array(z.byteLength+this.aac_last_incomplete_data_.byteLength);ce.set(this.aac_last_incomplete_data_,0),ce.set(z,this.aac_last_incomplete_data_.byteLength),z=ce}var Se,se;if($!=null&&(se=$/this.timescale_),this.audio_metadata_.codec==="aac"){if($==null&&this.audio_last_sample_pts_!=null)Se=1024/this.audio_metadata_.sampling_frequency*1e3,se=this.audio_last_sample_pts_+Se;else if($==null)return void a.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){Se=1024/this.audio_metadata_.sampling_frequency*1e3;var ve=this.audio_last_sample_pts_+Se;Math.abs(ve-se)>1&&(a.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(ve,"ms, PES pts: ").concat(se,"ms")),se=ve)}}for(var Pe,ke=new ae(z),xe=null,Re=se;(xe=ke.readNextAACFrame())!=null;){Se=1024/xe.sampling_frequency*1e3;var Be={codec:"aac",data:xe};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:xe.audio_object_type,sampling_freq_index:xe.sampling_freq_index,sampling_frequency:xe.sampling_frequency,channel_config:xe.channel_config},this.dispatchAudioInitSegment(Be)):this.detectAudioMetadataChange(Be)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Be)),Pe=Re;var Ue=Math.floor(Re),at={unit:xe.data,length:xe.data.byteLength,pts:Ue,dts:Ue};this.audio_track_.samples.push(at),this.audio_track_.length+=xe.data.byteLength,Re+=Se}ke.hasIncompleteData()&&(this.aac_last_incomplete_data_=ke.getIncompleteData()),Pe&&(this.audio_last_sample_pts_=Pe)}},Z.prototype.parseLOASAACPayload=function(z,$){var ce;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var Se=new Uint8Array(z.byteLength+this.aac_last_incomplete_data_.byteLength);Se.set(this.aac_last_incomplete_data_,0),Se.set(z,this.aac_last_incomplete_data_.byteLength),z=Se}var se,ve;if($!=null&&(ve=$/this.timescale_),this.audio_metadata_.codec==="aac"){if($==null&&this.audio_last_sample_pts_!=null)se=1024/this.audio_metadata_.sampling_frequency*1e3,ve=this.audio_last_sample_pts_+se;else if($==null)return void a.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){se=1024/this.audio_metadata_.sampling_frequency*1e3;var Pe=this.audio_last_sample_pts_+se;Math.abs(Pe-ve)>1&&(a.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(Pe,"ms, PES pts: ").concat(ve,"ms")),ve=Pe)}}for(var ke,xe=new te(z),Re=null,Be=ve;(Re=xe.readNextAACFrame((ce=this.loas_previous_frame)!==null&&ce!==void 0?ce:void 0))!=null;){this.loas_previous_frame=Re,se=1024/Re.sampling_frequency*1e3;var Ue={codec:"aac",data:Re};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:Re.audio_object_type,sampling_freq_index:Re.sampling_freq_index,sampling_frequency:Re.sampling_frequency,channel_config:Re.channel_config},this.dispatchAudioInitSegment(Ue)):this.detectAudioMetadataChange(Ue)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Ue)),ke=Be;var at=Math.floor(Be),gt={unit:Re.data,length:Re.data.byteLength,pts:at,dts:at};this.audio_track_.samples.push(gt),this.audio_track_.length+=Re.data.byteLength,Be+=se}xe.hasIncompleteData()&&(this.aac_last_incomplete_data_=xe.getIncompleteData()),ke&&(this.audio_last_sample_pts_=ke)}},Z.prototype.parseAC3Payload=function(z,$){if(!this.has_video_||this.video_init_segment_dispatched_){var ce,Se;if($!=null&&(Se=$/this.timescale_),this.audio_metadata_.codec==="ac-3"){if($==null&&this.audio_last_sample_pts_!=null)ce=1536/this.audio_metadata_.sampling_frequency*1e3,Se=this.audio_last_sample_pts_+ce;else if($==null)return void a.a.w(this.TAG,"AC3: Unknown pts")}for(var se,ve=new Ze(z),Pe=null,ke=Se;(Pe=ve.readNextAC3Frame())!=null;){ce=1536/Pe.sampling_frequency*1e3;var xe={codec:"ac-3",data:Pe};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ac-3",sampling_frequency:Pe.sampling_frequency,bit_stream_identification:Pe.bit_stream_identification,bit_stream_mode:Pe.bit_stream_mode,low_frequency_effects_channel_on:Pe.low_frequency_effects_channel_on,channel_mode:Pe.channel_mode},this.dispatchAudioInitSegment(xe)):this.detectAudioMetadataChange(xe)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(xe)),se=ke;var Re=Math.floor(ke),Be={unit:Pe.data,length:Pe.data.byteLength,pts:Re,dts:Re};this.audio_track_.samples.push(Be),this.audio_track_.length+=Pe.data.byteLength,ke+=ce}se&&(this.audio_last_sample_pts_=se)}},Z.prototype.parseEAC3Payload=function(z,$){if(!this.has_video_||this.video_init_segment_dispatched_){var ce,Se;if($!=null&&(Se=$/this.timescale_),this.audio_metadata_.codec==="ec-3"){if($==null&&this.audio_last_sample_pts_!=null)ce=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,Se=this.audio_last_sample_pts_+ce;else if($==null)return void a.a.w(this.TAG,"EAC3: Unknown pts")}for(var se,ve=new _e(z),Pe=null,ke=Se;(Pe=ve.readNextEAC3Frame())!=null;){ce=1536/Pe.sampling_frequency*1e3;var xe={codec:"ec-3",data:Pe};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ec-3",sampling_frequency:Pe.sampling_frequency,bit_stream_identification:Pe.bit_stream_identification,low_frequency_effects_channel_on:Pe.low_frequency_effects_channel_on,num_blks:Pe.num_blks,channel_mode:Pe.channel_mode},this.dispatchAudioInitSegment(xe)):this.detectAudioMetadataChange(xe)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(xe)),se=ke;var Re=Math.floor(ke),Be={unit:Pe.data,length:Pe.data.byteLength,pts:Re,dts:Re};this.audio_track_.samples.push(Be),this.audio_track_.length+=Pe.data.byteLength,ke+=ce}se&&(this.audio_last_sample_pts_=se)}},Z.prototype.parseOpusPayload=function(z,$){if(!this.has_video_||this.video_init_segment_dispatched_){var ce,Se;if($!=null&&(Se=$/this.timescale_),this.audio_metadata_.codec==="opus"){if($==null&&this.audio_last_sample_pts_!=null)ce=20,Se=this.audio_last_sample_pts_+ce;else if($==null)return void a.a.w(this.TAG,"Opus: Unknown pts")}for(var se,ve=Se,Pe=0;Pe<z.length;){ce=20;for(var ke=(16&z[Pe+1])!=0,xe=(8&z[Pe+1])!=0,Re=Pe+2,Be=0;z[Re]===255;)Be+=255,Re+=1;Be+=z[Re],Re+=1,Re+=ke?2:0,Re+=xe?2:0,se=ve;var Ue=Math.floor(ve),at=z.slice(Re,Re+Be),gt={unit:at,length:at.byteLength,pts:Ue,dts:Ue};this.audio_track_.samples.push(gt),this.audio_track_.length+=at.byteLength,ve+=ce,Pe=Re+Be}se&&(this.audio_last_sample_pts_=se)}},Z.prototype.parseMP3Payload=function(z,$){if(!this.has_video_||this.video_init_segment_dispatched_){var ce=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],Se=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],se=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],ve=z[1]>>>3&3,Pe=(6&z[1])>>1,ke=(240&z[2])>>>4,xe=(12&z[2])>>>2,Re=(z[3]>>>6&3)!==3?2:1,Be=0,Ue=34;switch(ve){case 0:Be=[11025,12e3,8e3,0][xe];break;case 2:Be=[22050,24e3,16e3,0][xe];break;case 3:Be=[44100,48e3,32e3,0][xe]}switch(Pe){case 1:Ue=34,ke<se.length&&se[ke];break;case 2:Ue=33,ke<Se.length&&Se[ke];break;case 3:Ue=32,ke<ce.length&&ce[ke]}var at=new Ee;at.object_type=Ue,at.sample_rate=Be,at.channel_count=Re,at.data=z;var gt={codec:"mp3",data:at};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"mp3",object_type:Ue,sample_rate:Be,channel_count:Re},this.dispatchAudioInitSegment(gt)):this.detectAudioMetadataChange(gt)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(gt));var Yt={unit:z,length:z.byteLength,pts:$/this.timescale_,dts:$/this.timescale_};this.audio_track_.samples.push(Yt),this.audio_track_.length+=z.byteLength}},Z.prototype.detectAudioMetadataChange=function(z){if(z.codec!==this.audio_metadata_.codec)return a.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(z.codec)),!0;if(z.codec==="aac"&&this.audio_metadata_.codec==="aac"){if(($=z.data).audio_object_type!==this.audio_metadata_.audio_object_type)return a.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat($.audio_object_type)),!0;if($.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return a.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat($.sampling_freq_index)),!0;if($.channel_config!==this.audio_metadata_.channel_config)return a.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat($.channel_config)),!0}else if(z.codec==="ac-3"&&this.audio_metadata_.codec==="ac-3"){var $;if(($=z.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return a.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat($.sampling_frequency)),!0;if($.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return a.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat($.bit_stream_identification)),!0;if($.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return a.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat($.bit_stream_mode)),!0;if($.channel_mode!==this.audio_metadata_.channel_mode)return a.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat($.channel_mode)),!0;if($.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return a.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat($.low_frequency_effects_channel_on)),!0}else if(z.codec==="opus"&&this.audio_metadata_.codec==="opus"){if((ce=z.meta).sample_rate!==this.audio_metadata_.sample_rate)return a.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(ce.sample_rate)),!0;if(ce.channel_count!==this.audio_metadata_.channel_count)return a.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(ce.channel_count)),!0}else if(z.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var ce;if((ce=z.data).object_type!==this.audio_metadata_.object_type)return a.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(ce.object_type)),!0;if(ce.sample_rate!==this.audio_metadata_.sample_rate)return a.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(ce.sample_rate)),!0;if(ce.channel_count!==this.audio_metadata_.channel_count)return a.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(ce.channel_count)),!0}return!1},Z.prototype.dispatchAudioInitSegment=function(z){var $={type:"audio"};if($.id=this.audio_track_.id,$.timescale=1e3,$.duration=this.duration_,this.audio_metadata_.codec==="aac"){var ce=z.codec==="aac"?z.data:null,Se=new ne(ce);$.audioSampleRate=Se.sampling_rate,$.channelCount=Se.channel_count,$.codec=Se.codec_mimetype,$.originalCodec=Se.original_codec_mimetype,$.config=Se.config,$.refSampleDuration=1024/$.audioSampleRate*$.timescale}else if(this.audio_metadata_.codec==="ac-3"){var se=z.codec==="ac-3"?z.data:null,ve=new je(se);$.audioSampleRate=ve.sampling_rate,$.channelCount=ve.channel_count,$.codec=ve.codec_mimetype,$.originalCodec=ve.original_codec_mimetype,$.config=ve.config,$.refSampleDuration=1536/$.audioSampleRate*$.timescale}else if(this.audio_metadata_.codec==="ec-3"){var Pe=z.codec==="ec-3"?z.data:null,ke=new Ne(Pe);$.audioSampleRate=ke.sampling_rate,$.channelCount=ke.channel_count,$.codec=ke.codec_mimetype,$.originalCodec=ke.original_codec_mimetype,$.config=ke.config,$.refSampleDuration=256*ke.num_blks/$.audioSampleRate*$.timescale}else this.audio_metadata_.codec==="opus"?($.audioSampleRate=this.audio_metadata_.sample_rate,$.channelCount=this.audio_metadata_.channel_count,$.channelConfigCode=this.audio_metadata_.channel_config_code,$.codec="opus",$.originalCodec="opus",$.config=void 0,$.refSampleDuration=20):this.audio_metadata_.codec==="mp3"&&($.audioSampleRate=this.audio_metadata_.sample_rate,$.channelCount=this.audio_metadata_.channel_count,$.codec="mp3",$.originalCodec="mp3",$.config=void 0);this.audio_init_segment_dispatched_==0&&a.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat($.codec)),this.onTrackMetadata("audio",$),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var xe=this.media_info_;xe.hasAudio=!0,xe.audioCodec=$.originalCodec,xe.audioSampleRate=$.audioSampleRate,xe.audioChannelCount=$.channelCount,xe.hasVideo&&xe.videoCodec?xe.mimeType='video/mp2t; codecs="'.concat(xe.videoCodec,",").concat(xe.audioCodec,'"'):xe.mimeType='video/mp2t; codecs="'.concat(xe.audioCodec,'"'),xe.isComplete()&&this.onMediaInfo(xe)},Z.prototype.dispatchPESPrivateDataDescriptor=function(z,$,ce){var Se=new Ae;Se.pid=z,Se.stream_type=$,Se.descriptor=ce,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(Se)},Z.prototype.parsePESPrivateDataPayload=function(z,$,ce,Se,se){var ve=new me;if(ve.pid=Se,ve.stream_id=se,ve.len=z.byteLength,ve.data=z,$!=null){var Pe=Math.floor($/this.timescale_);ve.pts=Pe}else ve.nearest_pts=this.getNearestTimestampMilliseconds();if(ce!=null){var ke=Math.floor(ce/this.timescale_);ve.dts=ke}this.onPESPrivateData&&this.onPESPrivateData(ve)},Z.prototype.parseTimedID3MetadataPayload=function(z,$,ce,Se,se){var ve=new me;if(ve.pid=Se,ve.stream_id=se,ve.len=z.byteLength,ve.data=z,$!=null){var Pe=Math.floor($/this.timescale_);ve.pts=Pe}if(ce!=null){var ke=Math.floor(ce/this.timescale_);ve.dts=ke}this.onTimedID3Metadata&&this.onTimedID3Metadata(ve)},Z.prototype.parseSynchronousKLVMetadataPayload=function(z,$,ce,Se,se){var ve=new fe;if(ve.pid=Se,ve.stream_id=se,ve.len=z.byteLength,ve.data=z,$!=null){var Pe=Math.floor($/this.timescale_);ve.pts=Pe}if(ce!=null){var ke=Math.floor(ce/this.timescale_);ve.dts=ke}ve.access_units=function(xe){for(var Re=[],Be=0;Be+5<xe.byteLength;){var Ue=xe[Be+0],at=xe[Be+1],gt=xe[Be+2],Yt=xe[Be+3]<<8|xe[Be+4]<<0,Ht=xe.slice(Be+5,Be+5+Yt);Re.push({service_id:Ue,sequence_number:at,flags:gt,data:Ht}),Be+=5+Yt}return Re}(z),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(ve)},Z.prototype.parseAsynchronousKLVMetadataPayload=function(z,$,ce){var Se=new me;Se.pid=$,Se.stream_id=ce,Se.len=z.byteLength,Se.data=z,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(Se)},Z.prototype.parseSMPTE2038MetadataPayload=function(z,$,ce,Se,se){var ve=new tt;if(ve.pid=Se,ve.stream_id=se,ve.len=z.byteLength,ve.data=z,$!=null){var Pe=Math.floor($/this.timescale_);ve.pts=Pe}if(ve.nearest_pts=this.getNearestTimestampMilliseconds(),ce!=null){var ke=Math.floor(ce/this.timescale_);ve.dts=ke}ve.ancillaries=function(xe){for(var Re=new B.a(xe),Be=0,Ue=[];Be+=6,Re.readBits(6)===0;){var at=Re.readBool();Be+=1;var gt=Re.readBits(11);Be+=11;var Yt=Re.readBits(12);Be+=12;var Ht=255&Re.readBits(10);Be+=10;var zt=255&Re.readBits(10);Be+=10;var oe=255&Re.readBits(10);Be+=10;for(var ge=new Uint8Array(oe),H=0;H<oe;H++){var P=255&Re.readBits(10);Be+=10,ge[H]=P}Re.readBits(10),Be+=10;var g="User Defined";Ht===65?zt===7&&(g="SCTE-104"):Ht===95?zt===220?g="ARIB STD-B37 (1SEG)":zt===221?g="ARIB STD-B37 (ANALOG)":zt===222?g="ARIB STD-B37 (SD)":zt===223&&(g="ARIB STD-B37 (HD)"):Ht===97&&(zt===1?g="EIA-708":zt===2&&(g="EIA-608")),Ue.push({yc_indicator:at,line_number:gt,horizontal_offset:Yt,did:Ht,sdid:zt,user_data:ge,description:g,information:{}}),Re.readBits(8-(Be-Math.floor(Be/8))%8),Be+=(8-(Be-Math.floor(Be/8)))%8}return Re.destroy(),Re=null,Ue}(z),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(ve)},Z.prototype.getNearestTimestampMilliseconds=function(){return this.audio_last_sample_pts_!=null?Math.floor(this.audio_last_sample_pts_):this.last_pcr_!=null?Math.floor(this.last_pcr_/300/this.timescale_):void 0},Z.prototype.getPcrBase=function(z){var $=33554432*z[6]+131072*z[7]+512*z[8]+2*z[9]+(128&z[10])/128+this.timestamp_offset_;return $+4294967296<this.last_pcr_base_&&($+=8589934592,this.timestamp_offset_+=8589934592),this.last_pcr_base_=$,$},Z.prototype.getTimestamp=function(z,$){var ce=536870912*(14&z[$])+4194304*(255&z[$+1])+16384*(254&z[$+2])+128*(255&z[$+3])+(254&z[$+4])/2+this.timestamp_offset_;return ce+4294967296<this.last_pcr_base_&&(ce+=8589934592),ce},Z}(f);i.a=nt},function(t,i,n){var o=n(8),a=function(){function c(){}return c._ebsp2rbsp=function(d){for(var f=d,l=f.byteLength,h=new Uint8Array(l),r=0,u=0;u<l;u++)u>=2&&f[u]===3&&f[u-1]===0&&f[u-2]===0||(h[r]=f[u],r++);return new Uint8Array(h.buffer,0,r)},c.parseVPS=function(d){var f=c._ebsp2rbsp(d),l=new o.a(f);return l.readByte(),l.readByte(),l.readBits(4),l.readBits(2),l.readBits(6),{num_temporal_layers:l.readBits(3)+1,temporal_id_nested:l.readBool()}},c.parseSPS=function(d){var f=c._ebsp2rbsp(d),l=new o.a(f);l.readByte(),l.readByte();for(var h=0,r=0,u=0,m=0,p=(l.readBits(4),l.readBits(3)),_=(l.readBool(),l.readBits(2)),A=l.readBool(),E=l.readBits(5),C=l.readByte(),k=l.readByte(),O=l.readByte(),G=l.readByte(),B=l.readByte(),T=l.readByte(),L=l.readByte(),I=l.readByte(),M=l.readByte(),K=l.readByte(),re=l.readByte(),ae=[],te=[],ne=0;ne<p;ne++)ae.push(l.readBool()),te.push(l.readBool());if(p>0)for(ne=p;ne<8;ne++)l.readBits(2);for(ne=0;ne<p;ne++)ae[ne]&&(l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte(),l.readByte()),te[ne]&&l.readByte();l.readUEG();var me=l.readUEG();me==3&&l.readBits(1);var Ae=l.readUEG(),F=l.readUEG();l.readBool()&&(h+=l.readUEG(),r+=l.readUEG(),u+=l.readUEG(),m+=l.readUEG());var y=l.readUEG(),v=l.readUEG(),S=l.readUEG();for(ne=l.readBool()?0:p;ne<=p;ne++)l.readUEG(),l.readUEG(),l.readUEG();if(l.readUEG(),l.readUEG(),l.readUEG(),l.readUEG(),l.readUEG(),l.readUEG(),l.readBool()&&l.readBool())for(var w=0;w<4;w++)for(var x=0;x<(w===3?2:6);x++)if(l.readBool()){var D=Math.min(64,1<<4+(w<<1));for(w>1&&l.readSEG(),ne=0;ne<D;ne++)l.readSEG()}else l.readUEG();l.readBool(),l.readBool(),l.readBool()&&(l.readByte(),l.readUEG(),l.readUEG(),l.readBool());var U=l.readUEG(),j=0;for(ne=0;ne<U;ne++){var X=!1;if(ne!==0&&(X=l.readBool()),X){ne===U&&l.readUEG(),l.readBool(),l.readUEG();for(var ee=0,ie=0;ie<=j;ie++){var be=l.readBool(),Te=!1;be||(Te=l.readBool()),(be||Te)&&ee++}j=ee}else{var Oe=l.readUEG(),He=l.readUEG();for(j=Oe+He,ie=0;ie<Oe;ie++)l.readUEG(),l.readBool();for(ie=0;ie<He;ie++)l.readUEG(),l.readBool()}}if(l.readBool()){var st=l.readUEG();for(ne=0;ne<st;ne++){for(ie=0;ie<S+4;ie++)l.readBits(1);l.readBits(1)}}var Le=0,rt=1,tt=1,Ee=!1,ft=1,pt=1;if(l.readBool(),l.readBool(),l.readBool()){if(l.readBool()){var Ze=l.readByte();Ze>0&&Ze<=16?(rt=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Ze-1],tt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Ze-1]):Ze===255&&(rt=l.readBits(16),tt=l.readBits(16))}if(l.readBool()&&l.readBool(),l.readBool()&&(l.readBits(3),l.readBool(),l.readBool()&&(l.readByte(),l.readByte(),l.readByte())),l.readBool()&&(l.readUEG(),l.readUEG()),l.readBool(),l.readBool(),l.readBool(),l.readBool()&&(l.readUEG(),l.readUEG(),l.readUEG(),l.readUEG()),l.readBool()&&(ft=l.readBits(32),pt=l.readBits(32),l.readBool()&&l.readUEG(),l.readBool())){var je=!1,he=!1,_e=!1;for(je=l.readBool(),he=l.readBool(),(je||he)&&((_e=l.readBool())&&(l.readByte(),l.readBits(5),l.readBool(),l.readBits(5)),l.readBits(4),l.readBits(4),_e&&l.readBits(4),l.readBits(5),l.readBits(5),l.readBits(5)),ne=0;ne<=p;ne++){var Ne=l.readBool();Ee=Ne;var fe=!0,Je=1;Ne||(fe=l.readBool());var ot=!1;if(fe?l.readUEG():ot=l.readBool(),ot||(Je=l.readUEG()+1),je){for(ie=0;ie<Je;ie++)l.readUEG(),l.readUEG(),_e&&(l.readUEG(),l.readUEG());l.readBool()}if(he){for(ie=0;ie<Je;ie++)l.readUEG(),l.readUEG(),_e&&(l.readUEG(),l.readUEG());l.readBool()}}}l.readBool()&&(l.readBool(),l.readBool(),l.readBool(),Le=l.readUEG(),l.readUEG(),l.readUEG(),l.readUEG(),l.readUEG())}l.readBool();var nt="hvc1.".concat(E,".1.L").concat(re,".B0"),q=Ae-(h+r)*(me===1||me===2?2:1),Z=F-(u+m)*(me===1?2:1),z=1;return rt!==1&&tt!==1&&(z=rt/tt),l.destroy(),l=null,{codec_mimetype:nt,profile_string:c.getProfileString(E),level_string:c.getLevelString(re),profile_idc:E,bit_depth:y+8,ref_frames:1,chroma_format:me,chroma_format_string:c.getChromaFormatString(me),general_level_idc:re,general_profile_space:_,general_tier_flag:A,general_profile_idc:E,general_profile_compatibility_flags_1:C,general_profile_compatibility_flags_2:k,general_profile_compatibility_flags_3:O,general_profile_compatibility_flags_4:G,general_constraint_indicator_flags_1:B,general_constraint_indicator_flags_2:T,general_constraint_indicator_flags_3:L,general_constraint_indicator_flags_4:I,general_constraint_indicator_flags_5:M,general_constraint_indicator_flags_6:K,min_spatial_segmentation_idc:Le,constant_frame_rate:0,chroma_format_idc:me,bit_depth_luma_minus8:y,bit_depth_chroma_minus8:v,frame_rate:{fixed:Ee,fps:pt/ft,fps_den:ft,fps_num:pt},sar_ratio:{width:rt,height:tt},codec_size:{width:q,height:Z},present_size:{width:q*z,height:Z}}},c.parsePPS=function(d){var f=c._ebsp2rbsp(d),l=new o.a(f);l.readByte(),l.readByte(),l.readUEG(),l.readUEG(),l.readBool(),l.readBool(),l.readBits(3),l.readBool(),l.readBool(),l.readUEG(),l.readUEG(),l.readSEG(),l.readBool(),l.readBool(),l.readBool()&&l.readUEG(),l.readSEG(),l.readSEG(),l.readBool(),l.readBool(),l.readBool(),l.readBool();var h=l.readBool(),r=l.readBool(),u=1;return r&&h?u=0:r?u=3:h&&(u=2),{parallelismType:u}},c.getChromaFormatString=function(d){switch(d){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},c.getProfileString=function(d){switch(d){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},c.getLevelString=function(d){return(d/30).toFixed(1)},c}();i.a=a},function(t,i,n){var o,a=n(0),c=function(){function B(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return B.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},B.prototype.addBytes=function(T){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=T,this._totalBytes+=T):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=T,this._totalBytes+=T):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=T,this._totalBytes+=T,this._lastCheckpoint=this._now())},Object.defineProperty(B.prototype,"currentKBps",{get:function(){this.addBytes(0);var T=(this._now()-this._lastCheckpoint)/1e3;return T==0&&(T=1),this._intervalBytes/T/1024},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"averageKBps",{get:function(){var T=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/T/1024},enumerable:!1,configurable:!0}),B}(),d=n(2),f=n(5),l=n(3),h=(o=function(B,T){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,I){L.__proto__=I}||function(L,I){for(var M in I)Object.prototype.hasOwnProperty.call(I,M)&&(L[M]=I[M])})(B,T)},function(B,T){if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function L(){this.constructor=B}o(B,T),B.prototype=T===null?Object.create(T):(L.prototype=T.prototype,new L)}),r=function(B){function T(L,I){var M=B.call(this,"fetch-stream-loader")||this;return M.TAG="FetchStreamLoader",M._seekHandler=L,M._config=I,M._needStash=!0,M._requestAbort=!1,M._abortController=null,M._contentLength=null,M._receivedLength=0,M}return h(T,B),T.isSupported=function(){try{var L=f.a.msedge&&f.a.version.minor>=15048,I=!f.a.msedge||L;return self.fetch&&self.ReadableStream&&I}catch{return!1}},T.prototype.destroy=function(){this.isWorking()&&this.abort(),B.prototype.destroy.call(this)},T.prototype.open=function(L,I){var M=this;this._dataSource=L,this._range=I;var K=L.url;this._config.reuseRedirectedURL&&L.redirectedURL!=null&&(K=L.redirectedURL);var re=this._seekHandler.getConfig(K,I),ae=new self.Headers;if(typeof re.headers=="object"){var te=re.headers;for(var ne in te)te.hasOwnProperty(ne)&&ae.append(ne,te[ne])}var me={method:"GET",headers:ae,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var ne in this._config.headers)ae.append(ne,this._config.headers[ne]);L.cors===!1&&(me.mode="same-origin"),L.withCredentials&&(me.credentials="include"),L.referrerPolicy&&(me.referrerPolicy=L.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,me.signal=this._abortController.signal),this._status=d.c.kConnecting,self.fetch(re.url,me).then(function(Ae){if(M._requestAbort)return M._status=d.c.kIdle,void Ae.body.cancel();if(Ae.ok&&Ae.status>=200&&Ae.status<=299){if(Ae.url!==re.url&&M._onURLRedirect){var F=M._seekHandler.removeURLParameters(Ae.url);M._onURLRedirect(F)}var y=Ae.headers.get("Content-Length");return y!=null&&(M._contentLength=parseInt(y),M._contentLength!==0&&M._onContentLengthKnown&&M._onContentLengthKnown(M._contentLength)),M._pump.call(M,Ae.body.getReader())}if(M._status=d.c.kError,!M._onError)throw new l.d("FetchStreamLoader: Http code invalid, "+Ae.status+" "+Ae.statusText);M._onError(d.b.HTTP_STATUS_CODE_INVALID,{code:Ae.status,msg:Ae.statusText})}).catch(function(Ae){if(!M._abortController||!M._abortController.signal.aborted){if(M._status=d.c.kError,!M._onError)throw Ae;M._onError(d.b.EXCEPTION,{code:-1,msg:Ae.message})}})},T.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==d.c.kBuffering||!f.a.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},T.prototype._pump=function(L){var I=this;return L.read().then(function(M){if(M.done)if(I._contentLength!==null&&I._receivedLength<I._contentLength){I._status=d.c.kError;var K=d.b.EARLY_EOF,re={code:-1,msg:"Fetch stream meet Early-EOF"};if(!I._onError)throw new l.d(re.msg);I._onError(K,re)}else I._status=d.c.kComplete,I._onComplete&&I._onComplete(I._range.from,I._range.from+I._receivedLength-1);else{if(I._abortController&&I._abortController.signal.aborted)return void(I._status=d.c.kComplete);if(I._requestAbort===!0)return I._status=d.c.kComplete,L.cancel();I._status=d.c.kBuffering;var ae=M.value.buffer,te=I._range.from+I._receivedLength;I._receivedLength+=ae.byteLength,I._onDataArrival&&I._onDataArrival(ae,te,I._receivedLength),I._pump(L)}}).catch(function(M){if(I._abortController&&I._abortController.signal.aborted)I._status=d.c.kComplete;else if(M.code!==11||!f.a.msedge){I._status=d.c.kError;var K=0,re=null;if(M.code!==19&&M.message!=="network error"||!(I._contentLength===null||I._contentLength!==null&&I._receivedLength<I._contentLength)?(K=d.b.EXCEPTION,re={code:M.code,msg:M.message}):(K=d.b.EARLY_EOF,re={code:M.code,msg:"Fetch stream meet Early-EOF"}),!I._onError)throw new l.d(re.msg);I._onError(K,re)}})},T}(d.a),u=function(){var B=function(T,L){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,M){I.__proto__=M}||function(I,M){for(var K in M)Object.prototype.hasOwnProperty.call(M,K)&&(I[K]=M[K])})(T,L)};return function(T,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function I(){this.constructor=T}B(T,L),T.prototype=L===null?Object.create(L):(I.prototype=L.prototype,new I)}}(),m=function(B){function T(L,I){var M=B.call(this,"xhr-moz-chunked-loader")||this;return M.TAG="MozChunkedLoader",M._seekHandler=L,M._config=I,M._needStash=!0,M._xhr=null,M._requestAbort=!1,M._contentLength=null,M._receivedLength=0,M}return u(T,B),T.isSupported=function(){try{var L=new XMLHttpRequest;return L.open("GET","https://example.com",!0),L.responseType="moz-chunked-arraybuffer",L.responseType==="moz-chunked-arraybuffer"}catch(I){return a.a.w("MozChunkedLoader",I.message),!1}},T.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),B.prototype.destroy.call(this)},T.prototype.open=function(L,I){this._dataSource=L,this._range=I;var M=L.url;this._config.reuseRedirectedURL&&L.redirectedURL!=null&&(M=L.redirectedURL);var K=this._seekHandler.getConfig(M,I);this._requestURL=K.url;var re=this._xhr=new XMLHttpRequest;if(re.open("GET",K.url,!0),re.responseType="moz-chunked-arraybuffer",re.onreadystatechange=this._onReadyStateChange.bind(this),re.onprogress=this._onProgress.bind(this),re.onloadend=this._onLoadEnd.bind(this),re.onerror=this._onXhrError.bind(this),L.withCredentials&&(re.withCredentials=!0),typeof K.headers=="object"){var ae=K.headers;for(var te in ae)ae.hasOwnProperty(te)&&re.setRequestHeader(te,ae[te])}if(typeof this._config.headers=="object"){ae=this._config.headers;for(var te in ae)ae.hasOwnProperty(te)&&re.setRequestHeader(te,ae[te])}this._status=d.c.kConnecting,re.send()},T.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=d.c.kComplete},T.prototype._onReadyStateChange=function(L){var I=L.target;if(I.readyState===2){if(I.responseURL!=null&&I.responseURL!==this._requestURL&&this._onURLRedirect){var M=this._seekHandler.removeURLParameters(I.responseURL);this._onURLRedirect(M)}if(I.status!==0&&(I.status<200||I.status>299)){if(this._status=d.c.kError,!this._onError)throw new l.d("MozChunkedLoader: Http code invalid, "+I.status+" "+I.statusText);this._onError(d.b.HTTP_STATUS_CODE_INVALID,{code:I.status,msg:I.statusText})}else this._status=d.c.kBuffering}},T.prototype._onProgress=function(L){if(this._status!==d.c.kError){this._contentLength===null&&L.total!==null&&L.total!==0&&(this._contentLength=L.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var I=L.target.response,M=this._range.from+this._receivedLength;this._receivedLength+=I.byteLength,this._onDataArrival&&this._onDataArrival(I,M,this._receivedLength)}},T.prototype._onLoadEnd=function(L){this._requestAbort!==!0?this._status!==d.c.kError&&(this._status=d.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},T.prototype._onXhrError=function(L){this._status=d.c.kError;var I=0,M=null;if(this._contentLength&&L.loaded<this._contentLength?(I=d.b.EARLY_EOF,M={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(I=d.b.EXCEPTION,M={code:-1,msg:L.constructor.name+" "+L.type}),!this._onError)throw new l.d(M.msg);this._onError(I,M)},T}(d.a),p=function(){var B=function(T,L){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,M){I.__proto__=M}||function(I,M){for(var K in M)Object.prototype.hasOwnProperty.call(M,K)&&(I[K]=M[K])})(T,L)};return function(T,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function I(){this.constructor=T}B(T,L),T.prototype=L===null?Object.create(L):(I.prototype=L.prototype,new I)}}(),_=(function(B){function T(L,I){var M=B.call(this,"xhr-msstream-loader")||this;return M.TAG="MSStreamLoader",M._seekHandler=L,M._config=I,M._needStash=!0,M._xhr=null,M._reader=null,M._totalRange=null,M._currentRange=null,M._currentRequestURL=null,M._currentRedirectedURL=null,M._contentLength=null,M._receivedLength=0,M._bufferLimit=16777216,M._lastTimeBufferSize=0,M._isReconnecting=!1,M}p(T,B),T.isSupported=function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var L=new XMLHttpRequest;return L.open("GET","https://example.com",!0),L.responseType="ms-stream",L.responseType==="ms-stream"}catch(I){return a.a.w("MSStreamLoader",I.message),!1}},T.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),B.prototype.destroy.call(this)},T.prototype.open=function(L,I){this._internalOpen(L,I,!1)},T.prototype._internalOpen=function(L,I,M){this._dataSource=L,M?this._currentRange=I:this._totalRange=I;var K=L.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?K=this._currentRedirectedURL:L.redirectedURL!=null&&(K=L.redirectedURL));var re=this._seekHandler.getConfig(K,I);this._currentRequestURL=re.url;var ae=this._reader=new self.MSStreamReader;ae.onprogress=this._msrOnProgress.bind(this),ae.onload=this._msrOnLoad.bind(this),ae.onerror=this._msrOnError.bind(this);var te=this._xhr=new XMLHttpRequest;if(te.open("GET",re.url,!0),te.responseType="ms-stream",te.onreadystatechange=this._xhrOnReadyStateChange.bind(this),te.onerror=this._xhrOnError.bind(this),L.withCredentials&&(te.withCredentials=!0),typeof re.headers=="object"){var ne=re.headers;for(var me in ne)ne.hasOwnProperty(me)&&te.setRequestHeader(me,ne[me])}if(typeof this._config.headers=="object"){ne=this._config.headers;for(var me in ne)ne.hasOwnProperty(me)&&te.setRequestHeader(me,ne[me])}this._isReconnecting?this._isReconnecting=!1:this._status=d.c.kConnecting,te.send()},T.prototype.abort=function(){this._internalAbort(),this._status=d.c.kComplete},T.prototype._internalAbort=function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},T.prototype._xhrOnReadyStateChange=function(L){var I=L.target;if(I.readyState===2)if(I.status>=200&&I.status<=299){if(this._status=d.c.kBuffering,I.responseURL!=null){var M=this._seekHandler.removeURLParameters(I.responseURL);I.responseURL!==this._currentRequestURL&&M!==this._currentRedirectedURL&&(this._currentRedirectedURL=M,this._onURLRedirect&&this._onURLRedirect(M))}var K=I.getResponseHeader("Content-Length");if(K!=null&&this._contentLength==null){var re=parseInt(K);re>0&&(this._contentLength=re,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=d.c.kError,!this._onError)throw new l.d("MSStreamLoader: Http code invalid, "+I.status+" "+I.statusText);this._onError(d.b.HTTP_STATUS_CODE_INVALID,{code:I.status,msg:I.statusText})}else if(I.readyState===3&&I.status>=200&&I.status<=299){this._status=d.c.kBuffering;var ae=I.response;this._reader.readAsArrayBuffer(ae)}},T.prototype._xhrOnError=function(L){this._status=d.c.kError;var I=d.b.EXCEPTION,M={code:-1,msg:L.constructor.name+" "+L.type};if(!this._onError)throw new l.d(M.msg);this._onError(I,M)},T.prototype._msrOnProgress=function(L){var I=L.target.result;if(I!=null){var M=I.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=I.byteLength;var K=this._totalRange.from+this._receivedLength;this._receivedLength+=M.byteLength,this._onDataArrival&&this._onDataArrival(M,K,this._receivedLength),I.byteLength>=this._bufferLimit&&(a.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(K+M.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},T.prototype._doReconnectIfNeeded=function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var L={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,L,!0)}},T.prototype._msrOnLoad=function(L){this._status=d.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},T.prototype._msrOnError=function(L){this._status=d.c.kError;var I=0,M=null;if(this._contentLength&&this._receivedLength<this._contentLength?(I=d.b.EARLY_EOF,M={code:-1,msg:"MSStream meet Early-Eof"}):(I=d.b.EARLY_EOF,M={code:-1,msg:L.constructor.name+" "+L.type}),!this._onError)throw new l.d(M.msg);this._onError(I,M)}}(d.a),function(){var B=function(T,L){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,M){I.__proto__=M}||function(I,M){for(var K in M)Object.prototype.hasOwnProperty.call(M,K)&&(I[K]=M[K])})(T,L)};return function(T,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function I(){this.constructor=T}B(T,L),T.prototype=L===null?Object.create(L):(I.prototype=L.prototype,new I)}}()),A=function(B){function T(L,I){var M=B.call(this,"xhr-range-loader")||this;return M.TAG="RangeLoader",M._seekHandler=L,M._config=I,M._needStash=!1,M._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],M._currentChunkSizeKB=384,M._currentSpeedNormalized=0,M._zeroSpeedChunkCount=0,M._xhr=null,M._speedSampler=new c,M._requestAbort=!1,M._waitForTotalLength=!1,M._totalLengthReceived=!1,M._currentRequestURL=null,M._currentRedirectedURL=null,M._currentRequestRange=null,M._totalLength=null,M._contentLength=null,M._receivedLength=0,M._lastTimeLoaded=0,M}return _(T,B),T.isSupported=function(){try{var L=new XMLHttpRequest;return L.open("GET","https://example.com",!0),L.responseType="arraybuffer",L.responseType==="arraybuffer"}catch(I){return a.a.w("RangeLoader",I.message),!1}},T.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),B.prototype.destroy.call(this)},Object.defineProperty(T.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),T.prototype.open=function(L,I){this._dataSource=L,this._range=I,this._status=d.c.kConnecting;var M=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(M=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||M?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},T.prototype._openSubRange=function(){var L=1024*this._currentChunkSizeKB,I=this._range.from+this._receivedLength,M=I+L;this._contentLength!=null&&M-this._range.from>=this._contentLength&&(M=this._range.from+this._contentLength-1),this._currentRequestRange={from:I,to:M},this._internalOpen(this._dataSource,this._currentRequestRange)},T.prototype._internalOpen=function(L,I){this._lastTimeLoaded=0;var M=L.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?M=this._currentRedirectedURL:L.redirectedURL!=null&&(M=L.redirectedURL));var K=this._seekHandler.getConfig(M,I);this._currentRequestURL=K.url;var re=this._xhr=new XMLHttpRequest;if(re.open("GET",K.url,!0),re.responseType="arraybuffer",re.onreadystatechange=this._onReadyStateChange.bind(this),re.onprogress=this._onProgress.bind(this),re.onload=this._onLoad.bind(this),re.onerror=this._onXhrError.bind(this),L.withCredentials&&(re.withCredentials=!0),typeof K.headers=="object"){var ae=K.headers;for(var te in ae)ae.hasOwnProperty(te)&&re.setRequestHeader(te,ae[te])}if(typeof this._config.headers=="object"){ae=this._config.headers;for(var te in ae)ae.hasOwnProperty(te)&&re.setRequestHeader(te,ae[te])}re.send()},T.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=d.c.kComplete},T.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},T.prototype._onReadyStateChange=function(L){var I=L.target;if(I.readyState===2){if(I.responseURL!=null){var M=this._seekHandler.removeURLParameters(I.responseURL);I.responseURL!==this._currentRequestURL&&M!==this._currentRedirectedURL&&(this._currentRedirectedURL=M,this._onURLRedirect&&this._onURLRedirect(M))}if(I.status>=200&&I.status<=299){if(this._waitForTotalLength)return;this._status=d.c.kBuffering}else{if(this._status=d.c.kError,!this._onError)throw new l.d("RangeLoader: Http code invalid, "+I.status+" "+I.statusText);this._onError(d.b.HTTP_STATUS_CODE_INVALID,{code:I.status,msg:I.statusText})}}},T.prototype._onProgress=function(L){if(this._status!==d.c.kError){if(this._contentLength===null){var I=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,I=!0;var M=L.total;this._internalAbort(),M!=null&M!==0&&(this._totalLength=M)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,I)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var K=L.loaded-this._lastTimeLoaded;this._lastTimeLoaded=L.loaded,this._speedSampler.addBytes(K)}},T.prototype._normalizeSpeed=function(L){var I=this._chunkSizeKBList,M=I.length-1,K=0,re=0,ae=M;if(L<I[0])return I[0];for(;re<=ae;){if((K=re+Math.floor((ae-re)/2))===M||L>=I[K]&&L<I[K+1])return I[K];I[K]<L?re=K+1:ae=K-1}},T.prototype._onLoad=function(L){if(this._status!==d.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var I=this._speedSampler.lastSecondKBps;if(I===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(I=this._speedSampler.currentKBps)),I!==0){var M=this._normalizeSpeed(I);this._currentSpeedNormalized!==M&&(this._currentSpeedNormalized=M,this._currentChunkSizeKB=M)}var K=L.target.response,re=this._range.from+this._receivedLength;this._receivedLength+=K.byteLength;var ae=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():ae=!0,this._onDataArrival&&this._onDataArrival(K,re,this._receivedLength),ae&&(this._status=d.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},T.prototype._onXhrError=function(L){this._status=d.c.kError;var I=0,M=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(I=d.b.EARLY_EOF,M={code:-1,msg:"RangeLoader meet Early-Eof"}):(I=d.b.EXCEPTION,M={code:-1,msg:L.constructor.name+" "+L.type}),!this._onError)throw new l.d(M.msg);this._onError(I,M)},T}(d.a),E=function(){var B=function(T,L){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,M){I.__proto__=M}||function(I,M){for(var K in M)Object.prototype.hasOwnProperty.call(M,K)&&(I[K]=M[K])})(T,L)};return function(T,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function I(){this.constructor=T}B(T,L),T.prototype=L===null?Object.create(L):(I.prototype=L.prototype,new I)}}(),C=function(B){function T(){var L=B.call(this,"websocket-loader")||this;return L.TAG="WebSocketLoader",L._needStash=!0,L._ws=null,L._requestAbort=!1,L._receivedLength=0,L}return E(T,B),T.isSupported=function(){try{return self.WebSocket!==void 0}catch{return!1}},T.prototype.destroy=function(){this._ws&&this.abort(),B.prototype.destroy.call(this)},T.prototype.open=function(L){try{var I=this._ws=new self.WebSocket(L.url);I.binaryType="arraybuffer",I.onopen=this._onWebSocketOpen.bind(this),I.onclose=this._onWebSocketClose.bind(this),I.onmessage=this._onWebSocketMessage.bind(this),I.onerror=this._onWebSocketError.bind(this),this._status=d.c.kConnecting}catch(K){this._status=d.c.kError;var M={code:K.code,msg:K.message};if(!this._onError)throw new l.d(M.msg);this._onError(d.b.EXCEPTION,M)}},T.prototype.abort=function(){var L=this._ws;!L||L.readyState!==0&&L.readyState!==1||(this._requestAbort=!0,L.close()),this._ws=null,this._status=d.c.kComplete},T.prototype._onWebSocketOpen=function(L){this._status=d.c.kBuffering},T.prototype._onWebSocketClose=function(L){this._requestAbort!==!0?(this._status=d.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},T.prototype._onWebSocketMessage=function(L){var I=this;if(L.data instanceof ArrayBuffer)this._dispatchArrayBuffer(L.data);else if(L.data instanceof Blob){var M=new FileReader;M.onload=function(){I._dispatchArrayBuffer(M.result)},M.readAsArrayBuffer(L.data)}else{this._status=d.c.kError;var K={code:-1,msg:"Unsupported WebSocket message type: "+L.data.constructor.name};if(!this._onError)throw new l.d(K.msg);this._onError(d.b.EXCEPTION,K)}},T.prototype._dispatchArrayBuffer=function(L){var I=L,M=this._receivedLength;this._receivedLength+=I.byteLength,this._onDataArrival&&this._onDataArrival(I,M,this._receivedLength)},T.prototype._onWebSocketError=function(L){this._status=d.c.kError;var I={code:L.code,msg:L.message};if(!this._onError)throw new l.d(I.msg);this._onError(d.b.EXCEPTION,I)},T}(d.a),k=function(){function B(T){this._zeroStart=T||!1}return B.prototype.getConfig=function(T,L){var I={};if(L.from!==0||L.to!==-1){var M=void 0;M=L.to!==-1?"bytes=".concat(L.from.toString(),"-").concat(L.to.toString()):"bytes=".concat(L.from.toString(),"-"),I.Range=M}else this._zeroStart&&(I.Range="bytes=0-");return{url:T,headers:I}},B.prototype.removeURLParameters=function(T){return T},B}(),O=function(){function B(T,L){this._startName=T,this._endName=L}return B.prototype.getConfig=function(T,L){var I=T;if(L.from!==0||L.to!==-1){var M=!0;I.indexOf("?")===-1&&(I+="?",M=!1),M&&(I+="&"),I+="".concat(this._startName,"=").concat(L.from.toString()),L.to!==-1&&(I+="&".concat(this._endName,"=").concat(L.to.toString()))}return{url:I,headers:{}}},B.prototype.removeURLParameters=function(T){var L=T.split("?")[0],I=void 0,M=T.indexOf("?");M!==-1&&(I=T.substring(M+1));var K="";if(I!=null&&I.length>0)for(var re=I.split("&"),ae=0;ae<re.length;ae++){var te=re[ae].split("="),ne=ae>0;te[0]!==this._startName&&te[0]!==this._endName&&(ne&&(K+="&"),K+=re[ae])}return K.length===0?L:L+"?"+K},B}(),G=function(){function B(T,L,I){this.TAG="IOController",this._config=L,this._extraData=I,this._stashInitialSize=65536,L.stashInitialSize!=null&&L.stashInitialSize>0&&(this._stashInitialSize=L.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,L.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=T,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(T.url),this._refTotalLength=T.filesize?T.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new c,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return B.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},B.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},B.prototype.isPaused=function(){return this._paused},Object.defineProperty(B.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"extraData",{get:function(){return this._extraData},set:function(T){this._extraData=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(T){this._onDataArrival=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(T){this._onSeeked=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onError",{get:function(){return this._onError},set:function(T){this._onError=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onComplete",{get:function(){return this._onComplete},set:function(T){this._onComplete=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(T){this._onRedirect=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(T){this._onRecoveredEarlyEof=T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"currentSpeed",{get:function(){return this._loaderClass===A?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),B.prototype._selectSeekHandler=function(){var T=this._config;if(T.seekType==="range")this._seekHandler=new k(this._config.rangeLoadZeroStart);else if(T.seekType==="param"){var L=T.seekParamStart||"bstart",I=T.seekParamEnd||"bend";this._seekHandler=new O(L,I)}else{if(T.seekType!=="custom")throw new l.b("Invalid seekType in config: ".concat(T.seekType));if(typeof T.customSeekHandler!="function")throw new l.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new T.customSeekHandler}},B.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=C;else if(r.isSupported())this._loaderClass=r;else if(m.isSupported())this._loaderClass=m;else{if(!A.isSupported())throw new l.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=A}},B.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},B.prototype.open=function(T){this._currentRange={from:0,to:-1},T&&(this._currentRange.from=T),this._speedSampler.reset(),T||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},B.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},B.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},B.prototype.resume=function(){if(this._paused){this._paused=!1;var T=this._resumeFrom;this._resumeFrom=0,this._internalSeek(T,!0)}},B.prototype.seek=function(T){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(T,!0)},B.prototype._internalSeek=function(T,L){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(L),this._loader.destroy(),this._loader=null;var I={from:T,to:-1};this._currentRange={from:I.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,I),this._onSeeked&&this._onSeeked()},B.prototype.updateUrl=function(T){if(!T||typeof T!="string"||T.length===0)throw new l.b("Url must be a non-empty string!");this._dataSource.url=T},B.prototype._expandBuffer=function(T){for(var L=this._stashSize;L+1048576<T;)L*=2;if((L+=1048576)!==this._bufferSize){var I=new ArrayBuffer(L);if(this._stashUsed>0){var M=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(I,0,L).set(M,0)}this._stashBuffer=I,this._bufferSize=L}},B.prototype._normalizeSpeed=function(T){var L=this._speedNormalizeList,I=L.length-1,M=0,K=0,re=I;if(T<L[0])return L[0];for(;K<=re;){if((M=K+Math.floor((re-K)/2))===I||T>=L[M]&&T<L[M+1])return L[M];L[M]<T?K=M+1:re=M-1}},B.prototype._adjustStashSize=function(T){var L=0;(L=this._config.isLive?T/8:T<512?T:T>=512&&T<=1024?Math.floor(1.5*T):2*T)>8192&&(L=8192);var I=1024*L+1048576;this._bufferSize<I&&this._expandBuffer(I),this._stashSize=1024*L},B.prototype._dispatchChunks=function(T,L){return this._currentRange.to=L+T.byteLength-1,this._onDataArrival(T,L)},B.prototype._onURLRedirect=function(T){this._redirectedURL=T,this._onRedirect&&this._onRedirect(T)},B.prototype._onContentLengthKnown=function(T){T&&this._fullRequestFlag&&(this._totalLength=T,this._fullRequestFlag=!1)},B.prototype._onLoaderChunkArrival=function(T,L,I){if(!this._onDataArrival)throw new l.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(T.byteLength);var M=this._speedSampler.lastSecondKBps;if(M!==0){var K=this._normalizeSpeed(M);this._speedNormalized!==K&&(this._speedNormalized=K,this._adjustStashSize(K))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=L),this._stashUsed+T.byteLength<=this._stashSize)(te=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(T),this._stashUsed),this._stashUsed+=T.byteLength;else if(te=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var re=this._stashBuffer.slice(0,this._stashUsed);(ne=this._dispatchChunks(re,this._stashByteStart))<re.byteLength?ne>0&&(me=new Uint8Array(re,ne),te.set(me,0),this._stashUsed=me.byteLength,this._stashByteStart+=ne):(this._stashUsed=0,this._stashByteStart+=ne),this._stashUsed+T.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+T.byteLength),te=new Uint8Array(this._stashBuffer,0,this._bufferSize)),te.set(new Uint8Array(T),this._stashUsed),this._stashUsed+=T.byteLength}else(ne=this._dispatchChunks(T,L))<T.byteLength&&((ae=T.byteLength-ne)>this._bufferSize&&(this._expandBuffer(ae),te=new Uint8Array(this._stashBuffer,0,this._bufferSize)),te.set(new Uint8Array(T,ne),0),this._stashUsed+=ae,this._stashByteStart=L+ne);else if(this._stashUsed===0){var ae;(ne=this._dispatchChunks(T,L))<T.byteLength&&((ae=T.byteLength-ne)>this._bufferSize&&this._expandBuffer(ae),(te=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(T,ne),0),this._stashUsed+=ae,this._stashByteStart=L+ne)}else{var te,ne;if(this._stashUsed+T.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+T.byteLength),(te=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(T),this._stashUsed),this._stashUsed+=T.byteLength,(ne=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&ne>0){var me=new Uint8Array(this._stashBuffer,ne);te.set(me,0)}this._stashUsed-=ne,this._stashByteStart+=ne}}},B.prototype._flushStashBuffer=function(T){if(this._stashUsed>0){var L=this._stashBuffer.slice(0,this._stashUsed),I=this._dispatchChunks(L,this._stashByteStart),M=L.byteLength-I;if(I<L.byteLength){if(!T){if(I>0){var K=new Uint8Array(this._stashBuffer,0,this._bufferSize),re=new Uint8Array(L,I);K.set(re,0),this._stashUsed=re.byteLength,this._stashByteStart+=I}return 0}a.a.w(this.TAG,"".concat(M," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,M}return 0},B.prototype._onLoaderComplete=function(T,L){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},B.prototype._onLoaderError=function(T,L){switch(a.a.e(this.TAG,"Loader error, code = ".concat(L.code,", msg = ").concat(L.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,T=d.b.UNRECOVERABLE_EARLY_EOF),T){case d.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var I=this._currentRange.to+1;return void(I<this._totalLength&&(a.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(I,!1)))}T=d.b.UNRECOVERABLE_EARLY_EOF;break;case d.b.UNRECOVERABLE_EARLY_EOF:case d.b.CONNECTING_TIMEOUT:case d.b.HTTP_STATUS_CODE_INVALID:case d.b.EXCEPTION:}if(!this._onError)throw new l.d("IOException: "+L.msg);this._onError(T,L)},B}();i.a=G},function(t,i,n){var o=n(10),a=n.n(o),c=n(0),d=n(5),f=n(13);function l(y,v,S){var w=y;if(v+S<w.length){for(;S--;)if((192&w[++v])!=128)return!1;return!0}return!1}var h,r=function(y){for(var v=[],S=y,w=0,x=y.length;w<x;)if(S[w]<128)v.push(String.fromCharCode(S[w])),++w;else{if(!(S[w]<192)){if(S[w]<224){if(l(S,w,1)&&(D=(31&S[w])<<6|63&S[w+1])>=128){v.push(String.fromCharCode(65535&D)),w+=2;continue}}else if(S[w]<240){if(l(S,w,2)&&(D=(15&S[w])<<12|(63&S[w+1])<<6|63&S[w+2])>=2048&&(63488&D)!=55296){v.push(String.fromCharCode(65535&D)),w+=3;continue}}else if(S[w]<248){var D;if(l(S,w,3)&&(D=(7&S[w])<<18|(63&S[w+1])<<12|(63&S[w+2])<<6|63&S[w+3])>65536&&D<1114112){D-=65536,v.push(String.fromCharCode(D>>>10|55296)),v.push(String.fromCharCode(1023&D|56320)),w+=4;continue}}}v.push("�"),++w}return v.join("")},u=n(3),m=(h=new ArrayBuffer(2),new DataView(h).setInt16(0,256,!0),new Int16Array(h)[0]===256),p=function(){function y(){}return y.parseScriptData=function(v,S,w){var x={};try{var D=y.parseValue(v,S,w),U=y.parseValue(v,S+D.size,w-D.size);x[D.data]=U.data}catch(j){c.a.e("AMF",j.toString())}return x},y.parseObject=function(v,S,w){if(w<3)throw new u.a("Data not enough when parse ScriptDataObject");var x=y.parseString(v,S,w),D=y.parseValue(v,S+x.size,w-x.size),U=D.objectEnd;return{data:{name:x.data,value:D.data},size:x.size+D.size,objectEnd:U}},y.parseVariable=function(v,S,w){return y.parseObject(v,S,w)},y.parseString=function(v,S,w){if(w<2)throw new u.a("Data not enough when parse String");var x=new DataView(v,S,w).getUint16(0,!m);return{data:x>0?r(new Uint8Array(v,S+2,x)):"",size:2+x}},y.parseLongString=function(v,S,w){if(w<4)throw new u.a("Data not enough when parse LongString");var x=new DataView(v,S,w).getUint32(0,!m);return{data:x>0?r(new Uint8Array(v,S+4,x)):"",size:4+x}},y.parseDate=function(v,S,w){if(w<10)throw new u.a("Data size invalid when parse Date");var x=new DataView(v,S,w),D=x.getFloat64(0,!m),U=x.getInt16(8,!m);return{data:new Date(D+=60*U*1e3),size:10}},y.parseValue=function(v,S,w){if(w<1)throw new u.a("Data not enough when parse Value");var x,D=new DataView(v,S,w),U=1,j=D.getUint8(0),X=!1;try{switch(j){case 0:x=D.getFloat64(1,!m),U+=8;break;case 1:x=!!D.getUint8(1),U+=1;break;case 2:var ee=y.parseString(v,S+1,w-1);x=ee.data,U+=ee.size;break;case 3:x={};var ie=0;for((16777215&D.getUint32(w-4,!m))==9&&(ie=3);U<w-4;){var be=y.parseObject(v,S+U,w-U-ie);if(be.objectEnd)break;x[be.data.name]=be.data.value,U+=be.size}U<=w-3&&(16777215&D.getUint32(U-1,!m))===9&&(U+=3);break;case 8:for(x={},U+=4,ie=0,(16777215&D.getUint32(w-4,!m))==9&&(ie=3);U<w-8;){var Te=y.parseVariable(v,S+U,w-U-ie);if(Te.objectEnd)break;x[Te.data.name]=Te.data.value,U+=Te.size}U<=w-3&&(16777215&D.getUint32(U-1,!m))===9&&(U+=3);break;case 9:x=void 0,U=1,X=!0;break;case 10:x=[];var Oe=D.getUint32(1,!m);U+=4;for(var He=0;He<Oe;He++){var st=y.parseValue(v,S+U,w-U);x.push(st.data),U+=st.size}break;case 11:var Le=y.parseDate(v,S+1,w-1);x=Le.data,U+=Le.size;break;case 12:var rt=y.parseString(v,S+1,w-1);x=rt.data,U+=rt.size;break;default:U=w,c.a.w("AMF","Unsupported AMF value type "+j)}}catch(tt){c.a.e("AMF",tt.toString())}return{data:x,size:U,objectEnd:X}},y}(),_=n(22),A=n(6),E=n(15);function C(y){return y.byteOffset%2==0&&y.byteLength%2==0}function k(y){return y.byteOffset%4==0&&y.byteLength%4==0}function O(y,v){for(var S=0;S<y.length;S++)if(y[S]!==v[S])return!1;return!0}var G=function(y,v){return y.byteLength===v.byteLength&&(k(y)&&k(v)?function(S,w){return O(new Uint32Array(S.buffer,S.byteOffset,S.byteLength/4),new Uint32Array(w.buffer,w.byteOffset,w.byteLength/4))}(y,v):C(y)&&C(v)?function(S,w){return O(new Uint16Array(S.buffer,S.byteOffset,S.byteLength/2),new Uint16Array(w.buffer,w.byteOffset,w.byteLength/2))}(y,v):function(S,w){return O(S,w)}(y,v))},B=n(8),T=function(){function y(){}return y.parseOBUs=function(v){for(var S=null,w=0;w<v.byteLength;){v[w];var x=(120&v[w])>>3,D=(4&v[w])!=0,U=(2&v[w])!=0;v[w],w+=1,D&&(w+=1);var j=Number.POSITIVE_INFINITY;if(U){j=0;for(var X=0;j|=(127&v[w])<<7*X,(128&v[w+=1])!=0;X++);}x===1&&(S=y.parseSeuqneceHeader(v.subarray(w,w+j))),w+=j}return S},y.parseSeuqneceHeader=function(v){var S=new B.a(v),w=S.readBits(3),x=(S.readBool(),S.readBool()),D=!0,U=0,j=0,X=[];if(x)X.push({operating_point_idc:0,level:S.readBits(5),tier:0});else{if(S.readBool()){var ee=S.readBits(32),ie=S.readBits(32),be=S.readBool();if(be){for(var Te=0;S.readBits(1)===0;)Te+=1;Te>=32||(1<<Te)-1+S.readBits(Te)}(U=ie)/(j=ee),D=be,S.readBool()&&(S.readBits(5),S.readBits(32),S.readBits(5),S.readBits(5))}for(var Oe=S.readBool(),He=S.readBits(5),st=0;st<=He;st++){var Le=S.readBits(12),rt=S.readBits(5),tt=rt>7?S.readBits(1):0;X.push({operating_point_idc:Le,level:rt,tier:tt}),Oe&&S.readBool()&&S.readBits(4)}}var Ee=X[0],ft=Ee.level,pt=Ee.tier,Ze=S.readBits(4),je=S.readBits(4),he=S.readBits(Ze+1)+1,_e=S.readBits(je+1)+1,Ne=!1;x||(Ne=S.readBool()),Ne&&(S.readBits(4),S.readBits(4)),S.readBool(),S.readBool(),S.readBool();var fe=!1;x||(S.readBool(),S.readBool(),S.readBool(),S.readBool(),(fe=S.readBool())&&(S.readBool(),S.readBool()),(S.readBool()||S.readBits(1))&&(S.readBool()||S.readBits(1)),fe&&S.readBits(3)+1),S.readBool(),S.readBool(),S.readBool();var Je=S.readBool(),ot=8;w===2&&Je?ot=S.readBool()?12:10:ot=Je?10:8;var nt=!1;w!==1&&(nt=S.readBool()),S.readBool()&&(S.readBits(8),S.readBits(8),S.readBits(8));var q=1,Z=1;return nt?(S.readBits(1),q=1,Z=1):(S.readBits(1),w==0?(q=1,Z=1):w==1?(q=0,Z=0):ot==12?S.readBits(1)&&S.readBits(1):(q=1,Z=0),q&&Z&&S.readBits(2),S.readBits(1)),S.readBool(),S.destroy(),S=null,{codec_mimetype:"av01.".concat(w,".").concat(y.getLevelString(ft,pt),".").concat(ot.toString(10).padStart(2,"0")),level:ft,tier:pt,level_string:y.getLevelString(ft,pt),profile_idc:w,profile_string:"".concat(w),bit_depth:ot,ref_frames:1,chroma_format:y.getChromaFormat(nt,q,Z),chroma_format_string:y.getChromaFormatString(nt,q,Z),frame_rate:{fixed:D,fps:U/j,fps_den:j,fps_num:U},sar_ratio:{width:1,height:1},codec_size:{width:he,height:_e},present_size:{width:1*he,height:_e}}},y.getLevelString=function(v,S){return"".concat(v.toString(10).padStart(2,"0")).concat(S===0?"M":"H")},y.getChromaFormat=function(v,S,w){return v?0:S===0&&w===0?3:S===1&&w===0?2:S===1&&w===1?1:Number.NaN},y.getChromaFormatString=function(v,S,w){return v?"4:0:0":S===0&&w===0?"4:4:4":S===1&&w===0?"4:2:2":S===1&&w===1?"4:2:0":"Unknown"},y}(),L=function(){function y(v,S){this.TAG="FLVDemuxer",this._config=S,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=v.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=v.hasAudioTrack,this._hasVideo=v.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new f.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var w=new ArrayBuffer(2);return new DataView(w).setInt16(0,256,!0),new Int16Array(w)[0]===256}()}return y.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},y.probe=function(v){var S=new Uint8Array(v);if(S.byteLength<9)return{needMoreData:!0};var w={match:!1};if(S[0]!==70||S[1]!==76||S[2]!==86||S[3]!==1)return w;var x,D,U=(4&S[4])>>>2!=0,j=(1&S[4])!=0,X=(x=S)[D=5]<<24|x[D+1]<<16|x[D+2]<<8|x[D+3];return X<9?w:{match:!0,consumed:X,dataOffset:X,hasAudioTrack:U,hasVideoTrack:j}},y.prototype.bindDataSource=function(v){return v.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(y.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(v){this._onTrackMetadata=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(v){this._onMediaInfo=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(v){this._onMetaDataArrived=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(v){this._onScriptDataArrived=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onError",{get:function(){return this._onError},set:function(v){this._onError=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(v){this._onDataAvailable=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(v){this._timestampBase=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"overridedDuration",{get:function(){return this._duration},set:function(v){this._durationOverrided=!0,this._duration=v,this._mediaInfo.duration=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"overridedHasAudio",{set:function(v){this._hasAudioFlagOverrided=!0,this._hasAudio=v,this._mediaInfo.hasAudio=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"overridedHasVideo",{set:function(v){this._hasVideoFlagOverrided=!0,this._hasVideo=v,this._mediaInfo.hasVideo=v},enumerable:!1,configurable:!0}),y.prototype.resetMediaInfo=function(){this._mediaInfo=new f.a},y.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},y.prototype.parseChunks=function(v,S){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new u.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var w=0,x=this._littleEndian;if(S===0){if(!(v.byteLength>13))return 0;w=y.probe(v).dataOffset}for(this._firstParse&&(this._firstParse=!1,S+w!==this._dataOffset&&c.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(D=new DataView(v,w)).getUint32(0,!x)!==0&&c.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),w+=4);w<v.byteLength;){this._dispatch=!0;var D=new DataView(v,w);if(w+11+4>v.byteLength)break;var U=D.getUint8(0),j=16777215&D.getUint32(0,!x);if(w+11+j+4>v.byteLength)break;if(U===8||U===9||U===18){var X=D.getUint8(4),ee=D.getUint8(5),ie=D.getUint8(6)|ee<<8|X<<16|D.getUint8(7)<<24;16777215&D.getUint32(7,!x)&&c.a.w(this.TAG,"Meet tag which has StreamID != 0!");var be=w+11;switch(U){case 8:this._parseAudioData(v,be,j,ie);break;case 9:this._parseVideoData(v,be,j,ie,S+w);break;case 18:this._parseScriptData(v,be,j)}var Te=D.getUint32(11+j,!x);Te!==11+j&&c.a.w(this.TAG,"Invalid PrevTagSize ".concat(Te)),w+=11+j+4}else c.a.w(this.TAG,"Unsupported tag type ".concat(U,", skipped")),w+=11+j+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),w},y.prototype._parseScriptData=function(v,S,w){var x=p.parseScriptData(v,S,w);if(x.hasOwnProperty("onMetaData")){if(x.onMetaData==null||typeof x.onMetaData!="object")return void c.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&c.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=x;var D=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},D)),typeof D.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=D.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof D.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=D.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof D.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=D.audiodatarate),typeof D.videodatarate=="number"&&(this._mediaInfo.videoDataRate=D.videodatarate),typeof D.width=="number"&&(this._mediaInfo.width=D.width),typeof D.height=="number"&&(this._mediaInfo.height=D.height),typeof D.duration=="number"){if(!this._durationOverrided){var U=Math.floor(D.duration*this._timescale);this._duration=U,this._mediaInfo.duration=U}}else this._mediaInfo.duration=0;if(typeof D.framerate=="number"){var j=Math.floor(1e3*D.framerate);if(j>0){var X=j/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=X,this._referenceFrameRate.fps_num=j,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=X}}if(typeof D.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var ee=D.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(ee),D.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=D,c.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(x).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},x))},y.prototype._parseKeyframesIndex=function(v){for(var S=[],w=[],x=1;x<v.times.length;x++){var D=this._timestampBase+Math.floor(1e3*v.times[x]);S.push(D),w.push(v.filepositions[x])}return{times:S,filepositions:w}},y.prototype._parseAudioData=function(v,S,w,x){if(w<=1)c.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var D=new DataView(v,S,w).getUint8(0),U=D>>>4;if(U!==9)if(U===2||U===10){var j=0,X=(12&D)>>>2;if(X>=0&&X<=4){j=this._flvSoundRateTable[X];var ee=1&D,ie=this._audioMetadata,be=this._audioTrack;if(ie||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(ie=this._audioMetadata={}).type="audio",ie.id=be.id,ie.timescale=this._timescale,ie.duration=this._duration,ie.audioSampleRate=j,ie.channelCount=ee===0?1:2),U===10){var Te=this._parseAACAudioData(v,S+1,w-1);if(Te==null)return;if(Te.packetType===0){if(ie.config){if(G(Te.data.config,ie.config))return;c.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var Oe=Te.data;ie.audioSampleRate=Oe.samplingRate,ie.channelCount=Oe.channelCount,ie.codec=Oe.codec,ie.originalCodec=Oe.originalCodec,ie.config=Oe.config,ie.refSampleDuration=1024/ie.audioSampleRate*ie.timescale,c.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",ie),(Le=this._mediaInfo).audioCodec=ie.originalCodec,Le.audioSampleRate=ie.audioSampleRate,Le.audioChannelCount=ie.channelCount,Le.hasVideo?Le.videoCodec!=null&&(Le.mimeType='video/x-flv; codecs="'+Le.videoCodec+","+Le.audioCodec+'"'):Le.mimeType='video/x-flv; codecs="'+Le.audioCodec+'"',Le.isComplete()&&this._onMediaInfo(Le)}else if(Te.packetType===1){var He=this._timestampBase+x,st={unit:Te.data,length:Te.data.byteLength,dts:He,pts:He};be.samples.push(st),be.length+=Te.data.length}else c.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(Te.packetType))}else if(U===2){if(!ie.codec){var Le;if((Oe=this._parseMP3AudioData(v,S+1,w-1,!0))==null)return;ie.audioSampleRate=Oe.samplingRate,ie.channelCount=Oe.channelCount,ie.codec=Oe.codec,ie.originalCodec=Oe.originalCodec,ie.refSampleDuration=1152/ie.audioSampleRate*ie.timescale,c.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",ie),(Le=this._mediaInfo).audioCodec=ie.codec,Le.audioSampleRate=ie.audioSampleRate,Le.audioChannelCount=ie.channelCount,Le.audioDataRate=Oe.bitRate,Le.hasVideo?Le.videoCodec!=null&&(Le.mimeType='video/x-flv; codecs="'+Le.videoCodec+","+Le.audioCodec+'"'):Le.mimeType='video/x-flv; codecs="'+Le.audioCodec+'"',Le.isComplete()&&this._onMediaInfo(Le)}var rt=this._parseMP3AudioData(v,S+1,w-1,!1);if(rt==null)return;He=this._timestampBase+x;var tt={unit:rt,length:rt.byteLength,dts:He,pts:He};be.samples.push(tt),be.length+=rt.length}}else this._onError(A.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+X)}else this._onError(A.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+U);else{if(w<=5)return void c.a.w(this.TAG,"Flv: Invalid audio packet, missing AudioFourCC in Ehnanced FLV payload!");var Ee=15&D,ft=String.fromCharCode.apply(String,new Uint8Array(v,S,w).slice(1,5));switch(ft){case"Opus":this._parseOpusAudioPacket(v,S+5,w-5,x,Ee);break;case"fLaC":this._parseFlacAudioPacket(v,S+5,w-5,x,Ee);break;default:this._onError(A.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec: "+ft)}}}},y.prototype._parseAACAudioData=function(v,S,w){if(!(w<=1)){var x={},D=new Uint8Array(v,S,w);return x.packetType=D[0],D[0]===0?x.data=this._parseAACAudioSpecificConfig(v,S+1,w-1):x.data=D.subarray(1),x}c.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},y.prototype._parseAACAudioSpecificConfig=function(v,S,w){var x,D,U=new Uint8Array(v,S,w),j=null,X=0,ee=null;if(X=x=U[0]>>>3,(D=(7&U[0])<<1|U[1]>>>7)<0||D>=this._mpegSamplingRates.length)this._onError(A.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var ie=this._mpegSamplingRates[D],be=(120&U[1])>>>3;if(!(be<0||be>=8)){X===5&&(ee=(7&U[1])<<1|U[2]>>>7,(124&U[2])>>>2);var Te=self.navigator.userAgent.toLowerCase();return Te.indexOf("firefox")!==-1?D>=6?(X=5,j=new Array(4),ee=D-3):(X=2,j=new Array(2),ee=D):Te.indexOf("android")!==-1?(X=2,j=new Array(2),ee=D):(X=5,ee=D,j=new Array(4),D>=6?ee=D-3:be===1&&(X=2,j=new Array(2),ee=D)),j[0]=X<<3,j[0]|=(15&D)>>>1,j[1]=(15&D)<<7,j[1]|=(15&be)<<3,X===5&&(j[1]|=(15&ee)>>>1,j[2]=(1&ee)<<7,j[2]|=8,j[3]=0),{config:j,samplingRate:ie,channelCount:be,codec:"mp4a.40."+X,originalCodec:"mp4a.40."+x}}this._onError(A.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},y.prototype._parseMP3AudioData=function(v,S,w,x){if(!(w<4)){this._littleEndian;var D=new Uint8Array(v,S,w),U=null;if(x){if(D[0]!==255)return;var j=D[1]>>>3&3,X=(6&D[1])>>1,ee=(240&D[2])>>>4,ie=(12&D[2])>>>2,be=(D[3]>>>6&3)!==3?2:1,Te=0,Oe=0;switch(j){case 0:Te=this._mpegAudioV25SampleRateTable[ie];break;case 2:Te=this._mpegAudioV20SampleRateTable[ie];break;case 3:Te=this._mpegAudioV10SampleRateTable[ie]}switch(X){case 1:ee<this._mpegAudioL3BitRateTable.length&&(Oe=this._mpegAudioL3BitRateTable[ee]);break;case 2:ee<this._mpegAudioL2BitRateTable.length&&(Oe=this._mpegAudioL2BitRateTable[ee]);break;case 3:ee<this._mpegAudioL1BitRateTable.length&&(Oe=this._mpegAudioL1BitRateTable[ee])}U={bitRate:Oe,samplingRate:Te,channelCount:be,codec:"mp3",originalCodec:"mp3"}}else U=D;return U}c.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},y.prototype._parseOpusAudioPacket=function(v,S,w,x,D){if(D===0)this._parseOpusSequenceHeader(v,S,w);else if(D===1)this._parseOpusAudioData(v,S,w,x);else if(D!==2)return void this._onError(A.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(D))},y.prototype._parseOpusSequenceHeader=function(v,S,w){if(w<=16)c.a.w(this.TAG,"Flv: Invalid OpusSequenceHeader, lack of data!");else{var x=this._audioMetadata,D=this._audioTrack;x||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(x=this._audioMetadata={}).type="audio",x.id=D.id,x.timescale=this._timescale,x.duration=this._duration);var U=new DataView(v,S,w);U.setUint8(8,0);var j=U.getUint8(9);U.setUint16(10,U.getUint16(10,!0),!1);var X=U.getUint32(12,!0);U.setUint32(12,U.getUint32(12,!0),!1);var ee={config:new Uint8Array(v,S+8,w-8),channelCount:j,samplingFrequence:X,codec:"opus",originalCodec:"opus"};if(x.config){if(G(ee.config,x.config))return;c.a.w(this.TAG,"OpusSequenceHeader has been changed, re-generate initialization segment")}x.audioSampleRate=ee.samplingFrequence,x.channelCount=ee.channelCount,x.codec=ee.codec,x.originalCodec=ee.originalCodec,x.config=ee.config,x.refSampleDuration=20,c.a.v(this.TAG,"Parsed OpusSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",x);var ie=this._mediaInfo;ie.audioCodec=x.originalCodec,ie.audioSampleRate=x.audioSampleRate,ie.audioChannelCount=x.channelCount,ie.hasVideo?ie.videoCodec!=null&&(ie.mimeType='video/x-flv; codecs="'+ie.videoCodec+","+ie.audioCodec+'"'):ie.mimeType='video/x-flv; codecs="'+ie.audioCodec+'"',ie.isComplete()&&this._onMediaInfo(ie)}},y.prototype._parseOpusAudioData=function(v,S,w,x){var D=this._audioTrack,U=new Uint8Array(v,S,w),j=this._timestampBase+x,X={unit:U,length:U.byteLength,dts:j,pts:j};D.samples.push(X),D.length+=U.length},y.prototype._parseFlacAudioPacket=function(v,S,w,x,D){if(D===0)this._parseFlacSequenceHeader(v,S,w);else if(D===1)this._parseFlacAudioData(v,S,w,x);else if(D!==2)return void this._onError(A.a.FORMAT_ERROR,"Flv: Invalid Flac audio packet type ".concat(D))},y.prototype._parseFlacSequenceHeader=function(v,S,w){var x=this._audioMetadata,D=this._audioTrack;x||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(x=this._audioMetadata={}).type="audio",x.id=D.id,x.timescale=this._timescale,x.duration=this._duration);var U=new Uint8Array(v,S+4,w-4),j=new B.a(U),X=j.readBits(16),ee=j.readBits(16),ie=ee===X?ee:null;j.readBits(24),j.readBits(24);var be=j.readBits(20),Te=j.readBits(3)+1,Oe=j.readBits(5)+1;j.destroy();var He=new Uint8Array(U.byteLength+4);He.set(U,4),He[0]=128,He[1]=U.byteLength>>>16&255,He[2]=U.byteLength>>>8&255,He[3]=U.byteLength>>>0&255;var st={config:He,channelCount:Te,samplingFrequence:be,sampleSize:Oe,codec:"flac",originalCodec:"flac"};if(x.config){if(G(st.config,x.config))return;c.a.w(this.TAG,"FlacSequenceHeader has been changed, re-generate initialization segment")}x.audioSampleRate=st.samplingFrequence,x.channelCount=st.channelCount,x.sampleSize=st.sampleSize,x.codec=st.codec,x.originalCodec=st.originalCodec,x.config=st.config,x.refSampleDuration=ie!=null?1e3*ie/st.samplingFrequence:null,c.a.v(this.TAG,"Parsed FlacSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",x);var Le=this._mediaInfo;Le.audioCodec=x.originalCodec,Le.audioSampleRate=x.audioSampleRate,Le.audioChannelCount=x.channelCount,Le.hasVideo?Le.videoCodec!=null&&(Le.mimeType='video/x-flv; codecs="'+Le.videoCodec+","+Le.audioCodec+'"'):Le.mimeType='video/x-flv; codecs="'+Le.audioCodec+'"',Le.isComplete()&&this._onMediaInfo(Le)},y.prototype._parseFlacAudioData=function(v,S,w,x){var D=this._audioTrack,U=new Uint8Array(v,S,w),j=this._timestampBase+x,X={unit:U,length:U.byteLength,dts:j,pts:j};D.samples.push(X),D.length+=U.length},y.prototype._parseVideoData=function(v,S,w,x,D){if(w<=1)c.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var U=new Uint8Array(v,S,w)[0],j=(112&U)>>>4;if(128&U){var X=15&U,ee=String.fromCharCode.apply(String,new Uint8Array(v,S,w).slice(1,5));if(ee==="hvc1")this._parseEnhancedHEVCVideoPacket(v,S+5,w-5,x,D,j,X);else{if(ee!=="av01")return void this._onError(A.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(ee));this._parseEnhancedAV1VideoPacket(v,S+5,w-5,x,D,j,X)}}else{var ie=15&U;if(ie===7)this._parseAVCVideoPacket(v,S+1,w-1,x,D,j);else{if(ie!==12)return void this._onError(A.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(ie));this._parseHEVCVideoPacket(v,S+1,w-1,x,D,j)}}}},y.prototype._parseAVCVideoPacket=function(v,S,w,x,D,U){if(w<4)c.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var j=this._littleEndian,X=new DataView(v,S,w),ee=X.getUint8(0),ie=(16777215&X.getUint32(0,!j))<<8>>8;if(ee===0)this._parseAVCDecoderConfigurationRecord(v,S+4,w-4);else if(ee===1)this._parseAVCVideoData(v,S+4,w-4,x,D,U,ie);else if(ee!==2)return void this._onError(A.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(ee))}},y.prototype._parseHEVCVideoPacket=function(v,S,w,x,D,U){if(w<4)c.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var j=this._littleEndian,X=new DataView(v,S,w),ee=X.getUint8(0),ie=(16777215&X.getUint32(0,!j))<<8>>8;if(ee===0)this._parseHEVCDecoderConfigurationRecord(v,S+4,w-4);else if(ee===1)this._parseHEVCVideoData(v,S+4,w-4,x,D,U,ie);else if(ee!==2)return void this._onError(A.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(ee))}},y.prototype._parseEnhancedHEVCVideoPacket=function(v,S,w,x,D,U,j){var X=this._littleEndian,ee=new DataView(v,S,w);if(j===0)this._parseHEVCDecoderConfigurationRecord(v,S,w);else if(j===1){var ie=(4294967040&ee.getUint32(0,!X))>>8;this._parseHEVCVideoData(v,S+3,w-3,x,D,U,ie)}else if(j===3)this._parseHEVCVideoData(v,S,w,x,D,U,0);else if(j!==2)return void this._onError(A.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(j))},y.prototype._parseEnhancedAV1VideoPacket=function(v,S,w,x,D,U,j){if(this._littleEndian,j===0)this._parseAV1CodecConfigurationRecord(v,S,w);else if(j===1)this._parseAV1VideoData(v,S,w,x,D,U,0);else{if(j===5)return void this._onError(A.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(j));if(j!==2)return void this._onError(A.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(j))}},y.prototype._parseAVCDecoderConfigurationRecord=function(v,S,w){if(w<7)c.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var x=this._videoMetadata,D=this._videoTrack,U=this._littleEndian,j=new DataView(v,S,w);if(x){if(x.avcc!==void 0){var X=new Uint8Array(v,S,w);if(G(X,x.avcc))return;c.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(x=this._videoMetadata={}).type="video",x.id=D.id,x.timescale=this._timescale,x.duration=this._duration;var ee=j.getUint8(0),ie=j.getUint8(1);if(j.getUint8(2),j.getUint8(3),ee===1&&ie!==0)if(this._naluLengthSize=1+(3&j.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var be=31&j.getUint8(5);if(be!==0){be>1&&c.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(be));for(var Te=6,Oe=0;Oe<be;Oe++){var He=j.getUint16(Te,!U);if(Te+=2,He!==0){var st=new Uint8Array(v,S+Te,He);Te+=He;var Le=_.a.parseSPS(st);if(Oe===0){x.codecWidth=Le.codec_size.width,x.codecHeight=Le.codec_size.height,x.presentWidth=Le.present_size.width,x.presentHeight=Le.present_size.height,x.profile=Le.profile_string,x.level=Le.level_string,x.bitDepth=Le.bit_depth,x.chromaFormat=Le.chroma_format,x.sarRatio=Le.sar_ratio,x.frameRate=Le.frame_rate,Le.frame_rate.fixed!==!1&&Le.frame_rate.fps_num!==0&&Le.frame_rate.fps_den!==0||(x.frameRate=this._referenceFrameRate);var rt=x.frameRate.fps_den,tt=x.frameRate.fps_num;x.refSampleDuration=x.timescale*(rt/tt);for(var Ee=st.subarray(1,4),ft="avc1.",pt=0;pt<3;pt++){var Ze=Ee[pt].toString(16);Ze.length<2&&(Ze="0"+Ze),ft+=Ze}x.codec=ft;var je=this._mediaInfo;je.width=x.codecWidth,je.height=x.codecHeight,je.fps=x.frameRate.fps,je.profile=x.profile,je.level=x.level,je.refFrames=Le.ref_frames,je.chromaFormat=Le.chroma_format_string,je.sarNum=x.sarRatio.width,je.sarDen=x.sarRatio.height,je.videoCodec=ft,je.hasAudio?je.audioCodec!=null&&(je.mimeType='video/x-flv; codecs="'+je.videoCodec+","+je.audioCodec+'"'):je.mimeType='video/x-flv; codecs="'+je.videoCodec+'"',je.isComplete()&&this._onMediaInfo(je)}}}var he=j.getUint8(Te);if(he!==0){for(he>1&&c.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(he)),Te++,Oe=0;Oe<he;Oe++)He=j.getUint16(Te,!U),Te+=2,He!==0&&(Te+=He);x.avcc=new Uint8Array(w),x.avcc.set(new Uint8Array(v,S,w),0),c.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",x)}else this._onError(A.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(A.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(A.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(A.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},y.prototype._parseHEVCDecoderConfigurationRecord=function(v,S,w){if(w<22)c.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var x=this._videoMetadata,D=this._videoTrack,U=this._littleEndian,j=new DataView(v,S,w);if(x){if(x.hvcc!==void 0){var X=new Uint8Array(v,S,w);if(G(X,x.hvcc))return;c.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(x=this._videoMetadata={}).type="video",x.id=D.id,x.timescale=this._timescale,x.duration=this._duration;var ee=j.getUint8(0),ie=31&j.getUint8(1);if(ee!==0&&ee!==1||ie===0)this._onError(A.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord");else if(this._naluLengthSize=1+(3&j.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var be=j.getUint8(22),Te=0,Oe=23;Te<be;Te++){var He=63&j.getUint8(Oe+0),st=j.getUint16(Oe+1,!U);Oe+=3;for(var Le=0;Le<st;Le++){var rt=j.getUint16(Oe+0,!U);if(Le===0)if(He===33){Oe+=2;var tt=new Uint8Array(v,S+Oe,rt),Ee=E.a.parseSPS(tt);x.codecWidth=Ee.codec_size.width,x.codecHeight=Ee.codec_size.height,x.presentWidth=Ee.present_size.width,x.presentHeight=Ee.present_size.height,x.profile=Ee.profile_string,x.level=Ee.level_string,x.bitDepth=Ee.bit_depth,x.chromaFormat=Ee.chroma_format,x.sarRatio=Ee.sar_ratio,x.frameRate=Ee.frame_rate,Ee.frame_rate.fixed!==!1&&Ee.frame_rate.fps_num!==0&&Ee.frame_rate.fps_den!==0||(x.frameRate=this._referenceFrameRate);var ft=x.frameRate.fps_den,pt=x.frameRate.fps_num;x.refSampleDuration=x.timescale*(ft/pt),x.codec=Ee.codec_mimetype;var Ze=this._mediaInfo;Ze.width=x.codecWidth,Ze.height=x.codecHeight,Ze.fps=x.frameRate.fps,Ze.profile=x.profile,Ze.level=x.level,Ze.refFrames=Ee.ref_frames,Ze.chromaFormat=Ee.chroma_format_string,Ze.sarNum=x.sarRatio.width,Ze.sarDen=x.sarRatio.height,Ze.videoCodec=Ee.codec_mimetype,Ze.hasAudio?Ze.audioCodec!=null&&(Ze.mimeType='video/x-flv; codecs="'+Ze.videoCodec+","+Ze.audioCodec+'"'):Ze.mimeType='video/x-flv; codecs="'+Ze.videoCodec+'"',Ze.isComplete()&&this._onMediaInfo(Ze),Oe+=rt}else Oe+=2+rt;else Oe+=2+rt}}x.hvcc=new Uint8Array(w),x.hvcc.set(new Uint8Array(v,S,w),0),c.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",x)}else this._onError(A.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1))}},y.prototype._parseAV1CodecConfigurationRecord=function(v,S,w){if(w<4)c.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var x=this._videoMetadata,D=this._videoTrack,U=(this._littleEndian,new DataView(v,S,w));x?x.av1c!==void 0&&c.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(x=this._videoMetadata={}).type="video",x.id=D.id,x.timescale=this._timescale,x.duration=this._duration);var j=127&U.getUint8(0);if(U.getUint8(1),U.getUint8(1),U.getUint8(2),j===1){var X=T.parseOBUs(new Uint8Array(v,S+4,w-4));if(X!=null){x.codecWidth=X.codec_size.width,x.codecHeight=X.codec_size.height,x.presentWidth=X.present_size.width,x.presentHeight=X.present_size.height,x.profile=X.profile_string,x.level=X.level_string,x.bitDepth=X.bit_depth,x.chromaFormat=X.chroma_format,x.sarRatio=X.sar_ratio,x.frameRate=X.frame_rate,X.frame_rate.fixed!==!1&&X.frame_rate.fps_num!==0&&X.frame_rate.fps_den!==0||(x.frameRate=this._referenceFrameRate);var ee=x.frameRate.fps_den,ie=x.frameRate.fps_num;x.refSampleDuration=x.timescale*(ee/ie),x.codec=X.codec_mimetype;var be=this._mediaInfo;be.width=x.codecWidth,be.height=x.codecHeight,be.fps=x.frameRate.fps,be.profile=x.profile,be.level=x.level,be.refFrames=X.ref_frames,be.chromaFormat=X.chroma_format_string,be.sarNum=x.sarRatio.width,be.sarDen=x.sarRatio.height,be.videoCodec=X.codec_mimetype,be.hasAudio?be.audioCodec!=null&&(be.mimeType='video/x-flv; codecs="'+be.videoCodec+","+be.audioCodec+'"'):be.mimeType='video/x-flv; codecs="'+be.videoCodec+'"',be.isComplete()&&this._onMediaInfo(be),x.av1c=new Uint8Array(w),x.av1c.set(new Uint8Array(v,S,w),0),c.a.v(this.TAG,"Parsed AV1CodecConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",x)}else this._onError(A.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(A.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},y.prototype._parseAVCVideoData=function(v,S,w,x,D,U,j){for(var X=this._littleEndian,ee=new DataView(v,S,w),ie=[],be=0,Te=0,Oe=this._naluLengthSize,He=this._timestampBase+x,st=U===1;Te<w;){if(Te+4>=w){c.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(He,", offset = ").concat(Te,", dataSize = ").concat(w));break}var Le=ee.getUint32(Te,!X);if(Oe===3&&(Le>>>=8),Le>w-Oe)return void c.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(He,", NaluSize > DataSize!"));var rt=31&ee.getUint8(Te+Oe);rt===5&&(st=!0);var tt=new Uint8Array(v,S+Te,Oe+Le),Ee={type:rt,data:tt};ie.push(Ee),be+=tt.byteLength,Te+=Oe+Le}if(ie.length){var ft=this._videoTrack,pt={units:ie,length:be,isKeyframe:st,dts:He,cts:j,pts:He+j};st&&(pt.fileposition=D),ft.samples.push(pt),ft.length+=be}},y.prototype._parseHEVCVideoData=function(v,S,w,x,D,U,j){for(var X=this._littleEndian,ee=new DataView(v,S,w),ie=[],be=0,Te=0,Oe=this._naluLengthSize,He=this._timestampBase+x,st=U===1;Te<w;){if(Te+4>=w){c.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(He,", offset = ").concat(Te,", dataSize = ").concat(w));break}var Le=ee.getUint32(Te,!X);if(Oe===3&&(Le>>>=8),Le>w-Oe)return void c.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(He,", NaluSize > DataSize!"));var rt=ee.getUint8(Te+Oe)>>1&63;rt!==19&&rt!==20&&rt!==21||(st=!0);var tt=new Uint8Array(v,S+Te,Oe+Le),Ee={type:rt,data:tt};ie.push(Ee),be+=tt.byteLength,Te+=Oe+Le}if(ie.length){var ft=this._videoTrack,pt={units:ie,length:be,isKeyframe:st,dts:He,cts:j,pts:He+j};st&&(pt.fileposition=D),ft.samples.push(pt),ft.length+=be}},y.prototype._parseAV1VideoData=function(v,S,w,x,D,U,j){this._littleEndian;var X,ee=[],ie=this._timestampBase+x,be=U===1;if(X=w,ee.push({unitType:0,data:new Uint8Array(v,S+0,w)}),ee.length){var Te=this._videoTrack,Oe={units:ee,length:X,isKeyframe:be,dts:ie,cts:j,pts:ie+j};be&&(Oe.fileposition=D),Te.samples.push(Oe),Te.length+=X}},y}(),I=n(14),M=function(y,v,S){for(var w,x=0,D=v.length;x<D;x++)!w&&x in v||(w||(w=Array.prototype.slice.call(v,0,x)),w[x]=v[x]);return y.concat(w||Array.prototype.slice.call(v))},K=function(){function y(){}return y.init=function(){for(var v in y.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[],fLaC:[],dfLa:[]},y.types)y.types.hasOwnProperty(v)&&(y.types[v]=[v.charCodeAt(0),v.charCodeAt(1),v.charCodeAt(2),v.charCodeAt(3)]);var S=y.constants={};S.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),S.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),S.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),S.STSC=S.STCO=S.STTS,S.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),S.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),S.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),S.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),S.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),S.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},y.box=function(v){for(var S=8,w=null,x=Array.prototype.slice.call(arguments,1),D=x.length,U=0;U<D;U++)S+=x[U].byteLength;(w=new Uint8Array(S))[0]=S>>>24&255,w[1]=S>>>16&255,w[2]=S>>>8&255,w[3]=255&S,w.set(v,4);var j=8;for(U=0;U<D;U++)w.set(x[U],j),j+=x[U].byteLength;return w},y.generateInitSegment=function(v){var S=y.box(y.types.ftyp,y.constants.FTYP),w=y.moov(v),x=new Uint8Array(S.byteLength+w.byteLength);return x.set(S,0),x.set(w,S.byteLength),x},y.moov=function(v){var S=y.mvhd(v.timescale,v.duration),w=y.trak(v),x=y.mvex(v);return y.box(y.types.moov,S,w,x)},y.mvhd=function(v,S){return y.box(y.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,255&v,S>>>24&255,S>>>16&255,S>>>8&255,255&S,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},y.trak=function(v){return y.box(y.types.trak,y.tkhd(v),y.mdia(v))},y.tkhd=function(v){var S=v.id,w=v.duration,x=v.presentWidth,D=v.presentHeight;return y.box(y.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,S>>>24&255,S>>>16&255,S>>>8&255,255&S,0,0,0,0,w>>>24&255,w>>>16&255,w>>>8&255,255&w,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,x>>>8&255,255&x,0,0,D>>>8&255,255&D,0,0]))},y.mdia=function(v){return y.box(y.types.mdia,y.mdhd(v),y.hdlr(v),y.minf(v))},y.mdhd=function(v){var S=v.timescale,w=v.duration;return y.box(y.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,S>>>24&255,S>>>16&255,S>>>8&255,255&S,w>>>24&255,w>>>16&255,w>>>8&255,255&w,85,196,0,0]))},y.hdlr=function(v){var S=null;return S=v.type==="audio"?y.constants.HDLR_AUDIO:y.constants.HDLR_VIDEO,y.box(y.types.hdlr,S)},y.minf=function(v){var S=null;return S=v.type==="audio"?y.box(y.types.smhd,y.constants.SMHD):y.box(y.types.vmhd,y.constants.VMHD),y.box(y.types.minf,S,y.dinf(),y.stbl(v))},y.dinf=function(){return y.box(y.types.dinf,y.box(y.types.dref,y.constants.DREF))},y.stbl=function(v){return y.box(y.types.stbl,y.stsd(v),y.box(y.types.stts,y.constants.STTS),y.box(y.types.stsc,y.constants.STSC),y.box(y.types.stsz,y.constants.STSZ),y.box(y.types.stco,y.constants.STCO))},y.stsd=function(v){return v.type==="audio"?v.codec==="mp3"?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.mp3(v)):v.codec==="ac-3"?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.ac3(v)):v.codec==="ec-3"?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.ec3(v)):v.codec==="opus"?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.Opus(v)):v.codec=="flac"?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.fLaC(v)):y.box(y.types.stsd,y.constants.STSD_PREFIX,y.mp4a(v)):v.type==="video"&&v.codec.startsWith("hvc1")?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.hvc1(v)):v.type==="video"&&v.codec.startsWith("av01")?y.box(y.types.stsd,y.constants.STSD_PREFIX,y.av01(v)):y.box(y.types.stsd,y.constants.STSD_PREFIX,y.avc1(v))},y.mp3=function(v){var S=v.channelCount,w=v.audioSampleRate,x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S,0,16,0,0,0,0,w>>>8&255,255&w,0,0]);return y.box(y.types[".mp3"],x)},y.mp4a=function(v){var S=v.channelCount,w=v.audioSampleRate,x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S,0,16,0,0,0,0,w>>>8&255,255&w,0,0]);return y.box(y.types.mp4a,x,y.esds(v))},y.ac3=function(v){var S=v.channelCount,w=v.audioSampleRate,x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S,0,16,0,0,0,0,w>>>8&255,255&w,0,0]);return y.box(y.types["ac-3"],x,y.box(y.types.dac3,new Uint8Array(v.config)))},y.ec3=function(v){var S=v.channelCount,w=v.audioSampleRate,x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S,0,16,0,0,0,0,w>>>8&255,255&w,0,0]);return y.box(y.types["ec-3"],x,y.box(y.types.dec3,new Uint8Array(v.config)))},y.esds=function(v){var S=v.config||[],w=S.length,x=new Uint8Array([0,0,0,0,3,23+w,0,1,0,4,15+w,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([w]).concat(S).concat([6,1,2]));return y.box(y.types.esds,x)},y.Opus=function(v){var S=v.channelCount,w=v.audioSampleRate,x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S,0,16,0,0,0,0,w>>>8&255,255&w,0,0]);return y.box(y.types.Opus,x,y.dOps(v))},y.dOps=function(v){var S=v.channelCount,w=v.channelConfigCode,x=v.audioSampleRate;if(v.config)return y.box(y.types.dOps,v.config);var D=[];switch(w){case 1:case 2:D=[0];break;case 0:D=[255,1,1,0,1];break;case 128:D=[255,2,0,0,1];break;case 3:D=[1,2,1,0,2,1];break;case 4:D=[1,2,2,0,1,2,3];break;case 5:D=[1,3,2,0,4,1,2,3];break;case 6:D=[1,4,2,0,4,1,2,3,5];break;case 7:D=[1,4,2,0,4,1,2,3,5,6];break;case 8:D=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:D=[1,1,2,0,1];break;case 131:D=[1,1,3,0,1,2];break;case 132:D=[1,1,4,0,1,2,3];break;case 133:D=[1,1,5,0,1,2,3,4];break;case 134:D=[1,1,6,0,1,2,3,4,5];break;case 135:D=[1,1,7,0,1,2,3,4,5,6];break;case 136:D=[1,1,8,0,1,2,3,4,5,6,7]}var U=new Uint8Array(M([0,S,0,0,x>>>24&255,x>>>17&255,x>>>8&255,x>>>0&255,0,0],D));return y.box(y.types.dOps,U)},y.fLaC=function(v){var S=v.channelCount,w=Math.min(v.audioSampleRate,65535),x=v.sampleSize,D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,S,0,x,0,0,0,0,w>>>8&255,255&w,0,0]);return y.box(y.types.fLaC,D,y.dfLa(v))},y.dfLa=function(v){var S=new Uint8Array(M([0,0,0,0],v.config));return y.box(y.types.dfLa,S)},y.avc1=function(v){var S=v.avcc,w=v.codecWidth,x=v.codecHeight,D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,w>>>8&255,255&w,x>>>8&255,255&x,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return y.box(y.types.avc1,D,y.box(y.types.avcC,S))},y.hvc1=function(v){var S=v.hvcc,w=v.codecWidth,x=v.codecHeight,D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,w>>>8&255,255&w,x>>>8&255,255&x,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return y.box(y.types.hvc1,D,y.box(y.types.hvcC,S))},y.av01=function(v){var S=v.av1c,w=v.codecWidth||192,x=v.codecHeight||108,D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,w>>>8&255,255&w,x>>>8&255,255&x,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return y.box(y.types.av01,D,y.box(y.types.av1C,S))},y.mvex=function(v){return y.box(y.types.mvex,y.trex(v))},y.trex=function(v){var S=v.id,w=new Uint8Array([0,0,0,0,S>>>24&255,S>>>16&255,S>>>8&255,255&S,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return y.box(y.types.trex,w)},y.moof=function(v,S){return y.box(y.types.moof,y.mfhd(v.sequenceNumber),y.traf(v,S))},y.mfhd=function(v){var S=new Uint8Array([0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,255&v]);return y.box(y.types.mfhd,S)},y.traf=function(v,S){var w=v.id,x=y.box(y.types.tfhd,new Uint8Array([0,0,0,0,w>>>24&255,w>>>16&255,w>>>8&255,255&w])),D=y.box(y.types.tfdt,new Uint8Array([0,0,0,0,S>>>24&255,S>>>16&255,S>>>8&255,255&S])),U=y.sdtp(v),j=y.trun(v,U.byteLength+16+16+8+16+8+8);return y.box(y.types.traf,x,D,j,U)},y.sdtp=function(v){for(var S=v.samples||[],w=S.length,x=new Uint8Array(4+w),D=0;D<w;D++){var U=S[D].flags;x[D+4]=U.isLeading<<6|U.dependsOn<<4|U.isDependedOn<<2|U.hasRedundancy}return y.box(y.types.sdtp,x)},y.trun=function(v,S){var w=v.samples||[],x=w.length,D=12+16*x,U=new Uint8Array(D);S+=8+D,U.set([0,0,15,1,x>>>24&255,x>>>16&255,x>>>8&255,255&x,S>>>24&255,S>>>16&255,S>>>8&255,255&S],0);for(var j=0;j<x;j++){var X=w[j].duration,ee=w[j].size,ie=w[j].flags,be=w[j].cts;U.set([X>>>24&255,X>>>16&255,X>>>8&255,255&X,ee>>>24&255,ee>>>16&255,ee>>>8&255,255&ee,ie.isLeading<<2|ie.dependsOn,ie.isDependedOn<<6|ie.hasRedundancy<<4|ie.isNonSync,0,0,be>>>24&255,be>>>16&255,be>>>8&255,255&be],12+16*j)}return y.box(y.types.trun,U)},y.mdat=function(v){return y.box(y.types.mdat,v)},y}();K.init();var re=K,ae=function(){function y(){}return y.getSilentFrame=function(v,S){if(v==="mp4a.40.2"){if(S===1)return new Uint8Array([0,200,0,128,35,128]);if(S===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(S===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(S===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(S===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(S===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(S===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(S===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(S===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},y}(),te=n(12),ne=function(){function y(v){this.TAG="MP4Remuxer",this._config=v,this._isLive=v.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new te.c("audio"),this._videoSegmentInfoList=new te.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!d.a.chrome||!(d.a.version.major<50||d.a.version.major===50&&d.a.version.build<2661)),this._fillSilentAfterSeek=d.a.msedge||d.a.msie,this._mp3UseMpegAudio=!d.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return y.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},y.prototype.bindDataSource=function(v){return v.onDataAvailable=this.remux.bind(this),v.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(y.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(v){this._onInitSegment=v},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(v){this._onMediaSegment=v},enumerable:!1,configurable:!0}),y.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},y.prototype.seek=function(v){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},y.prototype.remux=function(v,S){if(!this._onMediaSegment)throw new u.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(v,S),S&&this._remuxVideo(S),v&&this._remuxAudio(v)},y.prototype._onTrackMetadataReceived=function(v,S){var w=null,x="mp4",D=S.codec;if(v==="audio")this._audioMeta=S,S.codec==="mp3"&&this._mp3UseMpegAudio?(x="mpeg",D="",w=new Uint8Array):w=re.generateInitSegment(S);else{if(v!=="video")return;this._videoMeta=S,w=re.generateInitSegment(S)}if(!this._onInitSegment)throw new u.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(v,{type:v,data:w.buffer,codec:D,container:"".concat(v,"/").concat(x),mediaDuration:S.duration})},y.prototype._calculateDtsBase=function(v,S){this._dtsBaseInited||(v&&v.samples&&v.samples.length&&(this._audioDtsBase=v.samples[0].dts),S&&S.samples&&S.samples.length&&(this._videoDtsBase=S.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},y.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},y.prototype.flushStashedSamples=function(){var v=this._videoStashedLastSample,S=this._audioStashedLastSample,w={type:"video",id:1,sequenceNumber:0,samples:[],length:0};v!=null&&(w.samples.push(v),w.length=v.length);var x={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};S!=null&&(x.samples.push(S),x.length=S.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(w,!0),this._remuxAudio(x,!0)},y.prototype._remuxAudio=function(v,S){if(this._audioMeta!=null){var w,x=v,D=x.samples,U=void 0,j=-1,X=this._audioMeta.refSampleDuration,ee=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,ie=this._dtsBaseInited&&this._audioNextDts===void 0,be=!1;if(D&&D.length!==0&&(D.length!==1||S)){var Te=0,Oe=null,He=0;ee?(Te=0,He=x.length):(Te=8,He=8+x.length);var st=null;if(D.length>1&&(He-=(st=D.pop()).length),this._audioStashedLastSample!=null){var Le=this._audioStashedLastSample;this._audioStashedLastSample=null,D.unshift(Le),He+=Le.length}st!=null&&(this._audioStashedLastSample=st);var rt=D[0].dts-this._dtsBase;if(this._audioNextDts)U=rt-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())U=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(be=!0);else{var tt=this._audioSegmentInfoList.getLastSampleBefore(rt);if(tt!=null){var Ee=rt-(tt.originalDts+tt.duration);Ee<=3&&(Ee=0),U=rt-(tt.dts+tt.duration+Ee)}else U=0}if(be){var ft=rt-U,pt=this._videoSegmentInfoList.getLastSegmentBefore(rt);if(pt!=null&&pt.beginDts<ft){if(Z=ae.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var Ze=pt.beginDts,je=ft-pt.beginDts;c.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(Ze,", duration: ").concat(je)),D.unshift({unit:Z,dts:Ze,pts:Ze}),He+=Z.byteLength}}else be=!1}for(var he=[],_e=0;_e<D.length;_e++){var Ne=(Le=D[_e]).unit,fe=Le.dts-this._dtsBase,Je=(Ze=fe,!1),ot=null,nt=0;if(!(fe<-.001)){if(this._audioMeta.codec!=="mp3"&&X!=null){var q=fe;if(this._audioNextDts&&(q=this._audioNextDts),(U=fe-q)<=-3*X){c.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(fe," ms ,curRefDts: ").concat(q," ms)  due to dtsCorrection: ").concat(U," ms overlap."));continue}if(U>=3*X&&this._fillAudioTimestampGap&&!d.a.safari){Je=!0;var Z,z=Math.floor(U/X);c.a.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+"originalDts: ".concat(fe," ms, curRefDts: ").concat(q," ms, ")+"dtsCorrection: ".concat(Math.round(U)," ms, generate: ").concat(z," frames")),Ze=Math.floor(q),nt=Math.floor(q+X)-Ze,(Z=ae.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(c.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),Z=Ne),ot=[];for(var $=0;$<z;$++){q+=X;var ce=Math.floor(q),Se=Math.floor(q+X)-ce,se={dts:ce,pts:ce,cts:0,unit:Z,size:Z.byteLength,duration:Se,originalDts:fe,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ot.push(se),He+=se.size}this._audioNextDts=q+X}else Ze=Math.floor(q),nt=Math.floor(q+X)-Ze,this._audioNextDts=q+X}else Ze=fe-U,_e!==D.length-1?nt=D[_e+1].dts-this._dtsBase-U-Ze:st!=null?nt=st.dts-this._dtsBase-U-Ze:nt=he.length>=1?he[he.length-1].duration:Math.floor(X),this._audioNextDts=Ze+nt;j===-1&&(j=Ze),he.push({dts:Ze,pts:Ze,cts:0,unit:Le.unit,size:Le.unit.byteLength,duration:nt,originalDts:fe,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Je&&he.push.apply(he,ot)}}if(he.length===0)return x.samples=[],void(x.length=0);for(ee?Oe=new Uint8Array(He):((Oe=new Uint8Array(He))[0]=He>>>24&255,Oe[1]=He>>>16&255,Oe[2]=He>>>8&255,Oe[3]=255&He,Oe.set(re.types.mdat,4)),_e=0;_e<he.length;_e++)Ne=he[_e].unit,Oe.set(Ne,Te),Te+=Ne.byteLength;var ve=he[he.length-1];w=ve.dts+ve.duration;var Pe=new te.b;Pe.beginDts=j,Pe.endDts=w,Pe.beginPts=j,Pe.endPts=w,Pe.originalBeginDts=he[0].originalDts,Pe.originalEndDts=ve.originalDts+ve.duration,Pe.firstSample=new te.d(he[0].dts,he[0].pts,he[0].duration,he[0].originalDts,!1),Pe.lastSample=new te.d(ve.dts,ve.pts,ve.duration,ve.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Pe),x.samples=he,x.sequenceNumber++;var ke=null;ke=ee?new Uint8Array:re.moof(x,j),x.samples=[],x.length=0;var xe={type:"audio",data:this._mergeBoxes(ke,Oe).buffer,sampleCount:he.length,info:Pe};ee&&ie&&(xe.timestampOffset=j),this._onMediaSegment("audio",xe)}}},y.prototype._remuxVideo=function(v,S){if(this._videoMeta!=null){var w,x,D=v,U=D.samples,j=void 0,X=-1,ee=-1;if(U&&U.length!==0&&(U.length!==1||S)){var ie=8,be=null,Te=8+v.length,Oe=null;if(U.length>1&&(Te-=(Oe=U.pop()).length),this._videoStashedLastSample!=null){var He=this._videoStashedLastSample;this._videoStashedLastSample=null,U.unshift(He),Te+=He.length}Oe!=null&&(this._videoStashedLastSample=Oe);var st=U[0].dts-this._dtsBase;if(this._videoNextDts)j=st-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())j=0;else{var Le=this._videoSegmentInfoList.getLastSampleBefore(st);if(Le!=null){var rt=st-(Le.originalDts+Le.duration);rt<=3&&(rt=0),j=st-(Le.dts+Le.duration+rt)}else j=0}for(var tt=new te.b,Ee=[],ft=0;ft<U.length;ft++){var pt=(He=U[ft]).dts-this._dtsBase,Ze=He.isKeyframe,je=pt-j,he=He.cts,_e=je+he;X===-1&&(X=je,ee=_e);var Ne=0;if(ft!==U.length-1?Ne=U[ft+1].dts-this._dtsBase-j-je:Oe!=null?Ne=Oe.dts-this._dtsBase-j-je:Ne=Ee.length>=1?Ee[Ee.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),Ze){var fe=new te.d(je,_e,Ne,He.dts,!0);fe.fileposition=He.fileposition,tt.appendSyncPoint(fe)}Ee.push({dts:je,pts:_e,cts:he,units:He.units,size:He.length,isKeyframe:Ze,duration:Ne,originalDts:pt,flags:{isLeading:0,dependsOn:Ze?2:1,isDependedOn:Ze?1:0,hasRedundancy:0,isNonSync:Ze?0:1}})}for((be=new Uint8Array(Te))[0]=Te>>>24&255,be[1]=Te>>>16&255,be[2]=Te>>>8&255,be[3]=255&Te,be.set(re.types.mdat,4),ft=0;ft<Ee.length;ft++)for(var Je=Ee[ft].units;Je.length;){var ot=Je.shift().data;be.set(ot,ie),ie+=ot.byteLength}var nt=Ee[Ee.length-1];if(w=nt.dts+nt.duration,x=nt.pts+nt.duration,this._videoNextDts=w,tt.beginDts=X,tt.endDts=w,tt.beginPts=ee,tt.endPts=x,tt.originalBeginDts=Ee[0].originalDts,tt.originalEndDts=nt.originalDts+nt.duration,tt.firstSample=new te.d(Ee[0].dts,Ee[0].pts,Ee[0].duration,Ee[0].originalDts,Ee[0].isKeyframe),tt.lastSample=new te.d(nt.dts,nt.pts,nt.duration,nt.originalDts,nt.isKeyframe),this._isLive||this._videoSegmentInfoList.append(tt),D.samples=Ee,D.sequenceNumber++,this._forceFirstIDR){var q=Ee[0].flags;q.dependsOn=2,q.isNonSync=0}var Z=re.moof(D,X);D.samples=[],D.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Z,be).buffer,sampleCount:Ee.length,info:tt})}}},y.prototype._mergeBoxes=function(v,S){var w=new Uint8Array(v.byteLength+S.byteLength);return w.set(v,0),w.set(S,v.byteLength),w},y}(),me=n(16),Ae=n(1),F=(n(2),function(){function y(v,S){this.TAG="TransmuxingController",this._emitter=new a.a,this._config=S,v.segments||(v.segments=[{duration:v.duration,filesize:v.filesize,url:v.url}]),typeof v.cors!="boolean"&&(v.cors=!0),typeof v.withCredentials!="boolean"&&(v.withCredentials=!1),this._mediaDataSource=v,this._currentSegmentIndex=0;var w=0;this._mediaDataSource.segments.forEach(function(x){x.timestampBase=w,w+=x.duration,x.cors=v.cors,x.withCredentials=v.withCredentials,S.referrerPolicy&&(x.referrerPolicy=S.referrerPolicy)}),isNaN(w)||this._mediaDataSource.duration===w||(this._mediaDataSource.duration=w),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return y.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},y.prototype.on=function(v,S){this._emitter.addListener(v,S)},y.prototype.off=function(v,S){this._emitter.removeListener(v,S)},y.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},y.prototype._loadSegment=function(v,S){this._currentSegmentIndex=v;var w=this._mediaDataSource.segments[v],x=this._ioctl=new me.a(w,this._config,v);x.onError=this._onIOException.bind(this),x.onSeeked=this._onIOSeeked.bind(this),x.onComplete=this._onIOComplete.bind(this),x.onRedirect=this._onIORedirect.bind(this),x.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),S?this._demuxer.bindDataSource(this._ioctl):x.onDataArrival=this._onInitChunkArrival.bind(this),x.open(S)},y.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},y.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},y.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},y.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},y.prototype.seek=function(v){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var S=this._searchSegmentIndexContains(v);if(S===this._currentSegmentIndex){var w=this._mediaInfo.segments[S];if(w==null)this._pendingSeekTime=v;else{var x=w.getNearestKeyframe(v);this._remuxer.seek(x.milliseconds),this._ioctl.seek(x.fileposition),this._pendingResolveSeekPoint=x.milliseconds}}else{var D=this._mediaInfo.segments[S];D==null?(this._pendingSeekTime=v,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(S)):(x=D.getNearestKeyframe(v),this._internalAbort(),this._remuxer.seek(v),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[S].timestampBase,this._loadSegment(S,x.fileposition),this._pendingResolveSeekPoint=x.milliseconds,this._reportSegmentMediaInfo(S))}this._enableStatisticsReporter()}},y.prototype._searchSegmentIndexContains=function(v){for(var S=this._mediaDataSource.segments,w=S.length-1,x=0;x<S.length;x++)if(v<S[x].timestampBase){w=x-1;break}return w},y.prototype._onInitChunkArrival=function(v,S){var w=this,x=0;if(S>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,x=this._demuxer.parseChunks(v,S);else{var D=null;(D=L.probe(v)).match&&(this._setupFLVDemuxerRemuxer(D),x=this._demuxer.parseChunks(v,S)),D.match||D.needMoreData||(D=I.a.probe(v)).match&&(this._setupTSDemuxerRemuxer(D),x=this._demuxer.parseChunks(v,S)),D.match||D.needMoreData||(D=null,c.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(function(){w._internalAbort()}),this._emitter.emit(Ae.a.DEMUX_ERROR,A.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return x},y.prototype._setupFLVDemuxerRemuxer=function(v){this._demuxer=new L(v,this._config),this._remuxer||(this._remuxer=new ne(this._config));var S=this._mediaDataSource;S.duration==null||isNaN(S.duration)||(this._demuxer.overridedDuration=S.duration),typeof S.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=S.hasAudio),typeof S.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=S.hasVideo),this._demuxer.timestampBase=S.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},y.prototype._setupTSDemuxerRemuxer=function(v){var S=this._demuxer=new I.a(v,this._config);this._remuxer||(this._remuxer=new ne(this._config)),S.onError=this._onDemuxException.bind(this),S.onMediaInfo=this._onMediaInfo.bind(this),S.onMetaDataArrived=this._onMetaDataArrived.bind(this),S.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),S.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),S.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),S.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),S.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),S.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),S.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},y.prototype._onMediaInfo=function(v){var S=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},v),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,f.a.prototype));var w=Object.assign({},v);Object.setPrototypeOf(w,f.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=w,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var x=S._pendingSeekTime;S._pendingSeekTime=null,S.seek(x)})},y.prototype._onMetaDataArrived=function(v){this._emitter.emit(Ae.a.METADATA_ARRIVED,v)},y.prototype._onScriptDataArrived=function(v){this._emitter.emit(Ae.a.SCRIPTDATA_ARRIVED,v)},y.prototype._onTimedID3Metadata=function(v){var S=this._remuxer.getTimestampBase();S!=null&&(v.pts!=null&&(v.pts-=S),v.dts!=null&&(v.dts-=S),this._emitter.emit(Ae.a.TIMED_ID3_METADATA_ARRIVED,v))},y.prototype._onSynchronousKLVMetadata=function(v){var S=this._remuxer.getTimestampBase();S!=null&&(v.pts!=null&&(v.pts-=S),v.dts!=null&&(v.dts-=S),this._emitter.emit(Ae.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,v))},y.prototype._onAsynchronousKLVMetadata=function(v){this._emitter.emit(Ae.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,v)},y.prototype._onSMPTE2038Metadata=function(v){var S=this._remuxer.getTimestampBase();S!=null&&(v.pts!=null&&(v.pts-=S),v.dts!=null&&(v.dts-=S),v.nearest_pts!=null&&(v.nearest_pts-=S),this._emitter.emit(Ae.a.SMPTE2038_METADATA_ARRIVED,v))},y.prototype._onSCTE35Metadata=function(v){var S=this._remuxer.getTimestampBase();S!=null&&(v.pts!=null&&(v.pts-=S),v.nearest_pts!=null&&(v.nearest_pts-=S),this._emitter.emit(Ae.a.SCTE35_METADATA_ARRIVED,v))},y.prototype._onPESPrivateDataDescriptor=function(v){this._emitter.emit(Ae.a.PES_PRIVATE_DATA_DESCRIPTOR,v)},y.prototype._onPESPrivateData=function(v){var S=this._remuxer.getTimestampBase();S!=null&&(v.pts!=null&&(v.pts-=S),v.nearest_pts!=null&&(v.nearest_pts-=S),v.dts!=null&&(v.dts-=S),this._emitter.emit(Ae.a.PES_PRIVATE_DATA_ARRIVED,v))},y.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},y.prototype._onIOComplete=function(v){var S=v+1;S<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(S)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Ae.a.LOADING_COMPLETE),this._disableStatisticsReporter())},y.prototype._onIORedirect=function(v){var S=this._ioctl.extraData;this._mediaDataSource.segments[S].redirectedURL=v},y.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(Ae.a.RECOVERED_EARLY_EOF)},y.prototype._onIOException=function(v,S){c.a.e(this.TAG,"IOException: type = ".concat(v,", code = ").concat(S.code,", msg = ").concat(S.msg)),this._emitter.emit(Ae.a.IO_ERROR,v,S),this._disableStatisticsReporter()},y.prototype._onDemuxException=function(v,S){c.a.e(this.TAG,"DemuxException: type = ".concat(v,", info = ").concat(S)),this._emitter.emit(Ae.a.DEMUX_ERROR,v,S)},y.prototype._onRemuxerInitSegmentArrival=function(v,S){this._emitter.emit(Ae.a.INIT_SEGMENT,v,S)},y.prototype._onRemuxerMediaSegmentArrival=function(v,S){if(this._pendingSeekTime==null&&(this._emitter.emit(Ae.a.MEDIA_SEGMENT,v,S),this._pendingResolveSeekPoint!=null&&v==="video")){var w=S.info.syncPoints,x=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,d.a.safari&&w.length>0&&w[0].originalDts===x&&(x=w[0].pts),this._emitter.emit(Ae.a.RECOMMEND_SEEKPOINT,x)}},y.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},y.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},y.prototype._reportSegmentMediaInfo=function(v){var S=this._mediaInfo.segments[v],w=Object.assign({},S);w.duration=this._mediaInfo.duration,w.segmentCount=this._mediaInfo.segmentCount,delete w.segments,delete w.keyframesIndex,this._emitter.emit(Ae.a.MEDIA_INFO,w)},y.prototype._reportStatisticsInfo=function(){var v={};v.url=this._ioctl.currentURL,v.hasRedirect=this._ioctl.hasRedirect,v.hasRedirect&&(v.redirectedURL=this._ioctl.currentRedirectedURL),v.speed=this._ioctl.currentSpeed,v.loaderType=this._ioctl.loaderType,v.currentSegmentIndex=this._currentSegmentIndex,v.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Ae.a.STATISTICS_INFO,v)},y}());i.a=F},function(t,i,n){var o=function(){function a(){}return a.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(c,d){return c.__proto__=d,c},Object.assign=Object.assign||function(c){if(c==null)throw new TypeError("Cannot convert undefined or null to object");for(var d=Object(c),f=1;f<arguments.length;f++){var l=arguments[f];if(l!=null)for(var h in l)l.hasOwnProperty(h)&&(d[h]=l[h])}return d},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(c,d){var f=d>0?0|d:0;return this.substring(f,f+c.length)===c}}),typeof self.Promise!="function"&&n(25).polyfill()},a}();o.install(),i.a=o},function(t,i,n){var o=n(10),a=n.n(o),c=n(0),d=n(5),f=n(7),l=n(3),h=function(){function r(u){this.TAG="MSEController",this._config=u,this._emitter=new a.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return r.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},r.prototype.on=function(u,m){this._emitter.addListener(u,m)},r.prototype.off=function(u,m){this._emitter.removeListener(u,m)},r.prototype.initialize=function(u){if(this._mediaSource)throw new l.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&c.a.v(this.TAG,"Using ManagedMediaSource");var m=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;m.addEventListener("sourceopen",this.e.onSourceOpen),m.addEventListener("sourceended",this.e.onSourceEnded),m.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(m.addEventListener("startstreaming",this.e.onStartStreaming),m.addEventListener("endstreaming",this.e.onEndStreaming),m.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=u},r.prototype.shutdown=function(){if(this._mediaSource){var u=this._mediaSource;for(var m in this._sourceBuffers){var p=this._pendingSegments[m];p.splice(0,p.length),this._pendingSegments[m]=null,this._pendingRemoveRanges[m]=null,this._lastInitSegments[m]=null;var _=this._sourceBuffers[m];if(_){if(u.readyState!=="closed"){try{u.removeSourceBuffer(_)}catch(A){c.a.e(this.TAG,A.message)}_.removeEventListener("error",this.e.onSourceBufferError),_.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[m]=null,this._sourceBuffers[m]=null}}if(u.readyState==="open")try{u.endOfStream()}catch(A){c.a.e(this.TAG,A.message)}this._mediaElementProxy=null,u.removeEventListener("sourceopen",this.e.onSourceOpen),u.removeEventListener("sourceended",this.e.onSourceEnded),u.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(u.removeEventListener("startstraming",this.e.onStartStreaming),u.removeEventListener("endstreaming",this.e.onEndStreaming),u.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},r.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},r.prototype.getObject=function(){if(!this._mediaSource)throw new l.a("MediaSource has not been initialized yet!");return this._mediaSource},r.prototype.getHandle=function(){if(!this._mediaSource)throw new l.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},r.prototype.getObjectURL=function(){if(!this._mediaSource)throw new l.a("MediaSource has not been initialized yet!");return this._mediaSourceObjectURL==null&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},r.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},r.prototype.appendInitSegment=function(u,m){if(m===void 0&&(m=void 0),!this._mediaSource||this._mediaSource.readyState!=="open"||this._mediaSource.streaming===!1)return this._pendingSourceBufferInit.push(u),void this._pendingSegments[u.type].push(u);var p=u,_="".concat(p.container);p.codec&&p.codec.length>0&&(p.codec==="opus"&&d.a.safari&&(p.codec="Opus"),_+=";codecs=".concat(p.codec));var A=!1;if(c.a.v(this.TAG,"Received Initialization Segment, mimeType: "+_),this._lastInitSegments[p.type]=p,_!==this._mimeTypes[p.type]){if(this._mimeTypes[p.type])c.a.v(this.TAG,"Notice: ".concat(p.type," mimeType changed, origin: ").concat(this._mimeTypes[p.type],", target: ").concat(_));else{A=!0;try{var E=this._sourceBuffers[p.type]=this._mediaSource.addSourceBuffer(_);E.addEventListener("error",this.e.onSourceBufferError),E.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(C){return c.a.e(this.TAG,C.message),void this._emitter.emit(f.a.ERROR,{code:C.code,msg:C.message})}}this._mimeTypes[p.type]=_}m||this._pendingSegments[p.type].push(p),A||this._sourceBuffers[p.type]&&!this._sourceBuffers[p.type].updating&&this._doAppendSegments(),d.a.safari&&p.container==="audio/mpeg"&&p.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=p.mediaDuration/1e3,this._updateMediaSourceDuration())},r.prototype.appendMediaSegment=function(u){var m=u;this._pendingSegments[m.type].push(m),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var p=this._sourceBuffers[m.type];!p||p.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},r.prototype.flush=function(){for(var u in this._sourceBuffers)if(this._sourceBuffers[u]){var m=this._sourceBuffers[u];if(this._mediaSource.readyState==="open")try{m.abort()}catch(k){c.a.e(this.TAG,k.message)}var p=this._pendingSegments[u];if(p.splice(0,p.length),this._mediaSource.readyState!=="closed"){for(var _=0;_<m.buffered.length;_++){var A=m.buffered.start(_),E=m.buffered.end(_);this._pendingRemoveRanges[u].push({start:A,end:E})}if(m.updating||this._doRemoveRanges(),d.a.safari){var C=this._lastInitSegments[u];C&&(this._pendingSegments[u].push(C),m.updating||this._doAppendSegments())}}}},r.prototype.endOfStream=function(){var u=this._mediaSource,m=this._sourceBuffers;u&&u.readyState==="open"?m.video&&m.video.updating||m.audio&&m.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,u.endOfStream()):u&&u.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},r.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var u=this._mediaElementProxy.getCurrentTime();for(var m in this._sourceBuffers){var p=this._sourceBuffers[m];if(p){var _=p.buffered;if(_.length>=1&&u-_.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},r.prototype._doCleanupSourceBuffer=function(){var u=this._mediaElementProxy.getCurrentTime();for(var m in this._sourceBuffers){var p=this._sourceBuffers[m];if(p){for(var _=p.buffered,A=!1,E=0;E<_.length;E++){var C=_.start(E),k=_.end(E);if(C<=u&&u<k+3){if(u-C>=this._config.autoCleanupMaxBackwardDuration){A=!0;var O=u-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[m].push({start:C,end:O})}}else k<u&&(A=!0,this._pendingRemoveRanges[m].push({start:C,end:k}))}A&&!p.updating&&this._doRemoveRanges()}}},r.prototype._updateMediaSourceDuration=function(){var u=this._sourceBuffers;if(this._mediaElementProxy.getReadyState()!==0&&this._mediaSource.readyState==="open"&&!(u.video&&u.video.updating||u.audio&&u.audio.updating)){var m=this._mediaSource.duration,p=this._pendingMediaDuration;p>0&&(isNaN(m)||p>m)&&(c.a.v(this.TAG,"Update MediaSource duration from ".concat(m," to ").concat(p)),this._mediaSource.duration=p),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},r.prototype._doRemoveRanges=function(){for(var u in this._pendingRemoveRanges)if(this._sourceBuffers[u]&&!this._sourceBuffers[u].updating)for(var m=this._sourceBuffers[u],p=this._pendingRemoveRanges[u];p.length&&!m.updating;){var _=p.shift();m.remove(_.start,_.end)}},r.prototype._doAppendSegments=function(){var u=this._pendingSegments;for(var m in u)if(this._sourceBuffers[m]&&!this._sourceBuffers[m].updating&&this._mediaSource.streaming!==!1&&u[m].length>0){var p=u[m].shift();if(typeof p.timestampOffset=="number"&&isFinite(p.timestampOffset)){var _=this._sourceBuffers[m].timestampOffset,A=p.timestampOffset/1e3;Math.abs(_-A)>.1&&(c.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(_," to ").concat(A)),this._sourceBuffers[m].timestampOffset=A),delete p.timestampOffset}if(!p.data||p.data.byteLength===0)continue;try{this._sourceBuffers[m].appendBuffer(p.data),this._isBufferFull=!1}catch(E){this._pendingSegments[m].unshift(p),E.code===22?(this._isBufferFull||this._emitter.emit(f.a.BUFFER_FULL),this._isBufferFull=!0):(c.a.e(this.TAG,E.message),this._emitter.emit(f.a.ERROR,{code:E.code,msg:E.message}))}}},r.prototype._onSourceOpen=function(){if(c.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var u=this._pendingSourceBufferInit;u.length;){var m=u.shift();this.appendInitSegment(m,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(f.a.SOURCE_OPEN)},r.prototype._onStartStreaming=function(){c.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(f.a.START_STREAMING)},r.prototype._onEndStreaming=function(){c.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(f.a.END_STREAMING)},r.prototype._onQualityChange=function(){c.a.v(this.TAG,"ManagedMediaSource onQualityChange")},r.prototype._onSourceEnded=function(){c.a.v(this.TAG,"MediaSource onSourceEnded")},r.prototype._onSourceClose=function(){c.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstraming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},r.prototype._hasPendingSegments=function(){var u=this._pendingSegments;return u.video.length>0||u.audio.length>0},r.prototype._hasPendingRemoveRanges=function(){var u=this._pendingRemoveRanges;return u.video.length>0||u.audio.length>0},r.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(f.a.UPDATE_END)},r.prototype._onSourceBufferError=function(u){c.a.e(this.TAG,"SourceBuffer Error: ".concat(u))},r}();i.a=h},function(t,i,n){var o=n(10),a=n.n(o),c=n(21),d=n.n(c),f=n(0),l=n(9),h=n(17),r=n(1),u=(n(23),n(13)),m=n(14),p=function(){function _(A,E){if(this.TAG="Transmuxer",this._emitter=new a.a,E.enableWorker&&typeof Worker<"u")try{this._worker=d()(23),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[A,E]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},l.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:l.a.getConfig()})}catch{f.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new h.a(A,E)}else this._controller=new h.a(A,E);if(this._controller){var C=this._controller;C.on(r.a.IO_ERROR,this._onIOError.bind(this)),C.on(r.a.DEMUX_ERROR,this._onDemuxError.bind(this)),C.on(r.a.INIT_SEGMENT,this._onInitSegment.bind(this)),C.on(r.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),C.on(r.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),C.on(r.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),C.on(r.a.MEDIA_INFO,this._onMediaInfo.bind(this)),C.on(r.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),C.on(r.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),C.on(r.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),C.on(r.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),C.on(r.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),C.on(r.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),C.on(r.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),C.on(r.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),C.on(r.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),C.on(r.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),C.on(r.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return _.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),l.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},_.prototype.on=function(A,E){this._emitter.addListener(A,E)},_.prototype.off=function(A,E){this._emitter.removeListener(A,E)},_.prototype.hasWorker=function(){return this._worker!=null},_.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},_.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},_.prototype.seek=function(A){this._worker?this._worker.postMessage({cmd:"seek",param:A}):this._controller.seek(A)},_.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},_.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},_.prototype.switchPrimaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"primary"}):this._controller._demuxer instanceof m.a&&(this._controller._demuxer.preferred_secondary_audio=!1)},_.prototype.switchSecondaryAudio=function(){this._worker?this._worker.postMessage({cmd:"switch_audio",param:"secondary"}):this._controller._demuxer instanceof m.a&&(this._controller._demuxer.preferred_secondary_audio=!0)},_.prototype._onInitSegment=function(A,E){var C=this;Promise.resolve().then(function(){C._emitter.emit(r.a.INIT_SEGMENT,A,E)})},_.prototype._onMediaSegment=function(A,E){var C=this;Promise.resolve().then(function(){C._emitter.emit(r.a.MEDIA_SEGMENT,A,E)})},_.prototype._onLoadingComplete=function(){var A=this;Promise.resolve().then(function(){A._emitter.emit(r.a.LOADING_COMPLETE)})},_.prototype._onRecoveredEarlyEof=function(){var A=this;Promise.resolve().then(function(){A._emitter.emit(r.a.RECOVERED_EARLY_EOF)})},_.prototype._onMediaInfo=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.MEDIA_INFO,A)})},_.prototype._onMetaDataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.METADATA_ARRIVED,A)})},_.prototype._onScriptDataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.SCRIPTDATA_ARRIVED,A)})},_.prototype._onTimedID3MetadataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.TIMED_ID3_METADATA_ARRIVED,A)})},_.prototype._onSynchronousKLVMetadataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,A)})},_.prototype._onAsynchronousKLVMetadataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,A)})},_.prototype._onSMPTE2038MetadataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.SMPTE2038_METADATA_ARRIVED,A)})},_.prototype._onSCTE35MetadataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.SCTE35_METADATA_ARRIVED,A)})},_.prototype._onPESPrivateDataDescriptor=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.PES_PRIVATE_DATA_DESCRIPTOR,A)})},_.prototype._onPESPrivateDataArrived=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.PES_PRIVATE_DATA_ARRIVED,A)})},_.prototype._onStatisticsInfo=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.STATISTICS_INFO,A)})},_.prototype._onIOError=function(A,E){var C=this;Promise.resolve().then(function(){C._emitter.emit(r.a.IO_ERROR,A,E)})},_.prototype._onDemuxError=function(A,E){var C=this;Promise.resolve().then(function(){C._emitter.emit(r.a.DEMUX_ERROR,A,E)})},_.prototype._onRecommendSeekpoint=function(A){var E=this;Promise.resolve().then(function(){E._emitter.emit(r.a.RECOMMEND_SEEKPOINT,A)})},_.prototype._onLoggingConfigChanged=function(A){this._worker&&this._worker.postMessage({cmd:"logging_config",param:A})},_.prototype._onWorkerMessage=function(A){var E=A.data,C=E.data;if(E.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(E.msg){case r.a.INIT_SEGMENT:case r.a.MEDIA_SEGMENT:this._emitter.emit(E.msg,C.type,C.data);break;case r.a.LOADING_COMPLETE:case r.a.RECOVERED_EARLY_EOF:this._emitter.emit(E.msg);break;case r.a.MEDIA_INFO:Object.setPrototypeOf(C,u.a.prototype),this._emitter.emit(E.msg,C);break;case r.a.METADATA_ARRIVED:case r.a.SCRIPTDATA_ARRIVED:case r.a.TIMED_ID3_METADATA_ARRIVED:case r.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case r.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case r.a.SMPTE2038_METADATA_ARRIVED:case r.a.SCTE35_METADATA_ARRIVED:case r.a.PES_PRIVATE_DATA_DESCRIPTOR:case r.a.PES_PRIVATE_DATA_ARRIVED:case r.a.STATISTICS_INFO:this._emitter.emit(E.msg,C);break;case r.a.IO_ERROR:case r.a.DEMUX_ERROR:this._emitter.emit(E.msg,C.type,C.info);break;case r.a.RECOMMEND_SEEKPOINT:this._emitter.emit(E.msg,C);break;case"logcat_callback":f.a.emitter.emit("log",C.type,C.logcat)}},_}();i.a=p},function(t,i,n){function o(f){var l={};function h(u){if(l[u])return l[u].exports;var m=l[u]={i:u,l:!1,exports:{}};return f[u].call(m.exports,m,m.exports,h),m.l=!0,m.exports}h.m=f,h.c=l,h.i=function(u){return u},h.d=function(u,m,p){h.o(u,m)||Object.defineProperty(u,m,{configurable:!1,enumerable:!0,get:p})},h.r=function(u){Object.defineProperty(u,"__esModule",{value:!0})},h.n=function(u){var m=u&&u.__esModule?function(){return u.default}:function(){return u};return h.d(m,"a",m),m},h.o=function(u,m){return Object.prototype.hasOwnProperty.call(u,m)},h.p="/",h.oe=function(u){throw console.error(u),u};var r=h(h.s=ENTRY_MODULE);return r.default||r}function a(f){return(f+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function c(f,l,h){var r={};r[h]=[];var u=l.toString(),m=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!m)return r;for(var p,_=m[1],A=new RegExp("(\\\\n|\\W)"+a(_)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");p=A.exec(u);)p[3]!=="dll-reference"&&r[h].push(p[3]);for(A=new RegExp("\\("+a(_)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");p=A.exec(u);)f[p[2]]||(r[h].push(p[1]),f[p[2]]=n(p[1]).m),r[p[2]]=r[p[2]]||[],r[p[2]].push(p[4]);for(var E,C=Object.keys(r),k=0;k<C.length;k++)for(var O=0;O<r[C[k]].length;O++)E=r[C[k]][O],isNaN(1*E)||(r[C[k]][O]=1*r[C[k]][O]);return r}function d(f){return Object.keys(f).reduce(function(l,h){return l||f[h].length>0},!1)}t.exports=function(f,l){l=l||{};var h={main:n.m},r=l.all?{main:Object.keys(h.main)}:function(A,E){for(var C={main:[E]},k={main:[]},O={main:{}};d(C);)for(var G=Object.keys(C),B=0;B<G.length;B++){var T=G[B],L=C[T].pop();if(O[T]=O[T]||{},!O[T][L]&&A[T][L]){O[T][L]=!0,k[T]=k[T]||[],k[T].push(L);for(var I=c(A,A[T][L],T),M=Object.keys(I),K=0;K<M.length;K++)C[M[K]]=C[M[K]]||[],C[M[K]]=C[M[K]].concat(I[M[K]])}}return k}(h,f),u="";Object.keys(r).filter(function(A){return A!=="main"}).forEach(function(A){for(var E=0;r[A][E];)E++;r[A].push(E),h[A][E]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+A+" = ("+o.toString().replace("ENTRY_MODULE",JSON.stringify(E))+")({"+r[A].map(function(C){return JSON.stringify(C)+": "+h[A][C].toString()}).join(",")+`});
`}),u=u+"new (("+o.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+r.main.map(function(A){return JSON.stringify(A)+": "+h.main[A].toString()}).join(",")+"}))(self);";var m=new self.Blob([u],{type:"text/javascript"});if(l.bare)return m;var p=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(m),_=new self.Worker(p);return _.objectURL=p,_}},function(t,i,n){var o=n(8),a=function(){function c(){}return c._ebsp2rbsp=function(d){for(var f=d,l=f.byteLength,h=new Uint8Array(l),r=0,u=0;u<l;u++)u>=2&&f[u]===3&&f[u-1]===0&&f[u-2]===0||(h[r]=f[u],r++);return new Uint8Array(h.buffer,0,r)},c.parseSPS=function(d){for(var f=d.subarray(1,4),l="avc1.",h=0;h<3;h++){var r=f[h].toString(16);r.length<2&&(r="0"+r),l+=r}var u=c._ebsp2rbsp(d),m=new o.a(u);m.readByte();var p=m.readByte();m.readByte();var _=m.readByte();m.readUEG();var A=c.getProfileString(p),E=c.getLevelString(_),C=1,k=420,O=8,G=8;if((p===100||p===110||p===122||p===244||p===44||p===83||p===86||p===118||p===128||p===138||p===144)&&((C=m.readUEG())===3&&m.readBits(1),C<=3&&(k=[0,420,422,444][C]),O=m.readUEG()+8,G=m.readUEG()+8,m.readBits(1),m.readBool()))for(var B=C!==3?8:12,T=0;T<B;T++)m.readBool()&&(T<6?c._skipScalingList(m,16):c._skipScalingList(m,64));m.readUEG();var L=m.readUEG();if(L===0)m.readUEG();else if(L===1){m.readBits(1),m.readSEG(),m.readSEG();var I=m.readUEG();for(T=0;T<I;T++)m.readSEG()}var M=m.readUEG();m.readBits(1);var K=m.readUEG(),re=m.readUEG(),ae=m.readBits(1);ae===0&&m.readBits(1),m.readBits(1);var te=0,ne=0,me=0,Ae=0;m.readBool()&&(te=m.readUEG(),ne=m.readUEG(),me=m.readUEG(),Ae=m.readUEG());var F=1,y=1,v=0,S=!0,w=0,x=0;if(m.readBool()){if(m.readBool()){var D=m.readByte();D>0&&D<16?(F=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][D-1],y=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][D-1]):D===255&&(F=m.readByte()<<8|m.readByte(),y=m.readByte()<<8|m.readByte())}if(m.readBool()&&m.readBool(),m.readBool()&&(m.readBits(4),m.readBool()&&m.readBits(24)),m.readBool()&&(m.readUEG(),m.readUEG()),m.readBool()){var U=m.readBits(32),j=m.readBits(32);S=m.readBool(),v=(w=j)/(x=2*U)}}var X=1;F===1&&y===1||(X=F/y);var ee=0,ie=0;C===0?(ee=1,ie=2-ae):(ee=C===3?1:2,ie=(C===1?2:1)*(2-ae));var be=16*(K+1),Te=16*(re+1)*(2-ae);be-=(te+ne)*ee,Te-=(me+Ae)*ie;var Oe=Math.ceil(be*X);return m.destroy(),m=null,{codec_mimetype:l,profile_idc:p,level_idc:_,profile_string:A,level_string:E,chroma_format_idc:C,bit_depth:O,bit_depth_luma:O,bit_depth_chroma:G,ref_frames:M,chroma_format:k,chroma_format_string:c.getChromaFormatString(k),frame_rate:{fixed:S,fps:v,fps_den:x,fps_num:w},sar_ratio:{width:F,height:y},codec_size:{width:be,height:Te},present_size:{width:Oe,height:Te}}},c._skipScalingList=function(d,f){for(var l=8,h=8,r=0;r<f;r++)h!==0&&(h=(l+d.readSEG()+256)%256),l=h===0?l:h},c.getProfileString=function(d){switch(d){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},c.getLevelString=function(d){return(d/10).toFixed(1)},c.getChromaFormatString=function(d){switch(d){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},c}();i.a=a},function(t,i,n){n.r(i),n(0);var o=n(9),a=n(18),c=n(17),d=n(1),f=n(14);i.default=function(l){var h=null,r=(function(te,ne){l.postMessage({msg:"logcat_callback",data:{type:te,logcat:ne}})}).bind(this);function u(te,ne){var me={msg:d.a.INIT_SEGMENT,data:{type:te,data:ne}};l.postMessage(me,[ne.data])}function m(te,ne){var me={msg:d.a.MEDIA_SEGMENT,data:{type:te,data:ne}};l.postMessage(me,[ne.data])}function p(){var te={msg:d.a.LOADING_COMPLETE};l.postMessage(te)}function _(){var te={msg:d.a.RECOVERED_EARLY_EOF};l.postMessage(te)}function A(te){var ne={msg:d.a.MEDIA_INFO,data:te};l.postMessage(ne)}function E(te){var ne={msg:d.a.METADATA_ARRIVED,data:te};l.postMessage(ne)}function C(te){var ne={msg:d.a.SCRIPTDATA_ARRIVED,data:te};l.postMessage(ne)}function k(te){var ne={msg:d.a.TIMED_ID3_METADATA_ARRIVED,data:te};l.postMessage(ne)}function O(te){var ne={msg:d.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:te};l.postMessage(ne)}function G(te){var ne={msg:d.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:te};l.postMessage(ne)}function B(te){var ne={msg:d.a.SMPTE2038_METADATA_ARRIVED,data:te};l.postMessage(ne)}function T(te){var ne={msg:d.a.SCTE35_METADATA_ARRIVED,data:te};l.postMessage(ne)}function L(te){var ne={msg:d.a.PES_PRIVATE_DATA_DESCRIPTOR,data:te};l.postMessage(ne)}function I(te){var ne={msg:d.a.PES_PRIVATE_DATA_ARRIVED,data:te};l.postMessage(ne)}function M(te){var ne={msg:d.a.STATISTICS_INFO,data:te};l.postMessage(ne)}function K(te,ne){l.postMessage({msg:d.a.IO_ERROR,data:{type:te,info:ne}})}function re(te,ne){l.postMessage({msg:d.a.DEMUX_ERROR,data:{type:te,info:ne}})}function ae(te){l.postMessage({msg:d.a.RECOMMEND_SEEKPOINT,data:te})}a.a.install(),l.addEventListener("message",function(te){switch(te.data.cmd){case"init":(h=new c.a(te.data.param[0],te.data.param[1])).on(d.a.IO_ERROR,K.bind(this)),h.on(d.a.DEMUX_ERROR,re.bind(this)),h.on(d.a.INIT_SEGMENT,u.bind(this)),h.on(d.a.MEDIA_SEGMENT,m.bind(this)),h.on(d.a.LOADING_COMPLETE,p.bind(this)),h.on(d.a.RECOVERED_EARLY_EOF,_.bind(this)),h.on(d.a.MEDIA_INFO,A.bind(this)),h.on(d.a.METADATA_ARRIVED,E.bind(this)),h.on(d.a.SCRIPTDATA_ARRIVED,C.bind(this)),h.on(d.a.TIMED_ID3_METADATA_ARRIVED,k.bind(this)),h.on(d.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,O.bind(this)),h.on(d.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,G.bind(this)),h.on(d.a.SMPTE2038_METADATA_ARRIVED,B.bind(this)),h.on(d.a.SCTE35_METADATA_ARRIVED,T.bind(this)),h.on(d.a.PES_PRIVATE_DATA_DESCRIPTOR,L.bind(this)),h.on(d.a.PES_PRIVATE_DATA_ARRIVED,I.bind(this)),h.on(d.a.STATISTICS_INFO,M.bind(this)),h.on(d.a.RECOMMEND_SEEKPOINT,ae.bind(this));break;case"destroy":h&&(h.destroy(),h=null),l.postMessage({msg:"destroyed"});break;case"start":h.start();break;case"stop":h.stop();break;case"seek":h.seek(te.data.param);break;case"pause":h.pause();break;case"resume":h.resume();break;case"logging_config":var ne=te.data.param;o.a.applyConfig(ne),ne.enableCallback===!0?o.a.addLogListener(r):o.a.removeLogListener(r);break;case"switch_audio":h._demuxer instanceof f.a&&(te.data.param==="primary"?h._demuxer.preferred_secondary_audio=!1:te.data.param==="secondary"&&(h._demuxer.preferred_secondary_audio=!0))}})}},function(t,i,n){t.exports=n(29).default},function(t,i,n){(function(o,a){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var c;c=function(){function d(j){return typeof j=="function"}var f=Array.isArray?Array.isArray:function(j){return Object.prototype.toString.call(j)==="[object Array]"},l=0,h=void 0,r=void 0,u=function(j,X){k[l]=j,k[l+1]=X,(l+=2)===2&&(r?r(O):I())},m=typeof window<"u"?window:void 0,p=m||{},_=p.MutationObserver||p.WebKitMutationObserver,A=typeof self>"u"&&o!==void 0&&{}.toString.call(o)==="[object process]",E=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function C(){var j=setTimeout;return function(){return j(O,1)}}var k=new Array(1e3);function O(){for(var j=0;j<l;j+=2)(0,k[j])(k[j+1]),k[j]=void 0,k[j+1]=void 0;l=0}var G,B,T,L,I=void 0;function M(j,X){var ee=this,ie=new this.constructor(ae);ie[re]===void 0&&x(ie);var be=ee._state;if(be){var Te=arguments[be-1];u(function(){return S(be,ie,Te,ee._result)})}else y(ee,ie,j,X);return ie}function K(j){if(j&&typeof j=="object"&&j.constructor===this)return j;var X=new this(ae);return ne(X,j),X}A?I=function(){return o.nextTick(O)}:_?(B=0,T=new _(O),L=document.createTextNode(""),T.observe(L,{characterData:!0}),I=function(){L.data=B=++B%2}):E?((G=new MessageChannel).port1.onmessage=O,I=function(){return G.port2.postMessage(0)}):I=m===void 0?function(){try{var j=Function("return this")().require("vertx");return(h=j.runOnLoop||j.runOnContext)!==void 0?function(){h(O)}:C()}catch{return C()}}():C();var re=Math.random().toString(36).substring(2);function ae(){}function te(j,X,ee){X.constructor===j.constructor&&ee===M&&X.constructor.resolve===K?function(ie,be){be._state===1?Ae(ie,be._result):be._state===2?F(ie,be._result):y(be,void 0,function(Te){return ne(ie,Te)},function(Te){return F(ie,Te)})}(j,X):ee===void 0?Ae(j,X):d(ee)?function(ie,be,Te){u(function(Oe){var He=!1,st=function(Le,rt,tt,Ee){try{Le.call(rt,tt,Ee)}catch(ft){return ft}}(Te,be,function(Le){He||(He=!0,be!==Le?ne(Oe,Le):Ae(Oe,Le))},function(Le){He||(He=!0,F(Oe,Le))},Oe._label);!He&&st&&(He=!0,F(Oe,st))},ie)}(j,X,ee):Ae(j,X)}function ne(j,X){if(j===X)F(j,new TypeError("You cannot resolve a promise with itself"));else if(be=typeof(ie=X),ie===null||be!=="object"&&be!=="function")Ae(j,X);else{var ee=void 0;try{ee=X.then}catch(Te){return void F(j,Te)}te(j,X,ee)}var ie,be}function me(j){j._onerror&&j._onerror(j._result),v(j)}function Ae(j,X){j._state===void 0&&(j._result=X,j._state=1,j._subscribers.length!==0&&u(v,j))}function F(j,X){j._state===void 0&&(j._state=2,j._result=X,u(me,j))}function y(j,X,ee,ie){var be=j._subscribers,Te=be.length;j._onerror=null,be[Te]=X,be[Te+1]=ee,be[Te+2]=ie,Te===0&&j._state&&u(v,j)}function v(j){var X=j._subscribers,ee=j._state;if(X.length!==0){for(var ie=void 0,be=void 0,Te=j._result,Oe=0;Oe<X.length;Oe+=3)ie=X[Oe],be=X[Oe+ee],ie?S(ee,ie,be,Te):be(Te);j._subscribers.length=0}}function S(j,X,ee,ie){var be=d(ee),Te=void 0,Oe=void 0,He=!0;if(be){try{Te=ee(ie)}catch(st){He=!1,Oe=st}if(X===Te)return void F(X,new TypeError("A promises callback cannot return that same promise."))}else Te=ie;X._state!==void 0||(be&&He?ne(X,Te):He===!1?F(X,Oe):j===1?Ae(X,Te):j===2&&F(X,Te))}var w=0;function x(j){j[re]=w++,j._state=void 0,j._result=void 0,j._subscribers=[]}var D=function(){function j(X,ee){this._instanceConstructor=X,this.promise=new X(ae),this.promise[re]||x(this.promise),f(ee)?(this.length=ee.length,this._remaining=ee.length,this._result=new Array(this.length),this.length===0?Ae(this.promise,this._result):(this.length=this.length||0,this._enumerate(ee),this._remaining===0&&Ae(this.promise,this._result))):F(this.promise,new Error("Array Methods must be provided an Array"))}return j.prototype._enumerate=function(X){for(var ee=0;this._state===void 0&&ee<X.length;ee++)this._eachEntry(X[ee],ee)},j.prototype._eachEntry=function(X,ee){var ie=this._instanceConstructor,be=ie.resolve;if(be===K){var Te=void 0,Oe=void 0,He=!1;try{Te=X.then}catch(Le){He=!0,Oe=Le}if(Te===M&&X._state!==void 0)this._settledAt(X._state,ee,X._result);else if(typeof Te!="function")this._remaining--,this._result[ee]=X;else if(ie===U){var st=new ie(ae);He?F(st,Oe):te(st,X,Te),this._willSettleAt(st,ee)}else this._willSettleAt(new ie(function(Le){return Le(X)}),ee)}else this._willSettleAt(be(X),ee)},j.prototype._settledAt=function(X,ee,ie){var be=this.promise;be._state===void 0&&(this._remaining--,X===2?F(be,ie):this._result[ee]=ie),this._remaining===0&&Ae(be,this._result)},j.prototype._willSettleAt=function(X,ee){var ie=this;y(X,void 0,function(be){return ie._settledAt(1,ee,be)},function(be){return ie._settledAt(2,ee,be)})},j}(),U=function(){function j(X){this[re]=w++,this._result=this._state=void 0,this._subscribers=[],ae!==X&&(typeof X!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof j?function(ee,ie){try{ie(function(be){ne(ee,be)},function(be){F(ee,be)})}catch(be){F(ee,be)}}(this,X):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return j.prototype.catch=function(X){return this.then(null,X)},j.prototype.finally=function(X){var ee=this.constructor;return d(X)?this.then(function(ie){return ee.resolve(X()).then(function(){return ie})},function(ie){return ee.resolve(X()).then(function(){throw ie})}):this.then(X,X)},j}();return U.prototype.then=M,U.all=function(j){return new D(this,j).promise},U.race=function(j){var X=this;return f(j)?new X(function(ee,ie){for(var be=j.length,Te=0;Te<be;Te++)X.resolve(j[Te]).then(ee,ie)}):new X(function(ee,ie){return ie(new TypeError("You must pass an array to race."))})},U.resolve=K,U.reject=function(j){var X=new this(ae);return F(X,j),X},U._setScheduler=function(j){r=j},U._setAsap=function(j){u=j},U._asap=u,U.polyfill=function(){var j=void 0;if(a!==void 0)j=a;else if(typeof self<"u")j=self;else try{j=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var X=j.Promise;if(X){var ee=null;try{ee=Object.prototype.toString.call(X.resolve())}catch{}if(ee==="[object Promise]"&&!X.cast)return}j.Promise=U},U.Promise=U,U},t.exports=c()}).call(this,n(26),n(27))},function(t,i){var n,o,a=t.exports={};function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function f(E){if(n===setTimeout)return setTimeout(E,0);if((n===c||!n)&&setTimeout)return n=setTimeout,setTimeout(E,0);try{return n(E,0)}catch{try{return n.call(null,E,0)}catch{return n.call(this,E,0)}}}(function(){try{n=typeof setTimeout=="function"?setTimeout:c}catch{n=c}try{o=typeof clearTimeout=="function"?clearTimeout:d}catch{o=d}})();var l,h=[],r=!1,u=-1;function m(){r&&l&&(r=!1,l.length?h=l.concat(h):u=-1,h.length&&p())}function p(){if(!r){var E=f(m);r=!0;for(var C=h.length;C;){for(l=h,h=[];++u<C;)l&&l[u].run();u=-1,C=h.length}l=null,r=!1,function(k){if(o===clearTimeout)return clearTimeout(k);if((o===d||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(k);try{o(k)}catch{try{return o.call(null,k)}catch{return o.call(this,k)}}}(E)}}function _(E,C){this.fun=E,this.array=C}function A(){}a.nextTick=function(E){var C=new Array(arguments.length-1);if(arguments.length>1)for(var k=1;k<arguments.length;k++)C[k-1]=arguments[k];h.push(new _(E,C)),h.length!==1||r||f(p)},_.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=A,a.addListener=A,a.once=A,a.off=A,a.removeListener=A,a.removeAllListeners=A,a.emit=A,a.prependListener=A,a.prependOnceListener=A,a.listeners=function(E){return[]},a.binding=function(E){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(E){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(t,i){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}t.exports=n},function(t,i,n){n.r(i);var o=n(0),a=n(9),c=n(3),d=n(7),f=n(19),l=n(20),h=n(1),r=n(4),u=n(11);i.default=function(m){var p="PlayerEngineWorker",_=(function(F,y){m.postMessage({msg:"logcat_callback",type:F,logcat:y})}).bind(void 0),A=null,E=null,C=null,k=null,O=!1,G=!1,B=0,T=0,L=!1;function I(){C&&(C.shutdown(),C.destroy(),C=null)}function M(){if(A==null||E==null)throw new c.a("Worker not initialized");if(k)throw new c.a("Transmuxer has been initialized");G||(!E.deferLoadAfterSourceOpen||O?((k=new l.a(A,E)).on(h.a.INIT_SEGMENT,function(F,y){C.appendInitSegment(y)}),k.on(h.a.MEDIA_SEGMENT,function(F,y){C.appendMediaSegment(y),m.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:y.info.endDts})}),k.on(h.a.LOADING_COMPLETE,function(){C.endOfStream(),m.postMessage({msg:"player_event",event:r.a.LOADING_COMPLETE})}),k.on(h.a.RECOVERED_EARLY_EOF,function(){m.postMessage({msg:"player_event",event:r.a.RECOVERED_EARLY_EOF})}),k.on(h.a.IO_ERROR,function(F,y){m.postMessage({msg:"player_event",event:r.a.ERROR,error_type:u.b.NETWORK_ERROR,error_detail:F,info:y})}),k.on(h.a.DEMUX_ERROR,function(F,y){m.postMessage({msg:"player_event",event:r.a.ERROR,error_type:u.b.MEDIA_ERROR,error_detail:F,info:y})}),k.on(h.a.MEDIA_INFO,function(F){me(h.a.MEDIA_INFO,F)}),k.on(h.a.STATISTICS_INFO,function(F){me(h.a.STATISTICS_INFO,F)}),k.on(h.a.RECOMMEND_SEEKPOINT,function(F){(function(y){m.postMessage({msg:"transmuxing_event",event:h.a.RECOMMEND_SEEKPOINT,milliseconds:y})})(F)}),k.on(h.a.METADATA_ARRIVED,function(F){Ae(r.a.METADATA_ARRIVED,F)}),k.on(h.a.SCRIPTDATA_ARRIVED,function(F){Ae(r.a.SCRIPTDATA_ARRIVED,F)}),k.on(h.a.TIMED_ID3_METADATA_ARRIVED,function(F){Ae(r.a.TIMED_ID3_METADATA_ARRIVED,F)}),k.on(h.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(F){Ae(r.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,F)}),k.on(h.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(F){Ae(r.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,F)}),k.on(h.a.SMPTE2038_METADATA_ARRIVED,function(F){Ae(r.a.SMPTE2038_METADATA_ARRIVED,F)}),k.on(h.a.SCTE35_METADATA_ARRIVED,function(F){Ae(r.a.SCTE35_METADATA_ARRIVED,F)}),k.on(h.a.PES_PRIVATE_DATA_DESCRIPTOR,function(F){Ae(r.a.PES_PRIVATE_DATA_DESCRIPTOR,F)}),k.on(h.a.PES_PRIVATE_DATA_ARRIVED,function(F){Ae(r.a.PES_PRIVATE_DATA_ARRIVED,F)}),k.open()):G=!0)}function K(){C&&C.flush(),k&&(k.close(),k.destroy(),k=null)}function re(){O=!0,G&&(G=!1,M())}function ae(){m.postMessage({msg:"mse_event",event:d.a.UPDATE_END})}function te(){o.a.v(p,"MSE SourceBuffer is full, report to main thread"),m.postMessage({msg:"mse_event",event:d.a.BUFFER_FULL})}function ne(F){m.postMessage({msg:"player_event",event:r.a.ERROR,error_type:u.b.MEDIA_ERROR,error_detail:u.b.MEDIA_MSE_ERROR,info:F})}function me(F,y){m.postMessage({msg:"transmuxing_event",event:F,info:y})}function Ae(F,y){m.postMessage({msg:"player_event",event:F,extraData:y})}m.addEventListener("message",function(F){if(!L){var y=F.data;switch(y.cmd){case"logging_config":var v=y;a.a.applyConfig(v.logging_config),v.logging_config.enableCallback===!0?a.a.addLogListener(_):a.a.removeLogListener(_);break;case"init":A=(v=y).media_data_source,E=v.config;break;case"destroy":(function(){k&&K(),C&&I(),L=!0,m.postMessage({msg:"destroyed"})})();break;case"initialize_mse":(function(){o.a.v(p,"Initializing MediaSource in DedicatedWorker"),(C=new f.a(E)).on(d.a.SOURCE_OPEN,re.bind(this)),C.on(d.a.UPDATE_END,ae.bind(this)),C.on(d.a.BUFFER_FULL,te.bind(this)),C.on(d.a.ERROR,ne.bind(this)),C.initialize({getCurrentTime:function(){return B},getReadyState:function(){return T}});var S=C.getHandle();m.postMessage({msg:"mse_init",handle:S},[S])})();break;case"shutdown_mse":I();break;case"load":M();break;case"unload":K();break;case"unbuffered_seek":v=y,C.flush(),k.seek(v.milliseconds);break;case"timeupdate":B=(v=y).current_time;break;case"readystatechange":T=(v=y).ready_state;break;case"pause_transmuxer":k.pause();break;case"resume_transmuxer":k.resume();break;case"switch_audio":(v=y).audio_track==="primary"?k.switchPrimaryAudio():v.audio_track==="secondary"&&k.switchSecondaryAudio()}}})}},function(t,i,n){n.r(i);var o=n(18),a=n(16),c={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function d(){return Object.assign({},c)}var f=function(){function F(){}return F.supportMSEH264Playback=function(){var y=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),v=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return y||v},F.supportMSEH265Playback=function(){var y=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),v=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return y||v},F.supportNetworkStreamIO=function(){var y=new a.a({},d()),v=y.loaderType;return y.destroy(),v=="fetch-stream-loader"||v=="xhr-moz-chunked-loader"},F.getNetworkLoaderTypeName=function(){var y=new a.a({},d()),v=y.loaderType;return y.destroy(),v},F.supportNativeMediaPlayback=function(y){F.videoElement==null&&(F.videoElement=window.document.createElement("video"));var v=F.videoElement.canPlayType(y);return v==="probably"||v=="maybe"},F.getFeatureList=function(){var y={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return y.msePlayback=F.supportMSEH264Playback(),y.networkStreamIO=F.supportNetworkStreamIO(),y.networkLoaderName=F.getNetworkLoaderTypeName(),y.mseLivePlayback=y.msePlayback&&y.networkStreamIO,y.mseH265Playback=F.supportMSEH265Playback(),y.nativeMP4H264Playback=F.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),y.nativeMP4H265Playback=F.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),y.nativeWebmVP8Playback=F.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),y.nativeWebmVP9Playback=F.supportNativeMediaPlayback('video/webm; codecs="vp9"'),y},F}(),l=n(2),h=n(0),r=n(10),u=n.n(r),m=n(19),p=n(4),_=n(20),A=n(7),E=n(11),C=n(3),k=n(1),O=n(5),G=n(12),B=function(){function F(y,v,S){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new G.a,this.e=null,this._config=y,this._media_element=v,this._on_unbuffered_seek=S,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var w=O.a.chrome&&(O.a.version.major<50||O.a.version.major===50&&O.a.version.build<2661);this._always_seek_keyframe=!!(w||O.a.msedge||O.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return F.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},F.prototype.seek=function(y){var v=this._isPositionBuffered(y),S=!1;if(y<1&&this._media_element.buffered.length>0){var w=this._media_element.buffered.start(0);(w<1&&y<w||O.a.safari)&&(S=!0,y=O.a.safari?.1:w)}if(S)this.directSeek(y);else if(v)if(this._always_seek_keyframe){var x=this._getNearestKeyframe(Math.floor(1e3*y));x!=null&&(y=x.dts/1e3),this.directSeek(y)}else this.directSeek(y);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*y)),this._config.accurateSeek&&this.directSeek(y)},F.prototype.directSeek=function(y){this._request_set_current_time=!0,this._media_element.currentTime=y},F.prototype.appendSyncPoints=function(y){this._idr_sample_list.appendArray(y)},F.prototype._onMediaSeeking=function(y){if(this._request_set_current_time)this._request_set_current_time=!1;else{var v=this._media_element.currentTime,S=this._media_element.buffered;if(v<1&&S.length>0){var w=S.start(0);if(w<1&&v<w||O.a.safari){var x=O.a.safari?.1:w;return void this.directSeek(x)}}if(this._isPositionBuffered(v)){if(this._always_seek_keyframe){var D=this._getNearestKeyframe(Math.floor(1e3*v));D!=null&&(v=D.dts/1e3,this.directSeek(v))}}else this._seek_request_record_clocktime=F._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},F.prototype._pollAndApplyUnbufferedSeek=function(){if(this._seek_request_record_clocktime!=null)if(this._seek_request_record_clocktime<=F._getClockTime()-100){var y=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(y)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*y)),this._config.accurateSeek&&this.directSeek(y))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},F.prototype._isPositionBuffered=function(y){for(var v=this._media_element.buffered,S=0;S<v.length;S++){var w=v.start(S),x=v.end(S);if(y>=w&&y<x)return!0}return!1},F.prototype._getNearestKeyframe=function(y){return this._idr_sample_list.getLastSyncPointBeforeDts(y)},F._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},F}(),T=function(){function F(y,v,S,w){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=y,this._media_element=v,this._on_pause_transmuxer=S,this._on_resume_transmuxer=w,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return F.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},F.prototype.notifyBufferedPositionChanged=function(y){!this._config.isLive&&this._config.lazyLoad&&(y==null?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(y))},F.prototype._onMediaTimeUpdate=function(y){this._paused&&this._resumeTransmuxerIfNeeded()},F.prototype._suspendTransmuxerIfNeeded=function(){for(var y=this._media_element.buffered,v=this._media_element.currentTime,S=0,w=0;w<y.length;w++){var x=y.start(w),D=y.end(w);if(x<=v&&v<D){S=D;break}}S>0&&this._suspendTransmuxerIfBufferedPositionExceeded(S)},F.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(y){y>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(h.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},F.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},F.prototype._resumeTransmuxerIfNeeded=function(){for(var y=this._media_element.buffered,v=this._media_element.currentTime,S=this._config.lazyLoadRecoverDuration,w=!1,x=0;x<y.length;x++){var D=y.start(x),U=y.end(x);if(v>=D&&v<U){v>=U-S&&(w=!0);break}}w&&(h.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},F.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},F}(),L=function(){function F(y,v){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=y,this._on_direct_seek=v,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return F.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},F.prototype._onMediaCanPlay=function(y){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},F.prototype._onMediaStalled=function(y){this._detectAndFixStuckPlayback(!0)},F.prototype._onMediaProgress=function(y){this._detectAndFixStuckPlayback()},F.prototype._detectAndFixStuckPlayback=function(y){var v=this._media_element,S=v.buffered;y||!this._canplay_received||v.readyState<2?S.length>0&&v.currentTime<S.start(0)&&(h.a.w(this.TAG,"Playback seems stuck at ".concat(v.currentTime,", seek to ").concat(S.start(0))),this._on_direct_seek(S.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},F}(),I=function(){function F(y,v,S){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=y,this._media_element=v,this._on_direct_seek=S}return F.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},F.prototype.notifyBufferedRangeUpdate=function(){this._chaseLiveLatency()},F.prototype._chaseLiveLatency=function(){var y=this._media_element.buffered,v=this._media_element.currentTime,S=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&y.length!=0&&(this._config.liveBufferLatencyChasingOnPaused||!S)){var w=y.end(y.length-1);if(w>this._config.liveBufferLatencyMaxLatency&&w-v>this._config.liveBufferLatencyMaxLatency){var x=w-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(x)}}},F}(),M=function(){function F(y,v){this._config=null,this._media_element=null,this.e=null,this._config=y,this._media_element=v,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return F.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},F.prototype._onMediaTimeUpdate=function(y){if(this._config.isLive&&this._config.liveSync){var v=this._getCurrentLatency();if(v>this._config.liveSyncMaxLatency){var S=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate=S}else v>this._config.liveSyncTargetLatency||this._media_element.playbackRate!==1&&this._media_element.playbackRate!==0&&(this._media_element.playbackRate=1)}},F.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var y=this._media_element.buffered,v=this._media_element.currentTime;return y.length==0?0:y.end(y.length-1)-v},F}(),K=function(){function F(y,v){this.TAG="PlayerEngineMainThread",this._emitter=new r,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=y,this._config=d(),typeof v=="object"&&Object.assign(this._config,v),y.isLive===!0&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return F.prototype.destroy=function(){this._emitter.emit(p.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},F.prototype.on=function(y,v){var S=this;this._emitter.addListener(y,v),y===p.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return S._emitter.emit(p.a.MEDIA_INFO,S.mediaInfo)}):y==p.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return S._emitter.emit(p.a.STATISTICS_INFO,S.statisticsInfo)})},F.prototype.off=function(y,v){this._emitter.removeListener(y,v)},F.prototype.attachMediaElement=function(y){var v=this;this._media_element=y,y.src="",y.removeAttribute("src"),y.srcObject=null,y.load(),y.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new m.a(this._config),this._mse_controller.on(A.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(A.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(A.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(A.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(A.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(A.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return v._media_element.currentTime},getReadyState:function(){return v._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(y.disableRemotePlayback=!0,y.srcObject=this._mse_controller.getObject()):y.src=this._mse_controller.getObjectURL()},F.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},F.prototype.load=function(){var y=this;if(!this._media_element)throw new C.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new C.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new _.a(this._media_data_source,this._config),this._transmuxer.on(k.a.INIT_SEGMENT,function(v,S){y._mse_controller.appendInitSegment(S)}),this._transmuxer.on(k.a.MEDIA_SEGMENT,function(v,S){y._mse_controller.appendMediaSegment(S),!y._config.isLive&&v==="video"&&S.data&&S.data.byteLength>0&&"info"in S&&y._seeking_handler.appendSyncPoints(S.info.syncPoints),y._loading_controller.notifyBufferedPositionChanged(S.info.endDts/1e3)}),this._transmuxer.on(k.a.LOADING_COMPLETE,function(){y._mse_controller.endOfStream(),y._emitter.emit(p.a.LOADING_COMPLETE)}),this._transmuxer.on(k.a.RECOVERED_EARLY_EOF,function(){y._emitter.emit(p.a.RECOVERED_EARLY_EOF)}),this._transmuxer.on(k.a.IO_ERROR,function(v,S){y._emitter.emit(p.a.ERROR,E.b.NETWORK_ERROR,v,S)}),this._transmuxer.on(k.a.DEMUX_ERROR,function(v,S){y._emitter.emit(p.a.ERROR,E.b.MEDIA_ERROR,v,S)}),this._transmuxer.on(k.a.MEDIA_INFO,function(v){y._media_info=v,y._emitter.emit(p.a.MEDIA_INFO,Object.assign({},v))}),this._transmuxer.on(k.a.STATISTICS_INFO,function(v){y._statistics_info=y._fillStatisticsInfo(v),y._emitter.emit(p.a.STATISTICS_INFO,Object.assign({},v))}),this._transmuxer.on(k.a.RECOMMEND_SEEKPOINT,function(v){y._media_element&&!y._config.accurateSeek&&y._seeking_handler.directSeek(v/1e3)}),this._transmuxer.on(k.a.METADATA_ARRIVED,function(v){y._emitter.emit(p.a.METADATA_ARRIVED,v)}),this._transmuxer.on(k.a.SCRIPTDATA_ARRIVED,function(v){y._emitter.emit(p.a.SCRIPTDATA_ARRIVED,v)}),this._transmuxer.on(k.a.TIMED_ID3_METADATA_ARRIVED,function(v){y._emitter.emit(p.a.TIMED_ID3_METADATA_ARRIVED,v)}),this._transmuxer.on(k.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(v){y._emitter.emit(p.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,v)}),this._transmuxer.on(k.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(v){y._emitter.emit(p.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,v)}),this._transmuxer.on(k.a.SMPTE2038_METADATA_ARRIVED,function(v){y._emitter.emit(p.a.SMPTE2038_METADATA_ARRIVED,v)}),this._transmuxer.on(k.a.SCTE35_METADATA_ARRIVED,function(v){y._emitter.emit(p.a.SCTE35_METADATA_ARRIVED,v)}),this._transmuxer.on(k.a.PES_PRIVATE_DATA_DESCRIPTOR,function(v){y._emitter.emit(p.a.PES_PRIVATE_DATA_DESCRIPTOR,v)}),this._transmuxer.on(k.a.PES_PRIVATE_DATA_ARRIVED,function(v){y._emitter.emit(p.a.PES_PRIVATE_DATA_ARRIVED,v)}),this._seeking_handler=new B(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new T(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new L(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new I(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new M(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},F.prototype.unload=function(){var y,v,S,w,x,D,U,j,X;(y=this._media_element)===null||y===void 0||y.pause(),(v=this._live_latency_synchronizer)===null||v===void 0||v.destroy(),this._live_latency_synchronizer=null,(S=this._live_latency_chaser)===null||S===void 0||S.destroy(),this._live_latency_chaser=null,(w=this._startup_stall_jumper)===null||w===void 0||w.destroy(),this._startup_stall_jumper=null,(x=this._loading_controller)===null||x===void 0||x.destroy(),this._loading_controller=null,(D=this._seeking_handler)===null||D===void 0||D.destroy(),this._seeking_handler=null,(U=this._mse_controller)===null||U===void 0||U.flush(),(j=this._transmuxer)===null||j===void 0||j.close(),(X=this._transmuxer)===null||X===void 0||X.destroy(),this._transmuxer=null},F.prototype.play=function(){return this._media_element.play()},F.prototype.pause=function(){this._media_element.pause()},F.prototype.seek=function(y){this._media_element&&this._seeking_handler?this._seeking_handler.seek(y):this._pending_seek_time=y},F.prototype.switchPrimaryAudio=function(){this._transmuxer.switchPrimaryAudio()},F.prototype.switchSecondaryAudio=function(){this._transmuxer.switchSecondaryAudio()},Object.defineProperty(F.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),F.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},F.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},F.prototype._onMSEBufferFull=function(){h.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},F.prototype._onMSEError=function(y){this._emitter.emit(p.a.ERROR,E.b.MEDIA_ERROR,E.a.MEDIA_MSE_ERROR,y)},F.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(h.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},F.prototype._onMSEEndStreaming=function(){this._config.isLive||(h.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},F.prototype._onMediaLoadedMetadata=function(y){this._loaded_metadata_received=!0,this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},F.prototype._onRequestDirectSeek=function(y){this._seeking_handler.directSeek(y)},F.prototype._onRequiredUnbufferedSeek=function(y){this._mse_controller.flush(),this._transmuxer.seek(y)},F.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},F.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},F.prototype._fillStatisticsInfo=function(y){if(y.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return y;var v=!0,S=0,w=0;if(this._media_element.getVideoPlaybackQuality){var x=this._media_element.getVideoPlaybackQuality();S=x.totalVideoFrames,w=x.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(S=this._media_element.webkitDecodedFrameCount,w=this._media_element.webkitDroppedFrameCount):v=!1;return v&&(y.decodedFrames=S,y.droppedFrames=w),y},F}(),re=n(21),ae=n(9),te=function(){function F(y,v){this.TAG="PlayerEngineDedicatedThread",this._emitter=new r,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=y,this._config=d(),typeof v=="object"&&Object.assign(this._config,v),y.isLive===!0&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},ae.a.registerListener(this.e.onLoggingConfigChanged),this._worker=re(28,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:ae.a.getConfig()})}return F.isSupported=function(){return!!(self.Worker&&self.MediaSource&&"canConstructInDedicatedWorker"in self.MediaSource&&self.MediaSource.canConstructInDedicatedWorker===!0)},F.prototype.destroy=function(){this._emitter.emit(p.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),ae.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},F.prototype.on=function(y,v){var S=this;this._emitter.addListener(y,v),y===p.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return S._emitter.emit(p.a.MEDIA_INFO,S.mediaInfo)}):y==p.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return S._emitter.emit(p.a.STATISTICS_INFO,S.statisticsInfo)})},F.prototype.off=function(y,v){this._emitter.removeListener(y,v)},F.prototype.attachMediaElement=function(y){this._media_element=y,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},F.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},F.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new B(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new T(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new L(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new I(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new M(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},F.prototype.unload=function(){var y,v,S,w,x,D;(y=this._media_element)===null||y===void 0||y.pause(),this._worker.postMessage({cmd:"unload"}),(v=this._live_latency_synchronizer)===null||v===void 0||v.destroy(),this._live_latency_synchronizer=null,(S=this._live_latency_chaser)===null||S===void 0||S.destroy(),this._live_latency_chaser=null,(w=this._startup_stall_jumper)===null||w===void 0||w.destroy(),this._startup_stall_jumper=null,(x=this._loading_controller)===null||x===void 0||x.destroy(),this._loading_controller=null,(D=this._seeking_handler)===null||D===void 0||D.destroy(),this._seeking_handler=null},F.prototype.play=function(){return this._media_element.play()},F.prototype.pause=function(){this._media_element.pause()},F.prototype.seek=function(y){this._media_element&&this._seeking_handler?this._seeking_handler.seek(y):this._pending_seek_time=y},F.prototype.switchPrimaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"primary"})},F.prototype.switchSecondaryAudio=function(){this._worker.postMessage({cmd:"switch_audio",audio_track:"secondary"})},Object.defineProperty(F.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),F.prototype._onLoggingConfigChanged=function(y){var v;(v=this._worker)===null||v===void 0||v.postMessage({cmd:"logging_config",logging_config:y})},F.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},F.prototype._onMSEBufferFull=function(){h.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},F.prototype._onMediaLoadedMetadata=function(y){this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},F.prototype._onRequestDirectSeek=function(y){this._seeking_handler.directSeek(y)},F.prototype._onRequiredUnbufferedSeek=function(y){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:y})},F.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},F.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},F.prototype._onMediaTimeUpdate=function(y){this._worker.postMessage({cmd:"timeupdate",current_time:y.target.currentTime})},F.prototype._onMediaReadyStateChange=function(y){this._worker.postMessage({cmd:"readystatechange",ready_state:y.target.readyState})},F.prototype._onWorkerMessage=function(y){var v,S=y.data,w=S.msg;if(w=="destroyed"||this._worker_destroying)return this._worker_destroying=!1,(v=this._worker)===null||v===void 0||v.terminate(),void(this._worker=null);switch(w){case"mse_init":var x=S;this._media_element.srcObject=x.handle;break;case"mse_event":(x=S).event==A.a.UPDATE_END?this._onMSEUpdateEnd():x.event==A.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((x=S).event==k.a.MEDIA_INFO){var D=S;this._media_info=D.info,this._emitter.emit(p.a.MEDIA_INFO,Object.assign({},D.info))}else if(x.event==k.a.STATISTICS_INFO){var U=S;this._statistics_info=this._fillStatisticsInfo(U.info),this._emitter.emit(p.a.STATISTICS_INFO,Object.assign({},U.info))}else if(x.event==k.a.RECOMMEND_SEEKPOINT){var j=S;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(j.milliseconds/1e3)}break;case"player_event":if((x=S).event==p.a.ERROR){var X=S;this._emitter.emit(p.a.ERROR,X.error_type,X.error_detail,X.info)}else if("extraData"in x){var ee=S;this._emitter.emit(ee.event,ee.extraData)}break;case"logcat_callback":x=S,h.a.emitter.emit("log",x.type,x.logcat);break;case"buffered_position_changed":x=S,this._loading_controller.notifyBufferedPositionChanged(x.buffered_position_milliseconds/1e3)}},F.prototype._fillStatisticsInfo=function(y){if(y.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return y;var v=!0,S=0,w=0;if(this._media_element.getVideoPlaybackQuality){var x=this._media_element.getVideoPlaybackQuality();S=x.totalVideoFrames,w=x.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(S=this._media_element.webkitDecodedFrameCount,w=this._media_element.webkitDroppedFrameCount):v=!1;return v&&(y.decodedFrames=S,y.droppedFrames=w),y},F}(),ne=function(){function F(y,v){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var S=y.type.toLowerCase();if(S!=="mse"&&S!=="mpegts"&&S!=="m2ts"&&S!=="flv")throw new C.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");if(v&&v.enableWorkerForMSE&&te.isSupported())try{this._player_engine=new te(y,v)}catch{h.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new K(y,v)}else this._player_engine=new K(y,v)}return F.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},F.prototype.on=function(y,v){this._player_engine.on(y,v)},F.prototype.off=function(y,v){this._player_engine.off(y,v)},F.prototype.attachMediaElement=function(y){this._media_element=y,this._player_engine.attachMediaElement(y)},F.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},F.prototype.load=function(){this._player_engine.load()},F.prototype.unload=function(){this._player_engine.unload()},F.prototype.play=function(){return this._player_engine.play()},F.prototype.pause=function(){this._player_engine.pause()},F.prototype.switchPrimaryAudio=function(){this._player_engine.switchPrimaryAudio()},F.prototype.switchSecondaryAudio=function(){this._player_engine.switchSecondaryAudio()},Object.defineProperty(F.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"volume",{get:function(){return this._media_element.volume},set:function(y){this._media_element.volume=y},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"muted",{get:function(){return this._media_element.muted},set:function(y){this._media_element.muted=y},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(y){this._player_engine.seek(y)},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),F}(),me=function(){function F(y,v){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new u.a,this._config=d(),typeof v=="object"&&Object.assign(this._config,v);var S=y.type.toLowerCase();if(S==="mse"||S==="mpegts"||S==="m2ts"||S==="flv")throw new C.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(y.hasOwnProperty("segments"))throw new C.b("NativePlayer(".concat(y.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=y,this._mediaElement=null}return F.prototype.destroy=function(){this._emitter.emit(p.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},F.prototype.on=function(y,v){var S=this;y===p.a.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){S._emitter.emit(p.a.MEDIA_INFO,S.mediaInfo)}):y===p.a.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){S._emitter.emit(p.a.STATISTICS_INFO,S.statisticsInfo)}),this._emitter.addListener(y,v)},F.prototype.off=function(y,v){this._emitter.removeListener(y,v)},F.prototype.attachMediaElement=function(y){if(this._mediaElement=y,y.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{y.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},F.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},F.prototype.load=function(){if(!this._mediaElement)throw new C.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},F.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},F.prototype.play=function(){return this._mediaElement.play()},F.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(F.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(y){this._mediaElement.volume=y},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(y){this._mediaElement.muted=y},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(y){this._mediaElement?this._mediaElement.currentTime=y:this._pendingSeekTime=y},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"mediaInfo",{get:function(){var y={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(y.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(y.width=this._mediaElement.videoWidth,y.height=this._mediaElement.videoHeight)),y},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"statisticsInfo",{get:function(){var y={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return y;var v=!0,S=0,w=0;if(this._mediaElement.getVideoPlaybackQuality){var x=this._mediaElement.getVideoPlaybackQuality();S=x.totalVideoFrames,w=x.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(S=this._mediaElement.webkitDecodedFrameCount,w=this._mediaElement.webkitDroppedFrameCount):v=!1;return v&&(y.decodedFrames=S,y.droppedFrames=w),y},enumerable:!1,configurable:!0}),F.prototype._onvLoadedMetadata=function(y){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(p.a.MEDIA_INFO,this.mediaInfo)},F.prototype._reportStatisticsInfo=function(){this._emitter.emit(p.a.STATISTICS_INFO,this.statisticsInfo)},F}();o.a.install();var Ae={createPlayer:function(F,y){var v=F;if(v==null||typeof v!="object")throw new C.b("MediaDataSource must be an javascript object!");if(!v.hasOwnProperty("type"))throw new C.b("MediaDataSource must has type field to indicate video file type!");switch(v.type){case"mse":case"mpegts":case"m2ts":case"flv":return new ne(v,y);default:return new me(v,y)}},isSupported:function(){return f.supportMSEH264Playback()},getFeatureList:function(){return f.getFeatureList()}};Ae.BaseLoader=l.a,Ae.LoaderStatus=l.c,Ae.LoaderErrors=l.b,Ae.Events=p.a,Ae.ErrorTypes=E.b,Ae.ErrorDetails=E.a,Ae.MSEPlayer=ne,Ae.NativePlayer=me,Ae.LoggingControl=ae.a,Object.defineProperty(Ae,"version",{enumerable:!0,get:function(){return"1.7.3"}}),i.default=Ae}])})})(Jd);var lb=Jd.exports;const Kl=Rs(lb);class Wl{constructor(e,t){ye(this,"restart_required_when_quality_switched",!1);ye(this,"player");ye(this,"playback_mode");ye(this,"watch_content_element");ye(this,"watch_header_element");ye(this,"watch_player_element");ye(this,"request_picture_in_picture",null);this.player=e,this.playback_mode=t,this.watch_content_element=document.querySelector(".watch-content"),this.watch_header_element=document.querySelector(".watch-header"),this.watch_player_element=document.querySelector(".watch-player")}async init(){const e=pi();if(!("documentPictureInPicture"in window)){this.player.template.pipButton.style.display="none",console.log("[DocumentPiPManager] Initialized. (Document Picture-in-Picture API is not supported.)");return}this.request_picture_in_picture=this.player.video.requestPictureInPicture,this.player.video.requestPictureInPicture=async()=>{if(documentPictureInPicture.window)return documentPictureInPicture.window.close(),{};documentPictureInPicture.onenter=f=>{console.log("[DocumentPiPManager] Picture-in-Picture window entered."),e.is_document_pip=!0,e.event_emitter.emit("SetControlDisplayTimer",{is_player_region_event:!0,timeout_seconds:0})};const t=await documentPictureInPicture.requestWindow({width:540,height:304}),i=t.document.createElement("meta");i.name="darkreader-lock",t.document.head.appendChild(i),[...document.styleSheets].forEach(f=>{try{const l=[...f.cssRules].map(r=>r.cssText).join(""),h=document.createElement("style");h.textContent=l,t.document.head.appendChild(h)}catch{const h=document.createElement("link");h.rel="stylesheet",h.type=f.type,h.media=f.media.mediaText,h.href=f.href,t.document.head.appendChild(h)}}),t.document.body.classList.add("watch-container"),t.document.body.classList.add("watch-container--fullscreen"),ts(()=>e.is_control_display,f=>{f?t.document.body.classList.add("watch-container--control-display"):t.document.body.classList.remove("watch-container--control-display")});const n=t.document.createElement("div");n.classList.add("watch-content"),n.append(this.watch_header_element),n.append(this.watch_player_element),t.document.body.append(n);const o=document.createElement("div");o.classList.add("playing-in-pip");const a=document.createElement("span");a.classList.add("playing-in-pip__text"),a.textContent="Picture-in-Picture を再生しています",o.append(a);const c=document.createElement("button");c.classList.add("playing-in-pip__close-button"),c.textContent="Picture-in-Picture を終了",c.onclick=()=>t.close(),o.append(c),this.watch_content_element.append(o);const d=f=>{e.event_emitter.emit("SetControlDisplayTimer",{event:f,is_player_region_event:!0,timeout_seconds:1.25})};return n.addEventListener("mousemove",d),n.addEventListener("touchmove",d),n.addEventListener("click",d),t.addEventListener("pagehide",()=>{e.is_document_pip=!1,o.remove(),this.watch_content_element.append(this.watch_header_element),this.watch_content_element.append(this.watch_player_element),console.log("[DocumentPiPManager] Picture-in-Picture window exited.")}),{}},console.log("[DocumentPiPManager] Initialized.")}async destroy(){if(!("documentPictureInPicture"in window)){console.log("[DocumentPiPManager] Destroyed. (Document Picture-in-Picture API is not supported.)");return}documentPictureInPicture.window!==null&&documentPictureInPicture.window.close(),documentPictureInPicture.onenter=null,this.request_picture_in_picture!==null&&(this.player.video.requestPictureInPicture=this.request_picture_in_picture),console.log("[DocumentPiPManager] Destroyed.")}}class Yl{constructor(e,t,i=window.document){ye(this,"restart_required_when_quality_switched",!1);ye(this,"player");ye(this,"playback_mode");ye(this,"document");ye(this,"abort_controller",null);this.player=e,this.playback_mode=t,this.document=i}async init(){const e=sn(),t=pi(),i=Ni();this.abort_controller=new AbortController,document.querySelector(".route-container"),this.player.container.querySelector(".dplayer-capture-icon"),this.player.container.querySelector(".dplayer-comment-capture-icon"),document.querySelector(".tweet-form__textarea"),document.querySelector(".tweet-button"),document.querySelector(".remote-control-button-data"),document.querySelector(".remote-control-button-back"),document.querySelector(".remote-control-button-select"),document.querySelector(".remote-control-button-up"),document.querySelector(".remote-control-button-left"),document.querySelector(".remote-control-button-right"),document.querySelector(".remote-control-button-down"),document.querySelector(".remote-control-button-blue"),document.querySelector(".remote-control-button-red"),document.querySelector(".remote-control-button-green"),document.querySelector(".remote-control-button-yellow");const n=[{mode:"Live",key:"ArrowUp",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.is_zapping=!0,la.push({path:`/watch/${e.channel.previous.display_channel_id}`})}},{mode:"Live",key:"ArrowDown",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.is_zapping=!0,la.push({path:`/watch/${e.channel.next.display_channel_id}`})}},{mode:"Both",key:"Slash",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.shortcut_key_modal=!t.shortcut_key_modal}},{mode:"Both",key:"Space",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.player.toggle()}},{mode:"Video",key:"ArrowLeft",repeat:!0,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.player.seek(this.player.video.currentTime-5)}},{mode:"Video",key:"ArrowRight",repeat:!0,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.player.seek(this.player.video.currentTime+5)}},{mode:"Video",key:"ArrowLeft",repeat:!0,ctrl:!0,shift:!1,alt:!1,handler:()=>{this.player.seek(this.player.video.currentTime-15)}},{mode:"Video",key:"ArrowRight",repeat:!0,ctrl:!0,shift:!1,alt:!1,handler:()=>{this.player.seek(this.player.video.currentTime+15)}},{mode:"Video",key:"ArrowLeft",repeat:!0,ctrl:!1,shift:!0,alt:!1,handler:()=>{this.player.seek(this.player.video.currentTime-30)}},{mode:"Video",key:"ArrowRight",repeat:!0,ctrl:!1,shift:!0,alt:!1,handler:()=>{this.player.seek(this.player.video.currentTime+30)}},{mode:"Video",key:"ArrowLeft",repeat:!0,ctrl:!1,shift:!1,alt:!0,handler:()=>{this.player.seek(this.player.video.currentTime-60)}},{mode:"Video",key:"ArrowRight",repeat:!0,ctrl:!1,shift:!1,alt:!0,handler:()=>{this.player.seek(this.player.video.currentTime+60)}},{mode:"Both",key:"KeyF",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.player.fullScreen.toggle()}},{mode:"Both",key:"KeyE",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{document.pictureInPictureEnabled&&this.player.template.pipButton.click()}},{mode:"Both",key:"KeyD",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.player.template.showDanmaku.click(),this.player.template.showDanmakuToggle.checked?this.player.notice(`${this.player.tran("Show comment")}`):this.player.notice(`${this.player.tran("Hide comment")}`)}},{mode:"Live",key:"KeyM",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.player.controller.show(),this.player.comment.show(),t.event_emitter.emit("SetControlDisplayTimer",{}),window.setTimeout(()=>this.player.template.commentInput.focus(),100)}},{mode:"Both",key:"KeyP",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.is_panel_display=!t.is_panel_display}},{mode:"Live",key:"KeyK",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.tv_panel_active_tab="Program"}},{mode:"Video",key:"KeyK",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.video_panel_active_tab="RecordedProgram"}},{mode:"Live",key:"KeyL",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{t.tv_panel_active_tab="Channel"}},{mode:"Both",key:"Semicolon",repeat:!1,ctrl:!1,shift:!1,alt:!1,handler:()=>{this.playback_mode==="Live"?t.tv_panel_active_tab="Comment":t.video_panel_active_tab="Comment"}}];let o=0;this.document.addEventListener("keydown",a=>{if(a.isComposing===!0||a.keyCode===229)return;let c=!1;a.repeat&&(c=!0);const d=St.time();d-o<.05&&(c=!0),o=d;const f=St.isMacOS()===!0?a.metaKey:a.ctrlKey,l=a.shiftKey,h=a.altKey;this.playback_mode==="Live"?t.tv_panel_active_tab:t.video_panel_active_tab;const r=document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement;if(this.playback_mode==="Live"&&c===!1&&f===!1&&h===(i.settings.tv_channel_selection_requires_alt_key===!0)&&r===!1){const u=l?"BS":"GR";let m=null;if(["Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9"].includes(a.code)&&(m=Number(a.code.replace("Digit",""))),a.code==="Digit0"&&(m=10),a.code==="Minus"&&(m=11),a.code==="Equal"&&(m=12),["Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9"].includes(a.code)&&(m=Number(a.code.replace("Numpad",""))),a.code==="Numpad0"&&(m=10),m!==null){const p=e.getChannelByRemoconID(u,m);if(p!==null&&p.display_channel_id!==e.display_channel_id){la.push({path:`/watch/${p.display_channel_id}`}),a.preventDefault(),a.stopPropagation();return}}}if(this.playback_mode==="Live"&&a.code==="KeyM"&&c===!1&&f===!0&&l===!1&&h===!1&&this.player.template.controller.classList.contains("dplayer-controller-comment")&&(r===!1||document.activeElement===this.player.template.commentInput)){this.player.comment.hide(),a.preventDefault(),a.stopPropagation();return}if(r!==!0){for(const u of n)if(!(u.mode!=="Both"&&u.mode!==this.playback_mode)&&u.key===a.code&&!(u.repeat===!1&&c===!0)&&u.ctrl===f&&u.shift===l&&u.alt===h){u.handler(),a.preventDefault(),a.stopPropagation();return}}},{signal:this.abort_controller.signal}),console.log("[KeyboardShortcutManager] Initialized.")}async destroy(){const e=pi();if(this.playback_mode==="Live"&&e.is_zapping===!0){const t=ts(()=>e.is_player_initialized,(n,o)=>{o===!1&&n===!0&&(t(),i(),this.abort_controller!==null&&(this.abort_controller.abort(),this.abort_controller=null),console.log("[KeyboardShortcutManager] Destroyed. (Zapping finished)"))}),i=ts(()=>e.is_watching,(n,o)=>{o===!0&&n===!1&&(t(),i(),this.abort_controller!==null&&(this.abort_controller.abort(),this.abort_controller=null),console.log("[KeyboardShortcutManager] Destroyed. (Zapping canceled)"))})}else this.abort_controller!==null&&(this.abort_controller.abort(),this.abort_controller=null),console.log("[KeyboardShortcutManager] Destroyed.")}}function cb(s,e=0,{start:t=!0,middle:i=!0,once:n=!1}={}){let o=t,a=0,c,d=!1;function f(...l){if(d)return;const h=Date.now()-a;a=Date.now(),t&&i&&h>=e&&(o=!0),o?(o=!1,s.apply(this,l),n&&f.cancel()):(i&&h<e||!i)&&(clearTimeout(c),c=setTimeout(()=>{a=Date.now(),s.apply(this,l),n&&f.cancel()},i?e-h:e))}return f.cancel=()=>{clearTimeout(c),d=!0},f}class Xl{constructor(e){ye(this,"restart_required_when_quality_switched",!1);ye(this,"player");ye(this,"watch_session",null);ye(this,"comment_session",null);ye(this,"vpos_base_timestamp",0);ye(this,"keep_seat_interval_id",null);ye(this,"abort_controller",new AbortController);ye(this,"reconnecting",!1);ye(this,"destroyed",!1);this.player=e}async init(){const e=pi(),t=lo();this.destroyed=!1,await t.fetchUser();const i=await this.initWatchSession();if(i.is_success===!1){e.live_comment_init_failed_message=i.detail,console.error(`[LiveCommentManager][WatchSession] Error: ${i.detail}`),i.detail!=="このチャンネルはNX-Jikkyo に対応していません。"&&i.detail!=="現在放送中のNX-Jikkyo がありません。"&&this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice(i.detail,void 0,void 0,"#FF6F6A");return}this.initCommentSession(i),console.log("[LiveCommentManager] Initialized.")}async initWatchSession(){const e=sn();let t=!1;const i=await xu.fetchJikkyoSession(e.channel.current.id);if(i===null)return{is_success:!1,detail:"NX-Jikkyo のセッション情報を取得できませんでした。"};if(i.is_success===!1)return{is_success:!1,detail:i.detail};this.watch_session=new WebSocket(i.audience_token),this.watch_session.addEventListener("open",()=>{var o;(o=this.watch_session)==null||o.send(JSON.stringify({type:"startWatching",data:{reconnect:!1}}))},{signal:this.abort_controller.signal});const n=async o=>{if(t===!0)return;const a=o instanceof CloseEvent?o.code:"Error";this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice(`NX-Jikkyo との接続が切断されました。(Code: ${a})`,void 0,void 0,"#FF6F6A"),console.error(`[LiveCommentManager][WatchSession] Connection closed. (Code: ${a})`),await St.sleep(3),await this.reconnect()};return this.watch_session.addEventListener("close",n,{signal:this.abort_controller.signal}),this.watch_session.addEventListener("error",n,{signal:this.abort_controller.signal}),this.watch_session.addEventListener("message",async o=>{if(this.watch_session===null)return;const a=JSON.parse(o.data);switch(a.type){case"seat":{if(this.keep_seat_interval_id!==null)break;this.keep_seat_interval_id=window.setInterval(()=>{this.watch_session&&this.watch_session.readyState===WebSocket.OPEN?this.watch_session.send(JSON.stringify({type:"keepSeat"})):window.clearInterval(this.keep_seat_interval_id??0)},a.data.keepIntervalSec*1e3);break}case"ping":{this.watch_session.send(JSON.stringify({type:"pong"}));break}case"error":{if(a.data.code==="COMMENT_POST_NOT_ALLOWED"||a.data.code==="INVALID_MESSAGE")break;let c=`NX-Jikkyo でエラーが発生しています。(Code: ${a.data.code})`;switch(a.data.code){case"CONNECT_ERROR":c="NX-Jikkyo のコメントサーバーに接続できません。";break;case"CONTENT_NOT_READY":c="NX-Jikkyo が配信できない状態です。";break;case"NO_THREAD_AVAILABLE":c="NX-Jikkyo のコメントスレッドを取得できません。";break;case"NO_ROOM_AVAILABLE":c="NX-Jikkyo のコメント部屋を取得できません。";break;case"NO_PERMISSION":c="NX-Jikkyo の API にアクセスする権限がありません。";break;case"NOT_ON_AIR":c="NX-Jikkyo が放送中ではありません。";break;case"BROADCAST_NOT_FOUND":c="NX-Jikkyo の配信情報を取得できません。";break;case"INTERNAL_SERVERERROR":c="NX-Jikkyo でサーバーエラーが発生しています。";break}this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice(c,void 0,void 0,"#FF6F6A"),console.error(`[LiveCommentManager][WatchSession] Error occurred. (Code: ${a.data.code})`),await St.sleep(3),await this.reconnect();break}case"reconnect":{await this.reconnect();break}case"disconnect":{t=!0;let c=`NX-Jikkyo との接続が切断されました。(${a.data.reason})`;switch(a.data.reason){case"TAKEOVER":c="NX-Jikkyo の番組から追い出されました。";break;case"NO_PERMISSION":c="NX-Jikkyo の番組の座席を取得できませんでした。";break;case"END_PROGRAM":c="NX-Jikkyo がリセットされたか、コミュニティの番組が終了しました。";break;case"PING_TIMEOUT":c="コメントサーバーとの接続生存確認に失敗しました。";break;case"TOO_MANY_CONNECTIONS":c="NX-Jikkyo の同一ユーザからの接続数上限を越えています。";break;case"TOO_MANY_WATCHINGS":c="NX-Jikkyo の同一ユーザからの視聴番組数上限を越えています。";break;case"CROWDED":c="NX-Jikkyo の番組が満席です。";break;case"MAINTENANCE_IN":c="NX-Jikkyo はメンテナンス中です。";break;case"SERVICE_TEMPORARILY_UNAVAILABLE":c="NX-Jikkyo で一時的にサーバーエラーが発生しています。";break}this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice(c,void 0,void 0,"#FF6F6A"),console.error(`[LiveCommentManager][WatchSession] Disconnected. (Reason: ${a.data.reason})`),await St.sleep(3),await this.reconnect();break}}},{signal:this.abort_controller.signal}),new Promise(o=>{this.watch_session.addEventListener("message",async a=>{const c=JSON.parse(a.data);if(c.type==="room")return this.vpos_base_timestamp=Vi(c.data.vposBaseTime).valueOf(),console.log(`[LiveCommentManager][WatchSession] Connected.
Thread ID: ${c.data.threadId}
`),o({is_success:!0,detail:"視聴セッションを取得しました。",message_server_url:c.data.messageServer.uri,thread_id:c.data.threadId,your_post_key:c.data.yourPostKey?c.data.yourPostKey:null})},{signal:this.abort_controller.signal})})}initCommentSession(e){const t=pi(),i=[];let n=!1;const o=[];this.comment_session=new WebSocket(e.message_server_url),this.comment_session.addEventListener("open",()=>{this.comment_session!==null&&this.comment_session.send(JSON.stringify([{ping:{content:"rs:0"}},{ping:{content:"ps:0"}},{thread:{version:"20061206",thread:e.thread_id,threadkey:e.your_post_key,user_id:"",res_from:-100}},{ping:{content:"pf:0"}},{ping:{content:"rf:0"}}]))},{signal:this.abort_controller.signal});const a=async d=>{const f=d instanceof CloseEvent?d.code:"Error";this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice(`NX-Jikkyo との接続が切断されました。(Code: ${f})`,void 0,void 0,"#FF6F6A"),console.error(`[LiveCommentManager][CommentSession] Connection closed. (Code: ${f})`),await St.sleep(3),await this.reconnect()};this.comment_session.addEventListener("close",a,{signal:this.abort_controller.signal}),this.comment_session.addEventListener("error",a,{signal:this.abort_controller.signal});const c=cb(()=>{St.isSafari()===!1&&console.debug("[LiveCommentManager][CommentSession] Comments buffer length:",o.length),this.destroyed===!1&&t.event_emitter.emit("CommentReceived",{is_initial_comments:!1,comments:o}),o.length=0},333);this.comment_session.addEventListener("message",async d=>{const f=JSON.parse(d.data);if(f.thread!==void 0&&f.thread.resultcode!==0){console.error(`[LiveCommentManager][CommentSession] Connection failed. (Code: ${f.thread.resultcode})`);return}if(f.ping!==void 0&&f.ping.content==="rf:0"){n=!0,this.destroyed===!1&&t.event_emitter.emit("CommentReceived",{is_initial_comments:!0,comments:i});return}const l=f.chat;if(l===void 0||l.content===void 0||l.content===""||l.yourpost&&l.yourpost===1&&n===!0)return;const{color:h,position:r,size:u}=Cn.parseCommentCommand(l.mail);if(Cn.isMutedComment(l.content,l.user_id,h,r,u))return;const m={id:l.no,text:l.content,time:Vi(l.date*1e3).format("HH:mm:ss"),playback_position:this.player.video.currentTime,user_id:l.user_id,my_post:!1,rekari:l.user_id.startsWith("rekari:")};if(n===!1){i.push(m);return}let p=0;this.player.video.buffered.length>=1&&(p=this.player.video.buffered.end(0));const _=Math.max(p-this.player.video.currentTime,0);St.isSafari()===!1&&console.debug(`[LiveCommentManager][CommentSession] Delay: ${_} sec.`),await St.sleep(_),o.push(m),c(),this.player.video.paused===!1&&this.player.danmaku.draw({text:l.content,color:m.rekari?`${h}C0`:h,type:r,size:u})},{signal:this.abort_controller.signal})}sendComment(e){const t=pi();if(lo(),t.live_comment_init_failed_message!==null){e.error(t.live_comment_init_failed_message);return}if(this.watch_session===null||this.watch_session.readyState!==WebSocket.OPEN){console.error("[LiveCommentManager][WatchSession] Comment sending failed. (Connection is not established.)"),e.error("コメントの送信に失敗しました。WebSocket 接続が確立されていません。");return}const i={"#FFEAEA":"white","#F02840":"red","#FD7E80":"pink","#FDA708":"orange","#FFE133":"yellow","#64DD17":"green","#00D4F5":"cyan","#4763FF":"blue"},n={top:"ue",right:"naka",bottom:"shita"},o=Math.round((Vi().valueOf()-this.vpos_base_timestamp)/10);this.watch_session.send(JSON.stringify({type:"postComment",data:{text:e.data.text,color:i[e.data.color.toUpperCase()],position:n[e.data.type],size:e.data.size,vpos:o,isAnonymous:!0}}));const a=new AbortController;this.watch_session.addEventListener("message",c=>{const d=JSON.parse(c.data);switch(d.type){case"postCommentResult":{e.success(),t.event_emitter.emit("CommentSendCompleted",{comment:{id:St.time(),text:e.data.text,time:Vi().format("HH:mm:ss"),playback_position:this.player.video.currentTime,user_id:"Unknown",my_post:!0,rekari:!1}}),a.abort();break}case"error":{let f=`コメントの送信に失敗しました。(${d.data.code})`;switch(d.data.code){case"COMMENT_POST_NOT_ALLOWED":f="コメントが許可されていません。";break;case"INVALID_MESSAGE":f="コメント内容が無効です。";break}console.error(`[LiveCommentManager][WatchSession] Comment sending failed. (Code: ${d.data.code})`),e.error(f),a.abort();break}}},{signal:a.signal})}async reconnect(){const e=pi(),t=this.watch_session!==null&&(this.watch_session.readyState===WebSocket.CLOSING||this.watch_session.readyState===WebSocket.CLOSED),i=this.comment_session!==null&&(this.comment_session.readyState===WebSocket.CLOSING||this.comment_session.readyState===WebSocket.CLOSED);if(this.reconnecting===!0&&t===!1&&i===!1)return;this.reconnecting=!0,console.warn("[LiveCommentManager] Reconnecting..."),this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice("NX-Jikkyo に再接続しています…"),await this.destroy();const n=await this.initWatchSession();if(n.is_success===!1){e.live_comment_init_failed_message=n.detail,console.error("[LiveCommentManager] Reconnection failed."),this.player.template.notice.textContent.includes("再起動しています…")===!1&&this.player.notice(n.detail,void 0,void 0,"#FF6F6A"),this.reconnecting=!1;return}this.initCommentSession(n),this.destroyed=!1,this.reconnecting=!1,console.warn("[LiveCommentManager] Reconnected.")}async destroy(){const e=pi();this.abort_controller.abort(),this.abort_controller=new AbortController,this.watch_session!==null&&(this.watch_session.close(),this.watch_session=null),this.comment_session!==null&&(this.comment_session.close(),this.comment_session=null),this.keep_seat_interval_id!==null&&(window.clearInterval(this.keep_seat_interval_id),this.keep_seat_interval_id=null),this.vpos_base_timestamp=0,e.live_comment_init_failed_message=null,this.destroyed=!0,console.log("[LiveCommentManager] Destroyed.")}}const $n=class $n{constructor(e){ye(this,"player",null);ye(this,"player_managers",[]);ye(this,"playback_mode");ye(this,"tv_streaming_quality");ye(this,"tv_data_saver_mode");ye(this,"tv_low_latency_mode");ye(this,"video_streaming_quality");ye(this,"video_data_saver_mode");ye(this,"live_playback_buffer_seconds");ye(this,"live_force_seek_interval_timer_cancel",null);ye(this,"video_keep_alive_interval_timer_cancel",null);ye(this,"player_container_resize_observer",null);ye(this,"player_control_ui_hide_timer_id",0);ye(this,"screen_wake_lock",null);ye(this,"romsounds_context",new AudioContext);ye(this,"romsounds_buffers",[]);ye(this,"destroying",!1);ye(this,"destroyed",!1);this.playback_mode=e;const t=Ni(),i=Zn.getNetworkCircuitType();this.tv_streaming_quality=i==="Cellular"?t.settings.tv_streaming_quality_cellular:t.settings.tv_streaming_quality,this.tv_data_saver_mode=i==="Cellular"?t.settings.tv_data_saver_mode_cellular:t.settings.tv_data_saver_mode,this.tv_low_latency_mode=i==="Cellular"?t.settings.tv_low_latency_mode_cellular:t.settings.tv_low_latency_mode,this.video_streaming_quality=i==="Cellular"?t.settings.video_streaming_quality_cellular:t.settings.video_streaming_quality,this.video_data_saver_mode=i==="Cellular"?t.settings.video_data_saver_mode_cellular:t.settings.video_data_saver_mode,this.live_playback_buffer_seconds=this.tv_low_latency_mode?$n.LIVE_PLAYBACK_BUFFER_SECONDS_LOW_LATENCY:$n.LIVE_PLAYBACK_BUFFER_SECONDS,St.isSafari()===!0&&(this.live_playback_buffer_seconds+=.3)}async init(){const e=sn(),t=pi(),i=Ni();console.log("\x1B[31m[PlayerController] Initializing..."),this.destroyed=!1,t.is_player_initialized=!0,window.mpegts=Kl,window.Hls=yn;const n=this.playback_mode==="Live"?i.settings.tv_show_superimpose:i.settings.video_show_superimpose;localStorage.getItem("dplayer-danmaku-opacity")===null&&localStorage.setItem("dplayer-danmaku-opacity","1.0");let o="";t.recorded_program.id==-100&&(o=this.createSilentAudioBuffer(t.recorded_program.duration,3e3,1),console.log("\x1B[31m[PlayerController] audio_url:",o)),this.player=new qg({container:document.querySelector(".watch-player__dplayer"),theme:"#E64F97",lang:"ja-jp",live:this.playback_mode==="Live",liveSyncMinBufferSize:this.live_playback_buffer_seconds-.1,loop:(this.playback_mode==="Live",!1),autoplay:!0,airplay:!1,hotkey:!1,screenshot:!1,crossOrigin:"anonymous",volume:1,video:(()=>{const a=[];let c="";if(Zn.isHEVCVideoSupported()&&(this.playback_mode==="Live"&&this.tv_data_saver_mode===!0||this.playback_mode==="Video"&&this.video_data_saver_mode===!0)&&(c="-hevc"),this.playback_mode==="Live"){const d=`${St.api_base_url}/streams/live/${e.channel.current.display_channel_id}`;if(e.channel.current.is_radiochannel===!0)a.push({name:"48kHz/192kbps",type:"mpegts",url:`${d}/1080p/mpegts`});else for(const l of Su)a.push({name:l==="1080p-60fps"?"1080p (60fps)":l,type:"mpegts",url:`${d}/${l}${c}/mpegts`});let f=this.tv_streaming_quality;return e.channel.current.is_radiochannel&&(f="48kHz/192kbps"),{quality:a,defaultQuality:f}}else return{quality:[{name:"Silent",type:"normal",url:o}],defaultQuality:"Silent"}})(),danmaku:{user:"NX-Jikkyo",speedRate:i.settings.comment_speed_rate,fontSize:i.settings.comment_font_size,closeCommentFormAfterSend:i.settings.close_comment_form_after_sending},apiBackend:{read:async a=>{if(this.playback_mode==="Live")a.success([]);else{const c=await qu.fetchVideoJikkyoComments(t.recorded_program);if(c.is_success===!1)t.video_comment_init_failed_message=c.detail,c.detail!=="この録画番組の過去ログコメントは存在しないか、現在取得中です。"?a.error(c.detail):a.success([]);else{const d=t.recorded_program.recorded_video.recording_start_time;let f=0;t.event_emitter.emit("CommentReceived",{is_initial_comments:!0,comments:c.comments.map(l=>({id:f++,text:l.text,time:Vi(d).add(l.time,"seconds").format("MM/DD HH:mm:ss"),playback_position:l.time,user_id:l.author,my_post:!1,rekari:l.author.startsWith("rekari:")}))}),a.success(c.comments)}}},send:async a=>{if(this.playback_mode==="Live"){for(const c of this.player_managers)if(c instanceof Xl){c.sendComment(a);return}}else a.error("録画番組にはコメントできません。")}},subtitle:{type:"aribb24"},pluginOptions:{mpegts:{config:{enableWorker:!0,enableWorkerForMSE:window.MediaSource&&window.MediaSource.canConstructInDedicatedWorker===!0,enableStashBuffer:!0,stashInitialSize:Math.floor(2048*1024),liveSync:this.tv_low_latency_mode,liveSyncMaxLatency:3,liveSyncTargetLatency:this.live_playback_buffer_seconds,liveSyncPlaybackRate:1.1}},hls:{...yn.DefaultConfig,debug:!0,enableWorker:!0,preferManagedMediaSource:!1,manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e6,maxLoadTimeMs:1e6,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e6,maxLoadTimeMs:1e6,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e6,maxLoadTimeMs:1e6,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}}},aribb24:{disableSuperimposeRenderer:n===!1,normalFont:`"${i.settings.caption_font}", "Rounded M+ 1m for ARIB", sans-serif`,forceStrokeColor:i.settings.always_border_caption_text,forceBackgroundColor:(()=>{if(i.settings.specify_caption_opacity===!0)return`rgba(0, 0, 0, ${i.settings.caption_opacity})`})(),drcsReplacement:!0,enableRawCanvas:!0,useStroke:!0,usePUA:(()=>{const a=i.settings.caption_font,c=document.createElement("canvas").getContext("2d");return c.font='10px "Rounded M+ 1m for ARIB"',c.fillText("Test",0,0),c.font=`10px "${a}"`,c.fillText("Test",0,0),!!a.startsWith("Windows TV")})(),PRACallback:async a=>{if(n===!1)return;this.romsounds_context.state==="suspended"&&await this.romsounds_context.resume();const c=this.romsounds_context.createBufferSource();c.buffer=this.romsounds_buffers[a];const d=this.romsounds_context.createGain();c.connect(d),d.connect(this.romsounds_context.destination),d.gain.value=3,c.start(0)}}}}),window.player=this.player,this.player.container.classList.contains("dplayer-mobile")===!0&&this.player.volume(1,void 0,!0),this.player.controller.setAutoHide=a=>{},this.setupFullscreenHandler(),this.setupSettingPanelHandler(),this.setupPlayerContainerResizeHandler(),this.setControlDisplayTimer(),t.event_emitter.off("SendNotification"),t.event_emitter.on("SendNotification",a=>{this.destroyed===!0||this.player===null||this.player.notice(a.message,a.duration,a.opacity,a.color)}),t.event_emitter.off("SetControlDisplayTimer"),t.event_emitter.on("SetControlDisplayTimer",a=>{this.setControlDisplayTimer(a.event,a.is_player_region_event,a.timeout_seconds)}),"wakeLock"in navigator&&navigator.wakeLock.request("screen").then(a=>{this.screen_wake_lock=a,console.log("\x1B[31m[PlayerController] Screen Wake Lock API: Screen Wake Lock acquired.")}),this.playback_mode==="Live"?this.player_managers=[new Xl(this.player),new Wl(this.player,this.playback_mode),new Yl(this.player,this.playback_mode)]:this.player_managers=[new Wl(this.player,this.playback_mode),new Yl(this.player,this.playback_mode)],await Promise.all(this.player_managers.map(a=>a.init())),t.background_url=Zn.generatePlayerBackgroundURL(),t.is_background_display=!0,t.is_video_buffering=!1,console.log("\x1B[31m[PlayerController] Initialized.")}createSilentAudioBuffer(e,t,i){const o=[];for(let h=0;h<e;h+=3600){const r=Math.min(3600,e-h),u=Math.floor(r*t),m=new AudioBuffer({length:u,sampleRate:t,numberOfChannels:i});for(let p=0;p<i;p++){const _=m.getChannelData(p);for(let A=0;A<u;A++)_[A]=0}o.push(m)}const a=new Uint8Array(44),c=new DataView(a.buffer);c.setUint32(0,1380533830,!1),c.setUint32(4,36+e*t*i*2,!0),c.setUint32(8,1463899717,!1),c.setUint32(12,1718449184,!1),c.setUint32(16,16,!0),c.setUint16(20,1,!0),c.setUint16(22,i,!0),c.setUint32(24,t,!0),c.setUint32(28,t*i*2,!0),c.setUint16(32,i*2,!0),c.setUint16(34,16,!0),c.setUint32(36,1684108385,!1),c.setUint32(40,e*t*i*2,!0);const d=new ArrayBuffer(a.length+e*t*i*2),f=new DataView(d);f.setUint8(0,a[0]);for(let h=0;h<a.length;h++)f.setUint8(h,a[h]);let l=a.length;for(const h of o)for(let r=0;r<i;r++){const u=h.getChannelData(r);for(let m=0;m<h.length;m++)f.setInt16(l,u[m]*32767,!0),l+=2}return URL.createObjectURL(new Blob([d],{type:"audio/wav"}))}getPlaybackBufferSeconds(){if(this.player===null)return 0;if(this.playback_mode==="Live")try{const e=this.player.video.buffered.length,t=this.player.video.buffered.end(e-1)-this.player.video.currentTime;return St.mathFloor(t,3)}catch{return 0}else return 0}async recoverPlayback(){var t,i,n,o;Qi(this.player!==null);const e=pi();if(await St.sleep(1),e.is_video_buffering===!0&&((i=(t=this.player)==null?void 0:t.video)==null?void 0:i.readyState)<3){console.warn("\x1B[31m[PlayerController] Video still buffering. (HTMLVideoElement.readyState < HAVE_FUTURE_DATA) trying to recover."),this.player.video.pause(),await St.sleep(.25);try{await this.player.video.play()}catch{Qi(this.player!==null),console.warn("\x1B[31m[PlayerController] HTMLVideoElement.play() rejected. paused."),this.player.pause();return}if(await St.sleep(.5),e.is_video_buffering===!0&&((o=(n=this.player)==null?void 0:n.video)==null?void 0:o.readyState)<3){console.warn("\x1B[31m[PlayerController] Video still buffering. (HTMLVideoElement.readyState < HAVE_FUTURE_DATA) trying to recover."),this.player.video.pause(),await St.sleep(.25);try{await this.player.video.play()}catch{Qi(this.player!==null),console.warn("\x1B[31m[PlayerController] (retry) HTMLVideoElement.play() rejected. paused."),this.player.pause()}}}}setupVideoPlaybackHandler(){Qi(this.player!==null);const e=sn(),t=pi();this.playback_mode==="Live"&&(this.live_force_seek_interval_timer_cancel=St.setIntervalInWorker(()=>{this.player!==null&&this.player.video.paused&&this.player.video.buffered.length>=1&&this.player.video.buffered.end(0)-this.player.video.currentTime>30&&this.player.sync()},60*1e3)),this.playback_mode==="Video"&&(this.video_keep_alive_interval_timer_cancel=St.setIntervalInWorker(async()=>{if(this.player===null)return;const d=Zn.extractVideoAPIQualityFromDPlayer(this.player);await es.put(`${St.api_base_url}/streams/video/${t.recorded_program.id}/${d}/keep-alive`)},5*1e3));const i=()=>{this.player!==null&&(t.is_video_paused=this.player.video.paused,this.player.video.paused===!0&&t.is_loading===!1&&(t.is_video_buffering=!1),this.player.setting.hide(),this.setControlDisplayTimer())};this.player.on("play",i),this.player.on("pause",i),this.player.on("waiting",()=>{t.is_video_buffering=!0}),this.player.on("playing",()=>{t.is_loading===!1&&(t.is_video_buffering=!1),this.playback_mode==="Live"&&this.recoverPlayback()});const n=async()=>{var d;Qi(this.player!==null),t.background_url=Zn.generatePlayerBackgroundURL();for(const f of this.player_managers)f.restart_required_when_quality_switched===!0&&f.destroy().then(()=>f.init());if(this.playback_mode==="Live"){(d=this.player.plugins.mpegts)==null||d.on(Kl.Events.ERROR,async(h,r)=>{this.player!==null&&(await St.sleep(1),navigator.onLine===!1&&(this.player.notice("現在ネットワーク接続がありません。オンラインになるまで待機しています…",void 0,void 0,"#FF6F6A"),console.warn("\x1B[31m[PlayerController] mpegts.js error event: Network error. Waiting for online..."),await St.waitUntilOnline()),console.error("\x1B[31m[PlayerController] mpegts.js error event:",h,r),t.event_emitter.emit("PlayerRestartRequired",{message:`再生中にエラーが発生しました。(${h}: ${r}) プレイヤーを再起動しています…`}))}),this.player.on("error",async h=>{this.player===null||t.live_stream_status==="Offline"||(await St.sleep(1),this.player.video.error?(console.error("\x1B[31m[PlayerController] HTMLVideoElement error event:",this.player.video.error),t.event_emitter.emit("PlayerRestartRequired",{message:`再生中にエラーが発生しました。(Native: ${this.player.video.error.code}: ${this.player.video.error.message}) プレイヤーを再起動しています…`})):t.event_emitter.emit("PlayerRestartRequired",{message:"再生中にエラーが発生しました。(Native: unknown error) プレイヤーを再起動しています…"}))}),t.is_loading=!0,this.player.video.muted=!0;let f=!1;const l=async()=>{if(this.player===null||f===!0)return;this.player.video.oncanplaythrough=null,f=!0,console.log("\x1B[31m[PlayerController] buffering..."),this.player.video.playbackRate=0;let h=this.getPlaybackBufferSeconds();for(;h<this.live_playback_buffer_seconds;)await St.sleep(.1),h=this.getPlaybackBufferSeconds();this.player.video.playbackRate=1,console.log("\x1B[31m[PlayerController] buffering completed."),t.is_loading=!1,t.is_video_buffering=!1,this.recoverPlayback(),e.channel.current.is_radiochannel===!0?t.is_background_display=!0:t.is_background_display=!1,this.player.video.muted=!1,this.player.video.volume=0;const r=this.player.user.get("volume"),u=r/10;for(let m=0;m<10;m++)await St.sleep(.5/10),this.player.video.volume=Math.min(St.mathFloor(this.player.video.volume+u,3),r);this.player.video.volume=r};if(this.player.video.oncanplaythrough=l,(async()=>{for(;this.player!==null&&this.player.video.readyState<4;)await St.sleep(.05);await St.sleep(.1),f===!1&&(console.warn("\x1B[31m[PlayerController] canplaythrough event not fired. trying to recover."),l())})(),await St.sleep(15),this.destroyed===!0||this.player===null)return;t.live_stream_status==="ONAir"&&t.is_video_buffering===!0&&f===!1&&t.event_emitter.emit("PlayerRestartRequired",{message:"再生開始までに時間が掛かっています。プレイヤーを再起動しています…"})}else{t.is_loading=!0,t.is_background_display=!0;let f=!1;const l=async()=>{this.player!==null&&f!==!0&&(this.player.video.oncanplaythrough=null,f=!0,t.is_loading=!1,t.is_video_buffering=!1,t.is_background_display=!1)};this.player.video.oncanplaythrough=l}};n(),this.player.on("quality_start",n);let o=0,a=0;const c=document.querySelector(".program-info__next");c!==null&&(c.ontouchstart=()=>{if(this.player===null)return;const d=new Date().getTime(),f=d-a;f<500&&f>0&&(o++,o===3&&(this.player.infoPanel.toggle(),o=0)),a=d})}setupFullscreenHandler(){Qi(this.player!==null);const e=pi(),t=document.body;this.player.fullScreen.isFullScreen=n=>!!(document.fullscreenElement||document.webkitFullscreenElement),this.player.fullScreen.request=n=>{if(Qi(this.player!==null),this.player.fullScreen.isFullScreen()){this.player.fullScreen.cancel();return}if(t.requestFullscreen=t.requestFullscreen||t.webkitRequestFullscreen,t.requestFullscreen)t.requestFullscreen();else{this.player.notice("iPhone Safari は動画のフルスクリーン表示に対応していません。",void 0,void 0,"#FF6F6A");return}screen.orientation&&screen.orientation.lock("landscape").catch(()=>{})},this.player.fullScreen.cancel=n=>{document.exitFullscreen=document.exitFullscreen||document.webkitExitFullscreen,document.exitFullscreen&&document.exitFullscreen(),screen.orientation&&screen.orientation.unlock()};const i=()=>{Qi(this.player!==null),e.is_fullscreen=this.player.fullScreen.isFullScreen()===!0};t.onfullscreenchange!==void 0?t.onfullscreenchange=i:t.onwebkitfullscreenchange!==void 0&&(t.onwebkitfullscreenchange=i)}setupSettingPanelHandler(){Qi(this.player!==null);const e=pi();St.isTouchDevice()===!1&&(this.player.template.settingOriginPanel.insertAdjacentHTML("beforeend",`
            <div class="dplayer-setting-item dplayer-setting-keyboard-shortcut">
                <span class="dplayer-label">キーボードショートカット</span>
                <div class="dplayer-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32">
                        <path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path>
                    </svg>
                </div>
            </div>`),this.player.template.settingOriginPanel.querySelector(".dplayer-setting-keyboard-shortcut").addEventListener("click",()=>{Qi(this.player!==null),this.player.setting.hide(),e.shortcut_key_modal=!0}))}setupPlayerContainerResizeHandler(){const e=document.querySelector(".watch-player"),t=()=>{if(this.player===null)return;const i=this.player.danmaku.container,n=i.clientWidth,o=i.clientWidth*(9/16);if(e===null||e.clientHeight===null)return;const a=(e.clientHeight-o)/2,c=St.isSmartphoneVertical()?0:St.isSmartphoneHorizontal()?50:66;if(a<c){const d=(c-a)*2,f=n,l=o-d,h=(m,p)=>p===0?m:h(p,m%p),r=h(f,l),u=`${f/r} / ${l/r}`;i.style.transition="none",i.style.setProperty("--comment-area-aspect-ratio",u),i.style.setProperty("--comment-area-vertical-margin",`${d}px`),window.setTimeout(()=>i.style.transition="",.2*1e3)}else i.style.removeProperty("--comment-area-aspect-ratio"),i.style.removeProperty("--comment-area-vertical-margin")};t(),this.player_container_resize_observer=new ResizeObserver(t),this.player_container_resize_observer.observe(e)}setControlDisplayTimer(e=null,t=!1,i=3){const n=pi();if(St.isTouchDevice()===!0&&e!==null&&e.type==="mousemove"||St.isTouchDevice()===!1&&e!==null&&(e.type==="touchmove"||e.type==="click"))return;window.clearTimeout(this.player_control_ui_hide_timer_id);const o=()=>{if(this.player!==null){if(this.player.template.controller.classList.contains("dplayer-controller-comment")){this.player_control_ui_hide_timer_id=window.setTimeout(o,i*1e3);return}n.is_control_display=!1,this.player.controller.hide(),this.player.setting.hide()}};this.player!==null&&(St.isTouchDevice()===!0&&t===!0?this.player.controller.isShow()?(n.is_control_display=!0,this.player.controller.show(),this.player_control_ui_hide_timer_id=window.setTimeout(o,i*1e3)):(n.is_control_display=!1,this.player.controller.hide(),this.player.setting.hide()):(n.is_control_display=!0,this.player.controller.show(),this.player_control_ui_hide_timer_id=window.setTimeout(o,i*1e3)))}async destroy(){const e=pi();if(this.destroyed!==!0&&this.destroying!==!0){if(this.destroying=!0,console.log("\x1B[31m[PlayerController] Destroying..."),await Promise.all(this.player_managers.map(async t=>t.destroy())),this.player_managers=[],this.screen_wake_lock!==null&&(this.screen_wake_lock.release(),this.screen_wake_lock=null,console.log("\x1B[31m[PlayerController] Screen Wake Lock API: Screen Wake Lock released.")),e.is_background_display=!1,e.is_loading=!0,e.live_comment_init_failed_message=null,e.video_comment_init_failed_message=null,this.player!==null){const i=this.player.user.get("volume")/10;for(let n=0;n<10;n++)await St.sleep(.2/10),this.player&&this.player.video&&(this.player.video.volume=Math.max(St.mathFloor(this.player.video.volume-i,3),0));this.player.video.volume=0}if(this.live_force_seek_interval_timer_cancel!==null&&(this.live_force_seek_interval_timer_cancel(),this.live_force_seek_interval_timer_cancel=null),this.video_keep_alive_interval_timer_cancel!==null&&(this.video_keep_alive_interval_timer_cancel(),this.video_keep_alive_interval_timer_cancel=null),window.clearTimeout(this.player_control_ui_hide_timer_id),this.player_container_resize_observer!==null&&(this.player_container_resize_observer.disconnect(),this.player_container_resize_observer=null),this.player!==null){if(this.player.events.events.error&&(this.player.events.events.error=[]),this.player.plugins.mpegts)try{this.player.plugins.mpegts.unload(),this.player.plugins.mpegts.detachMediaElement(),this.player.plugins.mpegts.destroy()}catch{}this.player.danmaku.clear();try{this.player.destroy(!0)}catch{}this.player=null}this.destroying=!1,this.destroyed=!0,e.is_player_initialized=!1,console.log("\x1B[31m[PlayerController] Destroyed.")}}};ye($n,"LIVE_PLAYBACK_BUFFER_SECONDS_LOW_LATENCY",.8),ye($n,"LIVE_PLAYBACK_BUFFER_SECONDS",4);let Cs=$n;const Sb=Cs;export{uo as I,Sb as P,vb as W,pi as u};
