import{d,m as u,U as h,u as m,_,k as f,o as y,j as S}from"./index-C5RVHb70.js";import{W as w,P as v,u as $}from"./PlayerController-CK7DHp4a.js";import{u as b}from"./ChannelsStore-DLXPWJ_3.js";import"./ssrBoot-BuooRlv8.js";import"./VSwitch-BFGCT1N1.js";import"./VSelect-CDnJNCSN.js";import"./VAvatar-BF6yPvXH.js";import"./VCard-DMVRFrig.js";import"./swiper-CmuVZaAP.js";import"./CommentMuteSettings-D5E7npXh.js";let r=null;const g=d({name:"TV-Watch",components:{Watch:w},data(){return{interval_ids:[]}},computed:{...u(b,$,m)},created(){this.channelsStore.display_channel_id=this.$route.params.display_channel_id,this.init()},beforeRouteUpdate(n,e,i){const t=this.destroy();this.channelsStore.display_channel_id=n.params.display_channel_id,(async()=>this.playerStore.is_zapping===!0?(this.playerStore.is_zapping=!1,this.interval_ids.push(window.setTimeout(()=>{t.then(()=>this.init())},.5*1e3))):t.then(()=>this.init()))(),i()},beforeUnmount(){this.destroy(),this.channelsStore.display_channel_id="gr000"},methods:{async init(){var i;if(this.interval_ids.push(window.setTimeout(()=>{this.channelsStore.update(!0),this.interval_ids.push(window.setInterval(()=>{this.channelsStore.update(!0)},30*1e3))},0*1e3)),await this.channelsStore.update(),this.$route.params.display_channel_id===void 0){this.$router.push({path:"/not-found/"});return}if(this.channelsStore.channel.current.name==="チャンネル情報取得エラー"){await h.sleep(3),this.$router.push({path:"/not-found/"});return}const e=this.channelsStore.channel.current;if(e){const t=`テレビ実況 - Ch: ${e.channel_number} ${e.name} | NX-Jikkyo : ニコニコ実況避難所`,s=((i=e.program_present)==null?void 0:i.description)||"";document.title=t;const a=document.querySelector('meta[name="description"]');a&&a.setAttribute("content",s);const o=document.querySelector('meta[property="og:title"]');o&&o.setAttribute("content",t);const c=document.querySelector('meta[property="og:description"]');c&&c.setAttribute("content",s);const l=document.querySelector('meta[name="twitter:title"]');l&&l.setAttribute("content",t);const p=document.querySelector('meta[name="twitter:description"]');p&&p.setAttribute("content",s)}r=new v("Live"),await r.init()},async destroy(){for(const n of this.interval_ids)window.clearInterval(n);this.interval_ids=[],r!==null&&(await r.destroy(),r=null)}}});function W(n,e,i,t,s,a){const o=S("Watch",!0);return y(),f(o,{playback_mode:"Live"})}const I=_(g,[["render",W]]);export{I as default};
