import{d as H,U as F,P as N,m as U,M as E,u as $,_ as I,r as c,a as M,o as i,c as r,b as _,e as t,n as p,f as w,F as v,g as f,w as C,v as z,h as m,i as D,j as S,k as b,l as o,t as l,V as L,p as k,R as A,q as R,s as q}from"./index-B3SKrUvi.js";import{S as J,a as X}from"./swiper-kZFv2gtC.js";import{H as K,N as O}from"./Navigation-CL5eC0TK.js";import{C as Z,u as Y}from"./ChannelsStore-Bg59Bg8c.js";import{V as G}from"./ssrBoot-CtioA9ao.js";const W=H({name:"TV-Home",components:{HeaderBar:K,Navigation:O,Swiper:J,SwiperSlide:X},data(){return{Utils:Object.freeze(F),ChannelUtils:Object.freeze(Z),ProgramUtils:Object.freeze(N),active_tab_index:0,swiper_instance:null,scroll_abort_controller:new AbortController,is_loading:!0,interval_ids:[]}},computed:{...U(Y,$)},watch:{active_tab_index(){var u,s;(u=this.swiper_instance)==null||u.updateAutoHeight(),(s=this.swiper_instance)==null||s.slideTo(this.active_tab_index,this.is_loading===!0?0:void 0)}},async mounted(){var s,h;this.settingsStore.settings.pinned_channel_ids.length===0&&(this.active_tab_index=1);const u=60-new Date().getSeconds();this.interval_ids.push(window.setTimeout(()=>{this.channelsStore.update(!0),this.interval_ids.push(window.setInterval(()=>this.channelsStore.update(!0),30*1e3))},u*1e3)),await this.channelsStore.update(),((s=this.channelsStore.channels_list_with_pinned.get("ピン留め"))==null?void 0:s.length)===0&&(this.active_tab_index=1),(h=this.swiper_instance)==null||h.updateAutoHeight(),window.addEventListener("scroll",()=>{var g;(g=this.swiper_instance)==null||g.updateAutoHeight()},{passive:!0,signal:this.scroll_abort_controller.signal}),await F.sleep(.01),this.is_loading=!1},beforeUnmount(){for(const u of this.interval_ids)window.clearInterval(u);this.scroll_abort_controller.abort(),this.scroll_abort_controller=new AbortController},methods:{addPinnedChannel(u){this.settingsStore.settings.pinned_channel_ids=[...this.settingsStore.settings.pinned_channel_ids,u.id],E.show(`${u.name}をピン留めしました。`)},removePinnedChannel(u){var s;this.settingsStore.settings.pinned_channel_ids=this.settingsStore.settings.pinned_channel_ids.filter(h=>h!==u.id),((s=this.channelsStore.channels_list_with_pinned.get("ピン留め"))==null?void 0:s.length)===0&&(this.active_tab_index=1),E.show(`${u.name}のピン留めを外しました。`)},isPinnedChannel(u){return this.settingsStore.settings.pinned_channel_ids.includes(u.id)}}}),a=u=>(R("data-v-d1342f3b"),u=u(),q(),u),Q={class:"route-container"},uu=S('<div class="mt-5 mb-2 mx-4 text-center font-weight-bold" style="font-size:15px;" data-v-d1342f3b><blockquote class="text-left mx-auto" style="max-width:720px;" data-v-d1342f3b> 【重要なお知らせ】ニコニコ公式から「仮復旧」と称して <a class="link" href="https://originalnews.nico/464285" target="_blank" data-v-d1342f3b>ニコニコ実況(Re:仮)</a> がリリースされましたが、<br data-v-d1342f3b><a class="link" href="https://x.com/TVRemotePlus/status/1813121242565656577" target="_blank" data-v-d1342f3b> 「過去ログが残らず古いコメントから消えていく」<br class="d-inline d-sm-none" data-v-d1342f3b> 「技術的にニコ生との API 互換性が皆無」<br data-v-d1342f3b> 「コメント書き込み時に Captcha が入ってるため TVTest などのサードパーティーソフトで対応不可」<br data-v-d1342f3b> 「当然 NHK BS・BS11 以外の BS チャンネルには非対応」な使い捨ての劣化版クソサービス</a> なので、<br data-v-d1342f3b>何卒引き続きこの NX-Jikkyo 避難所でのコメントをお願いいたします…🙏🙏 </blockquote><div class="mt-2" data-v-d1342f3b>ぜひこのサイトをまだ NX-Jikkyo を知らないニコニコ実況難民の方に広めていただけると嬉しいです！</div><div class="mt-1" data-v-d1342f3b><a class="link" href="https://air.fem.jp/jkcommentviewer/" target="_blank" data-v-d1342f3b>jkcommentviewer</a> / <a class="link" href="https://blog.tsukumijima.net/article/nx-jikkyo-released/#toc4" target="_blank" data-v-d1342f3b>TVTest (NicoJK)</a> / <a class="link" href="https://github.com/tsukumijima/KonomiTV/releases/tag/v0.10.1" target="_blank" data-v-d1342f3b>KonomiTV</a> 最新版で NX-Jikkyo に対応しました！！🎉🎊</div><div class="mt-1" data-v-d1342f3b> 最新情報は <a class="link" href="https://x.com/search?q=%23NXJikkyo&amp;src=typed_query" target="_blank" data-v-d1342f3b>Twitter</a> で発信中です📣 <a class="link" href="https://www.amazon.co.jp/hz/wishlist/ls/3AZ4RI13SW2PV?tag=tsukumijima-22" target="_blank" data-v-d1342f3b>干し芋 or アマギフいただけると大変モチベ上がるのでぜひ🙇🙏</a></div><div class="mt-1" data-v-d1342f3b><a class="link" href="https://x.com/TVRemotePlus/status/1807923274061697127" target="_blank" data-v-d1342f3b>サーバーをスペックアップしました！🎉</a> ぜひ <a class="link" href="https://www.amazon.co.jp/dp/B0C1YY8GSB/?tag=tsukumijima-22" target="_blank" data-v-d1342f3b>このアフィリンク</a> から Amazon で何かお買い物して頂けると助かります🙏 </div></div>',1),tu={class:"channels-tab"},eu=a(()=>t("div",{class:"channels-tab__highlight"},null,-1)),su={class:"channel__broadcaster"},au=["src"],nu={class:"channel__broadcaster-content"},iu={class:"channel__broadcaster-name"},ou={class:"channel__broadcaster-status"},ru=a(()=>t("svg",{class:"iconify iconify--fa-solid",width:"10.5px",height:"12px",viewBox:"0 0 448 512"},[t("path",{fill:"currentColor",d:"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z"})],-1)),lu=a(()=>t("span",{class:"ml-1"},"勢い:",-1)),du={class:"ml-1"},cu=a(()=>t("span",{style:{"margin-left":"3px"}}," コメ/分",-1)),_u={class:"channel__broadcaster-status-viewers ml-2"},hu=a(()=>t("span",{class:"ml-1"},"コメント数:",-1)),pu={class:"ml-1"},mu=["onClick"],gu=a(()=>t("svg",{class:"iconify iconify--fluent",width:"24px",height:"24px",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M13.325 2.617a2 2 0 0 0-3.203.52l-1.73 3.459a1.5 1.5 0 0 1-.784.721l-3.59 1.436a1 1 0 0 0-.335 1.636L6.293 13L3 16.292V17h.707L7 13.706l2.61 2.61a1 1 0 0 0 1.636-.335l1.436-3.59a1.5 1.5 0 0 1 .722-.784l3.458-1.73a2 2 0 0 0 .52-3.203l-4.057-4.057Z"})],-1)),vu=[gu],fu={class:"channel__program-present"},Cu={class:"channel__program-present-title-wrapper"},bu=["innerHTML"],Bu={class:"channel__program-present-time"},Fu=["innerHTML"],Eu={class:"channel__program-following"},wu={class:"channel__program-following-title"},Du=a(()=>t("span",{class:"channel__program-following-title-decorate"},"NEXT",-1)),ku=a(()=>t("svg",{class:"channel__program-following-title-icon iconify iconify--fluent",width:"16px",height:"16px",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z"})],-1)),Au=["innerHTML"],Su={class:"channel__program-following-time"},yu={class:"channel__progressbar"},xu={key:0,class:"pinned-container d-flex justify-center align-center w-100"},Pu={class:"d-flex justify-center align-center flex-column"},Tu=a(()=>t("h2",null,[o("ピン留めされているチャンネルが"),t("br"),o("ありません。")],-1)),ju={class:"mt-4 text-text-darken-1"},Vu=a(()=>t("br",null,null,-1)),Hu=a(()=>t("div",{class:"mt-2 text-text-darken-1"},[o("チャンネルをピン留めすると、"),t("br"),o("このタブが最初に表示されます。")],-1)),Nu={key:0,class:"channels-list pinned-container d-flex justify-center align-center w-100",style:{"flex-grow":"1"}},Uu=S('<div class="d-flex justify-center align-center flex-column" data-v-d1342f3b><h2 data-v-d1342f3b>視聴可能なチャンネルが<br class="d-sm-none" data-v-d1342f3b>ありません。</h2><div class="mt-4 text-text-darken-1" data-v-d1342f3b>前回チャンネルスキャンしたときに<br class="d-sm-none" data-v-d1342f3b>受信可能なチャンネルを見つけられませんでした。</div><div class="mt-1 text-text-darken-1" data-v-d1342f3b>再度チャンネルスキャンを行ってください。</div></div>',1),$u=[Uu];function Iu(u,s,h,g,Mu,zu){const y=c("HeaderBar"),x=c("Navigation"),B=c("Icon"),P=c("router-link"),T=c("SwiperSlide"),j=c("Swiper"),V=M("tooltip");return i(),r("div",Q,[_(y),t("main",null,[_(x),t("div",{class:p(["channels-container channels-container--home",{"channels-container--loading":u.is_loading}])},[uu,t("div",tu,[t("div",{class:"channels-tab__buttons",style:w({"--tab-length":Array.from(u.channelsStore.channels_list_with_pinned).length,"--active-tab-index":u.active_tab_index})},[(i(!0),r(v,null,f(Array.from(u.channelsStore.channels_list_with_pinned),([n],d)=>(i(),b(L,{variant:"flat",class:p(["channels-tab__button",{"channels-tab__button--active":u.active_tab_index===d}]),key:n,onClick:e=>u.active_tab_index=d},{default:m(()=>[o(l(n),1)]),_:2},1032,["class","onClick"]))),128)),eu],4)]),C(_(j,{class:"channels-list","space-between":32,"auto-height":!0,"touch-start-prevent-default":!1,observer:!0,"observe-parents":!0,onSwiper:s[1]||(s[1]=n=>u.swiper_instance=n),onSlideChange:s[2]||(s[2]=n=>u.active_tab_index=n.activeIndex)},{default:m(()=>[(i(!0),r(v,null,f(Array.from(u.channelsStore.channels_list_with_pinned),([n,d])=>(i(),b(T,{key:n},{default:m(()=>[t("div",{class:p(["channels",`channels--tab-${n} channels--length-${d.length}`])},[(i(!0),r(v,null,f(d,e=>C((i(),b(P,{class:"channel",draggable:"false",key:e.id,to:`/watch/${e.display_channel_id}`},{default:m(()=>[t("div",su,[t("img",{class:"channel__broadcaster-icon",src:`${u.Utils.api_base_url}/channels/${e.id}/logo`},null,8,au),t("div",nu,[t("span",iu,"Ch: "+l(e.channel_number)+" "+l(e.name),1),t("div",ou,[t("div",{class:p(["channel__broadcaster-status-force",`channel__broadcaster-status-force--${u.ChannelUtils.getChannelForceType(e.jikkyo_force)}`])},[ru,lu,t("span",du,l(e.jikkyo_force??"--"),1),cu],2),t("div",_u,[_(B,{icon:"bi:chat-left-text-fill",height:"11px"}),hu,t("span",pu,l(e.viewer_count),1)])])]),C((i(),r("div",{class:p(["channel__broadcaster-pin",{"channel__broadcaster-pin--pinned":u.isPinnedChannel(e)}]),onClick:k(Lu=>u.isPinnedChannel(e)?u.removePinnedChannel(e):u.addPinnedChannel(e),["prevent","stop"]),onMousedown:s[0]||(s[0]=k(()=>{},["prevent","stop"]))},vu,42,mu)),[[A],[V,u.isPinnedChannel(e)?"ピン留めを外す":"ピン留めする"]])]),t("div",fu,[t("div",Cu,[t("span",{class:"channel__program-present-title",innerHTML:u.ProgramUtils.decorateProgramInfo(e.program_present,"title")},null,8,bu),t("span",Bu,l(u.ProgramUtils.getProgramTime(e.program_present)),1)]),t("span",{class:"channel__program-present-description",innerHTML:u.ProgramUtils.decorateProgramInfo(e.program_present,"description")},null,8,Fu)]),_(G),t("div",Eu,[t("div",wu,[Du,ku,t("span",{class:"channel__program-following-title-text",innerHTML:u.ProgramUtils.decorateProgramInfo(e.program_following,"title")},null,8,Au)]),t("span",Su,l(u.ProgramUtils.getProgramTime(e.program_following)),1)]),t("div",yu,[t("div",{class:"channel__progressbar-progress",style:w(`width:${u.ProgramUtils.getProgramProgress(e.program_present)}%;`)},null,4)])]),_:2},1032,["to"])),[[A]])),128)),n==="ピン留め"&&d.length===0?(i(),r("div",xu,[t("div",Pu,[Tu,t("div",ju,[o("各チャンネルの "),_(B,{style:{position:"relative",bottom:"-5px"},icon:"fluent:pin-20-filled",width:"22px"}),o(" アイコンから、よく実況する"),Vu,o("チャンネルをこのタブにピン留めできます。")]),Hu])])):D("",!0)],2)]),_:2},1024))),128))]),_:1},512),[[z,Array.from(u.channelsStore.channels_list_with_pinned).length>0]]),Array.from(u.channelsStore.channels_list_with_pinned).length===0?(i(),r("div",Nu,$u)):D("",!0)],2)])])}const Ou=I(W,[["render",Iu],["__scopeId","data-v-d1342f3b"]]);export{Ou as default};
