import{d,m as h,U as u,u as m,_,r as y,o as f,k as S}from"./index-Dawe3pgZ.js";import{W as w,P as v,u as $}from"./PlayerController-CZ_i1N3o.js";import{u as g}from"./ChannelsStore-BjTXyo1M.js";import"./ssrBoot-TB5zrPXz.js";import"./VSwitch-BpOYUuHe.js";import"./VSelect-BwTeTW_A.js";import"./VAvatar-CBd3PivA.js";import"./VCard-CLsm0ZHM.js";import"./swiper-DC4CkBDH.js";import"./CommentMuteSettings-rvDymRWD.js";let r=null;const b=d({name:"TV-Watch",components:{Watch:w},data(){return{interval_ids:[]}},computed:{...h(g,$,m)},created(){this.channelsStore.display_channel_id=this.$route.params.display_channel_id,this.init()},beforeRouteUpdate(e,n,i){const t=this.destroy();this.channelsStore.display_channel_id=e.params.display_channel_id,(async()=>this.playerStore.is_zapping===!0?(this.playerStore.is_zapping=!1,this.interval_ids.push(window.setTimeout(()=>{t.then(()=>this.init())},.5*1e3))):t.then(()=>this.init()))(),i()},beforeUnmount(){this.destroy(),this.channelsStore.display_channel_id="gr000"},methods:{async init(){var i;const e=60-new Date().getSeconds();if(this.interval_ids.push(window.setTimeout(()=>{this.channelsStore.update(!0),this.interval_ids.push(window.setInterval(()=>{this.channelsStore.update(!0)},30*1e3))},e*1e3)),await this.channelsStore.update(),this.$route.params.display_channel_id===void 0){this.$router.push({path:"/not-found/"});return}if(this.channelsStore.channel.current.name==="チャンネル情報取得エラー"){await u.sleep(3),this.$router.push({path:"/not-found/"});return}const n=this.channelsStore.channel.current;if(n){const t=`テレビ実況 - Ch: ${n.channel_number} ${n.name} | NX-Jikkyo : ニコニコ実況避難所`,o=((i=n.program_present)==null?void 0:i.description)||"";document.title=t;const a=document.querySelector('meta[name="description"]');a&&a.setAttribute("content",o);const s=document.querySelector('meta[property="og:title"]');s&&s.setAttribute("content",t);const c=document.querySelector('meta[property="og:description"]');c&&c.setAttribute("content",o);const l=document.querySelector('meta[name="twitter:title"]');l&&l.setAttribute("content",t);const p=document.querySelector('meta[name="twitter:description"]');p&&p.setAttribute("content",o)}r=new v("Live"),await r.init()},async destroy(){for(const e of this.interval_ids)window.clearInterval(e);this.interval_ids=[],r!==null&&(await r.destroy(),r=null)}}});function W(e,n,i,t,o,a){const s=y("Watch",!0);return f(),S(s,{playback_mode:"Live"})}const I=_(b,[["render",W]]);export{I as default};
